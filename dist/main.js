/*! For license information please see main.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.xayma=e():t.xayma=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};t.r(e),t.d(e,{Xayma:()=>Sl,init:()=>Cl});const n='<svg viewBox="0 0 152 152">\n  <path id="icon"\n    d="m76 0a76 76 0 1 0 76 76 76 76 0 0 0 -76-76zm-30.82 45.68a9.75 9.75 0 1 1 -9.74 9.75 9.75 9.75 0 0 1 9.74-9.75zm69.66 67.5a5.9 5.9 0 0 1 -4.18 1.73h-69.31a5.91 5.91 0 1 1 0-11.82h69.31a5.91 5.91 0 0 1 4.18 10.09zm-8-48a9.75 9.75 0 1 1 9.75-9.74 9.74 9.74 0 0 1 -9.77 9.73z">\n  </path>\n</svg>\n',i='<svg viewBox="0 0 152 152">\n  <path\n    d="m76 0a76 76 0 1 0 76 76 76 76 0 0 0 -76-76zm-37.57 58.43a9.75 9.75 0 1 1 9.75 9.75 9.75 9.75 0 0 1 -9.75-9.75zm63.51 59.17c-7.6-3-16.47-5.6-25.94-5.6s-18.34 2.61-25.94 5.6a3 3 0 0 1 -4.22-2.7c0-.15 0-.3 0-.45 2.25-14.61 14.88-23 30.12-23s27.87 8.41 30.12 23v.45a3 3 0 0 1 -4.14 2.7zm1.88-49.42a9.75 9.75 0 1 1 9.75-9.75 9.75 9.75 0 0 1 -9.75 9.75z">\n  </path>\n</svg>\n',s='<svg viewBox="0 0 152 152">\n  <path id="icon"\n    d="m76 0a76 76 0 1 0 76 76 76 76 0 0 0 -76-76zm-40.65 77.71c-4.39.85-4.71-2.38-4.57-4.18a3.48 3.48 0 0 1 .71-1.83l7.8-10a3.39 3.39 0 0 0 -.06-4.25l-7.69-9.28a3.3 3.3 0 0 1 -.76-1.8c-.29-3.56 2.49-4.31 4.16-4.44a3.36 3.36 0 0 1 2 .5l23.39 14.41c3.91 2.41 1 5.06.19 5.7a3.62 3.62 0 0 1 -.32.22l-23.76 14.52a3.11 3.11 0 0 1 -1.09.43zm73.35 43.71a89.78 89.78 0 0 0 -32.7-5.94 89.73 89.73 0 0 0 -32.69 5.94 3.82 3.82 0 0 1 -5.3-3.49 3.88 3.88 0 0 1 0-.48 38.41 38.41 0 0 1 75.91 0 4 4 0 0 1 0 .49 3.82 3.82 0 0 1 -5.22 3.48zm8-43.71a3 3 0 0 1 -1.09-.43l-23.8-14.52a3.62 3.62 0 0 1 -.32-.22c-.81-.64-3.72-3.29.19-5.7l23.38-14.36a3.41 3.41 0 0 1 2-.5c1.67.13 4.45.88 4.15 4.44a3.16 3.16 0 0 1 -.76 1.8l-7.68 9.28a3.37 3.37 0 0 0 -.06 4.25l7.79 10a3.41 3.41 0 0 1 .72 1.83c.15 1.75-.17 4.98-4.56 4.13z">\n  </path>\n\n</svg>\n',r='<svg viewBox="0 0 152 152">\n  <path\n    d="m76 0a76 76 0 1 0 76 76 76 76 0 0 0 -76-76zm27.82 48.69a9.75 9.75 0 1 1 -9.74 9.74 9.74 9.74 0 0 1 9.74-9.74zm-55.64 0a9.75 9.75 0 1 1 -9.74 9.74 9.75 9.75 0 0 1 9.74-9.74zm70.62 46.69c-3.19 18.21-21.14 30.84-42.8 30.84s-39.6-12.63-42.79-30.84a3.68 3.68 0 0 1 -.06-.56c0-2.63 3.2-4.33 6-3.37 10.8 3.73 23.4 5.63 36.86 5.63s26.06-1.9 36.86-5.63c2.79-1 6 .73 6 3.37a3.64 3.64 0 0 1 -.07.56z">\n  </path>\n  </path>\n</svg>\n',a='<svg viewBox="0 0 152 152">\n  <path\n    d="m76 0a76 76 0 1 0 76 76 76 76 0 0 0 -76-76zm-46.75 50.46c4.48-9.23 13.55-6.66 14.67-6.3.26-1.15 2.69-10.26 12.91-9.4 0 0 10 1.37 8.2 13.16l-5.9 22.48.24.41-.37-.09-.08.33-.24-.42-22.34-6.4c-11.03-4.46-7.09-13.77-7.09-13.77zm89.54 44.92c-3.19 18.21-21.13 30.84-42.79 30.84s-39.6-12.63-42.8-30.84a3.64 3.64 0 0 1 -.05-.56c0-2.63 3.2-4.33 6-3.37 10.79 3.73 23.39 5.63 36.85 5.63s26.05-1.9 36.86-5.63c2.79-1 6 .73 6 3.37a2.74 2.74 0 0 1 -.07.56zm-3.17-31.15-22.34 6.4-.24.42-.04-.33-.33.09.24-.41-5.91-22.48c-1.81-11.79 8.2-13.16 8.2-13.16 10.22-.86 12.64 8.25 12.91 9.4 1.12-.36 10.19-2.93 14.67 6.3-.03 0 3.9 9.31-7.16 13.77z">\n  </path>\n</svg>\n';let o='<div id="xayma-main" class="--xayma-main">\n  <div class="--xayma-body">\n    __xayma_action__\n\n    <div class="--xayma-editor --xayma-close">\n      <textarea\n        class="xayma-textarea"\n        placeholder="Racontez-nous votres expÃ©riences (facultatif)..."\n      ></textarea>\n    </div>\n\n    <div class="--xayma-email --xayma-close">\n      <input type="email" placeholder="Votre adresse email" />\n    </div>\n\n    <div class="--xayma-submit --xayma-close">\n      <button class="--xayma-submit-button">Envoyer</button>\n    </div>\n\n    __xayma_login__\n  </div>\n  <div class="--xayma-finish --xayma-close">\n    <div class="--xayma-finish-icon"></div>\n    <div class="--xayma-finish-text"></div>\n  </div>\n  <div class="--xayma-foot">\n    <small>by</small>\n    <strong>\n      <a rel="noopener" href="https://xaymaio.web.app/" target="_blank">\n        Xayma\n      </a>\n    </strong>\n  </div>\n  __xayma_saving__\n</div>\n';o=(t=>{const e=document.createElement("div");return e.classList.add("--xayma-saving"),e.innerHTML='<svg viewBox="0 0 38 38" stroke="currentColor" stroke-opacity=".5">\n  <g fill="none" fill-rule="evenodd">\n    <g transform="translate(1 1)" stroke-width="2">\n      <circle stroke-opacity=".3" cx="18" cy="18" r="18" />\n      <path d="M36 18c0-9.94-8.06-18-18-18">\n        <animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s"\n          repeatCount="indefinite" />\n      </path>\n    </g>\n  </g>\n</svg>\n',t.replace("__xayma_saving__",e.outerHTML)})(o),o=(t=>{const e={frown:{icon:s,text:"Horrible",note:1},dislike:{icon:i,text:"J'aime pas",note:2},acceptable:{icon:n,text:"Acceptable",note:3},like:{icon:r,text:"J'aime",note:4},love:{icon:a,text:"J'adore",note:5}},o=document.createElement("div");o.classList.add("--xayma-actions");const c=Object.keys(e);for(let t=0;t<c.length;t++){const n=c[t],i=document.createElement("button");i.classList.add("--xayma-action-button"),i.style.animationDuration=200*(c.length-t+1)+"ms",i.setAttribute("data-value",`${t+1}`);const s=document.createElement("div");s.classList.add("--xayma-action-button-icon"),s.innerHTML=e[n].icon,i.appendChild(s);const r=document.createElement("div");r.classList.add("--xayma-action-button-text"),r.innerHTML=e[n].text,i.appendChild(r),o.appendChild(i)}return t.replace("__xayma_action__",o.outerHTML)})(o),o=o.replace("__xayma_login__",'<div class="--xayma-login --xayma-close">\n  <div>\n    Lorem ipsum dolor sit amet consectetur adipisicing elit. Et eum odio\n    dignissimos eos quis ut corporis reprehenderit.\n  </div>\n\n  <button class="--xayma-login-button">\n    <svg viewBox="0 0 512 512">\n      <path\n        xmlns="http://www.w3.org/2000/svg"\n        d="m512 256c0-16.084-1.509-32.183-4.497-47.813-1.348-7.075-7.544-12.188-14.736-12.188h-235.767c-8.291 0-15 6.709-15 15v90c0 8.291 6.709 15 15 15h120.967c-7.537 15.258-17.924 28.497-30.121 39.635l84.78 84.78c48.781-46.475 79.374-111.875 79.374-184.414z"\n      ></path>\n      <path\n        xmlns="http://www.w3.org/2000/svg"\n        d="m256 120c29.429 0 57.422 9.346 80.947 27.041 5.947 4.468 14.341 3.926 19.614-1.392l64.014-64.014c2.974-2.974 4.57-7.061 4.38-11.265s-2.124-8.13-5.347-10.84c-45.805-38.392-103.916-59.53-163.608-59.53-87.849 0-165.458 44.654-211.337 112.452l88.048 88.048c21.006-47.316 68.268-80.5 123.289-80.5z"\n      ></path>\n      <path\n        xmlns="http://www.w3.org/2000/svg"\n        d="m256 512c57.263 0 109.993-19.2 152.602-51.187l-86.371-86.371c-19.742 11.116-42.306 17.558-66.231 17.558-55.021 0-102.283-33.184-123.289-80.5l-88.048 88.048c45.879 67.798 123.488 112.452 211.337 112.452z"\n      ></path>\n      <path\n        xmlns="http://www.w3.org/2000/svg"\n        d="m122.184 277.605c-1.149-7.079-2.184-14.208-2.184-21.605s1.035-14.526 2.184-21.605l-94.124-94.124c-17.808 34.78-28.06 74.045-28.06 115.729s10.252 80.949 28.061 115.728z"\n      ></path>\n    </svg>\n\n    <div>Se connecter avec google</div>\n  </button>\n</div>\n');const c=o;let l='@import url("https://fonts.googleapis.com/css2?family=Roboto&display=swap");:root{--xayma-primary-color: rgb(244,54,76);--xayma-light-color: rgb(255,255,255);--xayma-dark-color: rgb(0,0,0);--xayma-yellow-color: rgb(255,213,0);--border-color: rgba(0,0,0, 0.1);--xayma-shadow-color-var: 149,157,165;--xayma-shadow-color: rgba(var(--xayma-shadow-color-var), 0.2);--xayma-shadow: var(--xayma-shadow-color) 0px 8px 24px}\n';l+='.--xayma-main{position:relative;background-color:var(--xayma-light-color);color:var(--xayma-dark-color);box-shadow:var(--xayma-shadow);font-family:"Roboto", sans-serif}.--xayma-main .--xayma-main-close-btn{position:absolute;top:0;right:20px;border:0;padding:0;width:20px;height:20px;border-radius:100%;transform:translateY(-50%);cursor:pointer;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);fill:var(--xayma-light-color);display:flex;align-items:center;justify-content:center;z-index:10}.--xayma-main .--xayma-main-close-btn svg{width:10px}.--xayma-main .--xayma-head{text-align:center;padding:15px;padding:20px}.--xayma-main .--xayma-actions{display:flex;align-items:center;justify-content:center;gap:5px;padding:20px}.--xayma-main .--xayma-actions .--xayma-action-button{display:flex;align-items:center;justify-content:center;flex-direction:column;border:0;background-color:transparent;padding:0;width:42px;height:42px;line-height:1;cursor:pointer;position:relative;animation:AnimeActionButton 0.5s ease}@keyframes AnimeActionButton{0%{transform:translateX(-200px) scale(0.2);opacity:0}100%{transform:translateX(0px) scale(1);opacity:1}}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-icon{width:32px;display:flex;align-items:center;justify-content:center}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-icon>svg{width:32px}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-text{font-size:9px;position:absolute;top:100%;left:50%;transform:translateX(-50%);width:max-content;opacity:0;padding:5px;box-shadow:var(--xayma-shadow-color)}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-deactive-button .--xayma-action-button-icon{opacity:0.5}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-active-button .--xayma-action-button-icon{opacity:1}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-active-button .--xayma-action-button-icon svg{fill:var(--xayma-yellow-color)}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-icon{opacity:1}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-icon svg{fill:var(--xayma-yellow-color)}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-text{opacity:1}.--xayma-main .--xayma-editor{position:relative}.--xayma-main .--xayma-editor::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:var(--xayma-dark-color);opacity:0.03}.--xayma-main .--xayma-editor .xayma-textarea{border:0;width:calc(100% - 20px);height:150px;outline:none;resize:none;background-color:transparent;padding:10px;font:inherit;position:relative}.--xayma-main .--xayma-email{position:relative}.--xayma-main .--xayma-email::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:var(--xayma-dark-color);opacity:0.05}.--xayma-main .--xayma-email input{border:0;width:calc(100% - 20px);outline:none;background-color:transparent;padding:15px 20px;font:inherit;position:relative}.--xayma-main .--xayma-submit{display:flex;align-items:center;padding:10px 20px}.--xayma-main .--xayma-submit .--xayma-submit-button{margin-left:auto;border:0;height:32px;padding:0 10px;border-radius:0.3em;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);cursor:pointer}.--xayma-main .--xayma-foot{padding:5px;font-size:12px;text-align:center}.--xayma-main .--xayma-foot a{color:var(--xayma-dark-color)}.--xayma-main .--xayma-saving{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background-color:var(--border-color);display:flex;align-items:center;justify-content:center;border-radius:inherit}.--xayma-main .--xayma-saving svg{width:32px}.--xayma-main .--xayma-close{display:none !important}\n',l+=".--xayma-finish{padding:40px;text-align:center}.--xayma-finish .--xayma-finish-icon{width:64px;height:64px;margin:auto;display:flex;align-items:center;justify-content:center}.--xayma-finish .--xayma-finish-icon svg{fill:var(--xayma-yellow-color)}.--xayma-finish .--xayma-finish-text{margin:auto;margin-top:20px;text-align:center}\n";const h=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,a=r?t[e+1]:0,o=e+2<t.length,c=o?t[e+2]:0,l=s>>2,h=(3&s)<<4|a>>4;let u=(15&a)<<2|c>>6,d=63&c;o||(d=64,r||(u=64)),i.push(n[l],n[h],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(h(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],a=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],r=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const o=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==r||null==a||null==o)throw Error();const c=s<<2|r>>4;if(i.push(c),64!==a){const t=r<<4&240|a>>2;if(i.push(t),64!==o){const t=a<<6&192|o;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},d=function(t){return function(t){const e=h(t);return u.encodeByteArray(e,!0)}(t).replace(/\./g,"")};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}class m extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,g.prototype.create)}}class g{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(y,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",a=`${this.serviceName}: ${r} (${i}).`;return new m(i,a,n)}}const y=/\{\$([^}]+)}/g;function v(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(b(n)&&b(r)){if(!v(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function b(t){return null!==t&&"object"==typeof t}function w(t){return t&&t._delegate?t._delegate:t}class x{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const E="[DEFAULT]";class T{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new f;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:E})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===E?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:E:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class I{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new T(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const S=[];var A,C;(C=A||(A={}))[C.DEBUG=0]="DEBUG",C[C.VERBOSE=1]="VERBOSE",C[C.INFO=2]="INFO",C[C.WARN=3]="WARN",C[C.ERROR=4]="ERROR",C[C.SILENT=5]="SILENT";const _={debug:A.DEBUG,verbose:A.VERBOSE,info:A.INFO,warn:A.WARN,error:A.ERROR,silent:A.SILENT},N=A.INFO,D={[A.DEBUG]:"log",[A.VERBOSE]:"log",[A.INFO]:"info",[A.WARN]:"warn",[A.ERROR]:"error"},k=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=D[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class L{constructor(t){this.name=t,this._logLevel=N,this._logHandler=k,this._userLogHandler=null,S.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in A))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?_[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,A.DEBUG,...t),this._logHandler(this,A.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,A.VERBOSE,...t),this._logHandler(this,A.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,A.INFO,...t),this._logHandler(this,A.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,A.WARN,...t),this._logHandler(this,A.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,A.ERROR,...t),this._logHandler(this,A.ERROR,...t)}}let R,O;const M=new WeakMap,P=new WeakMap,V=new WeakMap,F=new WeakMap,U=new WeakMap;let B={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return P.get(t);if("objectStoreNames"===e)return t.objectStoreNames||V.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function j(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(O||(O=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(H(this),t),$(M.get(this))}:function(...t){return $(e.apply(H(this),t))}:function(t,...n){const i=e.call(H(this),t,...n);return V.set(i,t.sort?t.sort():[t]),$(i)}:(t instanceof IDBTransaction&&function(t){if(P.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));P.set(t,e)}(t),n=t,(R||(R=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,B):t);var e,n}function $(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e($(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&M.set(e,t)})).catch((()=>{})),U.set(e,t),e}(t);if(F.has(t))return F.get(t);const e=j(t);return e!==t&&(F.set(t,e),U.set(e,t)),e}const H=t=>U.get(t),q=["get","getKey","getAll","getAllKeys","count"],z=["put","add","delete","clear"],K=new Map;function G(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(K.get(e))return K.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=z.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!q.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let a=r.store;return i&&(a=a.index(e.shift())),(await Promise.all([a[n](...e),s&&r.done]))[0]};return K.set(e,r),r}var X;X=B,B={...X,get:(t,e,n)=>G(t,e)||X.get(t,e,n),has:(t,e)=>!!G(t,e)||X.has(t,e)};class W{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const Y="@firebase/app",Q="0.7.25",J=new L("@firebase/app"),Z={[Y]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},tt=new Map,et=new Map;function nt(t,e){try{t.container.addComponent(e)}catch(n){J.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function it(t){const e=t.name;if(et.has(e))return J.debug(`There were multiple attempts to register component ${e}.`),!1;et.set(e,t);for(const e of tt.values())nt(e,t);return!0}const st=new g("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class rt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new x("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw st.create("app-deleted",{appName:this._name})}}function at(t,e,n){var i;let s=null!==(i=Z[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void J.warn(t.join(" "))}it(new x(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const ot="firebase-heartbeat-store";let ct=null;function lt(){return ct||(ct=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const a=indexedDB.open(t,e),o=$(a);return i&&a.addEventListener("upgradeneeded",(t=>{i($(a.result),t.oldVersion,t.newVersion,$(a.transaction))})),n&&a.addEventListener("blocked",(()=>n())),o.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(ot)}}).catch((t=>{throw st.create("storage-open",{originalErrorMessage:t.message})}))),ct}async function ht(t,e){try{const n=(await lt()).transaction(ot,"readwrite"),i=n.objectStore(ot);return await i.put(e,ut(t)),n.done}catch(t){throw st.create("storage-set",{originalErrorMessage:t.message})}}function ut(t){return`${t.name}!${t.options.appId}`}class dt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new pt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=ft();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=ft(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),mt(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),mt(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=d(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function ft(){return(new Date).toISOString().substring(0,10)}class pt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return"object"==typeof indexedDB&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{return(await lt()).transaction(ot).objectStore(ot).get(ut(t))}catch(t){throw st.create("storage-get",{originalErrorMessage:t.message})}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ht(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ht(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function mt(t){return d(JSON.stringify({version:2,heartbeats:t})).length}it(new x("platform-logger",(t=>new W(t)),"PRIVATE")),it(new x("heartbeat",(t=>new dt(t)),"PRIVATE")),at(Y,Q,""),at(Y,Q,"esm2017"),at("fire-js",""),at("firebase","9.8.2","app");var gt,yt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},vt={},bt=bt||{},wt=yt||self;function xt(){}function Et(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Tt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var It="closure_uid_"+(1e9*Math.random()>>>0),St=0;function At(t,e,n){return t.call.apply(t.bind,arguments)}function Ct(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _t(t,e,n){return(_t=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?At:Ct).apply(null,arguments)}function Nt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Dt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function kt(){this.s=this.s,this.o=this.o}var Lt={};kt.prototype.s=!1,kt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,It)&&t[It]||(t[It]=++St)}(this);delete Lt[t]}},kt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Rt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ot=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<i;r++)r in s&&e.call(n,s[r],r,t)};function Mt(t){return Array.prototype.concat.apply([],arguments)}function Pt(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Vt(t){return/^[\s\xa0]*$/.test(t)}var Ft,Ut=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Bt(t,e){return-1!=t.indexOf(e)}function jt(t,e){return t<e?-1:t>e?1:0}t:{var $t=wt.navigator;if($t){var Ht=$t.userAgent;if(Ht){Ft=Ht;break t}}Ft=""}function qt(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function zt(t){const e={};for(const n in t)e[n]=t[n];return e}var Kt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Gt(t,e){let n,i;for(let e=1;e<arguments.length;e++){for(n in i=arguments[e],i)t[n]=i[n];for(let e=0;e<Kt.length;e++)n=Kt[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Xt(t){return Xt[" "](t),t}Xt[" "]=xt;var Wt,Yt,Qt=Bt(Ft,"Opera"),Jt=Bt(Ft,"Trident")||Bt(Ft,"MSIE"),Zt=Bt(Ft,"Edge"),te=Zt||Jt,ee=Bt(Ft,"Gecko")&&!(Bt(Ft.toLowerCase(),"webkit")&&!Bt(Ft,"Edge"))&&!(Bt(Ft,"Trident")||Bt(Ft,"MSIE"))&&!Bt(Ft,"Edge"),ne=Bt(Ft.toLowerCase(),"webkit")&&!Bt(Ft,"Edge");function ie(){var t=wt.document;return t?t.documentMode:void 0}t:{var se="",re=(Yt=Ft,ee?/rv:([^\);]+)(\)|;)/.exec(Yt):Zt?/Edge\/([\d\.]+)/.exec(Yt):Jt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Yt):ne?/WebKit\/(\S+)/.exec(Yt):Qt?/(?:Version)[ \/]?(\S+)/.exec(Yt):void 0);if(re&&(se=re?re[1]:""),Jt){var ae=ie();if(null!=ae&&ae>parseFloat(se)){Wt=String(ae);break t}}Wt=se}var oe,ce={};function le(){return t=ce,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let t=0;const e=Ut(String(Wt)).split("."),n=Ut("9").split("."),i=Math.max(e.length,n.length);for(let a=0;0==t&&a<i;a++){var s=e[a]||"",r=n[a]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=jt(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||jt(0==s[2].length,0==r[2].length)||jt(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t}();var t}wt.document&&Jt?oe=ie()||parseInt(Wt,10)||void 0:oe=void 0;var he=oe,ue=function(){if(!wt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{wt.addEventListener("test",xt,e),wt.removeEventListener("test",xt,e)}catch(t){}return t}();function de(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function fe(t,e){if(de.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ee){t:{try{Xt(e.nodeName);var s=!0;break t}catch(t){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:pe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&fe.Z.h.call(this)}}de.prototype.h=function(){this.defaultPrevented=!0},Dt(fe,de);var pe={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),ge=0;function ye(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=s,this.key=++ge,this.ca=this.fa=!1}function ve(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function be(t){this.src=t,this.g={},this.h=0}function we(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=Rt(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(ve(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function xe(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ca&&r.listener==e&&r.capture==!!n&&r.ia==i)return s}return-1}be.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var a=xe(t,e,i,s);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new ye(e,this.src,r,!!i,s)).fa=n,t.push(e)),e};var Ee="closure_lm_"+(1e6*Math.random()|0),Te={};function Ie(t,e,n,i,s){if(i&&i.once)return Ae(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)Ie(t,e[r],n,i,s);return null}return n=Re(n),t&&t[me]?t.N(e,n,Tt(i)?!!i.capture:!!i,s):Se(t,e,n,!1,i,s)}function Se(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var a=Tt(s)?!!s.capture:!!s,o=ke(t);if(o||(t[Ee]=o=new be(t)),(n=o.add(e,n,i,a,r)).proxy)return n;if(i=function(){var t=De;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)ue||(s=a),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(Ne(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ae(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)Ae(t,e[r],n,i,s);return null}return n=Re(n),t&&t[me]?t.O(e,n,Tt(i)?!!i.capture:!!i,s):Se(t,e,n,!0,i,s)}function Ce(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)Ce(t,e[r],n,i,s);else i=Tt(i)?!!i.capture:!!i,n=Re(n),t&&t[me]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=xe(r=t.g[e],n,i,s))&&(ve(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--))):t&&(t=ke(t))&&(e=t.g[e.toString()],t=-1,e&&(t=xe(e,n,i,s)),(n=-1<t?e[t]:null)&&_e(n))}function _e(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[me])we(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ne(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=ke(e))?(we(n,t),0==n.h&&(n.src=null,e[Ee]=null)):ve(t)}}}function Ne(t){return t in Te?Te[t]:Te[t]="on"+t}function De(t,e){if(t.ca)t=!0;else{e=new fe(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&_e(t),t=n.call(i,e)}return t}function ke(t){return(t=t[Ee])instanceof be?t:null}var Le="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(t){return"function"==typeof t?t:(t[Le]||(t[Le]=function(e){return t.handleEvent(e)}),t[Le])}function Oe(){kt.call(this),this.i=new be(this),this.P=this,this.I=null}function Me(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new de(e,t);else if(e instanceof de)e.target=e.target||t;else{var s=e;Gt(e=new de(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var a=e.g=n[r];s=Pe(a,i,!0,e)&&s}if(s=Pe(a=e.g=t,i,!0,e)&&s,s=Pe(a,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=Pe(a=e.g=n[r],i,!1,e)&&s}function Pe(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var a=e[r];if(a&&!a.ca&&a.capture==n){var o=a.listener,c=a.ia||a.src;a.fa&&we(t.i,a),s=!1!==o.call(c,i)&&s}}return s&&!i.defaultPrevented}Dt(Oe,kt),Oe.prototype[me]=!0,Oe.prototype.removeEventListener=function(t,e,n,i){Ce(this,t,e,n,i)},Oe.prototype.M=function(){if(Oe.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ve(n[i]);delete e.g[t],e.h--}}this.I=null},Oe.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Oe.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Ve=wt.JSON.stringify;function Fe(){var t=ze;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ue,Be=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new je),(t=>t.reset()));class je{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function $e(t){wt.setTimeout((()=>{throw t}),0)}function He(t,e){Ue||function(){var t=wt.Promise.resolve(void 0);Ue=function(){t.then(Ke)}}(),qe||(Ue(),qe=!0),ze.add(t,e)}var qe=!1,ze=new class{constructor(){this.h=this.g=null}add(t,e){const n=Be.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Ke(){for(var t;t=Fe();){try{t.h.call(t.g)}catch(t){$e(t)}var e=Be;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}qe=!1}function Ge(t,e){Oe.call(this),this.h=t||1,this.g=e||wt,this.j=_t(this.kb,this),this.l=Date.now()}function Xe(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function We(t,e,n){if("function"==typeof t)n&&(t=_t(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_t(t.handleEvent,t)}return 2147483647<Number(e)?-1:wt.setTimeout(t,e||0)}function Ye(t){t.g=We((()=>{t.g=null,t.i&&(t.i=!1,Ye(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Dt(Ge,Oe),(gt=Ge.prototype).da=!1,gt.S=null,gt.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Me(this,"tick"),this.da&&(Xe(this),this.start()))}},gt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gt.M=function(){Ge.Z.M.call(this),Xe(this),delete this.g};class Qe extends kt{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ye(this)}M(){super.M(),this.g&&(wt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Je(t){kt.call(this),this.h=t,this.g={}}Dt(Je,kt);var Ze=[];function tn(t,e,n,i){Array.isArray(n)||(n&&(Ze[0]=n.toString()),n=Ze);for(var s=0;s<n.length;s++){var r=Ie(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function en(t){qt(t.g,(function(t,e){this.g.hasOwnProperty(e)&&_e(t)}),t),t.g={}}function nn(){this.g=!0}function sn(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var a=1;a<s.length;a++)s[a]=""}}}return Ve(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Je.prototype.M=function(){Je.Z.M.call(this),en(this)},Je.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},nn.prototype.Aa=function(){this.g=!1},nn.prototype.info=function(){};var rn={},an=null;function on(){return an=an||new Oe}function cn(t){de.call(this,rn.Ma,t)}function ln(t){const e=on();Me(e,new cn(e,t))}function hn(t,e){de.call(this,rn.STAT_EVENT,t),this.stat=e}function un(t){const e=on();Me(e,new hn(e,t))}function dn(t,e){de.call(this,rn.Na,t),this.size=e}function fn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return wt.setTimeout((function(){t()}),e)}rn.Ma="serverreachability",Dt(cn,de),rn.STAT_EVENT="statevent",Dt(hn,de),rn.Na="timingevent",Dt(dn,de);var pn={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},mn={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function gn(){}function yn(t){return t.h||(t.h=t.i())}function vn(){}gn.prototype.h=null;var bn,wn={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function xn(){de.call(this,"d")}function En(){de.call(this,"c")}function Tn(){}function In(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new Je(this),this.P=An,t=te?125:void 0,this.W=new Ge(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Sn}function Sn(){this.i=null,this.g="",this.h=!1}Dt(xn,de),Dt(En,de),Dt(Tn,gn),Tn.prototype.g=function(){return new XMLHttpRequest},Tn.prototype.i=function(){return{}},bn=new Tn;var An=45e3,Cn={},_n={};function Nn(t,e,n){t.K=1,t.v=Jn(Kn(e)),t.s=n,t.U=!0,Dn(t,null)}function Dn(t,e){t.F=Date.now(),On(t),t.A=Kn(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),ui(n.h,"t",i),t.C=0,n=t.l.H,t.h=new Sn,t.g=us(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Qe(_t(t.Ia,t,t.g),t.O)),tn(t.V,t.g,"readystatechange",t.gb),e=t.H?zt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),ln(1),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var a="",o=r.split("&"),c=0;c<o.length;c++){var l=o[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");a=2<=u.length&&"type"==u[1]?a+(h+"=")+l+"&":a+(h+"=redacted&")}}else a=null;else a=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function kn(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function Ln(t,e,n){let i,s=!0;for(;!t.I&&t.C<n.length;){if(i=Rn(t,n),i==_n){4==e&&(t.o=4,un(14),s=!1),sn(t.j,t.m,null,"[Incomplete Response]");break}if(i==Cn){t.o=4,un(15),sn(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}sn(t.j,t.m,i,null),Un(t,i)}kn(t)&&i!=_n&&i!=Cn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,un(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),is(e),e.L=!0,un(11))):(sn(t.j,t.m,n,"[Invalid Chunked Response]"),Fn(t),Vn(t))}function Rn(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?_n:(n=Number(e.substring(n,i)),isNaN(n)?Cn:(i+=1)+n>e.length?_n:(e=e.substr(i,n),t.C=i+n,e))}function On(t){t.Y=Date.now()+t.P,Mn(t,t.P)}function Mn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=fn(_t(t.eb,t),e)}function Pn(t){t.B&&(wt.clearTimeout(t.B),t.B=null)}function Vn(t){0==t.l.G||t.I||as(t.l,t)}function Fn(t){Pn(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Xe(t.W),en(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Un(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||yi(n.i,t)))if(n.I=t.N,!t.J&&yi(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;rs(n),Xi(n)}ns(n),un(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&0==n.A&&!n.v&&(n.v=fn(_t(n.ab,n),6e3));if(1>=gi(n.i)&&n.ka){try{n.ka()}catch(t){}n.ka=void 0}}else cs(n,11)}else if((t.J||n.g==t)&&rs(n),!Vt(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.U=l[0],l=l[1],2==n.G)if("c"==l[0]){n.J=l[1],n.la=l[2];const e=l[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const s=l[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(i=1.5*h,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.i;!r.g&&(Bt(t,"spdy")||Bt(t,"quic")||Bt(t,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(vi(r,r.h),r.h=null))}if(i.D){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,Qn(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var a=t;if((i=n).oa=hs(i,i.H?i.la:null,i.W),a.J){bi(i.i,a);var o=a,c=i.K;c&&o.setTimeout(c),o.B&&(Pn(o),On(o)),i.g=a}else es(i);0<n.l.length&&Qi(n)}else"stop"!=l[0]&&"close"!=l[0]||cs(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?cs(n,7):Gi(n):"noop"!=l[0]&&n.j&&n.j.wa(l),n.A=0)}ln(4)}catch(t){}}function Bn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Et(t)||"string"==typeof t)Ot(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(Et(t)||"string"==typeof t){n=[];for(var i=t.length,s=0;s<i;s++)n.push(s)}else for(s in n=[],i=0,t)n[i++]=s;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(Et(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),s=i.length;for(var r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}}function jn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof jn)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function $n(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Hn(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)Hn(s,i=t.g[e])||(t.g[n++]=i,s[i]=1),e++;t.g.length=n}}function Hn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(gt=In.prototype).setTimeout=function(t){this.P=t},gt.gb=function(t){t=t.target;const e=this.L;e&&3==$i(t)?e.l():this.Ia(t)},gt.Ia=function(t){try{if(t==this.g)t:{const h=$i(this.g);var e=this.g.Da();const u=this.g.ba();if(!(3>h)&&(3!=h||te||this.g&&(this.h.h||this.g.ga()||Hi(this.g)))){this.I||4!=h||7==e||ln(8==e||0>=u?3:2),Pn(this);var n=this.g.ba();this.N=n;e:if(kn(this)){var i=Hi(this.g);t="";var s=i.length,r=4==$i(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Fn(this),Vn(this);var a="";break e}this.h.i=new wt.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=200==n,function(t,e,n,i,s,r,a){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+a}))}(this.j,this.u,this.A,this.m,this.X,h,n),this.i){if(this.$&&!this.J){e:{if(this.g){var o,c=this.g;if((o=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Vt(o)){var l=o;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,un(12),Fn(this),Vn(this);break t}sn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Un(this,n)}this.U?(Ln(this,h,a),te&&this.i&&3==h&&(tn(this.V,this.W,"tick",this.fb),this.W.start())):(sn(this.j,this.m,a,null),Un(this,a)),4==h&&Fn(this),this.i&&!this.I&&(4==h?as(this.l,this):(this.i=!1,On(this)))}else 400==n&&0<a.indexOf("Unknown SID")?(this.o=3,un(12)):(this.o=0,un(13)),Fn(this),Vn(this)}}}catch(t){}},gt.fb=function(){if(this.g){var t=$i(this.g),e=this.g.ga();this.C<e.length&&(Pn(this),Ln(this,t,e),this.i&&4!=t&&On(this))}},gt.cancel=function(){this.I=!0,Fn(this)},gt.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(ln(3),un(17)),Fn(this),this.o=2,Vn(this)):Mn(this,this.Y-t)},(gt=jn.prototype).R=function(){$n(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},gt.T=function(){return $n(this),this.g.concat()},gt.get=function(t,e){return Hn(this.h,t)?this.h[t]:e},gt.set=function(t,e){Hn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},gt.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var s=n[i],r=this.get(s);t.call(e,r,s,this)}};var qn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function zn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof zn){this.g=void 0!==e?e:t.g,Gn(this,t.j),this.s=t.s,Xn(this,t.i),Wn(this,t.m),this.l=t.l,e=t.h;var n=new oi;n.i=e.i,e.g&&(n.g=new jn(e.g),n.h=e.h),Yn(this,n),this.o=t.o}else t&&(n=String(t).match(qn))?(this.g=!!e,Gn(this,n[1]||"",!0),this.s=Zn(n[2]||""),Xn(this,n[3]||"",!0),Wn(this,n[4]),this.l=Zn(n[5]||"",!0),Yn(this,n[6]||"",!0),this.o=Zn(n[7]||"")):(this.g=!!e,this.h=new oi(null,this.g))}function Kn(t){return new zn(t)}function Gn(t,e,n){t.j=n?Zn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Xn(t,e,n){t.i=n?Zn(e,!0):e}function Wn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Yn(t,e,n){e instanceof oi?(t.h=e,function(t,e){e&&!t.j&&(ci(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(li(this,e),ui(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=ti(e,ri)),t.h=new oi(e,t.g))}function Qn(t,e,n){t.h.set(e,n)}function Jn(t){return Qn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Zn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ti(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ei),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ei(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}zn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ti(e,ni,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ti(e,ni,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(ti(n,"/"==n.charAt(0)?si:ii,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ti(n,ai)),t.join("")};var ni=/[#\/\?@]/g,ii=/[#\?:]/g,si=/[#\?]/g,ri=/[#\?@]/g,ai=/#/g;function oi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ci(t){t.g||(t.g=new jn,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function li(t,e){ci(t),e=di(t,e),Hn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Hn((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&$n(t)))}function hi(t,e){return ci(t),e=di(t,e),Hn(t.g.h,e)}function ui(t,e,n){li(t,e),0<n.length&&(t.i=null,t.g.set(di(t,e),Pt(n)),t.h+=n.length)}function di(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function fi(t){this.l=t||pi,t=wt.PerformanceNavigationTiming?0<(t=wt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(wt.g&&wt.g.Ea&&wt.g.Ea()&&wt.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gt=oi.prototype).add=function(t,e){ci(this),this.i=null,t=di(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},gt.forEach=function(t,e){ci(this),this.g.forEach((function(n,i){Ot(n,(function(n){t.call(e,n,i,this)}),this)}),this)},gt.T=function(){ci(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var s=t[i],r=0;r<s.length;r++)n.push(e[i]);return n},gt.R=function(t){ci(this);var e=[];if("string"==typeof t)hi(this,t)&&(e=Mt(e,this.g.get(di(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Mt(e,t[n])}return e},gt.set=function(t,e){return ci(this),this.i=null,hi(this,t=di(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},gt.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},gt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var a=s;""!==i[r]&&(a+="="+encodeURIComponent(String(i[r]))),t.push(a)}}return this.i=t.join("&")};var pi=10;function mi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function gi(t){return t.h?1:t.g?t.g.size:0}function yi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function vi(t,e){t.g?t.g.add(e):t.h=e}function bi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function wi(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Pt(t.i)}function xi(){}function Ei(){this.g=new xi}function Ti(t,e,n){const i=n||"";try{Bn(t,(function(t,n){let s=t;Tt(t)&&(s=Ve(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function Ii(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(t){}}function Si(t){this.l=t.$b||null,this.j=t.ib||!1}function Ai(t,e){Oe.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ci,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}fi.prototype.cancel=function(){if(this.i=wi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},xi.prototype.stringify=function(t){return wt.JSON.stringify(t,void 0)},xi.prototype.parse=function(t){return wt.JSON.parse(t,void 0)},Dt(Si,gn),Si.prototype.g=function(){return new Ai(this.l,this.j)},Si.prototype.i=function(t){return function(){return t}}({}),Dt(Ai,Oe);var Ci=0;function _i(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Ni(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Di(t)}function Di(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(gt=Ai.prototype).open=function(t,e){if(this.readyState!=Ci)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Di(this)},gt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||wt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},gt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ni(this)),this.readyState=Ci},gt.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Di(this)),this.g&&(this.readyState=3,Di(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==wt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_i(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},gt.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ni(this):Di(this),3==this.readyState&&_i(this)}},gt.Ua=function(t){this.g&&(this.response=this.responseText=t,Ni(this))},gt.Ta=function(t){this.g&&(this.response=t,Ni(this))},gt.ha=function(){this.g&&Ni(this)},gt.setRequestHeader=function(t,e){this.v.append(t,e)},gt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},gt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ai.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var ki=wt.JSON.parse;function Li(t){Oe.call(this),this.headers=new jn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Ri,this.K=this.L=!1}Dt(Li,Oe);var Ri="",Oi=/^https?$/i,Mi=["POST","PUT"];function Pi(t){return"content-type"==t.toLowerCase()}function Vi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Fi(t),Bi(t)}function Fi(t){t.D||(t.D=!0,Me(t,"complete"),Me(t,"error"))}function Ui(t){if(t.h&&void 0!==bt&&(!t.C[1]||4!=$i(t)||2!=t.ba()))if(t.v&&4==$i(t))We(t.Fa,0,t);else if(Me(t,"readystatechange"),4==$i(t)){t.h=!1;try{const o=t.ba();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===o){var s=String(t.H).match(qn)[1]||null;if(!s&&wt.self&&wt.self.location){var r=wt.self.location.protocol;s=r.substr(0,r.length-1)}i=!Oi.test(s?s.toLowerCase():"")}n=i}if(n)Me(t,"complete"),Me(t,"success");else{t.m=6;try{var a=2<$i(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Fi(t)}}finally{Bi(t)}}}function Bi(t,e){if(t.g){ji(t);const n=t.g,i=t.C[0]?xt:null;t.g=null,t.C=null,e||Me(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function ji(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(wt.clearTimeout(t.A),t.A=null)}function $i(t){return t.g?t.g.readyState:0}function Hi(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Ri:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qi(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return qt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Qn(t,e,n))}function zi(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ki(t){this.za=0,this.l=[],this.h=new nn,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=zi("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=zi("baseRetryDelayMs",5e3,t),this.$a=zi("retryDelaySeedMs",1e4,t),this.Ya=zi("forwardChannelMaxRetries",2,t),this.ra=zi("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new fi(t&&t.concurrentRequestLimit),this.Ca=new Ei,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Gi(t){if(Wi(t),3==t.G){var e=t.V++,n=Kn(t.F);Qn(n,"SID",t.J),Qn(n,"RID",e),Qn(n,"TYPE","terminate"),Zi(t,n),(e=new In(t,t.h,e,void 0)).K=2,e.v=Jn(Kn(n)),n=!1,wt.navigator&&wt.navigator.sendBeacon&&(n=wt.navigator.sendBeacon(e.v.toString(),"")),!n&&wt.Image&&((new Image).src=e.v,n=!0),n||(e.g=us(e.l,null),e.g.ea(e.v)),e.F=Date.now(),On(e)}ls(t)}function Xi(t){t.g&&(is(t),t.g.cancel(),t.g=null)}function Wi(t){Xi(t),t.u&&(wt.clearTimeout(t.u),t.u=null),rs(t),t.i.cancel(),t.m&&("number"==typeof t.m&&wt.clearTimeout(t.m),t.m=null)}function Yi(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&Qi(t)}function Qi(t){mi(t.i)||t.m||(t.m=!0,He(t.Ha,t),t.C=0)}function Ji(t,e){var n;n=e?e.m:t.V++;const i=Kn(t.F);Qn(i,"SID",t.J),Qn(i,"RID",n),Qn(i,"AID",t.U),Zi(t,i),t.o&&t.s&&qi(i,t.o,t.s),n=new In(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ts(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),vi(t.i,n),Nn(n,i,e)}function Zi(t,e){t.j&&Bn({},(function(t,n){Qn(e,n,t)}))}function ts(t,e,n){n=Math.min(t.l.length,n);var i=t.j?_t(t.j.Oa,t.j,t):null;t:{var s=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let r=!0;for(let a=0;a<n;a++){let n=s[a].h;const o=s[a].g;if(n-=e,0>n)e=Math.max(0,s[a].h-100),r=!1;else try{Ti(o,t,"req"+n+"_")}catch(t){i&&i(o)}}if(r){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function es(t){t.g||t.u||(t.Y=1,He(t.Ga,t),t.A=0)}function ns(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=fn(_t(t.Ga,t),os(t,t.A)),t.A++,0))}function is(t){null!=t.B&&(wt.clearTimeout(t.B),t.B=null)}function ss(t){t.g=new In(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Kn(t.oa);Qn(e,"RID","rpc"),Qn(e,"SID",t.J),Qn(e,"CI",t.N?"0":"1"),Qn(e,"AID",t.U),Zi(t,e),Qn(e,"TYPE","xmlhttp"),t.o&&t.s&&qi(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Jn(Kn(e)),n.s=null,n.U=!0,Dn(n,t)}function rs(t){null!=t.v&&(wt.clearTimeout(t.v),t.v=null)}function as(t,e){var n=null;if(t.g==e){rs(t),is(t),t.g=null;var i=2}else{if(!yi(t.i,e))return;n=e.D,bi(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;Me(i=on(),new dn(i,n,e,s)),Qi(t)}else es(t);else if(3==(s=e.o)||0==s&&0<t.I||!(1==i&&function(t,e){return!(gi(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=fn(_t(t.Ha,t,e),os(t,t.C)),t.C++,0)))}(t,e)||2==i&&ns(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:cs(t,5);break;case 4:cs(t,10);break;case 3:cs(t,6);break;default:cs(t,2)}}function os(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function cs(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=_t(t.jb,t);n||(n=new zn("//www.google.com/images/cleardot.gif"),wt.location&&"http"==wt.location.protocol||Gn(n,"https"),Jn(n)),function(t,e){const n=new nn;if(wt.Image){const i=new Image;i.onload=Nt(Ii,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Nt(Ii,n,i,"TestLoadImage: error",!1,e),i.onabort=Nt(Ii,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Nt(Ii,n,i,"TestLoadImage: timeout",!1,e),wt.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else un(2);t.G=0,t.j&&t.j.va(e),ls(t),Wi(t)}function ls(t){t.G=0,t.I=-1,t.j&&(0==wi(t.i).length&&0==t.l.length||(t.i.i.length=0,Pt(t.l),t.l.length=0),t.j.ua())}function hs(t,e,n){let i=function(t){return t instanceof zn?Kn(t):new zn(t,void 0)}(n);if(""!=i.i)e&&Xn(i,e+"."+i.i),Wn(i,i.m);else{const t=wt.location;i=function(t,e,n,i){var s=new zn(null,void 0);return t&&Gn(s,t),e&&Xn(s,e),n&&Wn(s,n),i&&(s.l=i),s}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&qt(t.aa,(function(t,e){Qn(i,e,t)})),e=t.D,n=t.sa,e&&n&&Qn(i,e,n),Qn(i,"VER",t.ma),Zi(t,i),i}function us(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Li(new Si({ib:!0})):new Li(t.qa)).L=t.H,e}function ds(){}function fs(){if(Jt&&!(10<=Number(he)))throw Error("Environmental error: no available transport.")}function ps(t,e){Oe.call(this),this.g=new Ki(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Vt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Vt(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ys(this)}function ms(t){xn.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function gs(){En.call(this),this.status=1}function ys(t){this.g=t}(gt=Li.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():bn.g(),this.C=this.u?yn(this.u):yn(bn),this.g.onreadystatechange=_t(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Vi(this,t)}t=n||"";const s=new jn(this.headers);i&&Bn(i,(function(t,e){s.set(e,t)})),i=function(t){t:{var e=Pi;const n=t.length,i="string"==typeof t?t.split(""):t;for(let s=0;s<n;s++)if(s in i&&e.call(void 0,i[s],s,t)){e=s;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(s.T()),n=wt.FormData&&t instanceof wt.FormData,!(0<=Rt(Mi,e))||i||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ji(this),0<this.B&&((this.K=function(t){return Jt&&le()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_t(this.pa,this)):this.A=We(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Vi(this,t)}},gt.pa=function(){void 0!==bt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Me(this,"timeout"),this.abort(8))},gt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Me(this,"complete"),Me(this,"abort"),Bi(this))},gt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bi(this,!0)),Li.Z.M.call(this)},gt.Fa=function(){this.s||(this.F||this.v||this.l?Ui(this):this.cb())},gt.cb=function(){Ui(this)},gt.ba=function(){try{return 2<$i(this)?this.g.status:-1}catch(t){return-1}},gt.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},gt.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),ki(e)}},gt.Da=function(){return this.m},gt.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(gt=Ki.prototype).ma=8,gt.G=1,gt.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},gt.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new In(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?(r=zt(r),Gt(r,this.P)):r=this.P),null===this.o&&(s.H=r),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ts(this,s,e),Qn(n=Kn(this.F),"RID",t),Qn(n,"CVER",22),this.D&&Qn(n,"X-HTTP-Session-Id",this.D),Zi(this,n),this.o&&r&&qi(n,this.o,r),vi(this.i,s),this.Ra&&Qn(n,"TYPE","init"),this.ja?(Qn(n,"$req",e),Qn(n,"SID","null"),s.$=!0,Nn(s,n,null)):Nn(s,n,e),this.G=2}}else 3==this.G&&(t?Ji(this,t):0==this.l.length||mi(this.i)||Ji(this))},gt.Ga=function(){if(this.u=null,ss(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=fn(_t(this.bb,this),t)}},gt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,un(10),Xi(this),ss(this))},gt.ab=function(){null!=this.v&&(this.v=null,Xi(this),ns(this),un(19))},gt.jb=function(t){t?(this.h.info("Successfully pinged google.com"),un(2)):(this.h.info("Failed to ping google.com"),un(1))},(gt=ds.prototype).xa=function(){},gt.wa=function(){},gt.va=function(){},gt.ua=function(){},gt.Oa=function(){},fs.prototype.g=function(t,e){return new ps(t,e)},Dt(ps,Oe),ps.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),He(_t(t.hb,t,e))),un(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=hs(t,null,t.W),Qi(t)},ps.prototype.close=function(){Gi(this.g)},ps.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,Yi(this.g,e)}else this.v?((e={}).__data__=Ve(t),Yi(this.g,e)):Yi(this.g,t)},ps.prototype.M=function(){this.g.j=null,delete this.j,Gi(this.g),delete this.g,ps.Z.M.call(this)},Dt(ms,xn),Dt(gs,En),Dt(ys,ds),ys.prototype.xa=function(){Me(this.g,"a")},ys.prototype.wa=function(t){Me(this.g,new ms(t))},ys.prototype.va=function(t){Me(this.g,new gs(t))},ys.prototype.ua=function(){Me(this.g,"b")},fs.prototype.createWebChannel=fs.prototype.g,ps.prototype.send=ps.prototype.u,ps.prototype.open=ps.prototype.m,ps.prototype.close=ps.prototype.close,pn.NO_ERROR=0,pn.TIMEOUT=8,pn.HTTP_ERROR=6,mn.COMPLETE="complete",vn.EventType=wn,wn.OPEN="a",wn.CLOSE="b",wn.ERROR="c",wn.MESSAGE="d",Oe.prototype.listen=Oe.prototype.N,Li.prototype.listenOnce=Li.prototype.O,Li.prototype.getLastError=Li.prototype.La,Li.prototype.getLastErrorCode=Li.prototype.Da,Li.prototype.getStatus=Li.prototype.ba,Li.prototype.getResponseJson=Li.prototype.Qa,Li.prototype.getResponseText=Li.prototype.ga,Li.prototype.send=Li.prototype.ea;var vs=vt.createWebChannelTransport=function(){return new fs},bs=vt.getStatEventTarget=function(){return on()},ws=vt.ErrorCode=pn,xs=vt.EventType=mn,Es=vt.Event=rn,Ts=vt.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Is=vt.FetchXmlHttpFactory=Si,Ss=vt.WebChannel=vn,As=vt.XhrIo=Li;const Cs="@firebase/firestore";class _s{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}_s.UNAUTHENTICATED=new _s(null),_s.GOOGLE_CREDENTIALS=new _s("google-credentials-uid"),_s.FIRST_PARTY=new _s("first-party-uid"),_s.MOCK_USER=new _s("mock-user");let Ns="9.8.0";const Ds=new L("@firebase/firestore");function ks(){return Ds.logLevel}function Ls(t,...e){if(Ds.logLevel<=A.DEBUG){const n=e.map(Ms);Ds.debug(`Firestore (${Ns}): ${t}`,...n)}}function Rs(t,...e){if(Ds.logLevel<=A.ERROR){const n=e.map(Ms);Ds.error(`Firestore (${Ns}): ${t}`,...n)}}function Os(t,...e){if(Ds.logLevel<=A.WARN){const n=e.map(Ms);Ds.warn(`Firestore (${Ns}): ${t}`,...n)}}function Ms(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ps(t="Unexpected state"){const e=`FIRESTORE (${Ns}) INTERNAL ASSERTION FAILED: `+t;throw Rs(e),new Error(e)}function Vs(t,e){t||Ps()}function Fs(t,e){return t}const Us={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bs extends m{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class js{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class $s{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Hs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(_s.UNAUTHENTICATED)))}shutdown(){}}class qs{constructor(t){this.t=t,this.currentUser=_s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new js;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new js,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},a=t=>{Ls("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>a(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?a(t):(Ls("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new js)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ls("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Vs("string"==typeof e.accessToken),new $s(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Vs(null===t||"string"==typeof t),new _s(t)}}class zs{constructor(t,e,n){this.type="FirstParty",this.user=_s.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class Ks{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new zs(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(_s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Gs{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Xs{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,e){const n=t=>{null!=t.error&&Ls("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.p;return this.p=t.token,Ls("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ls("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?i(t):Ls("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Vs("string"==typeof t.token),this.p=t.token,new Gs(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Ws{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.I(t),this.T=t=>e.writeSequenceNumber(t))}I(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.T&&this.T(t),t}}function Ys(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}Ws.A=-1;class Qs{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=Ys(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<e&&(n+=t.charAt(i[s]%t.length))}return n}}function Js(t,e){return t<e?-1:t>e?1:0}function Zs(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class tr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Bs(Us.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Bs(Us.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Bs(Us.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Bs(Us.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return tr.fromMillis(Date.now())}static fromDate(t){return tr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new tr(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Js(this.nanoseconds,t.nanoseconds):Js(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class er{constructor(t){this.timestamp=t}static fromTimestamp(t){return new er(t)}static min(){return new er(new tr(0,0))}static max(){return new er(new tr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function nr(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ir(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function sr(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class rr{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ps(),void 0===n?n=t.length-e:n>t.length-e&&Ps(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===rr.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof rr?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class ar extends rr{construct(t,e,n){return new ar(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Bs(Us.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new ar(e)}static emptyPath(){return new ar([])}}const or=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cr extends rr{construct(t,e,n){return new cr(t,e,n)}static isValidIdentifier(t){return or.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cr.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new cr(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Bs(Us.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Bs(Us.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Bs(Us.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new Bs(Us.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new cr(e)}static emptyPath(){return new cr([])}}class lr{constructor(t){this.fields=t,t.sort(cr.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Zs(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class hr{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new hr(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new hr(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Js(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}hr.EMPTY_BYTE_STRING=new hr("");const ur=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dr(t){if(Vs(!!t),"string"==typeof t){let e=0;const n=ur.exec(t);if(Vs(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:fr(t.seconds),nanos:fr(t.nanos)}}function fr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pr(t){return"string"==typeof t?hr.fromBase64String(t):hr.fromUint8Array(t)}function mr(t){const e=dr(t.mapValue.fields.__local_write_time__.timestampValue);return new tr(e.seconds,e.nanos)}class gr{constructor(t,e,n,i,s,r,a,o){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=a,this.useFetchStreams=o}}class yr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new yr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof yr&&t.projectId===this.projectId&&t.database===this.database}}function vr(t){return null==t}function br(t){return 0===t&&1/t==-1/0}class wr{constructor(t){this.path=t}static fromPath(t){return new wr(ar.fromString(t))}static fromName(t){return new wr(ar.fromString(t).popFirst(5))}static empty(){return new wr(ar.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===ar.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return ar.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new wr(new ar(t.slice()))}}const xr={fields:{__type__:{stringValue:"__max__"}}};function Er(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:Rr(t)?9007199254740991:10:Ps()}function Tr(t,e){if(t===e)return!0;const n=Er(t);if(n!==Er(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mr(t).isEqual(mr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=dr(t.timestampValue),i=dr(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return pr(t.bytesValue).isEqual(pr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return fr(t.geoPointValue.latitude)===fr(e.geoPointValue.latitude)&&fr(t.geoPointValue.longitude)===fr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fr(t.integerValue)===fr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=fr(t.doubleValue),i=fr(e.doubleValue);return n===i?br(n)===br(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Zs(t.arrayValue.values||[],e.arrayValue.values||[],Tr);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(nr(n)!==nr(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Tr(n[t],i[t])))return!1;return!0}(t,e);default:return Ps()}}function Ir(t,e){return void 0!==(t.values||[]).find((t=>Tr(t,e)))}function Sr(t,e){if(t===e)return 0;const n=Er(t),i=Er(e);if(n!==i)return Js(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Js(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=fr(t.integerValue||t.doubleValue),i=fr(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Ar(t.timestampValue,e.timestampValue);case 4:return Ar(mr(t),mr(e));case 5:return Js(t.stringValue,e.stringValue);case 6:return function(t,e){const n=pr(t),i=pr(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=Js(n[t],i[t]);if(0!==e)return e}return Js(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=Js(fr(t.latitude),fr(e.latitude));return 0!==n?n:Js(fr(t.longitude),fr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=Sr(n[t],i[t]);if(e)return e}return Js(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===xr&&e===xr)return 0;if(t===xr)return 1;if(e===xr)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let t=0;t<i.length&&t<r.length;++t){const e=Js(i[t],r[t]);if(0!==e)return e;const a=Sr(n[i[t]],s[r[t]]);if(0!==a)return a}return Js(i.length,r.length)}(t.mapValue,e.mapValue);default:throw Ps()}}function Ar(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Js(t,e);const n=dr(t),i=dr(e),s=Js(n.seconds,i.seconds);return 0!==s?s:Js(n.nanos,i.nanos)}function Cr(t){return _r(t)}function _r(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=dr(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?pr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,wr.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=_r(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${_r(t.fields[s])}`;return n+"}"}(t.mapValue):Ps();var e,n}function Nr(t){return!!t&&"integerValue"in t}function Dr(t){return!!t&&"arrayValue"in t}function kr(t){return!!t&&"mapValue"in t}function Lr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ir(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Lr(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Rr(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Or{constructor(t){this.value=t}static empty(){return new Or({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!kr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Lr(e)}setAll(t){let e=cr.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=Lr(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());kr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Tr(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];kr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){ir(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new Or(Lr(this.value))}}function Mr(t){const e=[];return ir(t.fields,((t,n)=>{const i=new cr([t]);if(kr(n)){const t=Mr(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new lr(e)}class Pr{constructor(t,e,n,i,s,r){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=s,this.documentState=r}static newInvalidDocument(t){return new Pr(t,0,er.min(),er.min(),Or.empty(),0)}static newFoundDocument(t,e,n){return new Pr(t,1,e,er.min(),n,0)}static newNoDocument(t,e){return new Pr(t,2,e,er.min(),Or.empty(),0)}static newUnknownDocument(t,e){return new Pr(t,3,e,er.min(),Or.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Pr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Pr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function Vr(t){return new Fr(t.readTime,t.key,-1)}class Fr{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Fr(er.min(),wr.empty(),-1)}static max(){return new Fr(er.max(),wr.empty(),-1)}}function Ur(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=wr.comparator(t.documentKey,e.documentKey),0!==n?n:Js(t.largestBatchId,e.largestBatchId))}class Br{constructor(t,e){this.comparator=t,this.root=e||$r.EMPTY}insert(t,e){return new Br(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,$r.BLACK,null,null))}remove(t){return new Br(this.comparator,this.root.remove(t,this.comparator).copy(null,null,$r.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new jr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new jr(this.root,t,this.comparator,!1)}getReverseIterator(){return new jr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new jr(this.root,t,this.comparator,!0)}}class jr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class $r{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:$r.RED,this.left=null!=i?i:$r.EMPTY,this.right=null!=s?s:$r.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new $r(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $r.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return $r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,$r.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,$r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ps();if(this.right.isRed())throw Ps();const t=this.left.check();if(t!==this.right.check())throw Ps();return t+(this.isRed()?0:1)}}$r.EMPTY=null,$r.RED=!0,$r.BLACK=!1,$r.EMPTY=new class{constructor(){this.size=0}get key(){throw Ps()}get value(){throw Ps()}get color(){throw Ps()}get left(){throw Ps()}get right(){throw Ps()}copy(t,e,n,i,s){return this}insert(t,e,n){return new $r(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hr{constructor(t){this.comparator=t,this.data=new Br(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new qr(this.data.getIterator())}getIteratorFrom(t){return new qr(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Hr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Hr(this.comparator);return e.data=t,e}}class qr{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class zr{constructor(t,e=null,n=[],i=[],s=null,r=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=a,this.P=null}}function Kr(t,e=null,n=[],i=[],s=null,r=null,a=null){return new zr(t,e,n,i,s,r,a)}function Gr(t){const e=Fs(t);if(null===e.P){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Cr(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),vr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Cr(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Cr(t))).join(",")),e.P=t}return e.P}function Xr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!aa(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],i=e.filters[s],n.op!==i.op||!n.field.isEqual(i.field)||!Tr(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ca(t.startAt,e.startAt)&&ca(t.endAt,e.endAt)}class Wr extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.V(t,e,n):new Yr(t,e,n):"array-contains"===e?new ta(t,n):"in"===e?new ea(t,n):"not-in"===e?new na(t,n):"array-contains-any"===e?new ia(t,n):new Wr(t,e,n)}static V(t,e,n){return"in"===e?new Qr(t,n):new Jr(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.v(Sr(e,this.value)):null!==e&&Er(this.value)===Er(e)&&this.v(Sr(e,this.value))}v(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ps()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Yr extends Wr{constructor(t,e,n){super(t,e,n),this.key=wr.fromName(n.referenceValue)}matches(t){const e=wr.comparator(t.key,this.key);return this.v(e)}}class Qr extends Wr{constructor(t,e){super(t,"in",e),this.keys=Zr(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Jr extends Wr{constructor(t,e){super(t,"not-in",e),this.keys=Zr(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Zr(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>wr.fromName(t.referenceValue)))}class ta extends Wr{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Dr(e)&&Ir(e.arrayValue,this.value)}}class ea extends Wr{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ir(this.value.arrayValue,e)}}class na extends Wr{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ir(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Ir(this.value.arrayValue,e)}}class ia extends Wr{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Dr(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Ir(this.value.arrayValue,t)))}}class sa{constructor(t,e){this.position=t,this.inclusive=e}}class ra{constructor(t,e="asc"){this.field=t,this.dir=e}}function aa(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function oa(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],a=t.position[s];if(i=r.field.isKeyField()?wr.comparator(wr.fromName(a.referenceValue),n.key):Sr(a,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function ca(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tr(t.position[n],e.position[n]))return!1;return!0}class la{constructor(t,e=null,n=[],i=[],s=null,r="F",a=null,o=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=a,this.endAt=o,this.D=null,this.C=null,this.startAt,this.endAt}}function ha(t){const e=Fs(t);if(null===e.D){e.D=[];const t=function(t){for(const e of t.filters)if(e.S())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.D.push(new ra(t)),e.D.push(new ra(cr.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.D.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new ra(cr.keyField(),t))}}}return e.D}function ua(t){const e=Fs(t);if(!e.C)if("F"===e.limitType)e.C=Kr(e.path,e.collectionGroup,ha(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of ha(e)){const e="desc"===n.dir?"asc":"desc";t.push(new ra(n.field,e))}const n=e.endAt?new sa(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new sa(e.startAt.position,e.startAt.inclusive):null;e.C=Kr(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.C}function da(t,e){return Xr(ua(t),ua(e))&&t.limitType===e.limitType}function fa(t){return`${Gr(ua(t))}|lt:${t.limitType}`}function pa(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Cr(e.value)}`;var e})).join(", ")}]`),vr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Cr(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Cr(t))).join(",")),`Target(${e})`}(ua(t))}; limitType=${t.limitType})`}function ma(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):wr.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=oa(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,ha(t),e)||t.endAt&&!function(t,e,n){const i=oa(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,ha(t),e))}(t,e)}function ga(t,e,n){const i=t.field.isKeyField()?wr.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?Sr(i,s):Ps()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ps()}}function ya(t,e){if(t.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:br(e)?"-0":e}}function va(t){return{integerValue:""+t}}function ba(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!br(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?va(e):ya(t,e)}class wa{constructor(){this._=void 0}}function xa(t,e,n){return t instanceof Ia?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Sa?Aa(t,e):t instanceof Ca?_a(t,e):function(t,e){const n=Ta(t,e),i=Da(n)+Da(t.k);return Nr(n)&&Nr(t.k)?va(i):ya(t.M,i)}(t,e)}function Ea(t,e,n){return t instanceof Sa?Aa(t,e):t instanceof Ca?_a(t,e):n}function Ta(t,e){return t instanceof Na?Nr(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Ia extends wa{}class Sa extends wa{constructor(t){super(),this.elements=t}}function Aa(t,e){const n=ka(e);for(const e of t.elements)n.some((t=>Tr(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ca extends wa{constructor(t){super(),this.elements=t}}function _a(t,e){let n=ka(e);for(const e of t.elements)n=n.filter((t=>!Tr(t,e)));return{arrayValue:{values:n}}}class Na extends wa{constructor(t,e){super(),this.M=t,this.k=e}}function Da(t){return fr(t.integerValue||t.doubleValue)}function ka(t){return Dr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class La{constructor(t,e){this.version=t,this.transformResults=e}}class Ra{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Ra}static exists(t){return new Ra(void 0,t)}static updateTime(t){return new Ra(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Oa(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ma{}function Pa(t,e,n){t instanceof ja?function(t,e,n){const i=t.value.clone(),s=qa(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof $a?function(t,e,n){if(!Oa(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=qa(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(Ha(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Va(t,e,n){t instanceof ja?function(t,e,n){if(!Oa(t.precondition,e))return;const i=t.value.clone(),s=za(t.fieldTransforms,n,e);i.setAll(s),e.convertToFoundDocument(Ba(e),i).setHasLocalMutations()}(t,e,n):t instanceof $a?function(t,e,n){if(!Oa(t.precondition,e))return;const i=za(t.fieldTransforms,n,e),s=e.data;s.setAll(Ha(t)),s.setAll(i),e.convertToFoundDocument(Ba(e),s).setHasLocalMutations()}(t,e,n):function(t,e){Oa(t.precondition,e)&&e.convertToNoDocument(er.min())}(t,e)}function Fa(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=Ta(i.transform,t||null);null!=s&&(null==n&&(n=Or.empty()),n.set(i.field,s))}return n||null}function Ua(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Zs(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Sa&&e instanceof Sa||t instanceof Ca&&e instanceof Ca?Zs(t.elements,e.elements,Tr):t instanceof Na&&e instanceof Na?Tr(t.k,e.k):t instanceof Ia&&e instanceof Ia}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ba(t){return t.isFoundDocument()?t.version:er.min()}class ja extends Ma{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class $a extends Ma{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}}function Ha(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function qa(t,e,n){const i=new Map;Vs(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],a=r.transform,o=e.data.field(r.field);i.set(r.field,Ea(a,o,n[s]))}return i}function za(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,xa(t,r,e))}return i}class Ka extends Ma{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class Ga extends Ma{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}var Xa,Wa;(Wa=Xa||(Xa={}))[Wa.OK=0]="OK",Wa[Wa.CANCELLED=1]="CANCELLED",Wa[Wa.UNKNOWN=2]="UNKNOWN",Wa[Wa.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wa[Wa.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wa[Wa.NOT_FOUND=5]="NOT_FOUND",Wa[Wa.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wa[Wa.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wa[Wa.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wa[Wa.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wa[Wa.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wa[Wa.ABORTED=10]="ABORTED",Wa[Wa.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wa[Wa.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wa[Wa.INTERNAL=13]="INTERNAL",Wa[Wa.UNAVAILABLE=14]="UNAVAILABLE",Wa[Wa.DATA_LOSS=15]="DATA_LOSS";class Ya{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){ir(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return sr(this.inner)}size(){return this.innerSize}}const Qa=new Br(wr.comparator);function Ja(){return Qa}const Za=new Br(wr.comparator);function to(...t){let e=Za;for(const n of t)e=e.insert(n.key,n);return e}function eo(){return new Ya((t=>t.toString()),((t,e)=>t.isEqual(e)))}const no=new Br(wr.comparator),io=new Hr(wr.comparator);function so(...t){let e=io;for(const n of t)e=e.add(n);return e}const ro=new Hr(Js);class ao{constructor(t,e){this.databaseId=t,this.N=e}}function oo(t,e){return t.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function co(t,e){return t.N?e.toBase64():e.toUint8Array()}function lo(t,e){return oo(t,e.toTimestamp())}function ho(t){return Vs(!!t),er.fromTimestamp(function(t){const e=dr(t);return new tr(e.seconds,e.nanos)}(t))}function uo(t,e){return function(t){return new ar(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function fo(t,e){return uo(t.databaseId,e.path)}function po(t){const e=function(t){const e=ar.fromString(t);return Vs(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?ar.emptyPath():function(t){return Vs(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function mo(t,e,n){return{name:fo(t,e),fields:n.value.mapValue.fields}}function go(t){let e=po(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Vs(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=yo(n.where));let a=[];n.orderBy&&(a=n.orderBy.map((t=>function(t){return new ra(vo(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let o=null;n.limit&&(o=function(t){let e;return e="object"==typeof t?t.value:t,vr(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new sa(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new sa(n,e)}(n.endAt)),function(t,e,n,i,s,r,a,o){return new la(t,e,n,i,s,r,a,o)}(e,s,a,r,o,"F",c,l)}function yo(t){return t?void 0!==t.unaryFilter?[wo(t)]:void 0!==t.fieldFilter?[bo(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>yo(t))).reduce(((t,e)=>t.concat(e))):Ps():[]}function vo(t){return cr.fromServerFormat(t.fieldPath)}function bo(t){return Wr.create(vo(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ps()}}(t.fieldFilter.op),t.fieldFilter.value)}function wo(t){switch(t.unaryFilter.op){case"IS_NAN":const e=vo(t.unaryFilter.field);return Wr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=vo(t.unaryFilter.field);return Wr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(t.unaryFilter.field);return Wr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=vo(t.unaryFilter.field);return Wr.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Ps()}}function xo(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class Eo{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ps(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Eo(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Eo?e:Eo.resolve(e)}catch(t){return Eo.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Eo.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Eo.reject(e)}static resolve(t){return new Eo(((e,n)=>{e(t)}))}static reject(t){return new Eo(((e,n)=>{n(t)}))}static waitFor(t){return new Eo(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=Eo.resolve(!1);for(const n of t)e=e.next((t=>t?Eo.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function To(t){return"IndexedDbTransactionError"===t.name}class Io{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&Pa(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&Va(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&Va(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(er.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),so())}isEqual(t){return this.batchId===t.batchId&&Zs(this.mutations,t.mutations,((t,e)=>Ua(t,e)))&&Zs(this.baseMutations,t.baseMutations,((t,e)=>Ua(t,e)))}}class So{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Vs(t.mutations.length===n.length);let i=no;const s=t.mutations;for(let t=0;t<s.length;t++)i=i.insert(s[t].key,n[t].version);return new So(t,e,n,i)}}class Ao{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Co{constructor(t){this.Jt=t}}function _o(t){const e=go({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new la(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class No{constructor(){}Zt(t,e){this.te(t,e),e.ee()}te(t,e){if("nullValue"in t)this.ne(e,5);else if("booleanValue"in t)this.ne(e,10),e.se(t.booleanValue?1:0);else if("integerValue"in t)this.ne(e,15),e.se(fr(t.integerValue));else if("doubleValue"in t){const n=fr(t.doubleValue);isNaN(n)?this.ne(e,13):(this.ne(e,15),br(n)?e.se(0):e.se(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ne(e,20),"string"==typeof n?e.ie(n):(e.ie(`${n.seconds||""}`),e.se(n.nanos||0))}else if("stringValue"in t)this.re(t.stringValue,e),this.oe(e);else if("bytesValue"in t)this.ne(e,30),e.ue(pr(t.bytesValue)),this.oe(e);else if("referenceValue"in t)this.ae(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ne(e,45),e.se(n.latitude||0),e.se(n.longitude||0)}else"mapValue"in t?Rr(t)?this.ne(e,Number.MAX_SAFE_INTEGER):(this.ce(t.mapValue,e),this.oe(e)):"arrayValue"in t?(this.he(t.arrayValue,e),this.oe(e)):Ps()}re(t,e){this.ne(e,25),this.le(t,e)}le(t,e){e.ie(t)}ce(t,e){const n=t.fields||{};this.ne(e,55);for(const t of Object.keys(n))this.re(t,e),this.te(n[t],e)}he(t,e){const n=t.values||[];this.ne(e,50);for(const t of n)this.te(t,e)}ae(t,e){this.ne(e,37),wr.fromName(t).path.forEach((t=>{this.ne(e,60),this.le(t,e)}))}ne(t,e){t.se(e)}oe(t){t.se(2)}}No.fe=new No;class Do{constructor(){this.qe=new ko}addToCollectionParentIndex(t,e){return this.qe.add(e),Eo.resolve()}getCollectionParents(t,e){return Eo.resolve(this.qe.getEntries(e))}addFieldIndex(t,e){return Eo.resolve()}deleteFieldIndex(t,e){return Eo.resolve()}getDocumentsMatchingTarget(t,e){return Eo.resolve(null)}getIndexType(t,e){return Eo.resolve(0)}getFieldIndexes(t,e){return Eo.resolve([])}getNextCollectionGroupToUpdate(t){return Eo.resolve(null)}getMinOffset(t,e){return Eo.resolve(Fr.min())}updateCollectionGroup(t,e,n){return Eo.resolve()}updateIndexEntries(t,e){return Eo.resolve()}}class ko{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new Hr(ar.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new Hr(ar.comparator)).toArray()}}new Uint8Array(0);class Lo{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new Lo(t,Lo.DEFAULT_COLLECTION_PERCENTILE,Lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Lo.DEFAULT_COLLECTION_PERCENTILE=10,Lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lo.DEFAULT=new Lo(41943040,Lo.DEFAULT_COLLECTION_PERCENTILE,Lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lo.DISABLED=new Lo(-1,0,0);class Ro{constructor(t){this.mn=t}next(){return this.mn+=2,this.mn}static gn(){return new Ro(0)}static yn(){return new Ro(-1)}}async function Oo(t){if(t.code!==Us.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;Ls("LocalStore","Unexpectedly lost primary lease")}class Mo{constructor(t,e,n){this.ds=t,this.Bs=e,this.indexManager=n}Ls(t,e){return this.Bs.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Us(t,e,n)))}Us(t,e,n){return this.ds.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}qs(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}Ks(t,e){return this.ds.getEntries(t,e).next((e=>this.Gs(t,e).next((()=>e))))}Gs(t,e){return this.Bs.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.qs(e,t)))}Qs(t,e,n){return function(t){return wr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.js(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Ws(t,e,n):this.zs(t,e,n)}js(t,e){return this.Ls(t,new wr(e)).next((t=>{let e=to();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Ws(t,e,n){const i=e.collectionGroup;let s=to();return this.indexManager.getCollectionParents(t,i).next((r=>Eo.forEach(r,(r=>{const a=function(t,e){return new la(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,r.child(i));return this.zs(t,a,n).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}zs(t,e,n){let i;return this.ds.getAllFromCollection(t,e.path,n).next((n=>(i=n,this.Bs.getAllMutationBatchesAffectingQuery(t,e)))).next((t=>{for(const e of t)for(const t of e.mutations){const n=t.key;let s=i.get(n);null==s&&(s=Pr.newInvalidDocument(n),i=i.insert(n,s)),Va(t,s,e.localWriteTime),s.isFoundDocument()||(i=i.remove(n))}})).next((()=>(i.forEach(((t,n)=>{ma(e,n)||(i=i.remove(t))})),i)))}}class Po{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Hs=n,this.Js=i}static Ys(t,e){let n=so(),i=so();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new Po(t,e.fromCache,n,i)}}class Vo{constructor(){this.Xs=!1}initialize(t,e){this.Zs=t,this.indexManager=e,this.Xs=!0}Qs(t,e,n,i){return this.ti(t,e).next((s=>s||this.ei(t,e,i,n))).next((n=>n||this.ni(t,e)))}ti(t,e){return Eo.resolve(null)}ei(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||i.isEqual(er.min())?this.ni(t,e):this.Zs.Ks(t,n).next((s=>{const r=this.si(e,s);return this.ii(e,r,n,i)?this.ni(t,e):(ks()<=A.DEBUG&&Ls("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pa(e)),this.ri(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=er.fromTimestamp(1e9===i?new tr(n+1,0):new tr(n,i));return new Fr(s,wr.empty(),e)}(i,-1)))}))}si(t,e){let n=new Hr(function(t){return(e,n)=>{let i=!1;for(const s of ha(t)){const t=ga(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{ma(t,i)&&(n=n.add(i))})),n}ii(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ni(t,e){return ks()<=A.DEBUG&&Ls("QueryEngine","Using full collection scan to execute query:",pa(e)),this.Zs.Qs(t,e,Fr.min())}ri(t,e,n,i){return this.Zs.Qs(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class Fo{constructor(t,e,n,i){this.persistence=t,this.oi=e,this.M=i,this.ui=new Br(Js),this.ai=new Ya((t=>Gr(t)),Xr),this.ci=new Map,this.hi=t.getRemoteDocumentCache(),this.fs=t.getTargetCache(),this._s=t.getBundleCache(),this.li(n)}li(t){this.indexManager=this.persistence.getIndexManager(t),this.Bs=this.persistence.getMutationQueue(t,this.indexManager),this.fi=new Mo(this.hi,this.Bs,this.indexManager),this.hi.setIndexManager(this.indexManager),this.oi.initialize(this.fi,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ui)))}}async function Uo(t,e){const n=Fs(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.Bs.getAllMutationBatches(t).next((s=>(i=s,n.li(e),n.Bs.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let a=so();for(const t of i){s.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)a=a.add(e.key)}return n.fi.Ks(t,a).next((t=>({di:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Bo(t,e){const n=Fs(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.Bs.getNextMutationBatchAfterBatchId(t,e))))}class jo{constructor(t){this.M=t,this.yi=new Map,this.pi=new Map}getBundleMetadata(t,e){return Eo.resolve(this.yi.get(e))}saveBundleMetadata(t,e){var n;return this.yi.set(e.id,{id:(n=e).id,version:n.version,createTime:ho(n.createTime)}),Eo.resolve()}getNamedQuery(t,e){return Eo.resolve(this.pi.get(e))}saveNamedQuery(t,e){return this.pi.set(e.name,function(t){return{name:t.name,query:_o(t.bundledQuery),readTime:ho(t.readTime)}}(e)),Eo.resolve()}}class $o{constructor(){this.overlays=new Br(wr.comparator),this.Ii=new Map}getOverlay(t,e){return Eo.resolve(this.overlays.get(e))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.Xt(t,e,i)})),Eo.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Ii.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Ii.delete(n)),Eo.resolve()}getOverlaysForCollection(t,e,n){const i=eo(),s=e.length+1,r=new wr(e.child("")),a=this.overlays.getIteratorFrom(r);for(;a.hasNext();){const t=a.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return Eo.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new Br(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=eo(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const a=eo(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((t,e)=>a.set(t,e))),!(a.size()>=i)););return Eo.resolve(a)}Xt(t,e,n){if(null===n)return;const i=this.overlays.get(n.key);if(null!==i){const t=this.Ii.get(i.largestBatchId).delete(n.key);this.Ii.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Ao(e,n));let s=this.Ii.get(e);void 0===s&&(s=so(),this.Ii.set(e,s)),this.Ii.set(e,s.add(n.key))}}class Ho{constructor(){this.Ti=new Hr(qo.Ei),this.Ai=new Hr(qo.Ri)}isEmpty(){return this.Ti.isEmpty()}addReference(t,e){const n=new qo(t,e);this.Ti=this.Ti.add(n),this.Ai=this.Ai.add(n)}bi(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Pi(new qo(t,e))}Vi(t,e){t.forEach((t=>this.removeReference(t,e)))}vi(t){const e=new wr(new ar([])),n=new qo(e,t),i=new qo(e,t+1),s=[];return this.Ai.forEachInRange([n,i],(t=>{this.Pi(t),s.push(t.key)})),s}Si(){this.Ti.forEach((t=>this.Pi(t)))}Pi(t){this.Ti=this.Ti.delete(t),this.Ai=this.Ai.delete(t)}Di(t){const e=new wr(new ar([])),n=new qo(e,t),i=new qo(e,t+1);let s=so();return this.Ai.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new qo(t,0),n=this.Ti.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class qo{constructor(t,e){this.key=t,this.Ci=e}static Ei(t,e){return wr.comparator(t.key,e.key)||Js(t.Ci,e.Ci)}static Ri(t,e){return Js(t.Ci,e.Ci)||wr.comparator(t.key,e.key)}}class zo{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.Bs=[],this.xi=1,this.Ni=new Hr(qo.Ei)}checkEmpty(t){return Eo.resolve(0===this.Bs.length)}addMutationBatch(t,e,n,i){const s=this.xi;this.xi++,this.Bs.length>0&&this.Bs[this.Bs.length-1];const r=new Io(s,e,n,i);this.Bs.push(r);for(const e of i)this.Ni=this.Ni.add(new qo(e.key,s)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Eo.resolve(r)}lookupMutationBatch(t,e){return Eo.resolve(this.ki(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.Mi(n),s=i<0?0:i;return Eo.resolve(this.Bs.length>s?this.Bs[s]:null)}getHighestUnacknowledgedBatchId(){return Eo.resolve(0===this.Bs.length?-1:this.xi-1)}getAllMutationBatches(t){return Eo.resolve(this.Bs.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new qo(e,0),i=new qo(e,Number.POSITIVE_INFINITY),s=[];return this.Ni.forEachInRange([n,i],(t=>{const e=this.ki(t.Ci);s.push(e)})),Eo.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Hr(Js);return e.forEach((t=>{const e=new qo(t,0),i=new qo(t,Number.POSITIVE_INFINITY);this.Ni.forEachInRange([e,i],(t=>{n=n.add(t.Ci)}))})),Eo.resolve(this.Oi(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;wr.isDocumentKey(s)||(s=s.child(""));const r=new qo(new wr(s),0);let a=new Hr(Js);return this.Ni.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(a=a.add(t.Ci)),!0)}),r),Eo.resolve(this.Oi(a))}Oi(t){const e=[];return t.forEach((t=>{const n=this.ki(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Vs(0===this.Fi(e.batchId,"removed")),this.Bs.shift();let n=this.Ni;return Eo.forEach(e.mutations,(i=>{const s=new qo(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Ni=n}))}_n(t){}containsKey(t,e){const n=new qo(e,0),i=this.Ni.firstAfterOrEqual(n);return Eo.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.Bs.length,Eo.resolve()}Fi(t,e){return this.Mi(t)}Mi(t){return 0===this.Bs.length?0:t-this.Bs[0].batchId}ki(t){const e=this.Mi(t);return e<0||e>=this.Bs.length?null:this.Bs[e]}}class Ko{constructor(t){this.$i=t,this.docs=new Br(wr.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.$i(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Eo.resolve(n?n.document.mutableCopy():Pr.newInvalidDocument(e))}getEntries(t,e){let n=Ja();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Pr.newInvalidDocument(t))})),Eo.resolve(n)}getAllFromCollection(t,e,n){let i=Ja();const s=new wr(e.child("")),r=this.docs.getIteratorFrom(s);for(;r.hasNext();){const{key:t,value:{document:s}}=r.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||Ur(Vr(s),n)<=0||(i=i.insert(s.key,s.mutableCopy()))}return Eo.resolve(i)}getAllFromCollectionGroup(t,e,n,i){Ps()}Bi(t,e){return Eo.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Go(this)}getSize(t){return Eo.resolve(this.size)}}class Go extends class{constructor(){this.changes=new Ya((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Pr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Eo.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Kn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Kn.addEntry(t,i)):this.Kn.removeEntry(n)})),Eo.waitFor(e)}getFromCache(t,e){return this.Kn.getEntry(t,e)}getAllFromCache(t,e){return this.Kn.getEntries(t,e)}}class Xo{constructor(t){this.persistence=t,this.Li=new Ya((t=>Gr(t)),Xr),this.lastRemoteSnapshotVersion=er.min(),this.highestTargetId=0,this.Ui=0,this.qi=new Ho,this.targetCount=0,this.Ki=Ro.gn()}forEachTarget(t,e){return this.Li.forEach(((t,n)=>e(n))),Eo.resolve()}getLastRemoteSnapshotVersion(t){return Eo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Eo.resolve(this.Ui)}allocateTargetId(t){return this.highestTargetId=this.Ki.next(),Eo.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ui&&(this.Ui=e),Eo.resolve()}Tn(t){this.Li.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Ki=new Ro(e),this.highestTargetId=e),t.sequenceNumber>this.Ui&&(this.Ui=t.sequenceNumber)}addTargetData(t,e){return this.Tn(e),this.targetCount+=1,Eo.resolve()}updateTargetData(t,e){return this.Tn(e),Eo.resolve()}removeTargetData(t,e){return this.Li.delete(e.target),this.qi.vi(e.targetId),this.targetCount-=1,Eo.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Li.forEach(((r,a)=>{a.sequenceNumber<=e&&null===n.get(a.targetId)&&(this.Li.delete(r),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),Eo.waitFor(s).next((()=>i))}getTargetCount(t){return Eo.resolve(this.targetCount)}getTargetData(t,e){const n=this.Li.get(e)||null;return Eo.resolve(n)}addMatchingKeys(t,e,n){return this.qi.bi(e,n),Eo.resolve()}removeMatchingKeys(t,e,n){this.qi.Vi(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),Eo.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.qi.vi(e),Eo.resolve()}getMatchingKeysForTargetId(t,e){const n=this.qi.Di(e);return Eo.resolve(n)}containsKey(t,e){return Eo.resolve(this.qi.containsKey(e))}}class Wo{constructor(t,e){this.Gi={},this.overlays={},this.es=new Ws(0),this.ns=!1,this.ns=!0,this.referenceDelegate=t(this),this.fs=new Xo(this),this.indexManager=new Do,this.ds=function(t){return new Ko(t)}((t=>this.referenceDelegate.Qi(t))),this.M=new Co(e),this._s=new jo(this.M)}start(){return Promise.resolve()}shutdown(){return this.ns=!1,Promise.resolve()}get started(){return this.ns}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new $o,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Gi[t.toKey()];return n||(n=new zo(e,this.referenceDelegate),this.Gi[t.toKey()]=n),n}getTargetCache(){return this.fs}getRemoteDocumentCache(){return this.ds}getBundleCache(){return this._s}runTransaction(t,e,n){Ls("MemoryPersistence","Starting transaction:",t);const i=new Yo(this.es.next());return this.referenceDelegate.ji(),n(i).next((t=>this.referenceDelegate.Wi(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}zi(t,e){return Eo.or(Object.values(this.Gi).map((n=>()=>n.containsKey(t,e))))}}class Yo extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class Qo{constructor(t){this.persistence=t,this.Hi=new Ho,this.Ji=null}static Yi(t){return new Qo(t)}get Xi(){if(this.Ji)return this.Ji;throw Ps()}addReference(t,e,n){return this.Hi.addReference(n,e),this.Xi.delete(n.toString()),Eo.resolve()}removeReference(t,e,n){return this.Hi.removeReference(n,e),this.Xi.add(n.toString()),Eo.resolve()}markPotentiallyOrphaned(t,e){return this.Xi.add(e.toString()),Eo.resolve()}removeTarget(t,e){this.Hi.vi(e.targetId).forEach((t=>this.Xi.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Xi.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ji(){this.Ji=new Set}Wi(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Eo.forEach(this.Xi,(n=>{const i=wr.fromPath(n);return this.Zi(t,i).next((t=>{t||e.removeEntry(i,er.min())}))})).next((()=>(this.Ji=null,e.apply(t))))}updateLimboDocument(t,e){return this.Zi(t,e).next((t=>{t?this.Xi.delete(e.toString()):this.Xi.add(e.toString())}))}Qi(t){return 0}Zi(t,e){return Eo.or([()=>Eo.resolve(this.Hi.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.zi(t,e)])}}class Jo{constructor(){this.activeTargetIds=ro}nr(t){this.activeTargetIds=this.activeTargetIds.add(t)}sr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}er(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Zo{constructor(){this.Ur=new Jo,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Ur.nr(t),this.qr[t]||"not-current"}updateQueryState(t,e,n){this.qr[t]=e}removeLocalQueryTarget(t){this.Ur.sr(t)}isLocalQueryTarget(t){return this.Ur.activeTargetIds.has(t)}clearQueryState(t){delete this.qr[t]}getAllActiveQueryTargets(){return this.Ur.activeTargetIds}isActiveQueryTarget(t){return this.Ur.activeTargetIds.has(t)}start(){return this.Ur=new Jo,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class tc{Kr(t){}shutdown(){}}class ec{constructor(){this.Gr=()=>this.Qr(),this.jr=()=>this.Wr(),this.zr=[],this.Hr()}Kr(t){this.zr.push(t)}shutdown(){window.removeEventListener("online",this.Gr),window.removeEventListener("offline",this.jr)}Hr(){window.addEventListener("online",this.Gr),window.addEventListener("offline",this.jr)}Qr(){Ls("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.zr)t(0)}Wr(){Ls("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.zr)t(1)}static vt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const nc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class ic{constructor(t){this.Jr=t.Jr,this.Yr=t.Yr}Xr(t){this.Zr=t}eo(t){this.no=t}onMessage(t){this.so=t}close(){this.Yr()}send(t){this.Jr(t)}io(){this.Zr()}ro(t){this.no(t)}oo(t){this.so(t)}}class sc extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.uo=e+"://"+t.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(t,e,n,i,s){const r=this.ho(t,e);Ls("RestConnection","Sending: ",r,n);const a={};return this.lo(a,i,s),this.fo(t,r,a,n).then((t=>(Ls("RestConnection","Received: ",t),t)),(e=>{throw Os("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}_o(t,e,n,i,s){return this.co(t,e,n,i,s)}lo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ns,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ho(t,e){const n=nc[t];return`${this.uo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,n,i){return new Promise(((s,r)=>{const a=new As;a.listenOnce(xs.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case ws.NO_ERROR:const e=a.getResponseJson();Ls("Connection","XHR received:",JSON.stringify(e)),s(e);break;case ws.TIMEOUT:Ls("Connection",'RPC "'+t+'" timed out'),r(new Bs(Us.DEADLINE_EXCEEDED,"Request time out"));break;case ws.HTTP_ERROR:const n=a.getStatus();if(Ls("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){const t=a.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Us).indexOf(e)>=0?e:Us.UNKNOWN}(t.status);r(new Bs(e,t.message))}else r(new Bs(Us.UNKNOWN,"Server responded with status "+a.getStatus()))}else r(new Bs(Us.UNAVAILABLE,"Connection failed."));break;default:Ps()}}finally{Ls("Connection",'RPC "'+t+'" completed.')}}));const o=JSON.stringify(i);a.send(e,"POST",o,n,15)}))}wo(t,e,n){const i=[this.uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=vs(),r=bs(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Is({})),this.lo(a.initMessageHeaders,e,n),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||p().indexOf("Electron/")>=0||function(){const t=p();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||p().indexOf("MSAppHost/")>=0||function(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||(a.httpHeadersOverwriteParam="$httpHeaders");const o=i.join("");Ls("Connection","Creating WebChannel: "+o,a);const c=s.createWebChannel(o,a);let l=!1,h=!1;const u=new ic({Jr:t=>{h?Ls("Connection","Not sending because WebChannel is closed:",t):(l||(Ls("Connection","Opening WebChannel transport."),c.open(),l=!0),Ls("Connection","WebChannel sending:",t),c.send(t))},Yr:()=>c.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return d(c,Ss.EventType.OPEN,(()=>{h||Ls("Connection","WebChannel transport opened.")})),d(c,Ss.EventType.CLOSE,(()=>{h||(h=!0,Ls("Connection","WebChannel transport closed"),u.ro())})),d(c,Ss.EventType.ERROR,(t=>{h||(h=!0,Os("Connection","WebChannel transport errored:",t),u.ro(new Bs(Us.UNAVAILABLE,"The operation could not be completed")))})),d(c,Ss.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];Vs(!!n);const i=n,s=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(s){Ls("Connection","WebChannel received error:",s);const t=s.status;let e=function(t){const e=Xa[t];if(void 0!==e)return function(t){if(void 0===t)return Rs("GRPC error has no .code"),Us.UNKNOWN;switch(t){case Xa.OK:return Us.OK;case Xa.CANCELLED:return Us.CANCELLED;case Xa.UNKNOWN:return Us.UNKNOWN;case Xa.DEADLINE_EXCEEDED:return Us.DEADLINE_EXCEEDED;case Xa.RESOURCE_EXHAUSTED:return Us.RESOURCE_EXHAUSTED;case Xa.INTERNAL:return Us.INTERNAL;case Xa.UNAVAILABLE:return Us.UNAVAILABLE;case Xa.UNAUTHENTICATED:return Us.UNAUTHENTICATED;case Xa.INVALID_ARGUMENT:return Us.INVALID_ARGUMENT;case Xa.NOT_FOUND:return Us.NOT_FOUND;case Xa.ALREADY_EXISTS:return Us.ALREADY_EXISTS;case Xa.PERMISSION_DENIED:return Us.PERMISSION_DENIED;case Xa.FAILED_PRECONDITION:return Us.FAILED_PRECONDITION;case Xa.ABORTED:return Us.ABORTED;case Xa.OUT_OF_RANGE:return Us.OUT_OF_RANGE;case Xa.UNIMPLEMENTED:return Us.UNIMPLEMENTED;case Xa.DATA_LOSS:return Us.DATA_LOSS;default:return Ps()}}(e)}(t),n=s.message;void 0===e&&(e=Us.INTERNAL,n="Unknown error status: "+t+" with message "+s.message),h=!0,u.ro(new Bs(e,n)),c.close()}else Ls("Connection","WebChannel received:",n),u.oo(n)}})),d(r,Es.STAT_EVENT,(t=>{t.stat===Ts.PROXY?Ls("Connection","Detected buffering proxy"):t.stat===Ts.NOPROXY&&Ls("Connection","Detected no buffering proxy")})),setTimeout((()=>{u.io()}),0),u}}function rc(){return"undefined"!=typeof document?document:null}function ac(t){return new ao(t,!0)}class oc{constructor(t,e,n=1e3,i=1.5,s=6e4){this.Yn=t,this.timerId=e,this.mo=n,this.yo=i,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),i=Math.max(0,e-n);i>0&&Ls("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.To=this.Yn.enqueueAfterDelay(this.timerId,i,(()=>(this.Eo=Date.now(),t()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class cc extends class{constructor(t,e,n,i,s,r,a,o){this.Yn=t,this.Vo=n,this.vo=i,this.So=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new oc(t,e)}ko(){return 1===this.state||5===this.state||this.Mo()}Mo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.ko()&&await this.close(0)}Fo(){this.state=0,this.No.reset()}$o(){this.Mo()&&null===this.Co&&(this.Co=this.Yn.enqueueAfterDelay(this.Vo,6e4,(()=>this.Bo())))}Lo(t){this.Uo(),this.stream.send(t)}async Bo(){if(this.Mo())return this.close(0)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}async close(t,e){this.Uo(),this.qo(),this.No.cancel(),this.Do++,4!==t?this.No.reset():e&&e.code===Us.RESOURCE_EXHAUSTED?(Rs(e.toString()),Rs("Using maximum backoff delay to prevent overloading the backend."),this.No.Ao()):e&&e.code===Us.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Ko(),this.stream.close(),this.stream=null),this.state=t,await this.listener.eo(e)}Ko(){}auth(){this.state=1;const t=this.Go(this.Do),e=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Do===e&&this.Qo(t,n)}),(e=>{t((()=>{const t=new Bs(Us.UNKNOWN,"Fetching auth token failed: "+e.message);return this.jo(t)}))}))}Qo(t,e){const n=this.Go(this.Do);this.stream=this.Wo(t,e),this.stream.Xr((()=>{n((()=>(this.state=2,this.xo=this.Yn.enqueueAfterDelay(this.vo,1e4,(()=>(this.Mo()&&(this.state=3),Promise.resolve()))),this.listener.Xr())))})),this.stream.eo((t=>{n((()=>this.jo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Oo(){this.state=5,this.No.Ro((async()=>{this.state=0,this.start()}))}jo(t){return Ls("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Go(t){return e=>{this.Yn.enqueueAndForget((()=>this.Do===t?e():(Ls("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.M=s,this.Yo=!1}get Xo(){return this.Yo}start(){this.Yo=!1,this.lastStreamToken=void 0,super.start()}Ko(){this.Yo&&this.Zo([])}Wo(t,e){return this.So.wo("Write",t,e)}onMessage(t){if(Vs(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Yo){this.No.reset();const e=function(t,e){return t&&t.length>0?(Vs(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?ho(t.updateTime):ho(e);return n.isEqual(er.min())&&(n=ho(e)),new La(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=ho(t.commitTime);return this.listener.tu(n,e)}return Vs(!t.writeResults||0===t.writeResults.length),this.Yo=!0,this.listener.eu()}nu(){const t={};t.database=function(t){return new ar(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.M),this.Lo(t)}Zo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof ja)n={update:mo(t,e.key,e.value)};else if(e instanceof Ka)n={delete:fo(t,e.key)};else if(e instanceof $a)n={update:mo(t,e.key,e.data),updateMask:xo(e.fieldMask)};else{if(!(e instanceof Ga))return Ps();n={verify:fo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof Ia)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Sa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ca)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Na)return{fieldPath:e.field.canonicalString(),increment:n.k};throw Ps()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:lo(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Ps()}(t,e.precondition)),n}(this.M,t)))};this.Lo(e)}}class lc extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.So=n,this.M=i,this.su=!1}iu(){if(this.su)throw new Bs(Us.FAILED_PRECONDITION,"The client has already been terminated.")}co(t,e,n){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.So.co(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Us.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Bs(Us.UNKNOWN,t.toString())}))}_o(t,e,n){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.So._o(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Us.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Bs(Us.UNKNOWN,t.toString())}))}terminate(){this.su=!0}}class hc{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}au(){0===this.ru&&(this.cu("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}lu(t){"Online"===this.state?this.cu("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.fu(),this.ru=0,"Online"===t&&(this.uu=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}hu(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.uu?(Rs(e),this.uu=!1):Ls("OnlineStateTracker",e)}fu(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}class uc{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=s,this.gu.Kr((t=>{n.enqueueAndForget((async()=>{pc(this)&&(Ls("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Fs(t);e.wu.add(4),await fc(e),e.yu.set("Unknown"),e.wu.delete(4),await dc(e)}(this))}))})),this.yu=new hc(n,i)}}async function dc(t){if(pc(t))for(const e of t.mu)await e(!0)}async function fc(t){for(const e of t.mu)await e(!1)}function pc(t){return 0===Fs(t).wu.size}async function mc(t,e,n){if(!To(e))throw e;t.wu.add(1),await fc(t),t.yu.set("Offline"),n||(n=()=>function(t){const e=Fs(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.fs.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ls("RemoteStore","Retrying IndexedDB access"),await n(),t.wu.delete(1),await dc(t)}))}function gc(t,e){return e().catch((n=>mc(t,n,e)))}async function yc(t){const e=Fs(t),n=Cc(e);let i=e.du.length>0?e.du[e.du.length-1].batchId:-1;for(;vc(e);)try{const t=await Bo(e.localStore,i);if(null===t){0===e.du.length&&n.$o();break}i=t.batchId,bc(e,t)}catch(t){await mc(e,t)}wc(e)&&xc(e)}function vc(t){return pc(t)&&t.du.length<10}function bc(t,e){t.du.push(e);const n=Cc(t);n.Mo()&&n.Xo&&n.Zo(e.mutations)}function wc(t){return pc(t)&&!Cc(t).ko()&&t.du.length>0}function xc(t){Cc(t).start()}async function Ec(t){Cc(t).nu()}async function Tc(t){const e=Cc(t);for(const n of t.du)e.Zo(n.mutations)}async function Ic(t,e,n){const i=t.du.shift(),s=So.from(i,e,n);await gc(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await yc(t)}async function Sc(t,e){e&&Cc(t).Xo&&await async function(t,e){if(function(t){switch(t){default:return Ps();case Us.CANCELLED:case Us.UNKNOWN:case Us.DEADLINE_EXCEEDED:case Us.RESOURCE_EXHAUSTED:case Us.INTERNAL:case Us.UNAVAILABLE:case Us.UNAUTHENTICATED:return!1;case Us.INVALID_ARGUMENT:case Us.NOT_FOUND:case Us.ALREADY_EXISTS:case Us.PERMISSION_DENIED:case Us.FAILED_PRECONDITION:case Us.ABORTED:case Us.OUT_OF_RANGE:case Us.UNIMPLEMENTED:case Us.DATA_LOSS:return!0}}(n=e.code)&&n!==Us.ABORTED){const n=t.du.shift();Cc(t).Fo(),await gc(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await yc(t)}var n}(t,e),wc(t)&&xc(t)}async function Ac(t,e){const n=Fs(t);n.asyncQueue.verifyOperationInProgress(),Ls("RemoteStore","RemoteStore received new credentials");const i=pc(n);n.wu.add(3),await fc(n),i&&n.yu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.wu.delete(3),await dc(n)}function Cc(t){return t.Tu||(t.Tu=function(t,e,n){const i=Fs(t);return i.iu(),new cc(e,i.So,i.authCredentials,i.appCheckCredentials,i.M,n)}(t.datastore,t.asyncQueue,{Xr:Ec.bind(null,t),eo:Sc.bind(null,t),eu:Tc.bind(null,t),tu:Ic.bind(null,t)}),t.mu.push((async e=>{e?(t.Tu.Fo(),await yc(t)):(await t.Tu.stop(),t.du.length>0&&(Ls("RemoteStore",`Stopping write stream with ${t.du.length} pending writes`),t.du=[]))}))),t.Tu}class _c{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new js,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,a=new _c(t,e,r,i,s);return a.start(n),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Bs(Us.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nc(t,e){if(Rs("AsyncQueue",`${e}: ${t}`),To(t))return new Bs(Us.UNAVAILABLE,`${e}: ${t}`);throw t}class Dc{constructor(){this.queries=new Ya((t=>fa(t)),da),this.onlineState="Unknown",this.bu=new Set}}class kc{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.sa={},this.ia=new Ya((t=>fa(t)),da),this.ra=new Map,this.oa=new Set,this.ua=new Br(wr.comparator),this.aa=new Map,this.ca=new Ho,this.ha={},this.la=new Map,this.fa=Ro.yn(),this.onlineState="Unknown",this.da=void 0}get isPrimaryClient(){return!0===this.da}}function Lc(t,e,n){const i=Fs(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.ia.forEach(((n,i)=>{const s=i.view.Pu(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=Fs(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.Pu(e)&&(i=!0)})),i&&function(t){t.bu.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.sa.zo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Rc(t,e){const n=Fs(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Fs(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.hi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let a=Eo.resolve();return r.forEach((t=>{a=a.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);Vs(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),a.next((()=>t.Bs.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.Bs.performConsistencyCheck(t))).next((()=>n.fi.Ks(t,i)))}))}(n.localStore,e);Pc(n,i,null),Mc(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Vc(n,t)}catch(t){await Oo(t)}}async function Oc(t,e,n){const i=Fs(t);try{const t=await function(t,e){const n=Fs(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.Bs.lookupMutationBatch(t,e).next((e=>(Vs(null!==e),i=e.keys(),n.Bs.removeMutationBatch(t,e)))).next((()=>n.Bs.performConsistencyCheck(t))).next((()=>n.fi.Ks(t,i)))}))}(i.localStore,e);Pc(i,e,n),Mc(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Vc(i,t)}catch(n){await Oo(n)}}function Mc(t,e){(t.la.get(e)||[]).forEach((t=>{t.resolve()})),t.la.delete(e)}function Pc(t,e,n){const i=Fs(t);let s=i.ha[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.ha[i.currentUser.toKey()]=s}}async function Vc(t,e,n){const i=Fs(t),s=[],r=[],a=[];i.ia.isEmpty()||(i.ia.forEach(((t,o)=>{a.push(i._a(o,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(o.targetId,t.fromCache?"not-current":"current"),s.push(t);const e=Po.Ys(o.targetId,t);r.push(e)}})))})),await Promise.all(a),i.sa.zo(s),await async function(t,e){const n=Fs(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Eo.forEach(e,(e=>Eo.forEach(e.Hs,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>Eo.forEach(e.Js,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!To(t))throw t;Ls("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ui.get(e),i=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(i);n.ui=n.ui.insert(e,s)}}}(i.localStore,r))}async function Fc(t,e){const n=Fs(t);if(!n.currentUser.isEqual(e)){Ls("SyncEngine","User change. New user:",e.toKey());const t=await Uo(n.localStore,e);n.currentUser=e,function(t,e){t.la.forEach((t=>{t.forEach((t=>{t.reject(new Bs(Us.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.la.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Vc(n,t.di)}}function Uc(t){const e=Fs(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Rc.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Oc.bind(null,e),e}class Bc{constructor(){this.synchronizeTabs=!1}async initialize(t){this.M=ac(t.databaseInfo.databaseId),this.sharedClientState=this.ga(t),this.persistence=this.ya(t),await this.persistence.start(),this.gcScheduler=this.pa(t),this.localStore=this.Ia(t)}pa(t){return null}Ia(t){return function(t,e,n,i){return new Fo(t,e,n,i)}(this.persistence,new Vo,t.initialUser,this.M)}ya(t){return new Wo(Qo.Yi,this.M)}ga(t){return new Zo}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class jc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Lc(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Fc.bind(null,this.syncEngine),await async function(t,e){const n=Fs(t);e?(n.wu.delete(2),await dc(n)):e||(n.wu.add(2),await fc(n),n.yu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Dc}createDatastore(t){const e=ac(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new sc(i));var i;return function(t,e,n,i){return new lc(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,s=t=>Lc(this.syncEngine,t,0),r=ec.vt()?new ec:new tc,new uc(e,n,i,s,r);var e,n,i,s,r}createSyncEngine(t,e){return function(t,e,n,i,s,r,a){const o=new kc(t,e,n,i,s,r);return a&&(o.da=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Fs(t);Ls("RemoteStore","RemoteStore shutting down."),e.wu.add(5),await fc(e),e.gu.shutdown(),e.yu.set("Unknown")}(this.remoteStore)}}class $c{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=_s.UNAUTHENTICATED,this.clientId=Qs.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ls("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ls("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Bs(Us.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new js;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Nc(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Hc(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Ls("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Ls("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Uo(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Bc)),t.offlineComponents}(t);Ls("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>Ac(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>Ac(e.remoteStore,n))),t.onlineComponents=e}function qc(t){return async function(t){return t.onlineComponents||(Ls("FirestoreClient","Using default OnlineComponentProvider"),await Hc(t,new jc)),t.onlineComponents}(t).then((t=>t.syncEngine))}const zc=new Map;function Kc(t,e,n){if(!n)throw new Bs(Us.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Gc(t){if(!wr.isDocumentKey(t))throw new Bs(Us.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Xc(t){if(wr.isDocumentKey(t))throw new Bs(Us.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Wc(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ps()}class Yc{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Bs(Us.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Bs(Us.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Bs(Us.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Qc{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yc({}),this._settingsFrozen=!1,t instanceof yr?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Bs(Us.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yr(t.options.projectId)}(t))}get app(){if(!this._app)throw new Bs(Us.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Bs(Us.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yc(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Hs;switch(t.type){case"gapi":const e=t.client;return Vs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ks(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Bs(Us.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=zc.get(t);e&&(Ls("ComponentProvider","Removing Datastore"),zc.delete(t),e.terminate())}(this),Promise.resolve()}}class Jc{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Jc(this.firestore,t,this._key)}}class Zc{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Zc(this.firestore,t,this._query)}}class tl extends Zc{constructor(t,e,n){super(t,e,function(t){return new la(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Jc(this.firestore,null,new wr(t))}withConverter(t){return new tl(this.firestore,t,this._path)}}class el{constructor(){this.Fa=Promise.resolve(),this.$a=[],this.Ba=!1,this.La=[],this.Ua=null,this.qa=!1,this.Ka=!1,this.Ga=[],this.No=new oc(this,"async_queue_retry"),this.Qa=()=>{const t=rc();t&&Ls("AsyncQueue","Visibility state changed to "+t.visibilityState),this.No.Po()};const t=rc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Qa)}get isShuttingDown(){return this.Ba}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ja(),this.Wa(t)}enterRestrictedMode(t){if(!this.Ba){this.Ba=!0,this.Ka=t||!1;const e=rc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Qa)}}enqueue(t){if(this.ja(),this.Ba)return new Promise((()=>{}));const e=new js;return this.Wa((()=>this.Ba&&this.Ka?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.$a.push(t),this.za())))}async za(){if(0!==this.$a.length){try{await this.$a[0](),this.$a.shift(),this.No.reset()}catch(t){if(!To(t))throw t;Ls("AsyncQueue","Operation failed with retryable error: "+t)}this.$a.length>0&&this.No.Ro((()=>this.za()))}}Wa(t){const e=this.Fa.then((()=>(this.qa=!0,t().catch((t=>{this.Ua=t,this.qa=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Rs("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.qa=!1,t))))));return this.Fa=e,e}enqueueAfterDelay(t,e,n){this.ja(),this.Ga.indexOf(t)>-1&&(e=0);const i=_c.createAndSchedule(this,t,e,n,(t=>this.Ha(t)));return this.La.push(i),i}ja(){this.Ua&&Ps()}verifyOperationInProgress(){}async Ja(){let t;do{t=this.Fa,await t}while(t!==this.Fa)}Ya(t){for(const e of this.La)if(e.timerId===t)return!0;return!1}Xa(t){return this.Ja().then((()=>{this.La.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.La)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Ja()}))}Za(t){this.Ga.push(t)}Ha(t){const e=this.La.indexOf(t);this.La.splice(e,1)}}class nl extends Qc{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new el,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||il(this),this._firestoreClient.terminate()}}function il(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new gr(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new $c(t._authCredentials,t._appCheckCredentials,t._queue,i)}class sl{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Bs(Us.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class rl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new rl(hr.fromBase64String(t))}catch(t){throw new Bs(Us.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new rl(hr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class al{constructor(t){this._methodName=t}}class ol{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Bs(Us.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Bs(Us.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Js(this._lat,t._lat)||Js(this._long,t._long)}}const cl=/^__.*__$/;class ll{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new $a(t,this.data,this.fieldMask,e,this.fieldTransforms):new ja(t,this.data,e,this.fieldTransforms)}}function hl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ps()}}class ul{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.M=n,this.ignoreUndefinedProperties=i,void 0===s&&this.tc(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get ec(){return this.settings.ec}nc(t){return new ul(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}sc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.nc({path:n,ic:!1});return i.rc(t),i}oc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.nc({path:n,ic:!1});return i.tc(),i}uc(t){return this.nc({path:void 0,ic:!0})}ac(t){return xl(t,this.settings.methodName,this.settings.cc||!1,this.path,this.settings.hc)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}tc(){if(this.path)for(let t=0;t<this.path.length;t++)this.rc(this.path.get(t))}rc(t){if(0===t.length)throw this.ac("Document fields must not be empty");if(hl(this.ec)&&cl.test(t))throw this.ac('Document fields cannot begin and end with "__"')}}class dl{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.M=n||ac(t)}lc(t,e,n,i=!1){return new ul({ec:t,methodName:e,hc:n,path:cr.emptyPath(),ic:!1,cc:i},this.databaseId,this.M,this.ignoreUndefinedProperties)}}function fl(t){const e=t._freezeSettings(),n=ac(t._databaseId);return new dl(t._databaseId,!!e.ignoreUndefinedProperties,n)}function pl(t,e,n,i,s,r={}){const a=t.lc(r.merge||r.mergeFields?2:0,e,n,s);vl("Data must be an object, but it was:",a,i);const o=gl(i,a);let c,l;if(r.merge)c=new lr(a.fieldMask),l=a.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=bl(e,i,n);if(!a.contains(s))throw new Bs(Us.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);El(t,s)||t.push(s)}c=new lr(t),l=a.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,l=a.fieldTransforms;return new ll(new Or(o),c,l)}function ml(t,e){if(yl(t=w(t)))return vl("Unsupported field value:",e,t),gl(t,e);if(t instanceof al)return function(t,e){if(!hl(e.ec))throw e.ac(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.ac(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ic&&4!==e.ec)throw e.ac("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=ml(s,e.uc(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=w(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ba(e.M,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=tr.fromDate(t);return{timestampValue:oo(e.M,n)}}if(t instanceof tr){const n=new tr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:oo(e.M,n)}}if(t instanceof ol)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof rl)return{bytesValue:co(e.M,t._byteString)};if(t instanceof Jc){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.ac(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:uo(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.ac(`Unsupported field value: ${Wc(t)}`)}(t,e)}function gl(t,e){const n={};return sr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ir(t,((t,i)=>{const s=ml(i,e.sc(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function yl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof tr||t instanceof ol||t instanceof rl||t instanceof Jc||t instanceof al)}function vl(t,e,n){if(!yl(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Wc(n);throw"an object"===i?e.ac(t+" a custom object"):e.ac(t+" "+i)}}function bl(t,e,n){if((e=w(e))instanceof sl)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(wl)>=0)throw xl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sl(...e.split("."))._internalPath}catch(i){throw xl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw xl("Field path arguments must be of type string or ",t,!1,void 0,n)}const wl=new RegExp("[~\\*/\\[\\]]");function xl(t,e,n,i,s){const r=i&&!i.isEmpty(),a=void 0!==s;let o=`Function ${e}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(r||a)&&(c+=" (found",r&&(c+=` in field ${i}`),a&&(c+=` in document ${s}`),c+=")"),new Bs(Us.INVALID_ARGUMENT,o+t+c)}function El(t,e){return t.some((t=>t.isEqual(e)))}function Tl(t,e){const n=function(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Bs(Us.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wc(t);throw new Bs(Us.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}(t.firestore,nl),i=function(t,e,...n){if(t=w(t),1===arguments.length&&(e=Qs.R()),Kc("doc","path",e),t instanceof Qc){const i=ar.fromString(e,...n);return Gc(i),new Jc(t,null,new wr(i))}{if(!(t instanceof Jc||t instanceof tl))throw new Bs(Us.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(ar.fromString(e,...n));return Gc(i),new Jc(t.firestore,t instanceof tl?t.converter:null,new wr(i))}}(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return function(t,e){return function(t,e){const n=new js;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Uc(t);try{const t=await function(t,e){const n=Fs(t),i=tr.now(),s=e.reduce(((t,e)=>t.add(e.key)),so());let r;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.fi.Ks(t,s).next((s=>{r=s;const a=[];for(const t of e){const e=Fa(t,r.get(t.key));null!=e&&a.push(new $a(t.key,e,Mr(e.value.mapValue),Ra.exists(!0)))}return n.Bs.addMutationBatch(t,i,a,e)})))).then((t=>(t.applyToLocalDocumentSet(r),{batchId:t.batchId,changes:r})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.ha[t.currentUser.toKey()];i||(i=new Br(Js)),i=i.insert(e,n),t.ha[t.currentUser.toKey()]=i}(i,t.batchId,n),await Vc(i,t.changes),await yc(i.remoteStore)}catch(t){const e=Nc(t,"Failed to persist write");n.reject(e)}}(await qc(t),e,n))),n.promise}(function(t){return t._firestoreClient||il(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[pl(fl(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,Ra.exists(!1))]).then((()=>i))}!function(t,e=!0){Ns="9.8.2",it(new x("firestore",((t,{options:n})=>{const i=t.getProvider("app").getImmediate(),s=new nl(i,new qs(t.getProvider("auth-internal")),new Xs(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),s._setSettings(n),s}),"PUBLIC")),at(Cs,"3.4.9",t),at(Cs,"3.4.9","esm2017")}();const Il=async()=>{const t=function(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw st.create("bad-app-name",{appName:String(i)});const s=tt.get(i);if(s){if(v(t,s.options)&&v(n,s.config))return s;throw st.create("duplicate-app",{appName:i})}const r=new I(i);for(const t of et.values())r.addComponent(t);const a=new rt(t,n,r);return tt.set(i,a),a}({apiKey:"AIzaSyAgqNzJLW14CijwytJjTi0H7wdoodPsDGM",authDomain:"xaymaio.firebaseapp.com",projectId:"xaymaio",storageBucket:"xaymaio.appspot.com",messagingSenderId:"154252806076",appId:"1:154252806076:web:aa49d2551cf3a34e34cdb9",measurementId:"G-MF1J4FE7B0",databaseURL:"https://xaymaio.firebaseio.com"}),e=function(t=function(t="[DEFAULT]"){const e=tt.get(t);if(!e)throw st.create("no-app",{appName:t});return e}()){return function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}(t,"firestore").getImmediate()}(t);return{app:t,db:e,save:async t=>{const n=await Tl(function(t,e,...n){if(t=w(t),Kc("collection","path",e),t instanceof Qc){const i=ar.fromString(e,...n);return Xc(i),new tl(t,null,i)}{if(!(t instanceof Jc||t instanceof tl))throw new Bs(Us.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(ar.fromString(e,...n));return Xc(i),new tl(t.firestore,null,i)}}(e,"experiences"),t);return console.log("Document written with ID: ",n.id),n}}};class Sl{firebase;$textarea;$el;onSave;onReady;parent;entreprise;text="";constructor({parent:t,onReady:e,entreprise:n,onSave:i,lang:s="fr"}){this.entreprise=n,this.parent=t,this.lang=s,this.onReady=e,this.onSave=i,this.init()}async init(){(t=>{const e=document.createElement("div");e.innerHTML=c;const n=document.createElement("style");n.innerHTML='@import url("https://fonts.googleapis.com/css2?family=Roboto&display=swap");:root{--xayma-primary-color: rgb(244,54,76);--xayma-light-color: rgb(255,255,255);--xayma-dark-color: rgb(0,0,0);--xayma-yellow-color: rgb(255,213,0);--border-color: rgba(0,0,0, 0.1);--xayma-shadow-color-var: 149,157,165;--xayma-shadow-color: rgba(var(--xayma-shadow-color-var), 0.2);--xayma-shadow: var(--xayma-shadow-color) 0px 8px 24px}\n.--xayma-main{position:relative;background-color:var(--xayma-light-color);color:var(--xayma-dark-color);box-shadow:var(--xayma-shadow);font-family:"Roboto", sans-serif}.--xayma-main .--xayma-main-close-btn{position:absolute;top:0;right:20px;border:0;padding:0;width:20px;height:20px;border-radius:100%;transform:translateY(-50%);cursor:pointer;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);fill:var(--xayma-light-color);display:flex;align-items:center;justify-content:center;z-index:10}.--xayma-main .--xayma-main-close-btn svg{width:10px}.--xayma-main .--xayma-head{text-align:center;padding:15px;padding:20px}.--xayma-main .--xayma-actions{display:flex;align-items:center;justify-content:center;gap:5px;padding:20px}.--xayma-main .--xayma-actions .--xayma-action-button{display:flex;align-items:center;justify-content:center;flex-direction:column;border:0;background-color:transparent;padding:0;width:42px;height:42px;line-height:1;cursor:pointer;position:relative;animation:AnimeActionButton 0.5s ease}@keyframes AnimeActionButton{0%{transform:translateX(-200px) scale(0.2);opacity:0}100%{transform:translateX(0px) scale(1);opacity:1}}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-icon{width:32px;display:flex;align-items:center;justify-content:center}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-icon>svg{width:32px}.--xayma-main .--xayma-actions .--xayma-action-button .--xayma-action-button-text{font-size:9px;position:absolute;top:100%;left:50%;transform:translateX(-50%);width:max-content;opacity:0;padding:5px;box-shadow:var(--xayma-shadow-color)}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-deactive-button .--xayma-action-button-icon{opacity:0.5}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-active-button .--xayma-action-button-icon{opacity:1}.--xayma-main .--xayma-actions .--xayma-action-button.--coation-active-button .--xayma-action-button-icon svg{fill:var(--xayma-yellow-color)}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-icon{opacity:1}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-icon svg{fill:var(--xayma-yellow-color)}.--xayma-main .--xayma-actions .--xayma-action-button:hover .--xayma-action-button-text{opacity:1}.--xayma-main .--xayma-editor{position:relative}.--xayma-main .--xayma-editor::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:var(--xayma-dark-color);opacity:0.03}.--xayma-main .--xayma-editor .xayma-textarea{border:0;width:calc(100% - 20px);height:150px;outline:none;resize:none;background-color:transparent;padding:10px;font:inherit;position:relative}.--xayma-main .--xayma-email{position:relative}.--xayma-main .--xayma-email::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:var(--xayma-dark-color);opacity:0.05}.--xayma-main .--xayma-email input{border:0;width:calc(100% - 20px);outline:none;background-color:transparent;padding:15px 20px;font:inherit;position:relative}.--xayma-main .--xayma-submit{display:flex;align-items:center;padding:10px 20px}.--xayma-main .--xayma-submit .--xayma-submit-button{margin-left:auto;border:0;height:32px;padding:0 10px;border-radius:0.3em;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);cursor:pointer}.--xayma-main .--xayma-foot{padding:5px;font-size:12px;text-align:center}.--xayma-main .--xayma-foot a{color:var(--xayma-dark-color)}.--xayma-main .--xayma-saving{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background-color:var(--border-color);display:flex;align-items:center;justify-content:center;border-radius:inherit}.--xayma-main .--xayma-saving svg{width:32px}.--xayma-main .--xayma-close{display:none !important}\n.--xayma-finish{padding:40px;text-align:center}.--xayma-finish .--xayma-finish-icon{width:64px;height:64px;margin:auto;display:flex;align-items:center;justify-content:center}.--xayma-finish .--xayma-finish-icon svg{fill:var(--xayma-yellow-color)}.--xayma-finish .--xayma-finish-text{margin:auto;margin-top:20px;text-align:center}\n',e.firstChild?.appendChild(n),t.appendChild(e.firstChild)})(this.parent),this.firebase=await Il();const t=document.querySelector(".--xayma-main"),e=t.querySelector(".--xayma-actions"),n=e.querySelectorAll("button");n.forEach((t=>{const e=Number(t.getAttribute("data-value"));e&&!isNaN(e)&&t.addEventListener("click",(()=>this.onActionBtnClick(e)))}));const i=t.querySelector(".--xayma-editor"),s=i.querySelector("textarea");s.addEventListener("change",(()=>{this.text=s.value}));const r=t.querySelector(".--xayma-email"),a=r.querySelector("input");a.value=this.email,a.addEventListener("change",(()=>{this.email=a.value}));const o=t.querySelector(".--xayma-submit"),l=o.querySelector("button");l.addEventListener("click",(()=>this.submit()));const h=t.querySelector(".--xayma-saving"),u=t.querySelector(".--xayma-finish"),d=u.querySelector(".--xayma-finish-icon"),f=u.querySelector(".--xayma-finish-text");this.$el={el:t,children:{editor:{el:i,children:{textarea:s}},actions:{el:e,buttons:n},email:{el:r,input:a},submit:{el:o,button:l},saving:h,finish:{el:u,children:{icon:d,text:f}}}},this.step=1,this.translate(this.lang),this.onReady&&this.onReady()}onActionBtnClick(t){this.note=t}submit(){if(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@(([[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/gim.test(this.email)){const t={note:this.note,entreprise:this.entreprise,text:this.text||null,email:this.email};this.saving=!0,this.firebase.save(t).then((()=>{this.onSave&&this.onSave();const t={1:s,2:i,3:n,4:r,5:a};this.$el.children.finish.children.icon.innerHTML=t[this.note],this.step=100})).finally((()=>{this.saving=!1}))}else this.step=3}translate(t){const e={fr:{actions:{1:"Horrible",2:"J'aime pas",3:"Acceptable",4:"J'aime",5:"J'adore"},editor:{placeholder:"Racontez-nous votre expÃ©rience (facultatif)..."},email:{placeholder:"Votre adresse email"},finish:{text:"Merci d'avoir participer Ã  amÃ©liorer la qualitÃ© de ce service en partageant votre expÃ©rience!"},submit:{text:"Envoyer"}},en:{actions:{1:"Horrible",2:"I don't like it",3:"Acceptable",4:"I like it",5:"I love it"},editor:{placeholder:"Tell us about your expÃ©rience (optional)..."},email:{placeholder:"Your email address"},finish:{text:"Thank you for participating in improving the quality of this service by sharing your expÃ©rience !"},submit:{text:"Send"}}}[t];this.$el.children.actions.buttons.forEach(((t,n)=>{t.querySelector(".--xayma-action-button-text").innerText=e.actions[n+1]})),this.$el.children.editor.children.textarea.placeholder=e.editor.placeholder,this.$el.children.email.input.placeholder=e.email.placeholder,this.$el.children.finish.children.text.innerText=e.finish.text,this.$el.children.submit.button.innerText=e.submit.text}_note;get note(){return this._note}set note(t){this._note=t,this.$el.children.actions.buttons.forEach(((e,n)=>{e.classList.remove("--coation-active-button"),e.classList.remove("--coation-deactive-button"),n+1===t?e.classList.add("--coation-active-button"):void 0!==t&&e.classList.add("--coation-deactive-button")})),this._note=t,t&&this.step<2&&(this.step=2)}_step=1;get step(){return this._step}set step(t){this._step=t,this.saving=!1,this.$el.children.actions.el.classList.remove("--xayma-close"),this.$el.children.editor.el.classList.remove("--xayma-close"),this.$el.children.submit.el.classList.remove("--xayma-close"),this.$el.children.email.el.classList.remove("--xayma-close"),this.$el.children.finish.el.classList.remove("--xayma-close"),1===this.step?(this.$el.children.editor.el.classList.add("--xayma-close"),this.$el.children.submit.el.classList.add("--xayma-close"),this.$el.children.email.el.classList.add("--xayma-close"),this.$el.children.finish.el.classList.add("--xayma-close"),this.note=void 0,this.text=""):2===this.step?(this.$el.children.email.el.classList.add("--xayma-close"),this.$el.children.finish.el.classList.add("--xayma-close")):3===this.step?(this.$el.children.editor.el.classList.add("--xayma-close"),this.$el.children.finish.el.classList.add("--xayma-close")):(this.$el.children.actions.el.classList.add("--xayma-close"),this.$el.children.editor.el.classList.add("--xayma-close"),this.$el.children.submit.el.classList.add("--xayma-close"),this.$el.children.email.el.classList.add("--xayma-close"),this.$el.children.finish.el.classList.remove("--xayma-close"))}_saving=!1;get saving(){return this._saving}set saving(t){this._saving=t,this.$el.children.saving.classList[t?"remove":"add"]("--xayma-close")}get email(){return sessionStorage.getItem("xayma.auth.email")||""}set email(t){sessionStorage.setItem("xayma.auth.email",t)}_lang="fr";get lang(){return this._lang}set lang(t){this._lang=t}}class Al{main;app;entreprise;lang;$el;constructor(t,e){this.entreprise=t,this.lang=e,this.init()}async init(){if(!this.lang){const t=window.navigator.language;this.lang=["fr","en"].includes(t)?t:"fr"}const t=document.createElement("div");t.innerHTML=await(async()=>{let t='<div id="xayma">\n  __xayma_start_button__\n\n  <div class="--xayma-main-container">__xayma_closer_button__</div>\n</div>\n';return t=await(async t=>{const e=document.createElement("button");e.classList.add("--xayma-start-button");const n=document.createElement("div");n.classList.add("--xayma-start-button-text"),n.innerText="Votre avis",e.appendChild(n);const i=document.createElement("div");return i.classList.add("--xayma-start-button-icon"),i.innerHTML=a,e.appendChild(i),t.replace("__xayma_start_button__",e.outerHTML)})(t),t=await(async t=>{const e=document.createElement("button");return e.classList.add("--xayma-closer-button"),e.innerHTML="fermer",t.replace("__xayma_closer_button__",e.outerHTML)})(t),t})(),this.app=t.firstChild;const e=document.createElement("style");e.innerHTML='#xayma{font-family:"Roboto", sans-serif;font-size:14px}#xayma .--xayma-start-button{position:fixed;right:0;top:50%;transform:translateY(-50%);width:36px;border:0;padding:0;border-top-left-radius:0.3em;border-bottom-left-radius:0.3em;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);display:flex;align-items:center;justify-content:center;flex-direction:column;padding-top:8px;padding-bottom:8px;gap:5px;cursor:pointer}#xayma .--xayma-start-button .--xayma-start-button-text{writing-mode:vertical-rl;-webkit-text-orientation:mixed;text-orientation:mixed}#xayma .--xayma-start-button .--xayma-start-button-icon{width:20px}#xayma .--xayma-start-button .--xayma-start-button-icon svg{fill:var(--xayma-light-color)}#xayma .--xayma-main-container{position:fixed;right:10px;top:50%;transform:translateY(-50%);width:350px;max-width:calc(100% - 20px);box-shadow:var(--xayma-shadow);animation:XaymaAnimeMainContainer 0.5s ease}#xayma .--xayma-main-container .--xayma-closer-button{position:absolute;top:0;right:10px;transform:translateY(-50%);border:0;min-width:24px;height:24px;outline:none;background-color:var(--xayma-dark-color);color:var(--xayma-light-color);z-index:50;border-radius:16em;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:10px}#xayma .--xayma-main-container .--xayma-closer-button svg{fill:var(--xayma-light-color);width:8px}@keyframes XaymaAnimeMainContainer{0%{transform:translateY(-50%) translateX(50%);opacity:0}100%{transform:translateY(-50%) translateX(0) scale(1);opacity:1}}#xayma:not(.open) .--xayma-main-container{display:none}#xayma.open .--xayma-start-button{display:none}#xayma:not(.ready){display:none}\n',this.app.appendChild(e),document.body.appendChild(t);const n=this.app.querySelector(".--xayma-start-button");n.addEventListener("click",(()=>this.toggleOpen()));const i=this.app.querySelector(".--xayma-closer-button");i.addEventListener("click",(()=>this.toggleOpen()));const s=this.app.querySelector(".--xayma-main-container");this.$el={el:this.app,closerButton:i,starterButton:n},this.translate(this.lang),this.main=new Sl({parent:s,entreprise:this.entreprise,lang:this.lang,onReady:()=>this.onReady()})}translate(t){const e={fr:{starterButton:"Votre avis",closerButton:"Fermer"},en:{starterButton:"Feedback",closerButton:"Close"}}[t];this.$el.starterButton.querySelector(".--xayma-start-button-text").innerText=e.starterButton,this.$el.closerButton.innerText=e.closerButton}onReady(){this.app.classList.add("ready")}toggleOpen(t){this.app.classList[t?"remove":"toggle"]("open"),this.main.step=1}}function Cl(t,e){return new Al(t,e)}return e})()));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZSixFQUFLZ0IsYUFHekMxQyxVQUNFMXBELEtBQUt1VCxJQUFJdFMsVUFBVUMsSUFBSSxTQUd6Qm9yRCxXQUFXRyxHQUVUenNELEtBQUt1VCxJQUFJdFMsVUFBVXdyRCxFQUFhLFNBQVcsVUFBVSxRQUNyRHpzRCxLQUFLaXNELEtBQUtqQixLQUFPLEdLN0ZkLFNBQVNuQixHQUFLRixFQUFvQkMsR0FFdkMsT0FEWSxJQUFJb0MsR0FBTXJDLEVBQVlDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veGF5bWEvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL3hheW1hL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3hheW1hL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly94YXltYS93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3hheW1hL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8veGF5bWEvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy9wb3B1cC90ZW1wbGF0ZXMvdGVtcGxhdGUuaHRtbCIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS9zdmdzL2luZGV4LnRzIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL3N2Z3MvYWNjZXB0YWJsZS5zdmciLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvc3Zncy9kaXNsaWtlLnN2ZyIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS9zdmdzL2Zyb3duLnN2ZyIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS9zdmdzL2xpa2Uuc3ZnIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL3N2Z3MvbG92ZS5zdmciLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvdGVtcGxhdGUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvdGVtcGxhdGUvdGVtcGxhdGUuaHRtbCIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS90ZW1wbGF0ZS9zYXZpbmcudHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvc3Zncy9sb2FkZXIuc3ZnIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL3RlbXBsYXRlL2FjdGlvbnMudHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvdGVtcGxhdGUvbG9naW4udHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvdGVtcGxhdGUvbG9naW4uaHRtbCIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS9zdHlsZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvc3R5bGVzL2luZGV4LnNjc3MiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMveGF5bWEvc3R5bGVzL21haW4uc2NzcyIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy94YXltYS9zdHlsZXMvZmluaXNoLnNjc3MiLCJ3ZWJwYWNrOi8veGF5bWEvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL3hheW1hLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9jb21wb25lbnQvZGlzdC9lc20vaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly94YXltYS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9ub2RlX21vZHVsZXMvaWRiL2J1aWxkL3dyYXAtaWRiLXZhbHVlLmpzIiwid2VicGFjazovL3hheW1hLy4vbm9kZV9tb2R1bGVzL2lkYi9idWlsZC9pbmRleC5qcyIsIndlYnBhY2s6Ly94YXltYS8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9ub2RlX21vZHVsZXMvZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovL3hheW1hLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXIvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL3hheW1hLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL2ZpcmViYXNlL2luZGV4LnRzIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL2luZGV4LnRzIiwid2VicGFjazovL3hheW1hLy4vc3JjL3hheW1hL2FwcC50cyIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy9wb3B1cC9pbmRleC50cyIsIndlYnBhY2s6Ly94YXltYS8uL3NyYy9wb3B1cC90ZW1wbGF0ZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMvcG9wdXAvdGVtcGxhdGVzL3N0YXJ0QnV0dG9uLnRzIiwid2VicGFjazovL3hheW1hLy4vc3JjL3BvcHVwL3RlbXBsYXRlcy9jbG9zZXJCdXR0b24udHMiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMvcG9wdXAvc3R5bGVzL2luZGV4LnNjc3MiLCJ3ZWJwYWNrOi8veGF5bWEvLi9zcmMvbWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ4YXltYVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ4YXltYVwiXSA9IGZhY3RvcnkoKTtcbn0pKHNlbGYsICgpID0+IHtcbnJldHVybiAiLCIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiZXhwb3J0IGRlZmF1bHQgXCI8ZGl2IGlkPVxcXCJ4YXltYVxcXCI+XFxuICBfX3hheW1hX3N0YXJ0X2J1dHRvbl9fXFxuXFxuICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLW1haW4tY29udGFpbmVyXFxcIj5fX3hheW1hX2Nsb3Nlcl9idXR0b25fXzwvZGl2PlxcbjwvZGl2PlxcblwiOyIsImltcG9ydCBhY2NlcHRhYmxlIGZyb20gXCIhIXJhdy1sb2FkZXIhLi9hY2NlcHRhYmxlLnN2Z1wiO1xuaW1wb3J0IGRpc2xpa2UgZnJvbSBcIiEhcmF3LWxvYWRlciEuL2Rpc2xpa2Uuc3ZnXCI7XG5pbXBvcnQgZnJvd24gZnJvbSBcIiEhcmF3LWxvYWRlciEuL2Zyb3duLnN2Z1wiO1xuaW1wb3J0IGdvb2dsZSBmcm9tIFwiISFyYXctbG9hZGVyIS4vZ29vZ2xlLnN2Z1wiO1xuaW1wb3J0IGxpa2UgZnJvbSBcIiEhcmF3LWxvYWRlciEuL2xpa2Uuc3ZnXCI7XG5pbXBvcnQgbG9hZGVyIGZyb20gXCIhIXJhdy1sb2FkZXIhLi9sb2FkZXIuc3ZnXCI7XG5pbXBvcnQgbG92ZSBmcm9tIFwiISFyYXctbG9hZGVyIS4vbG92ZS5zdmdcIjtcbmltcG9ydCBjbG9zZSBmcm9tIFwiISFyYXctbG9hZGVyIS4vY2xvc2Uuc3ZnXCI7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgYWNjZXB0YWJsZSxcbiAgZGlzbGlrZSxcbiAgZnJvd24sXG4gIGdvb2dsZSxcbiAgbGlrZSxcbiAgbG92ZSxcbiAgbG9hZGVyLFxuICBjbG9zZSxcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDE1MiAxNTJcXFwiPlxcbiAgPHBhdGggaWQ9XFxcImljb25cXFwiXFxuICAgIGQ9XFxcIm03NiAwYTc2IDc2IDAgMSAwIDc2IDc2IDc2IDc2IDAgMCAwIC03Ni03NnptLTMwLjgyIDQ1LjY4YTkuNzUgOS43NSAwIDEgMSAtOS43NCA5Ljc1IDkuNzUgOS43NSAwIDAgMSA5Ljc0LTkuNzV6bTY5LjY2IDY3LjVhNS45IDUuOSAwIDAgMSAtNC4xOCAxLjczaC02OS4zMWE1LjkxIDUuOTEgMCAxIDEgMC0xMS44Mmg2OS4zMWE1LjkxIDUuOTEgMCAwIDEgNC4xOCAxMC4wOXptLTgtNDhhOS43NSA5Ljc1IDAgMSAxIDkuNzUtOS43NCA5Ljc0IDkuNzQgMCAwIDEgLTkuNzcgOS43M3pcXFwiPlxcbiAgPC9wYXRoPlxcbjwvc3ZnPlxcblwiOyIsImV4cG9ydCBkZWZhdWx0IFwiPHN2ZyB2aWV3Qm94PVxcXCIwIDAgMTUyIDE1MlxcXCI+XFxuICA8cGF0aFxcbiAgICBkPVxcXCJtNzYgMGE3NiA3NiAwIDEgMCA3NiA3NiA3NiA3NiAwIDAgMCAtNzYtNzZ6bS0zNy41NyA1OC40M2E5Ljc1IDkuNzUgMCAxIDEgOS43NSA5Ljc1IDkuNzUgOS43NSAwIDAgMSAtOS43NS05Ljc1em02My41MSA1OS4xN2MtNy42LTMtMTYuNDctNS42LTI1Ljk0LTUuNnMtMTguMzQgMi42MS0yNS45NCA1LjZhMyAzIDAgMCAxIC00LjIyLTIuN2MwLS4xNSAwLS4zIDAtLjQ1IDIuMjUtMTQuNjEgMTQuODgtMjMgMzAuMTItMjNzMjcuODcgOC40MSAzMC4xMiAyM3YuNDVhMyAzIDAgMCAxIC00LjE0IDIuN3ptMS44OC00OS40MmE5Ljc1IDkuNzUgMCAxIDEgOS43NS05Ljc1IDkuNzUgOS43NSAwIDAgMSAtOS43NSA5Ljc1elxcXCI+XFxuICA8L3BhdGg+XFxuPC9zdmc+XFxuXCI7IiwiZXhwb3J0IGRlZmF1bHQgXCI8c3ZnIHZpZXdCb3g9XFxcIjAgMCAxNTIgMTUyXFxcIj5cXG4gIDxwYXRoIGlkPVxcXCJpY29uXFxcIlxcbiAgICBkPVxcXCJtNzYgMGE3NiA3NiAwIDEgMCA3NiA3NiA3NiA3NiAwIDAgMCAtNzYtNzZ6bS00MC42NSA3Ny43MWMtNC4zOS44NS00LjcxLTIuMzgtNC41Ny00LjE4YTMuNDggMy40OCAwIDAgMSAuNzEtMS44M2w3LjgtMTBhMy4zOSAzLjM5IDAgMCAwIC0uMDYtNC4yNWwtNy42OS05LjI4YTMuMyAzLjMgMCAwIDEgLS43Ni0xLjhjLS4yOS0zLjU2IDIuNDktNC4zMSA0LjE2LTQuNDRhMy4zNiAzLjM2IDAgMCAxIDIgLjVsMjMuMzkgMTQuNDFjMy45MSAyLjQxIDEgNS4wNi4xOSA1LjdhMy42MiAzLjYyIDAgMCAxIC0uMzIuMjJsLTIzLjc2IDE0LjUyYTMuMTEgMy4xMSAwIDAgMSAtMS4wOS40M3ptNzMuMzUgNDMuNzFhODkuNzggODkuNzggMCAwIDAgLTMyLjctNS45NCA4OS43MyA4OS43MyAwIDAgMCAtMzIuNjkgNS45NCAzLjgyIDMuODIgMCAwIDEgLTUuMy0zLjQ5IDMuODggMy44OCAwIDAgMSAwLS40OCAzOC40MSAzOC40MSAwIDAgMSA3NS45MSAwIDQgNCAwIDAgMSAwIC40OSAzLjgyIDMuODIgMCAwIDEgLTUuMjIgMy40OHptOC00My43MWEzIDMgMCAwIDEgLTEuMDktLjQzbC0yMy44LTE0LjUyYTMuNjIgMy42MiAwIDAgMSAtLjMyLS4yMmMtLjgxLS42NC0zLjcyLTMuMjkuMTktNS43bDIzLjM4LTE0LjM2YTMuNDEgMy40MSAwIDAgMSAyLS41YzEuNjcuMTMgNC40NS44OCA0LjE1IDQuNDRhMy4xNiAzLjE2IDAgMCAxIC0uNzYgMS44bC03LjY4IDkuMjhhMy4zNyAzLjM3IDAgMCAwIC0uMDYgNC4yNWw3Ljc5IDEwYTMuNDEgMy40MSAwIDAgMSAuNzIgMS44M2MuMTUgMS43NS0uMTcgNC45OC00LjU2IDQuMTN6XFxcIj5cXG4gIDwvcGF0aD5cXG5cXG48L3N2Zz5cXG5cIjsiLCJleHBvcnQgZGVmYXVsdCBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDE1MiAxNTJcXFwiPlxcbiAgPHBhdGhcXG4gICAgZD1cXFwibTc2IDBhNzYgNzYgMCAxIDAgNzYgNzYgNzYgNzYgMCAwIDAgLTc2LTc2em0yNy44MiA0OC42OWE5Ljc1IDkuNzUgMCAxIDEgLTkuNzQgOS43NCA5Ljc0IDkuNzQgMCAwIDEgOS43NC05Ljc0em0tNTUuNjQgMGE5Ljc1IDkuNzUgMCAxIDEgLTkuNzQgOS43NCA5Ljc1IDkuNzUgMCAwIDEgOS43NC05Ljc0em03MC42MiA0Ni42OWMtMy4xOSAxOC4yMS0yMS4xNCAzMC44NC00Mi44IDMwLjg0cy0zOS42LTEyLjYzLTQyLjc5LTMwLjg0YTMuNjggMy42OCAwIDAgMSAtLjA2LS41NmMwLTIuNjMgMy4yLTQuMzMgNi0zLjM3IDEwLjggMy43MyAyMy40IDUuNjMgMzYuODYgNS42M3MyNi4wNi0xLjkgMzYuODYtNS42M2MyLjc5LTEgNiAuNzMgNiAzLjM3YTMuNjQgMy42NCAwIDAgMSAtLjA3LjU2elxcXCI+XFxuICA8L3BhdGg+XFxuICA8L3BhdGg+XFxuPC9zdmc+XFxuXCI7IiwiZXhwb3J0IGRlZmF1bHQgXCI8c3ZnIHZpZXdCb3g9XFxcIjAgMCAxNTIgMTUyXFxcIj5cXG4gIDxwYXRoXFxuICAgIGQ9XFxcIm03NiAwYTc2IDc2IDAgMSAwIDc2IDc2IDc2IDc2IDAgMCAwIC03Ni03NnptLTQ2Ljc1IDUwLjQ2YzQuNDgtOS4yMyAxMy41NS02LjY2IDE0LjY3LTYuMy4yNi0xLjE1IDIuNjktMTAuMjYgMTIuOTEtOS40IDAgMCAxMCAxLjM3IDguMiAxMy4xNmwtNS45IDIyLjQ4LjI0LjQxLS4zNy0uMDktLjA4LjMzLS4yNC0uNDItMjIuMzQtNi40Yy0xMS4wMy00LjQ2LTcuMDktMTMuNzctNy4wOS0xMy43N3ptODkuNTQgNDQuOTJjLTMuMTkgMTguMjEtMjEuMTMgMzAuODQtNDIuNzkgMzAuODRzLTM5LjYtMTIuNjMtNDIuOC0zMC44NGEzLjY0IDMuNjQgMCAwIDEgLS4wNS0uNTZjMC0yLjYzIDMuMi00LjMzIDYtMy4zNyAxMC43OSAzLjczIDIzLjM5IDUuNjMgMzYuODUgNS42M3MyNi4wNS0xLjkgMzYuODYtNS42M2MyLjc5LTEgNiAuNzMgNiAzLjM3YTIuNzQgMi43NCAwIDAgMSAtLjA3LjU2em0tMy4xNy0zMS4xNS0yMi4zNCA2LjQtLjI0LjQyLS4wNC0uMzMtLjMzLjA5LjI0LS40MS01LjkxLTIyLjQ4Yy0xLjgxLTExLjc5IDguMi0xMy4xNiA4LjItMTMuMTYgMTAuMjItLjg2IDEyLjY0IDguMjUgMTIuOTEgOS40IDEuMTItLjM2IDEwLjE5LTIuOTMgMTQuNjcgNi4zLS4wMyAwIDMuOSA5LjMxLTcuMTYgMTMuNzd6XFxcIj5cXG4gIDwvcGF0aD5cXG48L3N2Zz5cXG5cIjsiLCJpbXBvcnQgX3RlbXBsYXRlIGZyb20gXCIhIXJhdy1sb2FkZXIhLi90ZW1wbGF0ZS5odG1sXCI7XG5cbmltcG9ydCBsb2dpbiBmcm9tIFwiLi9sb2dpblwiO1xuaW1wb3J0IGFjdGlvbnMgZnJvbSBcIi4vYWN0aW9uc1wiO1xuaW1wb3J0IHNhdmluZyBmcm9tIFwiLi9zYXZpbmdcIjtcblxubGV0IHRlbXBsYXRlID0gX3RlbXBsYXRlO1xudGVtcGxhdGUgPSBzYXZpbmcodGVtcGxhdGUpO1xudGVtcGxhdGUgPSBhY3Rpb25zKHRlbXBsYXRlKTtcbnRlbXBsYXRlID0gbG9naW4odGVtcGxhdGUpO1xuXG5leHBvcnQgZGVmYXVsdCB0ZW1wbGF0ZTtcbiIsImV4cG9ydCBkZWZhdWx0IFwiPGRpdiBpZD1cXFwieGF5bWEtbWFpblxcXCIgY2xhc3M9XFxcIi0teGF5bWEtbWFpblxcXCI+XFxuICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLWJvZHlcXFwiPlxcbiAgICBfX3hheW1hX2FjdGlvbl9fXFxuXFxuICAgIDxkaXYgY2xhc3M9XFxcIi0teGF5bWEtZWRpdG9yIC0teGF5bWEtY2xvc2VcXFwiPlxcbiAgICAgIDx0ZXh0YXJlYVxcbiAgICAgICAgY2xhc3M9XFxcInhheW1hLXRleHRhcmVhXFxcIlxcbiAgICAgICAgcGxhY2Vob2xkZXI9XFxcIlJhY29udGV6LW5vdXMgdm90cmVzIGV4cMOpcmllbmNlcyAoZmFjdWx0YXRpZikuLi5cXFwiXFxuICAgICAgPjwvdGV4dGFyZWE+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLWVtYWlsIC0teGF5bWEtY2xvc2VcXFwiPlxcbiAgICAgIDxpbnB1dCB0eXBlPVxcXCJlbWFpbFxcXCIgcGxhY2Vob2xkZXI9XFxcIlZvdHJlIGFkcmVzc2UgZW1haWxcXFwiIC8+XFxuICAgIDwvZGl2PlxcblxcbiAgICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLXN1Ym1pdCAtLXhheW1hLWNsb3NlXFxcIj5cXG4gICAgICA8YnV0dG9uIGNsYXNzPVxcXCItLXhheW1hLXN1Ym1pdC1idXR0b25cXFwiPkVudm95ZXI8L2J1dHRvbj5cXG4gICAgPC9kaXY+XFxuXFxuICAgIF9feGF5bWFfbG9naW5fX1xcbiAgPC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLWZpbmlzaCAtLXhheW1hLWNsb3NlXFxcIj5cXG4gICAgPGRpdiBjbGFzcz1cXFwiLS14YXltYS1maW5pc2gtaWNvblxcXCI+PC9kaXY+XFxuICAgIDxkaXYgY2xhc3M9XFxcIi0teGF5bWEtZmluaXNoLXRleHRcXFwiPjwvZGl2PlxcbiAgPC9kaXY+XFxuICA8ZGl2IGNsYXNzPVxcXCItLXhheW1hLWZvb3RcXFwiPlxcbiAgICA8c21hbGw+Ynk8L3NtYWxsPlxcbiAgICA8c3Ryb25nPlxcbiAgICAgIDxhIHJlbD1cXFwibm9vcGVuZXJcXFwiIGhyZWY9XFxcImh0dHBzOi8veGF5bWFpby53ZWIuYXBwL1xcXCIgdGFyZ2V0PVxcXCJfYmxhbmtcXFwiPlxcbiAgICAgICAgWGF5bWFcXG4gICAgICA8L2E+XFxuICAgIDwvc3Ryb25nPlxcbiAgPC9kaXY+XFxuICBfX3hheW1hX3NhdmluZ19fXFxuPC9kaXY+XFxuXCI7IiwiaW1wb3J0IHN2Z3MgZnJvbSBcIi4uL3N2Z3NcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHRlbXBsYXRlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgZGl2LmNsYXNzTGlzdC5hZGQoXCItLXhheW1hLXNhdmluZ1wiKTtcbiAgZGl2LmlubmVySFRNTCA9IHN2Z3MubG9hZGVyO1xuXG4gIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFwiX194YXltYV9zYXZpbmdfX1wiLCBkaXYub3V0ZXJIVE1MKTtcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDM4IDM4XFxcIiBzdHJva2U9XFxcImN1cnJlbnRDb2xvclxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIi41XFxcIj5cXG4gIDxnIGZpbGw9XFxcIm5vbmVcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCI+XFxuICAgIDxnIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDEgMSlcXFwiIHN0cm9rZS13aWR0aD1cXFwiMlxcXCI+XFxuICAgICAgPGNpcmNsZSBzdHJva2Utb3BhY2l0eT1cXFwiLjNcXFwiIGN4PVxcXCIxOFxcXCIgY3k9XFxcIjE4XFxcIiByPVxcXCIxOFxcXCIgLz5cXG4gICAgICA8cGF0aCBkPVxcXCJNMzYgMThjMC05Ljk0LTguMDYtMTgtMTgtMThcXFwiPlxcbiAgICAgICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT1cXFwidHJhbnNmb3JtXFxcIiB0eXBlPVxcXCJyb3RhdGVcXFwiIGZyb209XFxcIjAgMTggMThcXFwiIHRvPVxcXCIzNjAgMTggMThcXFwiIGR1cj1cXFwiMXNcXFwiXFxuICAgICAgICAgIHJlcGVhdENvdW50PVxcXCJpbmRlZmluaXRlXFxcIiAvPlxcbiAgICAgIDwvcGF0aD5cXG4gICAgPC9nPlxcbiAgPC9nPlxcbjwvc3ZnPlxcblwiOyIsImltcG9ydCBzdmdzIGZyb20gXCIuLi9zdmdzXCI7XG5cbmV4cG9ydCBkZWZhdWx0ICh0ZW1wbGF0ZTogc3RyaW5nKSA9PiB7XG4gIHR5cGUgQWN0aW9uID0geyBpY29uOiBzdHJpbmc7IHRleHQ6IHN0cmluZzsgbm90ZTogbnVtYmVyIH07XG5cbiAgY29uc3QgYWN0aW9uczogeyBba2V5OiBzdHJpbmddOiBBY3Rpb24gfSA9IHtcbiAgICBmcm93bjogeyBpY29uOiBzdmdzLmZyb3duLCB0ZXh0OiBcIkhvcnJpYmxlXCIsIG5vdGU6IDEgfSxcbiAgICBkaXNsaWtlOiB7IGljb246IHN2Z3MuZGlzbGlrZSwgdGV4dDogXCJKJ2FpbWUgcGFzXCIsIG5vdGU6IDIgfSxcbiAgICBhY2NlcHRhYmxlOiB7IGljb246IHN2Z3MuYWNjZXB0YWJsZSwgdGV4dDogXCJBY2NlcHRhYmxlXCIsIG5vdGU6IDMgfSxcbiAgICBsaWtlOiB7IGljb246IHN2Z3MubGlrZSwgdGV4dDogXCJKJ2FpbWVcIiwgbm90ZTogNCB9LFxuICAgIGxvdmU6IHsgaWNvbjogc3Zncy5sb3ZlLCB0ZXh0OiBcIkonYWRvcmVcIiwgbm90ZTogNSB9LFxuICB9O1xuXG4gIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGRpdi5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1hY3Rpb25zXCIpO1xuXG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhY3Rpb25zKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBrZXkgPSBrZXlzW2ldO1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCItLXhheW1hLWFjdGlvbi1idXR0b25cIik7XG4gICAgYnV0dG9uLnN0eWxlLmFuaW1hdGlvbkR1cmF0aW9uID0gYCR7KGtleXMubGVuZ3RoIC0gaSArIDEpICogMjAwfW1zYDtcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS12YWx1ZVwiLCBgJHtpICsgMX1gKTtcblxuICAgIC8vIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXG4gICAgLy8gICBcIm9uY2xpY2tcIixcbiAgICAvLyAgIGBDT1RBVElPTi5vbkFjdGlvbkNsaWNrKCR7YWN0aW9uc1trZXldLm5vdGV9KTtgXG4gICAgLy8gKTtcblxuICAgIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGljb24uY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtYWN0aW9uLWJ1dHRvbi1pY29uXCIpO1xuICAgIGljb24uaW5uZXJIVE1MID0gYWN0aW9uc1trZXldLmljb247XG4gICAgYnV0dG9uLmFwcGVuZENoaWxkKGljb24pO1xuXG4gICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdGV4dC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1hY3Rpb24tYnV0dG9uLXRleHRcIik7XG4gICAgdGV4dC5pbm5lckhUTUwgPSBhY3Rpb25zW2tleV0udGV4dDtcbiAgICBidXR0b24uYXBwZW5kQ2hpbGQodGV4dCk7XG5cbiAgICBkaXYuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgfVxuXG4gIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFwiX194YXltYV9hY3Rpb25fX1wiLCBkaXYub3V0ZXJIVE1MKTtcbn07XG4iLCJpbXBvcnQgX3RlbXBsYXRlIGZyb20gXCIhIXJhdy1sb2FkZXIhLi9sb2dpbi5odG1sXCI7XG5cbmV4cG9ydCBkZWZhdWx0ICh0ZW1wbGF0ZTogc3RyaW5nKSA9PiB7XG4gIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFwiX194YXltYV9sb2dpbl9fXCIsIF90ZW1wbGF0ZSk7XG59O1xuIiwiZXhwb3J0IGRlZmF1bHQgXCI8ZGl2IGNsYXNzPVxcXCItLXhheW1hLWxvZ2luIC0teGF5bWEtY2xvc2VcXFwiPlxcbiAgPGRpdj5cXG4gICAgTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQgY29uc2VjdGV0dXIgYWRpcGlzaWNpbmcgZWxpdC4gRXQgZXVtIG9kaW9cXG4gICAgZGlnbmlzc2ltb3MgZW9zIHF1aXMgdXQgY29ycG9yaXMgcmVwcmVoZW5kZXJpdC5cXG4gIDwvZGl2PlxcblxcbiAgPGJ1dHRvbiBjbGFzcz1cXFwiLS14YXltYS1sb2dpbi1idXR0b25cXFwiPlxcbiAgICA8c3ZnIHZpZXdCb3g9XFxcIjAgMCA1MTIgNTEyXFxcIj5cXG4gICAgICA8cGF0aFxcbiAgICAgICAgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIlxcbiAgICAgICAgZD1cXFwibTUxMiAyNTZjMC0xNi4wODQtMS41MDktMzIuMTgzLTQuNDk3LTQ3LjgxMy0xLjM0OC03LjA3NS03LjU0NC0xMi4xODgtMTQuNzM2LTEyLjE4OGgtMjM1Ljc2N2MtOC4yOTEgMC0xNSA2LjcwOS0xNSAxNXY5MGMwIDguMjkxIDYuNzA5IDE1IDE1IDE1aDEyMC45NjdjLTcuNTM3IDE1LjI1OC0xNy45MjQgMjguNDk3LTMwLjEyMSAzOS42MzVsODQuNzggODQuNzhjNDguNzgxLTQ2LjQ3NSA3OS4zNzQtMTExLjg3NSA3OS4zNzQtMTg0LjQxNHpcXFwiXFxuICAgICAgPjwvcGF0aD5cXG4gICAgICA8cGF0aFxcbiAgICAgICAgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIlxcbiAgICAgICAgZD1cXFwibTI1NiAxMjBjMjkuNDI5IDAgNTcuNDIyIDkuMzQ2IDgwLjk0NyAyNy4wNDEgNS45NDcgNC40NjggMTQuMzQxIDMuOTI2IDE5LjYxNC0xLjM5Mmw2NC4wMTQtNjQuMDE0YzIuOTc0LTIuOTc0IDQuNTctNy4wNjEgNC4zOC0xMS4yNjVzLTIuMTI0LTguMTMtNS4zNDctMTAuODRjLTQ1LjgwNS0zOC4zOTItMTAzLjkxNi01OS41My0xNjMuNjA4LTU5LjUzLTg3Ljg0OSAwLTE2NS40NTggNDQuNjU0LTIxMS4zMzcgMTEyLjQ1Mmw4OC4wNDggODguMDQ4YzIxLjAwNi00Ny4zMTYgNjguMjY4LTgwLjUgMTIzLjI4OS04MC41elxcXCJcXG4gICAgICA+PC9wYXRoPlxcbiAgICAgIDxwYXRoXFxuICAgICAgICB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiXFxuICAgICAgICBkPVxcXCJtMjU2IDUxMmM1Ny4yNjMgMCAxMDkuOTkzLTE5LjIgMTUyLjYwMi01MS4xODdsLTg2LjM3MS04Ni4zNzFjLTE5Ljc0MiAxMS4xMTYtNDIuMzA2IDE3LjU1OC02Ni4yMzEgMTcuNTU4LTU1LjAyMSAwLTEwMi4yODMtMzMuMTg0LTEyMy4yODktODAuNWwtODguMDQ4IDg4LjA0OGM0NS44NzkgNjcuNzk4IDEyMy40ODggMTEyLjQ1MiAyMTEuMzM3IDExMi40NTJ6XFxcIlxcbiAgICAgID48L3BhdGg+XFxuICAgICAgPHBhdGhcXG4gICAgICAgIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCJcXG4gICAgICAgIGQ9XFxcIm0xMjIuMTg0IDI3Ny42MDVjLTEuMTQ5LTcuMDc5LTIuMTg0LTE0LjIwOC0yLjE4NC0yMS42MDVzMS4wMzUtMTQuNTI2IDIuMTg0LTIxLjYwNWwtOTQuMTI0LTk0LjEyNGMtMTcuODA4IDM0Ljc4LTI4LjA2IDc0LjA0NS0yOC4wNiAxMTUuNzI5czEwLjI1MiA4MC45NDkgMjguMDYxIDExNS43Mjh6XFxcIlxcbiAgICAgID48L3BhdGg+XFxuICAgIDwvc3ZnPlxcblxcbiAgICA8ZGl2PlNlIGNvbm5lY3RlciBhdmVjIGdvb2dsZTwvZGl2PlxcbiAgPC9idXR0b24+XFxuPC9kaXY+XFxuXCI7IiwiaW1wb3J0IGluZGV4IGZyb20gXCIhIXJhdy1sb2FkZXIhc2Fzcy1sb2FkZXIhLi9pbmRleC5zY3NzXCI7XG5pbXBvcnQgbWFpbiBmcm9tIFwiISFyYXctbG9hZGVyIXNhc3MtbG9hZGVyIS4vbWFpbi5zY3NzXCI7XG5pbXBvcnQgZmluaXNoIGZyb20gXCIhIXJhdy1sb2FkZXIhc2Fzcy1sb2FkZXIhLi9maW5pc2guc2Nzc1wiO1xuXG5sZXQgc3R5bGUgPSBpbmRleDtcbnN0eWxlICs9IG1haW47XG5zdHlsZSArPSBmaW5pc2g7XG5cbmV4cG9ydCBkZWZhdWx0IHN0eWxlO1xuIiwiZXhwb3J0IGRlZmF1bHQgXCJAaW1wb3J0IHVybChcXFwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1Sb2JvdG8mZGlzcGxheT1zd2FwXFxcIik7OnJvb3R7LS14YXltYS1wcmltYXJ5LWNvbG9yOiByZ2IoMjQ0LDU0LDc2KTstLXhheW1hLWxpZ2h0LWNvbG9yOiByZ2IoMjU1LDI1NSwyNTUpOy0teGF5bWEtZGFyay1jb2xvcjogcmdiKDAsMCwwKTstLXhheW1hLXllbGxvdy1jb2xvcjogcmdiKDI1NSwyMTMsMCk7LS1ib3JkZXItY29sb3I6IHJnYmEoMCwwLDAsIDAuMSk7LS14YXltYS1zaGFkb3ctY29sb3ItdmFyOiAxNDksMTU3LDE2NTstLXhheW1hLXNoYWRvdy1jb2xvcjogcmdiYSh2YXIoLS14YXltYS1zaGFkb3ctY29sb3ItdmFyKSwgMC4yKTstLXhheW1hLXNoYWRvdzogdmFyKC0teGF5bWEtc2hhZG93LWNvbG9yKSAwcHggOHB4IDI0cHh9XFxuXCI7IiwiZXhwb3J0IGRlZmF1bHQgXCIuLS14YXltYS1tYWlue3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6dmFyKC0teGF5bWEtbGlnaHQtY29sb3IpO2NvbG9yOnZhcigtLXhheW1hLWRhcmstY29sb3IpO2JveC1zaGFkb3c6dmFyKC0teGF5bWEtc2hhZG93KTtmb250LWZhbWlseTpcXFwiUm9ib3RvXFxcIiwgc2Fucy1zZXJpZn0uLS14YXltYS1tYWluIC4tLXhheW1hLW1haW4tY2xvc2UtYnRue3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3JpZ2h0OjIwcHg7Ym9yZGVyOjA7cGFkZGluZzowO3dpZHRoOjIwcHg7aGVpZ2h0OjIwcHg7Ym9yZGVyLXJhZGl1czoxMDAlO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpO2N1cnNvcjpwb2ludGVyO2JhY2tncm91bmQtY29sb3I6dmFyKC0teGF5bWEtZGFyay1jb2xvcik7Y29sb3I6dmFyKC0teGF5bWEtbGlnaHQtY29sb3IpO2ZpbGw6dmFyKC0teGF5bWEtbGlnaHQtY29sb3IpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt6LWluZGV4OjEwfS4tLXhheW1hLW1haW4gLi0teGF5bWEtbWFpbi1jbG9zZS1idG4gc3Zne3dpZHRoOjEwcHh9Li0teGF5bWEtbWFpbiAuLS14YXltYS1oZWFke3RleHQtYWxpZ246Y2VudGVyO3BhZGRpbmc6MTVweDtwYWRkaW5nOjIwcHh9Li0teGF5bWEtbWFpbiAuLS14YXltYS1hY3Rpb25ze2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtnYXA6NXB4O3BhZGRpbmc6MjBweH0uLS14YXltYS1tYWluIC4tLXhheW1hLWFjdGlvbnMgLi0teGF5bWEtYWN0aW9uLWJ1dHRvbntkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2JvcmRlcjowO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7cGFkZGluZzowO3dpZHRoOjQycHg7aGVpZ2h0OjQycHg7bGluZS1oZWlnaHQ6MTtjdXJzb3I6cG9pbnRlcjtwb3NpdGlvbjpyZWxhdGl2ZTthbmltYXRpb246QW5pbWVBY3Rpb25CdXR0b24gMC41cyBlYXNlfUBrZXlmcmFtZXMgQW5pbWVBY3Rpb25CdXR0b257MCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTIwMHB4KSBzY2FsZSgwLjIpO29wYWNpdHk6MH0xMDAle3RyYW5zZm9ybTp0cmFuc2xhdGVYKDBweCkgc2NhbGUoMSk7b3BhY2l0eToxfX0uLS14YXltYS1tYWluIC4tLXhheW1hLWFjdGlvbnMgLi0teGF5bWEtYWN0aW9uLWJ1dHRvbiAuLS14YXltYS1hY3Rpb24tYnV0dG9uLWljb257d2lkdGg6MzJweDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXJ9Li0teGF5bWEtbWFpbiAuLS14YXltYS1hY3Rpb25zIC4tLXhheW1hLWFjdGlvbi1idXR0b24gLi0teGF5bWEtYWN0aW9uLWJ1dHRvbi1pY29uPnN2Z3t3aWR0aDozMnB4fS4tLXhheW1hLW1haW4gLi0teGF5bWEtYWN0aW9ucyAuLS14YXltYS1hY3Rpb24tYnV0dG9uIC4tLXhheW1hLWFjdGlvbi1idXR0b24tdGV4dHtmb250LXNpemU6OXB4O3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxMDAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3dpZHRoOm1heC1jb250ZW50O29wYWNpdHk6MDtwYWRkaW5nOjVweDtib3gtc2hhZG93OnZhcigtLXhheW1hLXNoYWRvdy1jb2xvcil9Li0teGF5bWEtbWFpbiAuLS14YXltYS1hY3Rpb25zIC4tLXhheW1hLWFjdGlvbi1idXR0b24uLS1jb2F0aW9uLWRlYWN0aXZlLWJ1dHRvbiAuLS14YXltYS1hY3Rpb24tYnV0dG9uLWljb257b3BhY2l0eTowLjV9Li0teGF5bWEtbWFpbiAuLS14YXltYS1hY3Rpb25zIC4tLXhheW1hLWFjdGlvbi1idXR0b24uLS1jb2F0aW9uLWFjdGl2ZS1idXR0b24gLi0teGF5bWEtYWN0aW9uLWJ1dHRvbi1pY29ue29wYWNpdHk6MX0uLS14YXltYS1tYWluIC4tLXhheW1hLWFjdGlvbnMgLi0teGF5bWEtYWN0aW9uLWJ1dHRvbi4tLWNvYXRpb24tYWN0aXZlLWJ1dHRvbiAuLS14YXltYS1hY3Rpb24tYnV0dG9uLWljb24gc3Zne2ZpbGw6dmFyKC0teGF5bWEteWVsbG93LWNvbG9yKX0uLS14YXltYS1tYWluIC4tLXhheW1hLWFjdGlvbnMgLi0teGF5bWEtYWN0aW9uLWJ1dHRvbjpob3ZlciAuLS14YXltYS1hY3Rpb24tYnV0dG9uLWljb257b3BhY2l0eToxfS4tLXhheW1hLW1haW4gLi0teGF5bWEtYWN0aW9ucyAuLS14YXltYS1hY3Rpb24tYnV0dG9uOmhvdmVyIC4tLXhheW1hLWFjdGlvbi1idXR0b24taWNvbiBzdmd7ZmlsbDp2YXIoLS14YXltYS15ZWxsb3ctY29sb3IpfS4tLXhheW1hLW1haW4gLi0teGF5bWEtYWN0aW9ucyAuLS14YXltYS1hY3Rpb24tYnV0dG9uOmhvdmVyIC4tLXhheW1hLWFjdGlvbi1idXR0b24tdGV4dHtvcGFjaXR5OjF9Li0teGF5bWEtbWFpbiAuLS14YXltYS1lZGl0b3J7cG9zaXRpb246cmVsYXRpdmV9Li0teGF5bWEtbWFpbiAuLS14YXltYS1lZGl0b3I6OmJlZm9yZXtjb250ZW50OlxcXCJcXFwiO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDtyaWdodDowO2JvdHRvbTowO2JhY2tncm91bmQtY29sb3I6dmFyKC0teGF5bWEtZGFyay1jb2xvcik7b3BhY2l0eTowLjAzfS4tLXhheW1hLW1haW4gLi0teGF5bWEtZWRpdG9yIC54YXltYS10ZXh0YXJlYXtib3JkZXI6MDt3aWR0aDpjYWxjKDEwMCUgLSAyMHB4KTtoZWlnaHQ6MTUwcHg7b3V0bGluZTpub25lO3Jlc2l6ZTpub25lO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7cGFkZGluZzoxMHB4O2ZvbnQ6aW5oZXJpdDtwb3NpdGlvbjpyZWxhdGl2ZX0uLS14YXltYS1tYWluIC4tLXhheW1hLWVtYWlse3Bvc2l0aW9uOnJlbGF0aXZlfS4tLXhheW1hLW1haW4gLi0teGF5bWEtZW1haWw6OmJlZm9yZXtjb250ZW50OlxcXCJcXFwiO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDtyaWdodDowO2JvdHRvbTowO2JhY2tncm91bmQtY29sb3I6dmFyKC0teGF5bWEtZGFyay1jb2xvcik7b3BhY2l0eTowLjA1fS4tLXhheW1hLW1haW4gLi0teGF5bWEtZW1haWwgaW5wdXR7Ym9yZGVyOjA7d2lkdGg6Y2FsYygxMDAlIC0gMjBweCk7b3V0bGluZTpub25lO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7cGFkZGluZzoxNXB4IDIwcHg7Zm9udDppbmhlcml0O3Bvc2l0aW9uOnJlbGF0aXZlfS4tLXhheW1hLW1haW4gLi0teGF5bWEtc3VibWl0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7cGFkZGluZzoxMHB4IDIwcHh9Li0teGF5bWEtbWFpbiAuLS14YXltYS1zdWJtaXQgLi0teGF5bWEtc3VibWl0LWJ1dHRvbnttYXJnaW4tbGVmdDphdXRvO2JvcmRlcjowO2hlaWdodDozMnB4O3BhZGRpbmc6MCAxMHB4O2JvcmRlci1yYWRpdXM6MC4zZW07YmFja2dyb3VuZC1jb2xvcjp2YXIoLS14YXltYS1kYXJrLWNvbG9yKTtjb2xvcjp2YXIoLS14YXltYS1saWdodC1jb2xvcik7Y3Vyc29yOnBvaW50ZXJ9Li0teGF5bWEtbWFpbiAuLS14YXltYS1mb290e3BhZGRpbmc6NXB4O2ZvbnQtc2l6ZToxMnB4O3RleHQtYWxpZ246Y2VudGVyfS4tLXhheW1hLW1haW4gLi0teGF5bWEtZm9vdCBhe2NvbG9yOnZhcigtLXhheW1hLWRhcmstY29sb3IpfS4tLXhheW1hLW1haW4gLi0teGF5bWEtc2F2aW5ne3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3otaW5kZXg6MTAwO2JhY2tncm91bmQtY29sb3I6dmFyKC0tYm9yZGVyLWNvbG9yKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Ym9yZGVyLXJhZGl1czppbmhlcml0fS4tLXhheW1hLW1haW4gLi0teGF5bWEtc2F2aW5nIHN2Z3t3aWR0aDozMnB4fS4tLXhheW1hLW1haW4gLi0teGF5bWEtY2xvc2V7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9XFxuXCI7IiwiZXhwb3J0IGRlZmF1bHQgXCIuLS14YXltYS1maW5pc2h7cGFkZGluZzo0MHB4O3RleHQtYWxpZ246Y2VudGVyfS4tLXhheW1hLWZpbmlzaCAuLS14YXltYS1maW5pc2gtaWNvbnt3aWR0aDo2NHB4O2hlaWdodDo2NHB4O21hcmdpbjphdXRvO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uLS14YXltYS1maW5pc2ggLi0teGF5bWEtZmluaXNoLWljb24gc3Zne2ZpbGw6dmFyKC0teGF5bWEteWVsbG93LWNvbG9yKX0uLS14YXltYS1maW5pc2ggLi0teGF5bWEtZmluaXNoLXRleHR7bWFyZ2luOmF1dG87bWFyZ2luLXRvcDoyMHB4O3RleHQtYWxpZ246Y2VudGVyfVxcblwiOyIsIi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IEZpcmViYXNlIGNvbnN0YW50cy4gIFNvbWUgb2YgdGhlc2UgKEBkZWZpbmVzKSBjYW4gYmUgb3ZlcnJpZGRlbiBhdCBjb21waWxlLXRpbWUuXHJcbiAqL1xyXG5jb25zdCBDT05TVEFOVFMgPSB7XHJcbiAgICAvKipcclxuICAgICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgY2xpZW50IE5vZGUuanMgU0RLLlxyXG4gICAgICovXHJcbiAgICBOT0RFX0NMSUVOVDogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgQWRtaW4gTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQURNSU46IGZhbHNlLFxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJlYmFzZSBTREsgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBTREtfVkVSU0lPTjogJyR7SlNDT1JFX1ZFUlNJT059J1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhyb3dzIGFuIGVycm9yIGlmIHRoZSBwcm92aWRlZCBhc3NlcnRpb24gaXMgZmFsc3lcclxuICovXHJcbmNvbnN0IGFzc2VydCA9IGZ1bmN0aW9uIChhc3NlcnRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgYXNzZXJ0aW9uRXJyb3IobWVzc2FnZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIEVycm9yIG9iamVjdCBzdWl0YWJsZSBmb3IgdGhyb3dpbmcuXHJcbiAqL1xyXG5jb25zdCBhc3NlcnRpb25FcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XHJcbiAgICByZXR1cm4gbmV3IEVycm9yKCdGaXJlYmFzZSBEYXRhYmFzZSAoJyArXHJcbiAgICAgICAgQ09OU1RBTlRTLlNES19WRVJTSU9OICtcclxuICAgICAgICAnKSBJTlRFUk5BTCBBU1NFUlQgRkFJTEVEOiAnICtcclxuICAgICAgICBtZXNzYWdlKTtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3Qgc3RyaW5nVG9CeXRlQXJyYXkkMSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIC8vIFRPRE8odXNlcik6IFVzZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zIGlmL3doZW4gYXZhaWxhYmxlXHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGxldCBwID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChjICYgMHhmYzAwKSA9PT0gMHhkODAwICYmXHJcbiAgICAgICAgICAgIGkgKyAxIDwgc3RyLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAoc3RyLmNoYXJDb2RlQXQoaSArIDEpICYgMHhmYzAwKSA9PT0gMHhkYzAwKSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKChjICYgMHgwM2ZmKSA8PCAxMCkgKyAoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4MDNmZik7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcclxuICogY2hhcmFjdGVycyB0byB3aGljaCB0aGUgbnVtYmVycyBjb3JyZXNwb25kLlxyXG4gKiBAcGFyYW0gYnl0ZXMgQXJyYXkgb2YgbnVtYmVycyByZXByZXNlbnRpbmcgY2hhcmFjdGVycy5cclxuICogQHJldHVybiBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxyXG4gKi9cclxuY29uc3QgYnl0ZUFycmF5VG9TdHJpbmcgPSBmdW5jdGlvbiAoYnl0ZXMpIHtcclxuICAgIC8vIFRPRE8odXNlcik6IFVzZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zIGlmL3doZW4gYXZhaWxhYmxlXHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGxldCBwb3MgPSAwLCBjID0gMDtcclxuICAgIHdoaWxlIChwb3MgPCBieXRlcy5sZW5ndGgpIHtcclxuICAgICAgICBjb25zdCBjMSA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICBpZiAoYzEgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAxOTEgJiYgYzEgPCAyMjQpIHtcclxuICAgICAgICAgICAgY29uc3QgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMxICYgMzEpIDw8IDYpIHwgKGMyICYgNjMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAyMzkgJiYgYzEgPCAzNjUpIHtcclxuICAgICAgICAgICAgLy8gU3Vycm9nYXRlIFBhaXJcclxuICAgICAgICAgICAgY29uc3QgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBjb25zdCBjNCA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgY29uc3QgdSA9ICgoKGMxICYgNykgPDwgMTgpIHwgKChjMiAmIDYzKSA8PCAxMikgfCAoKGMzICYgNjMpIDw8IDYpIHwgKGM0ICYgNjMpKSAtXHJcbiAgICAgICAgICAgICAgICAweDEwMDAwO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkODAwICsgKHUgPj4gMTApKTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZGMwMCArICh1ICYgMTAyMykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDE1KSA8PCAxMikgfCAoKGMyICYgNjMpIDw8IDYpIHwgKGMzICYgNjMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0LmpvaW4oJycpO1xyXG59O1xyXG4vLyBXZSBkZWZpbmUgaXQgYXMgYW4gb2JqZWN0IGxpdGVyYWwgaW5zdGVhZCBvZiBhIGNsYXNzIGJlY2F1c2UgYSBjbGFzcyBjb21waWxlZCBkb3duIHRvIGVzNSBjYW4ndFxyXG4vLyBiZSB0cmVlc2hha2VkLiBodHRwczovL2dpdGh1Yi5jb20vcm9sbHVwL3JvbGx1cC9pc3N1ZXMvMTY5MVxyXG4vLyBTdGF0aWMgbG9va3VwIG1hcHMsIGxhemlseSBwb3B1bGF0ZWQgYnkgaW5pdF8oKVxyXG5jb25zdCBiYXNlNjQgPSB7XHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgYnl0ZXMgdG8gY2hhcmFjdGVycy5cclxuICAgICAqL1xyXG4gICAgYnl0ZVRvQ2hhck1hcF86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgY2hhcmFjdGVycyB0byBieXRlcy5cclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcF86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgYnl0ZXMgdG8gd2Vic2FmZSBjaGFyYWN0ZXJzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgYnl0ZVRvQ2hhck1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIHdlYnNhZmUgY2hhcmFjdGVycyB0byBieXRlcy5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGNoYXJUb0J5dGVNYXBXZWJTYWZlXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQsIHNoYXJlZCBiZXR3ZWVuXHJcbiAgICAgKiBFTkNPREVEX1ZBTFMgYW5kIEVOQ09ERURfVkFMU19XRUJTQUZFXHJcbiAgICAgKi9cclxuICAgIEVOQ09ERURfVkFMU19CQVNFOiAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICsgJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JyArICcwMTIzNDU2Nzg5JyxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQuIFZhbHVlIDY0ICg9KSBpcyBzcGVjaWFsOyBpdCBtZWFucyBcIm5vdGhpbmcuXCJcclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMUygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICcrLz0nO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIHdlYnNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKi9cclxuICAgIGdldCBFTkNPREVEX1ZBTFNfV0VCU0FGRSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICctXy4nO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogV2hldGhlciB0aGlzIGJyb3dzZXIgc3VwcG9ydHMgdGhlIGF0b2IgYW5kIGJ0b2EgZnVuY3Rpb25zLiBUaGlzIGV4dGVuc2lvblxyXG4gICAgICogc3RhcnRlZCBhdCBNb3ppbGxhIGJ1dCBpcyBub3cgaW1wbGVtZW50ZWQgYnkgbWFueSBicm93c2Vycy4gV2UgdXNlIHRoZVxyXG4gICAgICogQVNTVU1FXyogdmFyaWFibGVzIHRvIGF2b2lkIHB1bGxpbmcgaW4gdGhlIGZ1bGwgdXNlcmFnZW50IGRldGVjdGlvbiBsaWJyYXJ5XHJcbiAgICAgKiBidXQgc3RpbGwgYWxsb3dpbmcgdGhlIHN0YW5kYXJkIHBlci1icm93c2VyIGNvbXBpbGF0aW9ucy5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIEhBU19OQVRJVkVfU1VQUE9SVDogdHlwZW9mIGF0b2IgPT09ICdmdW5jdGlvbicsXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYW4gYXJyYXkgb2YgYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IEFuIGFycmF5IG9mIGJ5dGVzIChudW1iZXJzIHdpdGhcclxuICAgICAqICAgICB2YWx1ZSBpbiBbMCwgMjU1XSkgdG8gZW5jb2RlLlxyXG4gICAgICogQHBhcmFtIHdlYlNhZmUgQm9vbGVhbiBpbmRpY2F0aW5nIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZUJ5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ2VuY29kZUJ5dGVBcnJheSB0YWtlcyBhbiBhcnJheSBhcyBhIHBhcmFtZXRlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluaXRfKCk7XHJcbiAgICAgICAgY29uc3QgYnl0ZVRvQ2hhck1hcCA9IHdlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuYnl0ZVRvQ2hhck1hcF87XHJcbiAgICAgICAgY29uc3Qgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMSA9IGlucHV0W2ldO1xyXG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTIgPSBpICsgMSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTMgPSBpICsgMiA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTMgPSBoYXZlQnl0ZTMgPyBpbnB1dFtpICsgMl0gOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBvdXRCeXRlMSA9IGJ5dGUxID4+IDI7XHJcbiAgICAgICAgICAgIGNvbnN0IG91dEJ5dGUyID0gKChieXRlMSAmIDB4MDMpIDw8IDQpIHwgKGJ5dGUyID4+IDQpO1xyXG4gICAgICAgICAgICBsZXQgb3V0Qnl0ZTMgPSAoKGJ5dGUyICYgMHgwZikgPDwgMikgfCAoYnl0ZTMgPj4gNik7XHJcbiAgICAgICAgICAgIGxldCBvdXRCeXRlNCA9IGJ5dGUzICYgMHgzZjtcclxuICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTMpIHtcclxuICAgICAgICAgICAgICAgIG91dEJ5dGU0ID0gNjQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhdmVCeXRlMikge1xyXG4gICAgICAgICAgICAgICAgICAgIG91dEJ5dGUzID0gNjQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3V0cHV0LnB1c2goYnl0ZVRvQ2hhck1hcFtvdXRCeXRlMV0sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTJdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUzXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlNF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgQSBzdHJpbmcgdG8gZW5jb2RlLlxyXG4gICAgICogQHBhcmFtIHdlYlNhZmUgSWYgdHJ1ZSwgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlU3RyaW5nKGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICF3ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBidG9hKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQnl0ZUFycmF5KHN0cmluZ1RvQnl0ZUFycmF5JDEoaW5wdXQpLCB3ZWJTYWZlKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nKGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICF3ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdG9iKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJ5dGVBcnJheVRvU3RyaW5nKHRoaXMuZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQsIHdlYlNhZmUpKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogSW4gYmFzZS02NCBkZWNvZGluZywgZ3JvdXBzIG9mIGZvdXIgY2hhcmFjdGVycyBhcmUgY29udmVydGVkIGludG8gdGhyZWVcclxuICAgICAqIGJ5dGVzLiAgSWYgdGhlIGVuY29kZXIgZGlkIG5vdCBhcHBseSBwYWRkaW5nLCB0aGUgaW5wdXQgbGVuZ3RoIG1heSBub3RcclxuICAgICAqIGJlIGEgbXVsdGlwbGUgb2YgNC5cclxuICAgICAqXHJcbiAgICAgKiBJbiB0aGlzIGNhc2UsIHRoZSBsYXN0IGdyb3VwIHdpbGwgaGF2ZSBmZXdlciB0aGFuIDQgY2hhcmFjdGVycywgYW5kXHJcbiAgICAgKiBwYWRkaW5nIHdpbGwgYmUgaW5mZXJyZWQuICBJZiB0aGUgZ3JvdXAgaGFzIG9uZSBvciB0d28gY2hhcmFjdGVycywgaXQgZGVjb2Rlc1xyXG4gICAgICogdG8gb25lIGJ5dGUuICBJZiB0aGUgZ3JvdXAgaGFzIHRocmVlIGNoYXJhY3RlcnMsIGl0IGRlY29kZXMgdG8gdHdvIGJ5dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpbnB1dCBJbnB1dCB0byBkZWNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlIHdlYi1zYWZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiBieXRlcyByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIGRlY29kZVN0cmluZ1RvQnl0ZUFycmF5KGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIGNvbnN0IGNoYXJUb0J5dGVNYXAgPSB3ZWJTYWZlXHJcbiAgICAgICAgICAgID8gdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV9cclxuICAgICAgICAgICAgOiB0aGlzLmNoYXJUb0J5dGVNYXBfO1xyXG4gICAgICAgIGNvbnN0IG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOykge1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMSA9IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkrKyldO1xyXG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTIgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBieXRlMiA9IGhhdmVCeXRlMiA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDA7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTMgPSBoYXZlQnl0ZTMgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBjb25zdCBoYXZlQnl0ZTQgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBieXRlNCA9IGhhdmVCeXRlNCA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIGlmIChieXRlMSA9PSBudWxsIHx8IGJ5dGUyID09IG51bGwgfHwgYnl0ZTMgPT0gbnVsbCB8fCBieXRlNCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG91dEJ5dGUxID0gKGJ5dGUxIDw8IDIpIHwgKGJ5dGUyID4+IDQpO1xyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMSk7XHJcbiAgICAgICAgICAgIGlmIChieXRlMyAhPT0gNjQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG91dEJ5dGUyID0gKChieXRlMiA8PCA0KSAmIDB4ZjApIHwgKGJ5dGUzID4+IDIpO1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJ5dGU0ICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dEJ5dGUzID0gKChieXRlMyA8PCA2KSAmIDB4YzApIHwgYnl0ZTQ7XHJcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBMYXp5IHN0YXRpYyBpbml0aWFsaXphdGlvbiBmdW5jdGlvbi4gQ2FsbGVkIGJlZm9yZVxyXG4gICAgICogYWNjZXNzaW5nIGFueSBvZiB0aGUgc3RhdGljIG1hcCB2YXJpYWJsZXMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBpbml0XygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYnl0ZVRvQ2hhck1hcF8pIHtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgcXVpY2sgbWFwcGluZ3MgYmFjayBhbmQgZm9ydGgsIHNvIHdlIHByZWNvbXB1dGUgdHdvIG1hcHMuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5FTkNPREVEX1ZBTFMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuYnl0ZVRvQ2hhck1hcF9baV1dID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgLy8gQmUgZm9yZ2l2aW5nIHdoZW4gZGVjb2RpbmcgYW5kIGNvcnJlY3RseSBkZWNvZGUgYm90aCBlbmNvZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xyXG4gKi9cclxuY29uc3QgYmFzZTY0RW5jb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgY29uc3QgdXRmOEJ5dGVzID0gc3RyaW5nVG9CeXRlQXJyYXkkMShzdHIpO1xyXG4gICAgcmV0dXJuIGJhc2U2NC5lbmNvZGVCeXRlQXJyYXkodXRmOEJ5dGVzLCB0cnVlKTtcclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZyAod2l0aG91dCBcIi5cIiBwYWRkaW5nIGluIHRoZSBlbmQpLlxyXG4gKiBlLmcuIFVzZWQgaW4gSlNPTiBXZWIgVG9rZW4gKEpXVCkgcGFydHMuXHJcbiAqL1xyXG5jb25zdCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIC8vIFVzZSBiYXNlNjR1cmwgZW5jb2RpbmcgYW5kIHJlbW92ZSBwYWRkaW5nIGluIHRoZSBlbmQgKGRvdCBjaGFyYWN0ZXJzKS5cclxuICAgIHJldHVybiBiYXNlNjRFbmNvZGUoc3RyKS5yZXBsYWNlKC9cXC4vZywgJycpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGRlY29kaW5nXHJcbiAqXHJcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxyXG4gKiBiYXNlNjRVcmwgdmFyaWFudCBlbmNvZGluZy5cclxuICpcclxuICogQHBhcmFtIHN0ciBUbyBiZSBkZWNvZGVkXHJcbiAqIEByZXR1cm4gRGVjb2RlZCByZXN1bHQsIGlmIHBvc3NpYmxlXHJcbiAqL1xyXG5jb25zdCBiYXNlNjREZWNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBiYXNlNjQuZGVjb2RlU3RyaW5nKHN0ciwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Jhc2U2NERlY29kZSBmYWlsZWQ6ICcsIGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEbyBhIGRlZXAtY29weSBvZiBiYXNpYyBKYXZhU2NyaXB0IE9iamVjdHMgb3IgQXJyYXlzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcENvcHkodmFsdWUpIHtcclxuICAgIHJldHVybiBkZWVwRXh0ZW5kKHVuZGVmaW5lZCwgdmFsdWUpO1xyXG59XHJcbi8qKlxyXG4gKiBDb3B5IHByb3BlcnRpZXMgZnJvbSBzb3VyY2UgdG8gdGFyZ2V0IChyZWN1cnNpdmVseSBhbGxvd3MgZXh0ZW5zaW9uXHJcbiAqIG9mIE9iamVjdHMgYW5kIEFycmF5cykuICBTY2FsYXIgdmFsdWVzIGluIHRoZSB0YXJnZXQgYXJlIG92ZXItd3JpdHRlbi5cclxuICogSWYgdGFyZ2V0IGlzIHVuZGVmaW5lZCwgYW4gb2JqZWN0IG9mIHRoZSBhcHByb3ByaWF0ZSB0eXBlIHdpbGwgYmUgY3JlYXRlZFxyXG4gKiAoYW5kIHJldHVybmVkKS5cclxuICpcclxuICogV2UgcmVjdXJzaXZlbHkgY29weSBhbGwgY2hpbGQgcHJvcGVydGllcyBvZiBwbGFpbiBPYmplY3RzIGluIHRoZSBzb3VyY2UtIHNvXHJcbiAqIHRoYXQgbmFtZXNwYWNlLSBsaWtlIGRpY3Rpb25hcmllcyBhcmUgbWVyZ2VkLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgdGhlIHRhcmdldCBjYW4gYmUgYSBmdW5jdGlvbiwgaW4gd2hpY2ggY2FzZSB0aGUgcHJvcGVydGllcyBpblxyXG4gKiB0aGUgc291cmNlIE9iamVjdCBhcmUgY29waWVkIG9udG8gaXQgYXMgc3RhdGljIHByb3BlcnRpZXMgb2YgdGhlIEZ1bmN0aW9uLlxyXG4gKlxyXG4gKiBOb3RlOiB3ZSBkb24ndCBtZXJnZSBfX3Byb3RvX18gdG8gcHJldmVudCBwcm90b3R5cGUgcG9sbHV0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWVwRXh0ZW5kKHRhcmdldCwgc291cmNlKSB7XHJcbiAgICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBPYmplY3QpKSB7XHJcbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIHN3aXRjaCAoc291cmNlLmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgY2FzZSBEYXRlOlxyXG4gICAgICAgICAgICAvLyBUcmVhdCBEYXRlcyBsaWtlIHNjYWxhcnM7IGlmIHRoZSB0YXJnZXQgZGF0ZSBvYmplY3QgaGFkIGFueSBjaGlsZFxyXG4gICAgICAgICAgICAvLyBwcm9wZXJ0aWVzIC0gdGhleSB3aWxsIGJlIGxvc3QhXHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGVWYWx1ZSA9IHNvdXJjZTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVWYWx1ZS5nZXRUaW1lKCkpO1xyXG4gICAgICAgIGNhc2UgT2JqZWN0OlxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQXJyYXk6XHJcbiAgICAgICAgICAgIC8vIEFsd2F5cyBjb3B5IHRoZSBhcnJheSBzb3VyY2UgYW5kIG92ZXJ3cml0ZSB0aGUgdGFyZ2V0LlxyXG4gICAgICAgICAgICB0YXJnZXQgPSBbXTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgLy8gTm90IGEgcGxhaW4gT2JqZWN0IC0gdHJlYXQgaXQgYXMgYSBzY2FsYXIuXHJcbiAgICAgICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKGNvbnN0IHByb3AgaW4gc291cmNlKSB7XHJcbiAgICAgICAgLy8gdXNlIGlzVmFsaWRLZXkgdG8gZ3VhcmQgYWdhaW5zdCBwcm90b3R5cGUgcG9sbHV0aW9uLiBTZWUgaHR0cHM6Ly9zbnlrLmlvL3Z1bG4vU05ZSy1KUy1MT0RBU0gtNDUwMjAyXHJcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgIWlzVmFsaWRLZXkocHJvcCkpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG5mdW5jdGlvbiBpc1ZhbGlkS2V5KGtleSkge1xyXG4gICAgcmV0dXJuIGtleSAhPT0gJ19fcHJvdG9fXyc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgRGVmZXJyZWQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5yZWplY3QgPSAoKSA9PiB7IH07XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlID0gKCkgPT4geyB9O1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgdGhpcy5yZWplY3QgPSByZWplY3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE91ciBBUEkgaW50ZXJuYWxzIGFyZSBub3QgcHJvbWlzZWlmaWVkIGFuZCBjYW5ub3QgYmVjYXVzZSBvdXIgY2FsbGJhY2sgQVBJcyBoYXZlIHN1YnRsZSBleHBlY3RhdGlvbnMgYXJvdW5kXHJcbiAgICAgKiBpbnZva2luZyBwcm9taXNlcyBpbmxpbmUsIHdoaWNoIFByb21pc2VzIGFyZSBmb3JiaWRkZW4gdG8gZG8uIFRoaXMgbWV0aG9kIGFjY2VwdHMgYW4gb3B0aW9uYWwgbm9kZS1zdHlsZSBjYWxsYmFja1xyXG4gICAgICogYW5kIHJldHVybnMgYSBub2RlLXN0eWxlIGNhbGxiYWNrIHdoaWNoIHdpbGwgcmVzb2x2ZSBvciByZWplY3QgdGhlIERlZmVycmVkJ3MgcHJvbWlzZS5cclxuICAgICAqL1xyXG4gICAgd3JhcENhbGxiYWNrKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgcmV0dXJuIChlcnJvciwgdmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEF0dGFjaGluZyBub29wIGhhbmRsZXIganVzdCBpbiBjYXNlIGRldmVsb3BlciB3YXNuJ3QgZXhwZWN0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBwcm9taXNlc1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9taXNlLmNhdGNoKCgpID0+IHsgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyBTb21lIG9mIG91ciBjYWxsYmFja3MgZG9uJ3QgZXhwZWN0IGEgdmFsdWUgYW5kIG91ciBvd24gdGVzdHNcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBwYXJhbWV0ZXIgbGVuZ3RoIGlzIDFcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjay5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVNb2NrVXNlclRva2VuKHRva2VuLCBwcm9qZWN0SWQpIHtcclxuICAgIGlmICh0b2tlbi51aWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBcInVpZFwiIGZpZWxkIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQgYnkgbW9ja1VzZXJUb2tlbi4gUGxlYXNlIHVzZSBcInN1YlwiIGluc3RlYWQgZm9yIEZpcmViYXNlIEF1dGggVXNlciBJRC4nKTtcclxuICAgIH1cclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSBcIm5vbmVcIiBhcyB0aGUgYWxnb3JpdGhtLlxyXG4gICAgY29uc3QgaGVhZGVyID0ge1xyXG4gICAgICAgIGFsZzogJ25vbmUnLFxyXG4gICAgICAgIHR5cGU6ICdKV1QnXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcHJvamVjdCA9IHByb2plY3RJZCB8fCAnZGVtby1wcm9qZWN0JztcclxuICAgIGNvbnN0IGlhdCA9IHRva2VuLmlhdCB8fCAwO1xyXG4gICAgY29uc3Qgc3ViID0gdG9rZW4uc3ViIHx8IHRva2VuLnVzZXJfaWQ7XHJcbiAgICBpZiAoIXN1Yikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIm1vY2tVc2VyVG9rZW4gbXVzdCBjb250YWluICdzdWInIG9yICd1c2VyX2lkJyBmaWVsZCFcIik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBwYXlsb2FkID0gT2JqZWN0LmFzc2lnbih7IFxyXG4gICAgICAgIC8vIFNldCBhbGwgcmVxdWlyZWQgZmllbGRzIHRvIGRlY2VudCBkZWZhdWx0c1xyXG4gICAgICAgIGlzczogYGh0dHBzOi8vc2VjdXJldG9rZW4uZ29vZ2xlLmNvbS8ke3Byb2plY3R9YCwgYXVkOiBwcm9qZWN0LCBpYXQsIGV4cDogaWF0ICsgMzYwMCwgYXV0aF90aW1lOiBpYXQsIHN1YiwgdXNlcl9pZDogc3ViLCBmaXJlYmFzZToge1xyXG4gICAgICAgICAgICBzaWduX2luX3Byb3ZpZGVyOiAnY3VzdG9tJyxcclxuICAgICAgICAgICAgaWRlbnRpdGllczoge31cclxuICAgICAgICB9IH0sIHRva2VuKTtcclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSB0aGUgZW1wdHkgc3RyaW5nIGFzIGEgc2lnbmF0dXJlLlxyXG4gICAgY29uc3Qgc2lnbmF0dXJlID0gJyc7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICAgIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKEpTT04uc3RyaW5naWZ5KGhlYWRlcikpLFxyXG4gICAgICAgIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKSxcclxuICAgICAgICBzaWduYXR1cmVcclxuICAgIF0uam9pbignLicpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIG5hdmlnYXRvci51c2VyQWdlbnQgc3RyaW5nIG9yICcnIGlmIGl0J3Mgbm90IGRlZmluZWQuXHJcbiAqIEByZXR1cm4gdXNlciBhZ2VudCBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIGdldFVBKCkge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgdHlwZW9mIG5hdmlnYXRvclsndXNlckFnZW50J10gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRvclsndXNlckFnZW50J107XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBDb3Jkb3ZhIC8gUGhvbmVHYXAgLyBJb25pYyBmcmFtZXdvcmtzIG9uIGEgbW9iaWxlIGRldmljZS5cclxuICpcclxuICogRGVsaWJlcmF0ZWx5IGRvZXMgbm90IHJlbHkgb24gY2hlY2tpbmcgYGZpbGU6Ly9gIFVSTHMgKGFzIHRoaXMgZmFpbHMgUGhvbmVHYXBcclxuICogaW4gdGhlIFJpcHBsZSBlbXVsYXRvcikgbm9yIENvcmRvdmEgYG9uRGV2aWNlUmVhZHlgLCB3aGljaCB3b3VsZCBub3JtYWxseVxyXG4gKiB3YWl0IGZvciBhIGNhbGxiYWNrLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNNb2JpbGVDb3Jkb3ZhKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIC8vIEB0cy1pZ25vcmUgU2V0dGluZyB1cCBhbiBicm9hZGx5IGFwcGxpY2FibGUgaW5kZXggc2lnbmF0dXJlIGZvciBXaW5kb3dcclxuICAgICAgICAvLyBqdXN0IHRvIGRlYWwgd2l0aCB0aGlzIGNhc2Ugd291bGQgcHJvYmFibHkgYmUgYSBiYWQgaWRlYS5cclxuICAgICAgICAhISh3aW5kb3dbJ2NvcmRvdmEnXSB8fCB3aW5kb3dbJ3Bob25lZ2FwJ10gfHwgd2luZG93WydQaG9uZUdhcCddKSAmJlxyXG4gICAgICAgIC9pb3N8aXBob25lfGlwb2R8aXBhZHxhbmRyb2lkfGJsYWNrYmVycnl8aWVtb2JpbGUvaS50ZXN0KGdldFVBKCkpKTtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IE5vZGUuanMuXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBOb2RlLmpzIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxuLy8gTm9kZSBkZXRlY3Rpb24gbG9naWMgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL2lsaWFrYW4vZGV0ZWN0LW5vZGUvXHJcbmZ1bmN0aW9uIGlzTm9kZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBCcm93c2VyIEVudmlyb25tZW50XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0Jyb3dzZXIoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHNlbGYgPT09ICdvYmplY3QnICYmIHNlbGYuc2VsZiA9PT0gc2VsZjtcclxufVxyXG5mdW5jdGlvbiBpc0Jyb3dzZXJFeHRlbnNpb24oKSB7XHJcbiAgICBjb25zdCBydW50aW1lID0gdHlwZW9mIGNocm9tZSA9PT0gJ29iamVjdCdcclxuICAgICAgICA/IGNocm9tZS5ydW50aW1lXHJcbiAgICAgICAgOiB0eXBlb2YgYnJvd3NlciA9PT0gJ29iamVjdCdcclxuICAgICAgICAgICAgPyBicm93c2VyLnJ1bnRpbWVcclxuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICByZXR1cm4gdHlwZW9mIHJ1bnRpbWUgPT09ICdvYmplY3QnICYmIHJ1bnRpbWUuaWQgIT09IHVuZGVmaW5lZDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cclxuICpcclxuICogQHJldHVybiB0cnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNSZWFjdE5hdGl2ZSgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yWydwcm9kdWN0J10gPT09ICdSZWFjdE5hdGl2ZScpO1xyXG59XHJcbi8qKiBEZXRlY3RzIEVsZWN0cm9uIGFwcHMuICovXHJcbmZ1bmN0aW9uIGlzRWxlY3Ryb24oKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdFbGVjdHJvbi8nKSA+PSAwO1xyXG59XHJcbi8qKiBEZXRlY3RzIEludGVybmV0IEV4cGxvcmVyLiAqL1xyXG5mdW5jdGlvbiBpc0lFKCkge1xyXG4gICAgY29uc3QgdWEgPSBnZXRVQSgpO1xyXG4gICAgcmV0dXJuIHVhLmluZGV4T2YoJ01TSUUgJykgPj0gMCB8fCB1YS5pbmRleE9mKCdUcmlkZW50LycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgVW5pdmVyc2FsIFdpbmRvd3MgUGxhdGZvcm0gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNVV1AoKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdNU0FwcEhvc3QvJykgPj0gMDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IHdoZXRoZXIgdGhlIGN1cnJlbnQgU0RLIGJ1aWxkIGlzIHRoZSBOb2RlIHZlcnNpb24uXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIHRoZSBOb2RlIFNESyBidWlsZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzTm9kZVNkaygpIHtcclxuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XHJcbn1cclxuLyoqIFJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBTYWZhcmkuICovXHJcbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xyXG4gICAgcmV0dXJuICghaXNOb2RlKCkgJiZcclxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxyXG4gICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSk7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0luZGV4ZWREQkF2YWlsYWJsZSgpIHtcclxuICAgIHJldHVybiB0eXBlb2YgaW5kZXhlZERCID09PSAnb2JqZWN0JztcclxufVxyXG4vKipcclxuICogVGhpcyBtZXRob2QgdmFsaWRhdGVzIGJyb3dzZXIvc3cgY29udGV4dCBmb3IgaW5kZXhlZERCIGJ5IG9wZW5pbmcgYSBkdW1teSBpbmRleGVkREIgZGF0YWJhc2UgYW5kIHJlamVjdFxyXG4gKiBpZiBlcnJvcnMgb2NjdXIgZHVyaW5nIHRoZSBkYXRhYmFzZSBvcGVuIG9wZXJhdGlvbi5cclxuICpcclxuICogQHRocm93cyBleGNlcHRpb24gaWYgY3VycmVudCBicm93c2VyL3N3IGNvbnRleHQgY2FuJ3QgcnVuIGlkYi5vcGVuIChleDogU2FmYXJpIGlmcmFtZSwgRmlyZWZveFxyXG4gKiBwcml2YXRlIGJyb3dzaW5nKVxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSgpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgbGV0IHByZUV4aXN0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY29uc3QgREJfQ0hFQ0tfTkFNRSA9ICd2YWxpZGF0ZS1icm93c2VyLWNvbnRleHQtZm9yLWluZGV4ZWRkYi1hbmFseXRpY3MtbW9kdWxlJztcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IHNlbGYuaW5kZXhlZERCLm9wZW4oREJfQ0hFQ0tfTkFNRSk7XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5yZXN1bHQuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBkYXRhYmFzZSBvbmx5IHdoZW4gaXQgZG9lc24ndCBwcmUtZXhpc3RcclxuICAgICAgICAgICAgICAgIGlmICghcHJlRXhpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShEQl9DSEVDS19OQU1FKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcHJlRXhpc3QgPSBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KCgoX2EgPSByZXF1ZXN0LmVycm9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubWVzc2FnZSkgfHwgJycpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICpcclxuICogVGhpcyBtZXRob2QgY2hlY2tzIHdoZXRoZXIgY29va2llIGlzIGVuYWJsZWQgd2l0aGluIGN1cnJlbnQgYnJvd3NlclxyXG4gKiBAcmV0dXJuIHRydWUgaWYgY29va2llIGlzIGVuYWJsZWQgd2l0aGluIGN1cnJlbnQgYnJvd3NlclxyXG4gKi9cclxuZnVuY3Rpb24gYXJlQ29va2llc0VuYWJsZWQoKSB7XHJcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ3VuZGVmaW5lZCcgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqIFBvbHlmaWxsIGZvciBgZ2xvYmFsVGhpc2Agb2JqZWN0LlxyXG4gKiBAcmV0dXJucyB0aGUgYGdsb2JhbFRoaXNgIG9iamVjdCBmb3IgdGhlIGdpdmVuIGVudmlyb25tZW50LlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0R2xvYmFsKCkge1xyXG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBnbG9iYWw7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdC4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBTdGFuZGFyZGl6ZWQgRmlyZWJhc2UgRXJyb3IuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKlxyXG4gKiAgIC8vIFR5cGVzY3JpcHQgc3RyaW5nIGxpdGVyYWxzIGZvciB0eXBlLXNhZmUgY29kZXNcclxuICogICB0eXBlIEVyciA9XHJcbiAqICAgICAndW5rbm93bicgfFxyXG4gKiAgICAgJ29iamVjdC1ub3QtZm91bmQnXHJcbiAqICAgICA7XHJcbiAqXHJcbiAqICAgLy8gQ2xvc3VyZSBlbnVtIGZvciB0eXBlLXNhZmUgZXJyb3IgY29kZXNcclxuICogICAvLyBhdC1lbnVtIHtzdHJpbmd9XHJcbiAqICAgdmFyIEVyciA9IHtcclxuICogICAgIFVOS05PV046ICd1bmtub3duJyxcclxuICogICAgIE9CSkVDVF9OT1RfRk9VTkQ6ICdvYmplY3Qtbm90LWZvdW5kJyxcclxuICogICB9XHJcbiAqXHJcbiAqICAgbGV0IGVycm9yczogTWFwPEVyciwgc3RyaW5nPiA9IHtcclxuICogICAgICdnZW5lcmljLWVycm9yJzogXCJVbmtub3duIGVycm9yXCIsXHJcbiAqICAgICAnZmlsZS1ub3QtZm91bmQnOiBcIkNvdWxkIG5vdCBmaW5kIGZpbGU6IHskZmlsZX1cIixcclxuICogICB9O1xyXG4gKlxyXG4gKiAgIC8vIFR5cGUtc2FmZSBmdW5jdGlvbiAtIG11c3QgcGFzcyBhIHZhbGlkIGVycm9yIGNvZGUgYXMgcGFyYW0uXHJcbiAqICAgbGV0IGVycm9yID0gbmV3IEVycm9yRmFjdG9yeTxFcnI+KCdzZXJ2aWNlJywgJ1NlcnZpY2UnLCBlcnJvcnMpO1xyXG4gKlxyXG4gKiAgIC4uLlxyXG4gKiAgIHRocm93IGVycm9yLmNyZWF0ZShFcnIuR0VORVJJQyk7XHJcbiAqICAgLi4uXHJcbiAqICAgdGhyb3cgZXJyb3IuY3JlYXRlKEVyci5GSUxFX05PVF9GT1VORCwgeydmaWxlJzogZmlsZU5hbWV9KTtcclxuICogICAuLi5cclxuICogICAvLyBTZXJ2aWNlOiBDb3VsZCBub3QgZmlsZSBmaWxlOiBmb28udHh0IChzZXJ2aWNlL2ZpbGUtbm90LWZvdW5kKS5cclxuICpcclxuICogICBjYXRjaCAoZSkge1xyXG4gKiAgICAgYXNzZXJ0KGUubWVzc2FnZSA9PT0gXCJDb3VsZCBub3QgZmluZCBmaWxlOiBmb28udHh0LlwiKTtcclxuICogICAgIGlmIChlLmNvZGUgPT09ICdzZXJ2aWNlL2ZpbGUtbm90LWZvdW5kJykge1xyXG4gKiAgICAgICBjb25zb2xlLmxvZyhcIkNvdWxkIG5vdCByZWFkIGZpbGU6IFwiICsgZVsnZmlsZSddKTtcclxuICogICAgIH1cclxuICogICB9XHJcbiAqL1xyXG5jb25zdCBFUlJPUl9OQU1FID0gJ0ZpcmViYXNlRXJyb3InO1xyXG4vLyBCYXNlZCBvbiBjb2RlIGZyb206XHJcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yI0N1c3RvbV9FcnJvcl9UeXBlc1xyXG5jbGFzcyBGaXJlYmFzZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAvKiogVGhlIGVycm9yIGNvZGUgZm9yIHRoaXMgZXJyb3IuICovXHJcbiAgICBjb2RlLCBtZXNzYWdlLCBcclxuICAgIC8qKiBDdXN0b20gZGF0YSBmb3IgdGhpcyBlcnJvci4gKi9cclxuICAgIGN1c3RvbURhdGEpIHtcclxuICAgICAgICBzdXBlcihtZXNzYWdlKTtcclxuICAgICAgICB0aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IGN1c3RvbURhdGE7XHJcbiAgICAgICAgLyoqIFRoZSBjdXN0b20gbmFtZSBmb3IgYWxsIEZpcmViYXNlRXJyb3JzLiAqL1xyXG4gICAgICAgIHRoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgLy8gRml4IEZvciBFUzVcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQtd2lraS9ibG9iL21hc3Rlci9CcmVha2luZy1DaGFuZ2VzLm1kI2V4dGVuZGluZy1idWlsdC1pbnMtbGlrZS1lcnJvci1hcnJheS1hbmQtbWFwLW1heS1uby1sb25nZXItd29ya1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBGaXJlYmFzZUVycm9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24uXHJcbiAgICAgICAgLy8gT25seSBhdmFpbGFibGUgb24gVjguXHJcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XHJcbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY2xhc3MgRXJyb3JGYWN0b3J5IHtcclxuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgIH1cclxuICAgIGNyZWF0ZShjb2RlLCAuLi5kYXRhKSB7XHJcbiAgICAgICAgY29uc3QgY3VzdG9tRGF0YSA9IGRhdGFbMF0gfHwge307XHJcbiAgICAgICAgY29uc3QgZnVsbENvZGUgPSBgJHt0aGlzLnNlcnZpY2V9LyR7Y29kZX1gO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHRlbXBsYXRlID8gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlLCBjdXN0b21EYXRhKSA6ICdFcnJvcic7XHJcbiAgICAgICAgLy8gU2VydmljZSBOYW1lOiBFcnJvciBtZXNzYWdlIChzZXJ2aWNlL2NvZGUpLlxyXG4gICAgICAgIGNvbnN0IGZ1bGxNZXNzYWdlID0gYCR7dGhpcy5zZXJ2aWNlTmFtZX06ICR7bWVzc2FnZX0gKCR7ZnVsbENvZGV9KS5gO1xyXG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEZpcmViYXNlRXJyb3IoZnVsbENvZGUsIGZ1bGxNZXNzYWdlLCBjdXN0b21EYXRhKTtcclxuICAgICAgICByZXR1cm4gZXJyb3I7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlLCBkYXRhKSB7XHJcbiAgICByZXR1cm4gdGVtcGxhdGUucmVwbGFjZShQQVRURVJOLCAoXywga2V5KSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBkYXRhW2tleV07XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgPyBTdHJpbmcodmFsdWUpIDogYDwke2tleX0/PmA7XHJcbiAgICB9KTtcclxufVxyXG5jb25zdCBQQVRURVJOID0gL1xce1xcJChbXn1dKyl9L2c7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSBzdHJpbmcgY29udGFpbmluZyBKU09OLlxyXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cclxuICovXHJcbmZ1bmN0aW9uIGpzb25FdmFsKHN0cikge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIEpTT04gY29udGVudHMgb2YgdGhlIG9iamVjdC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxuY29uc3QgZGVjb2RlID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBsZXQgaGVhZGVyID0ge30sIGNsYWltcyA9IHt9LCBkYXRhID0ge30sIHNpZ25hdHVyZSA9ICcnO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgaGVhZGVyID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzBdKSB8fCAnJyk7XHJcbiAgICAgICAgY2xhaW1zID0ganNvbkV2YWwoYmFzZTY0RGVjb2RlKHBhcnRzWzFdKSB8fCAnJyk7XHJcbiAgICAgICAgc2lnbmF0dXJlID0gcGFydHNbMl07XHJcbiAgICAgICAgZGF0YSA9IGNsYWltc1snZCddIHx8IHt9O1xyXG4gICAgICAgIGRlbGV0ZSBjbGFpbXNbJ2QnXTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7IH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaGVhZGVyLFxyXG4gICAgICAgIGNsYWltcyxcclxuICAgICAgICBkYXRhLFxyXG4gICAgICAgIHNpZ25hdHVyZVxyXG4gICAgfTtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgdGltZS1iYXNlZCBjbGFpbXMuIFdpbGwgcmV0dXJuIHRydWUgaWYgdGhlXHJcbiAqIHRva2VuIGlzIHdpdGhpbiB0aGUgdGltZSB3aW5kb3cgYXV0aG9yaXplZCBieSB0aGUgJ25iZicgKG5vdC1iZWZvcmUpIGFuZCAnaWF0JyAoaXNzdWVkLWF0KSBjbGFpbXMuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICovXHJcbmNvbnN0IGlzVmFsaWRUaW1lc3RhbXAgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIGNvbnN0IGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xyXG4gICAgbGV0IHZhbGlkU2luY2UgPSAwLCB2YWxpZFVudGlsID0gMDtcclxuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ25iZicpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ25iZiddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ2lhdCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdleHAnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFVudGlsID0gY2xhaW1zWydleHAnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRva2VuIHdpbGwgZXhwaXJlIGFmdGVyIDI0aCBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSB2YWxpZFNpbmNlICsgODY0MDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICghIW5vdyAmJlxyXG4gICAgICAgICEhdmFsaWRTaW5jZSAmJlxyXG4gICAgICAgICEhdmFsaWRVbnRpbCAmJlxyXG4gICAgICAgIG5vdyA+PSB2YWxpZFNpbmNlICYmXHJcbiAgICAgICAgbm93IDw9IHZhbGlkVW50aWwpO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCByZXR1cm5zIGl0cyBpc3N1ZWQgYXQgdGltZSBpZiB2YWxpZCwgbnVsbCBvdGhlcndpc2UuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gbnVsbCBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICovXHJcbmNvbnN0IGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgY29uc3QgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XHJcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSkge1xyXG4gICAgICAgIHJldHVybiBjbGFpbXNbJ2lhdCddO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIGZvcm1hdC4gRXhwZWN0cyBhIHZhbGlkIGlzc3VlZC1hdCB0aW1lLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkRm9ybWF0ID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBjb25zdCBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XHJcbiAgICByZXR1cm4gISFjbGFpbXMgJiYgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKTtcclxufTtcclxuLyoqXHJcbiAqIEF0dGVtcHRzIHRvIHBlZXIgaW50byBhbiBhdXRoIHRva2VuIGFuZCBkZXRlcm1pbmUgaWYgaXQncyBhbiBhZG1pbiBhdXRoIHRva2VuIGJ5IGxvb2tpbmcgYXQgdGhlIGNsYWltcyBwb3J0aW9uLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc0FkbWluID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBjb25zdCBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIHJldHVybiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXNbJ2FkbWluJ10gPT09IHRydWU7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGNvbnRhaW5zKG9iaiwga2V5KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcclxufVxyXG5mdW5jdGlvbiBzYWZlR2V0KG9iaiwga2V5KSB7XHJcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNFbXB0eShvYmopIHtcclxuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBtYXAob2JqLCBmbiwgY29udGV4dE9iaikge1xyXG4gICAgY29uc3QgcmVzID0ge307XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICByZXNba2V5XSA9IGZuLmNhbGwoY29udGV4dE9iaiwgb2JqW2tleV0sIGtleSwgb2JqKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcbi8qKlxyXG4gKiBEZWVwIGVxdWFsIHR3byBvYmplY3RzLiBTdXBwb3J0IEFycmF5cyBhbmQgT2JqZWN0cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBFcXVhbChhLCBiKSB7XHJcbiAgICBpZiAoYSA9PT0gYikge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIGNvbnN0IGJLZXlzID0gT2JqZWN0LmtleXMoYik7XHJcbiAgICBmb3IgKGNvbnN0IGsgb2YgYUtleXMpIHtcclxuICAgICAgICBpZiAoIWJLZXlzLmluY2x1ZGVzKGspKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYVByb3AgPSBhW2tdO1xyXG4gICAgICAgIGNvbnN0IGJQcm9wID0gYltrXTtcclxuICAgICAgICBpZiAoaXNPYmplY3QoYVByb3ApICYmIGlzT2JqZWN0KGJQcm9wKSkge1xyXG4gICAgICAgICAgICBpZiAoIWRlZXBFcXVhbChhUHJvcCwgYlByb3ApKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYVByb3AgIT09IGJQcm9wKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmb3IgKGNvbnN0IGsgb2YgYktleXMpIHtcclxuICAgICAgICBpZiAoIWFLZXlzLmluY2x1ZGVzKGspKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBpc09iamVjdCh0aGluZykge1xyXG4gICAgcmV0dXJuIHRoaW5nICE9PSBudWxsICYmIHR5cGVvZiB0aGluZyA9PT0gJ29iamVjdCc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJldHVybnMgYSBxdWVyeXN0cmluZy1mb3JtYXR0ZWQgc3RyaW5nIChlLmcuICZhcmc9dmFsJmFyZzI9dmFsMikgZnJvbSBhXHJcbiAqIHBhcmFtcyBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXHJcbiAqIE5vdGU6IFlvdSBtdXN0IHByZXBlbmQgaXQgd2l0aCA/IHdoZW4gYWRkaW5nIGl0IHRvIGEgVVJMLlxyXG4gKi9cclxuZnVuY3Rpb24gcXVlcnlzdHJpbmcocXVlcnlzdHJpbmdQYXJhbXMpIHtcclxuICAgIGNvbnN0IHBhcmFtcyA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocXVlcnlzdHJpbmdQYXJhbXMpKSB7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goYXJyYXlWYWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xyXG59XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxyXG4gKiAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICovXHJcbmZ1bmN0aW9uIHF1ZXJ5c3RyaW5nRGVjb2RlKHF1ZXJ5c3RyaW5nKSB7XHJcbiAgICBjb25zdCBvYmogPSB7fTtcclxuICAgIGNvbnN0IHRva2VucyA9IHF1ZXJ5c3RyaW5nLnJlcGxhY2UoL15cXD8vLCAnJykuc3BsaXQoJyYnKTtcclxuICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcclxuICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gdG9rZW4uc3BsaXQoJz0nKTtcclxuICAgICAgICAgICAgb2JqW2RlY29kZVVSSUNvbXBvbmVudChrZXkpXSA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gb2JqO1xyXG59XHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBxdWVyeSBzdHJpbmcgcGFydCBvZiBhIFVSTCwgaW5jbHVkaW5nIHRoZSBsZWFkaW5nIHF1ZXN0aW9uIG1hcmsgKGlmIHByZXNlbnQpLlxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkge1xyXG4gICAgY29uc3QgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICBpZiAoIXF1ZXJ5U3RhcnQpIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBmcmFnbWVudFN0YXJ0ID0gdXJsLmluZGV4T2YoJyMnLCBxdWVyeVN0YXJ0KTtcclxuICAgIHJldHVybiB1cmwuc3Vic3RyaW5nKHF1ZXJ5U3RhcnQsIGZyYWdtZW50U3RhcnQgPiAwID8gZnJhZ21lbnRTdGFydCA6IHVuZGVmaW5lZCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoLlxyXG4gKiBWYXJpYWJsZSBuYW1lcyBmb2xsb3cgdGhlIG5vdGF0aW9uIGluIEZJUFMgUFVCIDE4MC0zOlxyXG4gKiBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZmlwcy9maXBzMTgwLTMvZmlwczE4MC0zX2ZpbmFsLnBkZi5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqICAgdmFyIHNoYTEgPSBuZXcgc2hhMSgpO1xyXG4gKiAgIHNoYTEudXBkYXRlKGJ5dGVzKTtcclxuICogICB2YXIgaGFzaCA9IHNoYTEuZGlnZXN0KCk7XHJcbiAqXHJcbiAqIFBlcmZvcm1hbmNlOlxyXG4gKiAgIENocm9tZSAyMzogICB+NDAwIE1iaXQvc1xyXG4gKiAgIEZpcmVmb3ggMTY6ICB+MjUwIE1iaXQvc1xyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cclxuICpcclxuICogVGhlIHByb3BlcnRpZXMgZGVjbGFyZWQgaGVyZSBhcmUgZGlzY3Vzc2VkIGluIHRoZSBhYm92ZSBhbGdvcml0aG0gZG9jdW1lbnQuXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZmluYWxcclxuICogQHN0cnVjdFxyXG4gKi9cclxuY2xhc3MgU2hhMSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIHRoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBjb21wcmVzcyBoZWxwZXIgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0gYnVmIEJsb2NrIHRvIGNvbXByZXNzLlxyXG4gICAgICogQHBhcmFtIG9mZnNldCBPZmZzZXQgb2YgdGhlIGJsb2NrIGluIHRoZSBidWZmZXIuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBjb21wcmVzc18oYnVmLCBvZmZzZXQpIHtcclxuICAgICAgICBpZiAoIW9mZnNldCkge1xyXG4gICAgICAgICAgICBvZmZzZXQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBXID0gdGhpcy5XXztcclxuICAgICAgICAvLyBnZXQgMTYgYmlnIGVuZGlhbiB3b3Jkc1xyXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8odXNlcik6IFtidWcgODE0MDEyMl0gUmVjZW50IHZlcnNpb25zIG9mIFNhZmFyaSBmb3IgTWFjIE9TIGFuZCBpT1NcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyBkdXJpbmcgSklUIGNvbXBpbGF0aW9uLiAgV2UgaGF2ZSBjb2RlIHRoYXQgZGVwZW5kcyBoZWF2aWx5IG9uIFNIQS0xIGZvclxyXG4gICAgICAgICAgICAgICAgLy8gY29ycmVjdG5lc3MgYW5kIHdoaWNoIGlzIGFmZmVjdGVkIGJ5IHRoaXMgYnVnLCBzbyBJJ3ZlIHJlbW92ZWQgYWxsIHVzZXNcclxuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgY2hhbmdlIG9uY2UgdGhlIFNhZmFyaSBidWdcclxuICAgICAgICAgICAgICAgIC8vIChodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA5MDM2KSBoYXMgYmVlbiBmaXhlZCBhbmRcclxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQpIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAxKSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob2Zmc2V0ICsgMikgPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWYuY2hhckNvZGVBdChvZmZzZXQgKyAzKTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0XSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29mZnNldCArIDFdIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0ICsgMl0gPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZbb2Zmc2V0ICsgM107XHJcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBleHBhbmQgdG8gODAgd29yZHNcclxuICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIGxldCBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgbGV0IGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIGxldCBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgbGV0IGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSAoKChhIDw8IDUpIHwgKGEgPj4+IDI3KSkgKyBmICsgZSArIGsgKyBXW2ldKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGUgPSBkO1xyXG4gICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgYyA9ICgoYiA8PCAzMCkgfCAoYiA+Pj4gMikpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgYiA9IGE7XHJcbiAgICAgICAgICAgIGEgPSB0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9ICh0aGlzLmNoYWluX1swXSArIGEpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9ICh0aGlzLmNoYWluX1syXSArIGMpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9ICh0aGlzLmNoYWluX1szXSArIGQpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcclxuICAgIH1cclxuICAgIHVwZGF0ZShieXRlcywgbGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhqb2hubGVueik6IHRpZ2h0ZW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSBhbmQgcmVtb3ZlIHRoaXMgY2hlY2tcclxuICAgICAgICBpZiAoYnl0ZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZW5ndGggPSBieXRlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGxlbmd0aE1pbnVzQmxvY2sgPSBsZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgY29uc3QgYnVmID0gdGhpcy5idWZfO1xyXG4gICAgICAgIGxldCBpbmJ1ZiA9IHRoaXMuaW5idWZfO1xyXG4gICAgICAgIC8vIFRoZSBvdXRlciB3aGlsZSBsb29wIHNob3VsZCBleGVjdXRlIGF0IG1vc3QgdHdpY2UuXHJcbiAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBoYXZlIG5vIGRhdGEgaW4gdGhlIGJsb2NrIHRvIHRvcCB1cCwgd2UgY2FuIGRpcmVjdGx5IHByb2Nlc3MgdGhlXHJcbiAgICAgICAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXHJcbiAgICAgICAgICAgIC8vIHNwZWVkdXAgb24gQ2hyb21lIDIzIGFuZCB+MTUlIHNwZWVkdXAgb24gRmlyZWZveCAxNiwgYnV0IHJlcXVpcmVzIHRoYXRcclxuICAgICAgICAgICAgLy8gdGhlIGRhdGEgaXMgcHJvdmlkZWQgaW4gbGFyZ2UgY2h1bmtzIChvciBpbiBtdWx0aXBsZXMgb2YgNjQgYnl0ZXMpLlxyXG4gICAgICAgICAgICBpZiAoaW5idWYgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDw9IGxlbmd0aE1pbnVzQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhieXRlcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXMuY2hhckNvZGVBdChuKTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlc1tuXTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSBpbmJ1ZjtcclxuICAgICAgICB0aGlzLnRvdGFsXyArPSBsZW5ndGg7XHJcbiAgICB9XHJcbiAgICAvKiogQG92ZXJyaWRlICovXHJcbiAgICBkaWdlc3QoKSB7XHJcbiAgICAgICAgY29uc3QgZGlnZXN0ID0gW107XHJcbiAgICAgICAgbGV0IHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEhlbHBlciB0byBtYWtlIGEgU3Vic2NyaWJlIGZ1bmN0aW9uIChqdXN0IGxpa2UgUHJvbWlzZSBoZWxwcyBtYWtlIGFcclxuICogVGhlbmFibGUpLlxyXG4gKlxyXG4gKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcclxuICogICAgIGFzIGEgcHJveHkuXHJcbiAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVN1YnNjcmliZShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgY29uc3QgcHJveHkgPSBuZXcgT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycyk7XHJcbiAgICByZXR1cm4gcHJveHkuc3Vic2NyaWJlLmJpbmQocHJveHkpO1xyXG59XHJcbi8qKlxyXG4gKiBJbXBsZW1lbnQgZmFuLW91dCBmb3IgYW55IG51bWJlciBvZiBPYnNlcnZlcnMgYXR0YWNoZWQgdmlhIGEgc3Vic2NyaWJlXHJcbiAqIGZ1bmN0aW9uLlxyXG4gKi9cclxuY2xhc3MgT2JzZXJ2ZXJQcm94eSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxyXG4gICAgICogICAgIGFzIGEgcHJveHkuXHJcbiAgICAgKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXHJcbiAgICAgICAgdGhpcy50YXNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xyXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxyXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cclxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxyXG4gICAgICAgIHRoaXMudGFza1xyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4ZWN1dG9yKHRoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvcihlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG5leHQodmFsdWUpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlcnJvcihlcnJvcikge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZShlcnJvcik7XHJcbiAgICB9XHJcbiAgICBjb21wbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN1YnNjcmliZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFkZCBhbiBPYnNlcnZlciB0byB0aGUgZmFuLW91dCBsaXN0LlxyXG4gICAgICpcclxuICAgICAqIC0gV2UgcmVxdWlyZSB0aGF0IG5vIGV2ZW50IGlzIHNlbnQgdG8gYSBzdWJzY3JpYmVyIHN5Y2hyb25vdXNseSB0byB0aGVpclxyXG4gICAgICogICBjYWxsIHRvIHN1YnNjcmliZSgpLlxyXG4gICAgICovXHJcbiAgICBzdWJzY3JpYmUobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkge1xyXG4gICAgICAgIGxldCBvYnNlcnZlcjtcclxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlbWJsZSBhbiBPYnNlcnZlciBvYmplY3Qgd2hlbiBwYXNzZWQgYXMgY2FsbGJhY2sgZnVuY3Rpb25zLlxyXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgW1xyXG4gICAgICAgICAgICAnbmV4dCcsXHJcbiAgICAgICAgICAgICdlcnJvcicsXHJcbiAgICAgICAgICAgICdjb21wbGV0ZSdcclxuICAgICAgICBdKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcclxuICAgICAgICAgICAgICAgIGVycm9yLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLm5leHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0ID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHVuc3ViID0gdGhpcy51bnN1YnNjcmliZU9uZS5iaW5kKHRoaXMsIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxyXG4gICAgICAgIC8vIGp1c3QgcmVzcG9uZCB0byB0aGUgT2JzZXJ2ZXIgd2l0aCB0aGUgZmluYWwgZXJyb3Igb3IgY29tcGxldGVcclxuICAgICAgICAvLyBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgICAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbmFsRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IodGhpcy5maW5hbEVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcclxuICAgICAgICByZXR1cm4gdW5zdWI7XHJcbiAgICB9XHJcbiAgICAvLyBVbnN1YnNjcmliZSBpcyBzeW5jaHJvbm91cyAtIHdlIGd1YXJhbnRlZSB0aGF0IG5vIGV2ZW50cyBhcmUgc2VudCB0b1xyXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cclxuICAgIHVuc3Vic2NyaWJlT25lKGkpIHtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyQ291bnQgPT09IDAgJiYgdGhpcy5vbk5vT2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZvckVhY2hPYnNlcnZlcihmbikge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAvLyBBbHJlYWR5IGNsb3NlZCBieSBwcmV2aW91cyBldmVudC4uLi5qdXN0IGVhdCB0aGUgYWRkaXRpb25hbCB2YWx1ZXMuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2luY2Ugc2VuZE9uZSBjYWxscyBhc3luY2hyb25vdXNseSAtIHRoZXJlIGlzIG5vIGNoYW5jZSB0aGF0XHJcbiAgICAgICAgLy8gdGhpcy5vYnNlcnZlcnMgd2lsbCBiZWNvbWUgdW5kZWZpbmVkLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kT25lKGksIGZuKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBDYWxsIHRoZSBPYnNlcnZlciB2aWEgb25lIG9mIGl0J3MgY2FsbGJhY2sgZnVuY3Rpb24uIFdlIGFyZSBjYXJlZnVsIHRvXHJcbiAgICAvLyBjb25maXJtIHRoYXQgdGhlIG9ic2VydmUgaGFzIG5vdCBiZWVuIHVuc3Vic2NyaWJlZCBzaW5jZSB0aGlzIGFzeW5jaHJvbm91c1xyXG4gICAgLy8gZnVuY3Rpb24gaGFkIGJlZW4gcXVldWVkLlxyXG4gICAgc2VuZE9uZShpLCBmbikge1xyXG4gICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgIHRoaXMudGFzay50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMub2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQgJiYgdGhpcy5vYnNlcnZlcnNbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbih0aGlzLm9ic2VydmVyc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBleGNlcHRpb25zIHJhaXNlZCBpbiBPYnNlcnZlcnMgb3IgbWlzc2luZyBtZXRob2RzIG9mIGFuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT2JzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHRvIGNvbnNvbGUuIGIvMzE0MDQ4MDZcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNsb3NlKGVycikge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAoZXJyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5maW5hbEVycm9yID0gZXJyO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQcm94eSBpcyBubyBsb25nZXIgbmVlZGVkIC0gZ2FyYmFnZSBjb2xsZWN0IHJlZmVyZW5jZXNcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8qKiBUdXJuIHN5bmNocm9ub3VzIGZ1bmN0aW9uIGludG8gb25lIGNhbGxlZCBhc3luY2hyb25vdXNseS4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcclxuZnVuY3Rpb24gYXN5bmMoZm4sIG9uRXJyb3IpIHtcclxuICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSh0cnVlKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIG1ldGhvZHMpIHtcclxuICAgICAgICBpZiAobWV0aG9kIGluIG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIG5vb3AoKSB7XHJcbiAgICAvLyBkbyBub3RoaW5nXHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENoZWNrIHRvIG1ha2Ugc3VyZSB0aGUgYXBwcm9wcmlhdGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgcHJvdmlkZWQgZm9yIGEgcHVibGljIGZ1bmN0aW9uLlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgaXQgZmFpbHMuXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIG1pbkNvdW50IFRoZSBtaW5pbXVtIG51bWJlciBvZiBhcmd1bWVudHMgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSBtYXhDb3VudCBUaGUgbWF4aW11bSBudW1iZXIgb2YgYXJndW1lbnQgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSBhcmdDb3VudCBUaGUgYWN0dWFsIG51bWJlciBvZiBhcmd1bWVudHMgcHJvdmlkZWQuXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZUFyZ0NvdW50ID0gZnVuY3Rpb24gKGZuTmFtZSwgbWluQ291bnQsIG1heENvdW50LCBhcmdDb3VudCkge1xyXG4gICAgbGV0IGFyZ0Vycm9yO1xyXG4gICAgaWYgKGFyZ0NvdW50IDwgbWluQ291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9ICdhdCBsZWFzdCAnICsgbWluQ291bnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChhcmdDb3VudCA+IG1heENvdW50KSB7XHJcbiAgICAgICAgYXJnRXJyb3IgPSBtYXhDb3VudCA9PT0gMCA/ICdub25lJyA6ICdubyBtb3JlIHRoYW4gJyArIG1heENvdW50O1xyXG4gICAgfVxyXG4gICAgaWYgKGFyZ0Vycm9yKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3IgPSBmbk5hbWUgK1xyXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBhcmdDb3VudCArXHJcbiAgICAgICAgICAgIChhcmdDb3VudCA9PT0gMSA/ICcgYXJndW1lbnQuJyA6ICcgYXJndW1lbnRzLicpICtcclxuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xyXG4gICAgICAgICAgICBhcmdFcnJvciArXHJcbiAgICAgICAgICAgICcuJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHRvIHByZWZpeCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IGZhaWxlZCBhcmd1bWVudCB2YWxpZGF0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIGFyZ05hbWUgVGhlIG5hbWUgb2YgdGhlIGFyZ3VtZW50XHJcbiAqIEByZXR1cm4gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZSwgYXJnTmFtZSkge1xyXG4gICAgcmV0dXJuIGAke2ZuTmFtZX0gZmFpbGVkOiAke2FyZ05hbWV9IGFyZ3VtZW50IGA7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSBmbk5hbWVcclxuICogQHBhcmFtIGFyZ3VtZW50TnVtYmVyXHJcbiAqIEBwYXJhbSBuYW1lc3BhY2VcclxuICogQHBhcmFtIG9wdGlvbmFsXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVzcGFjZShmbk5hbWUsIG5hbWVzcGFjZSwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgJ25hbWVzcGFjZScpICsgJ211c3QgYmUgYSB2YWxpZCBmaXJlYmFzZSBuYW1lc3BhY2UuJyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIGFyZ3VtZW50TmFtZSwgXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmNhbGxiYWNrLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE5hbWUsIGNvbnRleHQsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcclxuLy8gYXV0b21hdGljYWxseSByZXBsYWNlZCAnXFxyXFxuJyB3aXRoICdcXG4nLCBhbmQgdGhleSBkaWRuJ3QgaGFuZGxlIHN1cnJvZ2F0ZSBwYWlycyxcclxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxyXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cclxuLy8gZnJvbUNoYXJDb2RlIHJldHVybnMgdGhlIFVURi0xNiBlbmNvZGluZyBvZiBhIGNoYXJhY3RlciAtIHNvIHNvbWUgVW5pY29kZSBjaGFyYWN0ZXJzXHJcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YXNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3RcclxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXHJcbi8vIHBhaXIpLlxyXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtBcnJheX1cclxuICovXHJcbmNvbnN0IHN0cmluZ1RvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBsZXQgcCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgLy8gSXMgdGhpcyB0aGUgbGVhZCBzdXJyb2dhdGUgaW4gYSBzdXJyb2dhdGUgcGFpcj9cclxuICAgICAgICBpZiAoYyA+PSAweGQ4MDAgJiYgYyA8PSAweGRiZmYpIHtcclxuICAgICAgICAgICAgY29uc3QgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdHIubGVuZ3RoLCAnU3Vycm9nYXRlIHBhaXIgbWlzc2luZyB0cmFpbCBzdXJyb2dhdGUuJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvdyA9IHN0ci5jaGFyQ29kZUF0KGkpIC0gMHhkYzAwOyAvLyB0aGUgbG93IDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKGhpZ2ggPDwgMTApICsgbG93O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCA2NTUzNikge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59O1xyXG4vKipcclxuICogQ2FsY3VsYXRlIGxlbmd0aCB3aXRob3V0IGFjdHVhbGx5IGNvbnZlcnRpbmc7IHVzZWZ1bCBmb3IgZG9pbmcgY2hlYXBlciB2YWxpZGF0aW9uLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4ge251bWJlcn1cclxuICovXHJcbmNvbnN0IHN0cmluZ0xlbmd0aCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIGxldCBwID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIHArKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgcCArPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxyXG4gICAgICAgICAgICBwICs9IDQ7XHJcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwICs9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHA7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgYW1vdW50IG9mIG1pbGxpc2Vjb25kcyB0byBleHBvbmVudGlhbGx5IGluY3JlYXNlLlxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9JTlRFUlZBTF9NSUxMSVMgPSAxMDAwO1xyXG4vKipcclxuICogVGhlIGZhY3RvciB0byBiYWNrb2ZmIGJ5LlxyXG4gKiBTaG91bGQgYmUgYSBudW1iZXIgZ3JlYXRlciB0aGFuIDEuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0JBQ0tPRkZfRkFDVE9SID0gMjtcclxuLyoqXHJcbiAqIFRoZSBtYXhpbXVtIG1pbGxpc2Vjb25kcyB0byBpbmNyZWFzZSB0by5cclxuICpcclxuICogPHA+VmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gKi9cclxuY29uc3QgTUFYX1ZBTFVFX01JTExJUyA9IDQgKiA2MCAqIDYwICogMTAwMDsgLy8gRm91ciBob3VycywgbGlrZSBpT1MgYW5kIEFuZHJvaWQuXHJcbi8qKlxyXG4gKiBUaGUgcGVyY2VudGFnZSBvZiBiYWNrb2ZmIHRpbWUgdG8gcmFuZG9taXplIGJ5LlxyXG4gKiBTZWVcclxuICogaHR0cDovL2dvL3NhZmUtY2xpZW50LWJlaGF2aW9yI3N0ZXAtMS1kZXRlcm1pbmUtdGhlLWFwcHJvcHJpYXRlLXJldHJ5LWludGVydmFsLXRvLWhhbmRsZS1zcGlrZS10cmFmZmljXHJcbiAqIGZvciBjb250ZXh0LlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBSQU5ET01fRkFDVE9SID0gMC41O1xyXG4vKipcclxuICogQmFzZWQgb24gdGhlIGJhY2tvZmYgbWV0aG9kIGZyb21cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9tYXN0ZXIvY2xvc3VyZS9nb29nL21hdGgvZXhwb25lbnRpYWxiYWNrb2ZmLmpzLlxyXG4gKiBFeHRyYWN0ZWQgaGVyZSBzbyB3ZSBkb24ndCBuZWVkIHRvIHBhc3MgbWV0YWRhdGEgYW5kIGEgc3RhdGVmdWwgRXhwb25lbnRpYWxCYWNrb2ZmIG9iamVjdCBhcm91bmQuXHJcbiAqL1xyXG5mdW5jdGlvbiBjYWxjdWxhdGVCYWNrb2ZmTWlsbGlzKGJhY2tvZmZDb3VudCwgaW50ZXJ2YWxNaWxsaXMgPSBERUZBVUxUX0lOVEVSVkFMX01JTExJUywgYmFja29mZkZhY3RvciA9IERFRkFVTFRfQkFDS09GRl9GQUNUT1IpIHtcclxuICAgIC8vIENhbGN1bGF0ZXMgYW4gZXhwb25lbnRpYWxseSBpbmNyZWFzaW5nIHZhbHVlLlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjYWxjdWxhdGVzIHZhbHVlIGZyb20gY291bnQgYW5kIGEgY29uc3RhbnQgaW50ZXJ2YWwsIHNvIHdlIG9ubHkgbmVlZCB0byBzYXZlIHZhbHVlXHJcbiAgICAvLyBhbmQgY291bnQgdG8gcmVzdG9yZSBzdGF0ZS5cclxuICAgIGNvbnN0IGN1cnJCYXNlVmFsdWUgPSBpbnRlcnZhbE1pbGxpcyAqIE1hdGgucG93KGJhY2tvZmZGYWN0b3IsIGJhY2tvZmZDb3VudCk7XHJcbiAgICAvLyBBIHJhbmRvbSBcImZ1enpcIiB0byBhdm9pZCB3YXZlcyBvZiByZXRyaWVzLlxyXG4gICAgLy8gRGV2aWF0aW9uOiByYW5kb21GYWN0b3IgaXMgcmVxdWlyZWQuXHJcbiAgICBjb25zdCByYW5kb21XYWl0ID0gTWF0aC5yb3VuZChcclxuICAgIC8vIEEgZnJhY3Rpb24gb2YgdGhlIGJhY2tvZmYgdmFsdWUgdG8gYWRkL3N1YnRyYWN0LlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjaGFuZ2VzIG11bHRpcGxpY2F0aW9uIG9yZGVyIHRvIGltcHJvdmUgcmVhZGFiaWxpdHkuXHJcbiAgICBSQU5ET01fRkFDVE9SICpcclxuICAgICAgICBjdXJyQmFzZVZhbHVlICpcclxuICAgICAgICAvLyBBIHJhbmRvbSBmbG9hdCAocm91bmRlZCB0byBpbnQgYnkgTWF0aC5yb3VuZCBhYm92ZSkgaW4gdGhlIHJhbmdlIFstMSwgMV0uIERldGVybWluZXNcclxuICAgICAgICAvLyBpZiB3ZSBhZGQgb3Igc3VidHJhY3QuXHJcbiAgICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcclxuICAgICAgICAyKTtcclxuICAgIC8vIExpbWl0cyBiYWNrb2ZmIHRvIG1heCB0byBhdm9pZCBlZmZlY3RpdmVseSBwZXJtYW5lbnQgYmFja29mZi5cclxuICAgIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGUgRW5nbGlzaCBvcmRpbmFsIGxldHRlcnMgYWZ0ZXIgYSBudW1iZXJcclxuICovXHJcbmZ1bmN0aW9uIG9yZGluYWwoaSkge1xyXG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaSkpIHtcclxuICAgICAgICByZXR1cm4gYCR7aX1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGkgKyBpbmRpY2F0b3IoaSk7XHJcbn1cclxuZnVuY3Rpb24gaW5kaWNhdG9yKGkpIHtcclxuICAgIGkgPSBNYXRoLmFicyhpKTtcclxuICAgIGNvbnN0IGNlbnQgPSBpICUgMTAwO1xyXG4gICAgaWYgKGNlbnQgPj0gMTAgJiYgY2VudCA8PSAyMCkge1xyXG4gICAgICAgIHJldHVybiAndGgnO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGVjID0gaSAlIDEwO1xyXG4gICAgaWYgKGRlYyA9PT0gMSkge1xyXG4gICAgICAgIHJldHVybiAnc3QnO1xyXG4gICAgfVxyXG4gICAgaWYgKGRlYyA9PT0gMikge1xyXG4gICAgICAgIHJldHVybiAnbmQnO1xyXG4gICAgfVxyXG4gICAgaWYgKGRlYyA9PT0gMykge1xyXG4gICAgICAgIHJldHVybiAncmQnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICd0aCc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0TW9kdWxhckluc3RhbmNlKHNlcnZpY2UpIHtcclxuICAgIGlmIChzZXJ2aWNlICYmIHNlcnZpY2UuX2RlbGVnYXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2UuX2RlbGVnYXRlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgQ09OU1RBTlRTLCBEZWZlcnJlZCwgRXJyb3JGYWN0b3J5LCBGaXJlYmFzZUVycm9yLCBNQVhfVkFMVUVfTUlMTElTLCBSQU5ET01fRkFDVE9SLCBTaGExLCBhcmVDb29raWVzRW5hYmxlZCwgYXNzZXJ0LCBhc3NlcnRpb25FcnJvciwgYXN5bmMsIGJhc2U2NCwgYmFzZTY0RGVjb2RlLCBiYXNlNjRFbmNvZGUsIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nLCBjYWxjdWxhdGVCYWNrb2ZmTWlsbGlzLCBjb250YWlucywgY3JlYXRlTW9ja1VzZXJUb2tlbiwgY3JlYXRlU3Vic2NyaWJlLCBkZWNvZGUsIGRlZXBDb3B5LCBkZWVwRXF1YWwsIGRlZXBFeHRlbmQsIGVycm9yUHJlZml4LCBleHRyYWN0UXVlcnlzdHJpbmcsIGdldEdsb2JhbCwgZ2V0TW9kdWxhckluc3RhbmNlLCBnZXRVQSwgaXNBZG1pbiwgaXNCcm93c2VyLCBpc0Jyb3dzZXJFeHRlbnNpb24sIGlzRWxlY3Ryb24sIGlzRW1wdHksIGlzSUUsIGlzSW5kZXhlZERCQXZhaWxhYmxlLCBpc01vYmlsZUNvcmRvdmEsIGlzTm9kZSwgaXNOb2RlU2RrLCBpc1JlYWN0TmF0aXZlLCBpc1NhZmFyaSwgaXNVV1AsIGlzVmFsaWRGb3JtYXQsIGlzVmFsaWRUaW1lc3RhbXAsIGlzc3VlZEF0VGltZSwganNvbkV2YWwsIG1hcCwgb3JkaW5hbCwgcXVlcnlzdHJpbmcsIHF1ZXJ5c3RyaW5nRGVjb2RlLCBzYWZlR2V0LCBzdHJpbmdMZW5ndGgsIHN0cmluZ1RvQnl0ZUFycmF5LCBzdHJpbmdpZnksIHZhbGlkYXRlQXJnQ291bnQsIHZhbGlkYXRlQ2FsbGJhY2ssIHZhbGlkYXRlQ29udGV4dE9iamVjdCwgdmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSwgdmFsaWRhdGVOYW1lc3BhY2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyBEZWZlcnJlZCB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuLyoqXHJcbiAqIENvbXBvbmVudCBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcclxuICovXHJcbmNsYXNzIENvbXBvbmVudCB7XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgcHVibGljIHNlcnZpY2UgbmFtZSwgZS5nLiBhcHAsIGF1dGgsIGZpcmVzdG9yZSwgZGF0YWJhc2VcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZUZhY3RvcnkgU2VydmljZSBmYWN0b3J5IHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgcHVibGljIGludGVyZmFjZVxyXG4gICAgICogQHBhcmFtIHR5cGUgd2hldGhlciB0aGUgc2VydmljZSBwcm92aWRlZCBieSB0aGUgY29tcG9uZW50IGlzIHB1YmxpYyBvciBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGluc3RhbmNlRmFjdG9yeSwgdHlwZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZUZhY3RvcnkgPSBpbnN0YW5jZUZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLm11bHRpcGxlSW5zdGFuY2VzID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUHJvcGVydGllcyB0byBiZSBhZGRlZCB0byB0aGUgc2VydmljZSBuYW1lc3BhY2VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnNlcnZpY2VQcm9wcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuaW5zdGFudGlhdGlvbk1vZGUgPSBcIkxBWllcIiAvKiBMQVpZICovO1xyXG4gICAgICAgIHRoaXMub25JbnN0YW5jZUNyZWF0ZWQgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgc2V0SW5zdGFudGlhdGlvbk1vZGUobW9kZSkge1xyXG4gICAgICAgIHRoaXMuaW5zdGFudGlhdGlvbk1vZGUgPSBtb2RlO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgc2V0TXVsdGlwbGVJbnN0YW5jZXMobXVsdGlwbGVJbnN0YW5jZXMpIHtcclxuICAgICAgICB0aGlzLm11bHRpcGxlSW5zdGFuY2VzID0gbXVsdGlwbGVJbnN0YW5jZXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBzZXRTZXJ2aWNlUHJvcHMocHJvcHMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2VQcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLm9uSW5zdGFuY2VDcmVhdGVkID0gY2FsbGJhY2s7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgaW5zdGFuY2UgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuICdhdXRoJywgJ2F1dGgtaW50ZXJuYWwnXHJcbiAqIE5hbWVTZXJ2aWNlTWFwcGluZ1tUXSBpcyBhbiBhbGlhcyBmb3IgdGhlIHR5cGUgb2YgdGhlIGluc3RhbmNlXHJcbiAqL1xyXG5jbGFzcyBQcm92aWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmluc3RhbmNlcyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLm9uSW5pdENhbGxiYWNrcyA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgQSBwcm92aWRlciBjYW4gcHJvdmlkZSBtdWxpdHBsZSBpbnN0YW5jZXMgb2YgYSBzZXJ2aWNlXHJcbiAgICAgKiBpZiB0aGlzLmNvbXBvbmVudC5tdWx0aXBsZUluc3RhbmNlcyBpcyB0cnVlLlxyXG4gICAgICovXHJcbiAgICBnZXQoaWRlbnRpZmllcikge1xyXG4gICAgICAgIC8vIGlmIG11bHRpcGxlSW5zdGFuY2VzIGlzIG5vdCBzdXBwb3J0ZWQsIHVzZSB0aGUgZGVmYXVsdCBuYW1lXHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIXRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuaGFzKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLnNldChub3JtYWxpemVkSWRlbnRpZmllciwgZGVmZXJyZWQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG91bGRBdXRvSW5pdGlhbGl6ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIHRoZSBzZXJ2aWNlIGlmIGl0IGNhbiBiZSBhdXRvLWluaXRpYWxpemVkXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiBkdXJpbmcgZ2V0KCksIGl0IHNob3VsZCBub3QgY2F1c2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yLiBXZSBqdXN0IHJldHVybiB0aGUgdW5yZXNvbHZlZCBwcm9taXNlIGluIHRoaXMgY2FzZS5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5nZXQobm9ybWFsaXplZElkZW50aWZpZXIpLnByb21pc2U7XHJcbiAgICB9XHJcbiAgICBnZXRJbW1lZGlhdGUob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAvLyBpZiBtdWx0aXBsZUluc3RhbmNlcyBpcyBub3Qgc3VwcG9ydGVkLCB1c2UgdGhlIGRlZmF1bHQgbmFtZVxyXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIob3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmlkZW50aWZpZXIpO1xyXG4gICAgICAgIGNvbnN0IG9wdGlvbmFsID0gKF9hID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm9wdGlvbmFsKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSB8fFxyXG4gICAgICAgICAgICB0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEluIGNhc2UgYSBjb21wb25lbnQgaXMgbm90IGluaXRpYWxpemVkIGFuZCBzaG91bGQvY2FuIG5vdCBiZSBhdXRvLWluaXRpYWxpemVkIGF0IHRoZSBtb21lbnQsIHJldHVybiBudWxsIGlmIHRoZSBvcHRpb25hbCBmbGFnIGlzIHNldCwgb3IgdGhyb3dcclxuICAgICAgICAgICAgaWYgKG9wdGlvbmFsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKGBTZXJ2aWNlICR7dGhpcy5uYW1lfSBpcyBub3QgYXZhaWxhYmxlYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRDb21wb25lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50O1xyXG4gICAgfVxyXG4gICAgc2V0Q29tcG9uZW50KGNvbXBvbmVudCkge1xyXG4gICAgICAgIGlmIChjb21wb25lbnQubmFtZSAhPT0gdGhpcy5uYW1lKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBNaXNtYXRjaGluZyBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZm9yIFByb3ZpZGVyICR7dGhpcy5uYW1lfS5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBDb21wb25lbnQgZm9yICR7dGhpcy5uYW1lfSBoYXMgYWxyZWFkeSBiZWVuIHByb3ZpZGVkYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gY29tcG9uZW50O1xyXG4gICAgICAgIC8vIHJldHVybiBlYXJseSB3aXRob3V0IGF0dGVtcHRpbmcgdG8gaW5pdGlhbGl6ZSB0aGUgY29tcG9uZW50IGlmIHRoZSBjb21wb25lbnQgcmVxdWlyZXMgZXhwbGljaXQgaW5pdGlhbGl6YXRpb24gKGNhbGxpbmcgYFByb3ZpZGVyLmluaXRpYWxpemUoKWApXHJcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiB0aGUgc2VydmljZSBpcyBlYWdlciwgaW5pdGlhbGl6ZSB0aGUgZGVmYXVsdCBpbnN0YW5jZVxyXG4gICAgICAgIGlmIChpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7IGluc3RhbmNlSWRlbnRpZmllcjogREVGQVVMVF9FTlRSWV9OQU1FIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3aGVuIHRoZSBpbnN0YW5jZSBmYWN0b3J5IGZvciBhbiBlYWdlciBDb21wb25lbnQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBkdXJpbmcgdGhlIGVhZ2VyXHJcbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXphdGlvbiwgaXQgc2hvdWxkIG5vdCBjYXVzZSBhIGZhdGFsIGVycm9yLlxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogSW52ZXN0aWdhdGUgaWYgd2UgbmVlZCB0byBtYWtlIGl0IGNvbmZpZ3VyYWJsZSwgYmVjYXVzZSBzb21lIGNvbXBvbmVudCBtYXkgd2FudCB0byBjYXVzZVxyXG4gICAgICAgICAgICAgICAgLy8gYSBmYXRhbCBlcnJvciBpbiB0aGlzIGNhc2U/XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ3JlYXRlIHNlcnZpY2UgaW5zdGFuY2VzIGZvciB0aGUgcGVuZGluZyBwcm9taXNlcyBhbmQgcmVzb2x2ZSB0aGVtXHJcbiAgICAgICAgLy8gTk9URTogaWYgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyBpcyBmYWxzZSwgb25seSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB3aWxsIGJlIGNyZWF0ZWRcclxuICAgICAgICAvLyBhbmQgYWxsIHByb21pc2VzIHdpdGggcmVzb2x2ZSB3aXRoIGl0IHJlZ2FyZGxlc3Mgb2YgdGhlIGlkZW50aWZpZXIuXHJcbiAgICAgICAgZm9yIChjb25zdCBbaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZURlZmVycmVkXSBvZiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmVudHJpZXMoKSkge1xyXG4gICAgICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAvLyBgZ2V0T3JJbml0aWFsaXplU2VydmljZSgpYCBzaG91bGQgYWx3YXlzIHJldHVybiBhIHZhbGlkIGluc3RhbmNlIHNpbmNlIGEgY29tcG9uZW50IGlzIGd1YXJhbnRlZWQuIHVzZSAhIHRvIG1ha2UgdHlwZXNjcmlwdCBoYXBweS5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZWRJZGVudGlmaWVyXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiwgaXQgc2hvdWxkIG5vdCBjYXVzZVxyXG4gICAgICAgICAgICAgICAgLy8gYSBmYXRhbCBlcnJvci4gV2UganVzdCBsZWF2ZSB0aGUgcHJvbWlzZSB1bnJlc29sdmVkLlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2xlYXJJbnN0YW5jZShpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5kZWxldGUoaWRlbnRpZmllcik7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlcy5kZWxldGUoaWRlbnRpZmllcik7XHJcbiAgICB9XHJcbiAgICAvLyBhcHAuZGVsZXRlKCkgd2lsbCBjYWxsIHRoaXMgbWV0aG9kIG9uIGV2ZXJ5IHByb3ZpZGVyIHRvIGRlbGV0ZSB0aGUgc2VydmljZXNcclxuICAgIC8vIFRPRE86IHNob3VsZCB3ZSBtYXJrIHRoZSBwcm92aWRlciBhcyBkZWxldGVkP1xyXG4gICAgYXN5bmMgZGVsZXRlKCkge1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2VzID0gQXJyYXkuZnJvbSh0aGlzLmluc3RhbmNlcy52YWx1ZXMoKSk7XHJcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICAuLi5zZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgLmZpbHRlcihzZXJ2aWNlID0+ICdJTlRFUk5BTCcgaW4gc2VydmljZSkgLy8gbGVnYWN5IHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgICAgICAgLm1hcChzZXJ2aWNlID0+IHNlcnZpY2UuSU5URVJOQUwuZGVsZXRlKCkpLFxyXG4gICAgICAgICAgICAuLi5zZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgLmZpbHRlcihzZXJ2aWNlID0+ICdfZGVsZXRlJyBpbiBzZXJ2aWNlKSAvLyBtb2R1bGFyaXplZCBzZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICAgICAgICAgIC5tYXAoc2VydmljZSA9PiBzZXJ2aWNlLl9kZWxldGUoKSlcclxuICAgICAgICBdKTtcclxuICAgIH1cclxuICAgIGlzQ29tcG9uZW50U2V0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudCAhPSBudWxsO1xyXG4gICAgfVxyXG4gICAgaXNJbml0aWFsaXplZChpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzLmhhcyhpZGVudGlmaWVyKTtcclxuICAgIH1cclxuICAgIGdldE9wdGlvbnMoaWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlc09wdGlvbnMuZ2V0KGlkZW50aWZpZXIpIHx8IHt9O1xyXG4gICAgfVxyXG4gICAgaW5pdGlhbGl6ZShvcHRzID0ge30pIHtcclxuICAgICAgICBjb25zdCB7IG9wdGlvbnMgPSB7fSB9ID0gb3B0cztcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKG9wdHMuaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgJHt0aGlzLm5hbWV9KCR7bm9ybWFsaXplZElkZW50aWZpZXJ9KSBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5pc0NvbXBvbmVudFNldCgpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBDb21wb25lbnQgJHt0aGlzLm5hbWV9IGhhcyBub3QgYmVlbiByZWdpc3RlcmVkIHlldGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXIsXHJcbiAgICAgICAgICAgIG9wdGlvbnNcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyByZXNvbHZlIGFueSBwZW5kaW5nIHByb21pc2Ugd2FpdGluZyBmb3IgdGhlIHNlcnZpY2UgaW5zdGFuY2VcclxuICAgICAgICBmb3IgKGNvbnN0IFtpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlRGVmZXJyZWRdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWREZWZlcnJlZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZElkZW50aWZpZXIgPT09IG5vcm1hbGl6ZWREZWZlcnJlZElkZW50aWZpZXIpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgaW52b2tlZCAgYWZ0ZXIgdGhlIHByb3ZpZGVyIGhhcyBiZWVuIGluaXRpYWxpemVkIGJ5IGNhbGxpbmcgcHJvdmlkZXIuaW5pdGlhbGl6ZSgpLlxyXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIGludm9rZWQgU1lOQ0hST05PVVNMWSwgc28gaXQgc2hvdWxkIG5vdCBleGVjdXRlIGFueSBsb25ncnVubmluZyB0YXNrcyBpbiBvcmRlciB0byBub3QgYmxvY2sgdGhlIHByb2dyYW0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgQW4gb3B0aW9uYWwgaW5zdGFuY2UgaWRlbnRpZmllclxyXG4gICAgICogQHJldHVybnMgYSBmdW5jdGlvbiB0byB1bnJlZ2lzdGVyIHRoZSBjYWxsYmFja1xyXG4gICAgICovXHJcbiAgICBvbkluaXQoY2FsbGJhY2ssIGlkZW50aWZpZXIpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyKTtcclxuICAgICAgICBjb25zdCBleGlzdGluZ0NhbGxiYWNrcyA9IChfYSA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChub3JtYWxpemVkSWRlbnRpZmllcikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG5ldyBTZXQoKTtcclxuICAgICAgICBleGlzdGluZ0NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMub25Jbml0Q2FsbGJhY2tzLnNldChub3JtYWxpemVkSWRlbnRpZmllciwgZXhpc3RpbmdDYWxsYmFja3MpO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQobm9ybWFsaXplZElkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0luc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGV4aXN0aW5nSW5zdGFuY2UsIG5vcm1hbGl6ZWRJZGVudGlmaWVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgZXhpc3RpbmdDYWxsYmFja3MuZGVsZXRlKGNhbGxiYWNrKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnZva2Ugb25Jbml0IGNhbGxiYWNrcyBzeW5jaHJvbm91c2x5XHJcbiAgICAgKiBAcGFyYW0gaW5zdGFuY2UgdGhlIHNlcnZpY2UgaW5zdGFuY2VgXHJcbiAgICAgKi9cclxuICAgIGludm9rZU9uSW5pdENhbGxiYWNrcyhpbnN0YW5jZSwgaWRlbnRpZmllcikge1xyXG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChpZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIWNhbGxiYWNrcykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAoY29uc3QgY2FsbGJhY2sgb2YgY2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhpbnN0YW5jZSwgaWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZXJyb3JzIGluIHRoZSBvbkluaXQgY2FsbGJhY2tcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldE9ySW5pdGlhbGl6ZVNlcnZpY2UoeyBpbnN0YW5jZUlkZW50aWZpZXIsIG9wdGlvbnMgPSB7fSB9KSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcy5pbnN0YW5jZXMuZ2V0KGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgaWYgKCFpbnN0YW5jZSAmJiB0aGlzLmNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZSA9IHRoaXMuY29tcG9uZW50Lmluc3RhbmNlRmFjdG9yeSh0aGlzLmNvbnRhaW5lciwge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpbnN0YW5jZUlkZW50aWZpZXIpLFxyXG4gICAgICAgICAgICAgICAgb3B0aW9uc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXMuc2V0KGluc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc09wdGlvbnMuc2V0KGluc3RhbmNlSWRlbnRpZmllciwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBJbnZva2Ugb25Jbml0IGxpc3RlbmVycy5cclxuICAgICAgICAgICAgICogTm90ZSB0aGlzLmNvbXBvbmVudC5vbkluc3RhbmNlQ3JlYXRlZCBpcyBkaWZmZXJlbnQsIHdoaWNoIGlzIHVzZWQgYnkgdGhlIGNvbXBvbmVudCBjcmVhdG9yLFxyXG4gICAgICAgICAgICAgKiB3aGlsZSBvbkluaXQgbGlzdGVuZXJzIGFyZSByZWdpc3RlcmVkIGJ5IGNvbnN1bWVycyBvZiB0aGUgcHJvdmlkZXIuXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLmludm9rZU9uSW5pdENhbGxiYWNrcyhpbnN0YW5jZSwgaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIE9yZGVyIGlzIGltcG9ydGFudFxyXG4gICAgICAgICAgICAgKiBvbkluc3RhbmNlQ3JlYXRlZCgpIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhpcy5pbnN0YW5jZXMuc2V0KGluc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2UpOyB3aGljaFxyXG4gICAgICAgICAgICAgKiBtYWtlcyBgaXNJbml0aWFsaXplZCgpYCByZXR1cm4gdHJ1ZS5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBvbmVudC5vbkluc3RhbmNlQ3JlYXRlZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5vbkluc3RhbmNlQ3JlYXRlZCh0aGlzLmNvbnRhaW5lciwgaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZXJyb3JzIGluIHRoZSBvbkluc3RhbmNlQ3JlYXRlZENhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlIHx8IG51bGw7XHJcbiAgICB9XHJcbiAgICBub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xyXG4gICAgICAgIGlmICh0aGlzLmNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgPyBpZGVudGlmaWVyIDogREVGQVVMVF9FTlRSWV9OQU1FO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlkZW50aWZpZXI7IC8vIGFzc3VtZSBtdWx0aXBsZSBpbnN0YW5jZXMgYXJlIHN1cHBvcnRlZCBiZWZvcmUgdGhlIGNvbXBvbmVudCBpcyBwcm92aWRlZC5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzaG91bGRBdXRvSW5pdGlhbGl6ZSgpIHtcclxuICAgICAgICByZXR1cm4gKCEhdGhpcy5jb21wb25lbnQgJiZcclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnQuaW5zdGFudGlhdGlvbk1vZGUgIT09IFwiRVhQTElDSVRcIiAvKiBFWFBMSUNJVCAqLyk7XHJcbiAgICB9XHJcbn1cclxuLy8gdW5kZWZpbmVkIHNob3VsZCBiZSBwYXNzZWQgdG8gdGhlIHNlcnZpY2UgZmFjdG9yeSBmb3IgdGhlIGRlZmF1bHQgaW5zdGFuY2VcclxuZnVuY3Rpb24gbm9ybWFsaXplSWRlbnRpZmllckZvckZhY3RvcnkoaWRlbnRpZmllcikge1xyXG4gICAgcmV0dXJuIGlkZW50aWZpZXIgPT09IERFRkFVTFRfRU5UUllfTkFNRSA/IHVuZGVmaW5lZCA6IGlkZW50aWZpZXI7XHJcbn1cclxuZnVuY3Rpb24gaXNDb21wb25lbnRFYWdlcihjb21wb25lbnQpIHtcclxuICAgIHJldHVybiBjb21wb25lbnQuaW5zdGFudGlhdGlvbk1vZGUgPT09IFwiRUFHRVJcIiAvKiBFQUdFUiAqLztcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQ29tcG9uZW50Q29udGFpbmVyIHRoYXQgcHJvdmlkZXMgUHJvdmlkZXJzIGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiBgYXV0aGAsIGBhdXRoLWludGVybmFsYFxyXG4gKi9cclxuY2xhc3MgQ29tcG9uZW50Q29udGFpbmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMucHJvdmlkZXJzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNvbXBvbmVudCBDb21wb25lbnQgYmVpbmcgYWRkZWRcclxuICAgICAqIEBwYXJhbSBvdmVyd3JpdGUgV2hlbiBhIGNvbXBvbmVudCB3aXRoIHRoZSBzYW1lIG5hbWUgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLFxyXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIHRydWU6IG92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgY29tcG9uZW50IHdpdGggdGhlIG5ldyBjb21wb25lbnQgYW5kIGNyZWF0ZSBhIG5ld1xyXG4gICAgICogcHJvdmlkZXIgd2l0aCB0aGUgbmV3IGNvbXBvbmVudC4gSXQgY2FuIGJlIHVzZWZ1bCBpbiB0ZXN0cyB3aGVyZSB5b3Ugd2FudCB0byB1c2UgZGlmZmVyZW50IG1vY2tzXHJcbiAgICAgKiBmb3IgZGlmZmVyZW50IHRlc3RzLlxyXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIGZhbHNlOiB0aHJvdyBhbiBleGNlcHRpb25cclxuICAgICAqL1xyXG4gICAgYWRkQ29tcG9uZW50KGNvbXBvbmVudCkge1xyXG4gICAgICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XHJcbiAgICAgICAgaWYgKHByb3ZpZGVyLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIHdpdGggJHt0aGlzLm5hbWV9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHByb3ZpZGVyLnNldENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICBpZiAocHJvdmlkZXIuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICAvLyBkZWxldGUgdGhlIGV4aXN0aW5nIHByb3ZpZGVyIGZyb20gdGhlIGNvbnRhaW5lciwgc28gd2UgY2FuIHJlZ2lzdGVyIHRoZSBuZXcgY29tcG9uZW50XHJcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJzLmRlbGV0ZShjb21wb25lbnQubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIGdldFByb3ZpZGVyIHByb3ZpZGVzIGEgdHlwZSBzYWZlIGludGVyZmFjZSB3aGVyZSBpdCBjYW4gb25seSBiZSBjYWxsZWQgd2l0aCBhIGZpZWxkIG5hbWVcclxuICAgICAqIHByZXNlbnQgaW4gTmFtZVNlcnZpY2VNYXBwaW5nIGludGVyZmFjZS5cclxuICAgICAqXHJcbiAgICAgKiBGaXJlYmFzZSBTREtzIHByb3ZpZGluZyBzZXJ2aWNlcyBzaG91bGQgZXh0ZW5kIE5hbWVTZXJ2aWNlTWFwcGluZyBpbnRlcmZhY2UgdG8gcmVnaXN0ZXJcclxuICAgICAqIHRoZW1zZWx2ZXMuXHJcbiAgICAgKi9cclxuICAgIGdldFByb3ZpZGVyKG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm92aWRlcnMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVycy5nZXQobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNyZWF0ZSBhIFByb3ZpZGVyIGZvciBhIHNlcnZpY2UgdGhhdCBoYXNuJ3QgcmVnaXN0ZXJlZCB3aXRoIEZpcmViYXNlXHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgUHJvdmlkZXIobmFtZSwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMuc2V0KG5hbWUsIHByb3ZpZGVyKTtcclxuICAgICAgICByZXR1cm4gcHJvdmlkZXI7XHJcbiAgICB9XHJcbiAgICBnZXRQcm92aWRlcnMoKSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5wcm92aWRlcnMudmFsdWVzKCkpO1xyXG4gICAgfVxyXG59XG5cbmV4cG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50Q29udGFpbmVyLCBQcm92aWRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsIi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIGNvbnRhaW5lciBmb3IgYWxsIG9mIHRoZSBMb2dnZXIgaW5zdGFuY2VzXHJcbiAqL1xyXG5jb25zdCBpbnN0YW5jZXMgPSBbXTtcclxuLyoqXHJcbiAqIFRoZSBKUyBTREsgc3VwcG9ydHMgNSBsb2cgbGV2ZWxzIGFuZCBhbHNvIGFsbG93cyBhIHVzZXIgdGhlIGFiaWxpdHkgdG9cclxuICogc2lsZW5jZSB0aGUgbG9ncyBhbHRvZ2V0aGVyLlxyXG4gKlxyXG4gKiBUaGUgb3JkZXIgaXMgYSBmb2xsb3dzOlxyXG4gKiBERUJVRyA8IFZFUkJPU0UgPCBJTkZPIDwgV0FSTiA8IEVSUk9SXHJcbiAqXHJcbiAqIEFsbCBvZiB0aGUgbG9nIHR5cGVzIGFib3ZlIHRoZSBjdXJyZW50IGxvZyBsZXZlbCB3aWxsIGJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgSU5GT2AsIGVycm9ycyB3aWxsIHN0aWxsIGJlIGxvZ2dlZCwgYnV0IGBERUJVR2AgYW5kXHJcbiAqIGBWRVJCT1NFYCBsb2dzIHdpbGwgbm90KVxyXG4gKi9cclxudmFyIExvZ0xldmVsO1xyXG4oZnVuY3Rpb24gKExvZ0xldmVsKSB7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkRFQlVHXCJdID0gMF0gPSBcIkRFQlVHXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlZFUkJPU0VcIl0gPSAxXSA9IFwiVkVSQk9TRVwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJJTkZPXCJdID0gMl0gPSBcIklORk9cIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiV0FSTlwiXSA9IDNdID0gXCJXQVJOXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkVSUk9SXCJdID0gNF0gPSBcIkVSUk9SXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlNJTEVOVFwiXSA9IDVdID0gXCJTSUxFTlRcIjtcclxufSkoTG9nTGV2ZWwgfHwgKExvZ0xldmVsID0ge30pKTtcclxuY29uc3QgbGV2ZWxTdHJpbmdUb0VudW0gPSB7XHJcbiAgICAnZGVidWcnOiBMb2dMZXZlbC5ERUJVRyxcclxuICAgICd2ZXJib3NlJzogTG9nTGV2ZWwuVkVSQk9TRSxcclxuICAgICdpbmZvJzogTG9nTGV2ZWwuSU5GTyxcclxuICAgICd3YXJuJzogTG9nTGV2ZWwuV0FSTixcclxuICAgICdlcnJvcic6IExvZ0xldmVsLkVSUk9SLFxyXG4gICAgJ3NpbGVudCc6IExvZ0xldmVsLlNJTEVOVFxyXG59O1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgbG9nIGxldmVsXHJcbiAqL1xyXG5jb25zdCBkZWZhdWx0TG9nTGV2ZWwgPSBMb2dMZXZlbC5JTkZPO1xyXG4vKipcclxuICogQnkgZGVmYXVsdCwgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGRldmVsb3BlciBjb25zb2xlIChpblxyXG4gKiBjaHJvbWUpLiBUbyBhdm9pZCBmb3JjaW5nIHVzZXJzIHRvIGhhdmUgdG8gb3B0LWluIHRvIHRoZXNlIGxvZ3MgdHdpY2VcclxuICogKGkuZS4gb25jZSBmb3IgZmlyZWJhc2UsIGFuZCBvbmNlIGluIHRoZSBjb25zb2xlKSwgd2UgYXJlIHNlbmRpbmcgYERFQlVHYFxyXG4gKiBsb2dzIHRvIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uLlxyXG4gKi9cclxuY29uc3QgQ29uc29sZU1ldGhvZCA9IHtcclxuICAgIFtMb2dMZXZlbC5ERUJVR106ICdsb2cnLFxyXG4gICAgW0xvZ0xldmVsLlZFUkJPU0VdOiAnbG9nJyxcclxuICAgIFtMb2dMZXZlbC5JTkZPXTogJ2luZm8nLFxyXG4gICAgW0xvZ0xldmVsLldBUk5dOiAnd2FybicsXHJcbiAgICBbTG9nTGV2ZWwuRVJST1JdOiAnZXJyb3InXHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgaGFuZGxlciB3aWxsIGZvcndhcmQgREVCVUcsIFZFUkJPU0UsIElORk8sIFdBUk4sIGFuZCBFUlJPUlxyXG4gKiBtZXNzYWdlcyBvbiB0byB0aGVpciBjb3JyZXNwb25kaW5nIGNvbnNvbGUgY291bnRlcnBhcnRzIChpZiB0aGUgbG9nIG1ldGhvZFxyXG4gKiBpcyBzdXBwb3J0ZWQgYnkgdGhlIGN1cnJlbnQgbG9nIGxldmVsKVxyXG4gKi9cclxuY29uc3QgZGVmYXVsdExvZ0hhbmRsZXIgPSAoaW5zdGFuY2UsIGxvZ1R5cGUsIC4uLmFyZ3MpID0+IHtcclxuICAgIGlmIChsb2dUeXBlIDwgaW5zdGFuY2UubG9nTGV2ZWwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICBjb25zdCBtZXRob2QgPSBDb25zb2xlTWV0aG9kW2xvZ1R5cGVdO1xyXG4gICAgaWYgKG1ldGhvZCkge1xyXG4gICAgICAgIGNvbnNvbGVbbWV0aG9kXShgWyR7bm93fV0gICR7aW5zdGFuY2UubmFtZX06YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEF0dGVtcHRlZCB0byBsb2cgYSBtZXNzYWdlIHdpdGggYW4gaW52YWxpZCBsb2dUeXBlICh2YWx1ZTogJHtsb2dUeXBlfSlgKTtcclxuICAgIH1cclxufTtcclxuY2xhc3MgTG9nZ2VyIHtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZXMgeW91IGFuIGluc3RhbmNlIG9mIGEgTG9nZ2VyIHRvIGNhcHR1cmUgbWVzc2FnZXMgYWNjb3JkaW5nIHRvXHJcbiAgICAgKiBGaXJlYmFzZSdzIGxvZ2dpbmcgc2NoZW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGxvZ3Mgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxvZyBsZXZlbCBvZiB0aGUgZ2l2ZW4gTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2xvZ0xldmVsID0gZGVmYXVsdExvZ0xldmVsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBtYWluIChpbnRlcm5hbCkgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICogQ2FuIGJlIHNldCB0byBhIG5ldyBmdW5jdGlvbiBpbiBpbnRlcm5hbCBwYWNrYWdlIGNvZGUgYnV0IG5vdCBieSB1c2VyLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSBkZWZhdWx0TG9nSGFuZGxlcjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgb3B0aW9uYWwsIGFkZGl0aW9uYWwsIHVzZXItZGVmaW5lZCBsb2cgaGFuZGxlciBmb3IgdGhlIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FwdHVyZSB0aGUgY3VycmVudCBpbnN0YW5jZSBmb3IgbGF0ZXIgdXNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5zdGFuY2VzLnB1c2godGhpcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgbG9nTGV2ZWwoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ0xldmVsO1xyXG4gICAgfVxyXG4gICAgc2V0IGxvZ0xldmVsKHZhbCkge1xyXG4gICAgICAgIGlmICghKHZhbCBpbiBMb2dMZXZlbCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCB2YWx1ZSBcIiR7dmFsfVwiIGFzc2lnbmVkIHRvIFxcYGxvZ0xldmVsXFxgYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0xldmVsID0gdmFsO1xyXG4gICAgfVxyXG4gICAgLy8gV29ya2Fyb3VuZCBmb3Igc2V0dGVyL2dldHRlciBoYXZpbmcgdG8gYmUgdGhlIHNhbWUgdHlwZS5cclxuICAgIHNldExvZ0xldmVsKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2xvZ0xldmVsID0gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgPyBsZXZlbFN0cmluZ1RvRW51bVt2YWxdIDogdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IGxvZ0hhbmRsZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvZ0hhbmRsZXI7XHJcbiAgICB9XHJcbiAgICBzZXQgbG9nSGFuZGxlcih2YWwpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdWYWx1ZSBhc3NpZ25lZCB0byBgbG9nSGFuZGxlcmAgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSB2YWw7XHJcbiAgICB9XHJcbiAgICBnZXQgdXNlckxvZ0hhbmRsZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJMb2dIYW5kbGVyO1xyXG4gICAgfVxyXG4gICAgc2V0IHVzZXJMb2dIYW5kbGVyKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyID0gdmFsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgZnVuY3Rpb25zIGJlbG93IGFyZSBhbGwgYmFzZWQgb24gdGhlIGBjb25zb2xlYCBpbnRlcmZhY2VcclxuICAgICAqL1xyXG4gICAgZGVidWcoLi4uYXJncykge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkRFQlVHLCAuLi5hcmdzKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkRFQlVHLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGxvZyguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiZcclxuICAgICAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuVkVSQk9TRSwgLi4uYXJncyk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5WRVJCT1NFLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGluZm8oLi4uYXJncykge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLklORk8sIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuSU5GTywgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgICB3YXJuKC4uLmFyZ3MpIHtcclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5XQVJOLCAuLi5hcmdzKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLldBUk4sIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgZXJyb3IoLi4uYXJncykge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkVSUk9SLCAuLi5hcmdzKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkVSUk9SLCAuLi5hcmdzKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBzZXRMb2dMZXZlbChsZXZlbCkge1xyXG4gICAgaW5zdGFuY2VzLmZvckVhY2goaW5zdCA9PiB7XHJcbiAgICAgICAgaW5zdC5zZXRMb2dMZXZlbChsZXZlbCk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBzZXRVc2VyTG9nSGFuZGxlcihsb2dDYWxsYmFjaywgb3B0aW9ucykge1xyXG4gICAgZm9yIChjb25zdCBpbnN0YW5jZSBvZiBpbnN0YW5jZXMpIHtcclxuICAgICAgICBsZXQgY3VzdG9tTG9nTGV2ZWwgPSBudWxsO1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubGV2ZWwpIHtcclxuICAgICAgICAgICAgY3VzdG9tTG9nTGV2ZWwgPSBsZXZlbFN0cmluZ1RvRW51bVtvcHRpb25zLmxldmVsXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxvZ0NhbGxiYWNrID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gKGluc3RhbmNlLCBsZXZlbCwgLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGFyZ3NcclxuICAgICAgICAgICAgICAgICAgICAubWFwKGFyZyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFyZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgYXJnID09PSAnYm9vbGVhbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZy50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhcmcgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGFyZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGlnbm9yZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGFyZyA9PiBhcmcpXHJcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyAnKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZXZlbCA+PSAoY3VzdG9tTG9nTGV2ZWwgIT09IG51bGwgJiYgY3VzdG9tTG9nTGV2ZWwgIT09IHZvaWQgMCA/IGN1c3RvbUxvZ0xldmVsIDogaW5zdGFuY2UubG9nTGV2ZWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogTG9nTGV2ZWxbbGV2ZWxdLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGluc3RhbmNlLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgTG9nTGV2ZWwsIExvZ2dlciwgc2V0TG9nTGV2ZWwsIHNldFVzZXJMb2dIYW5kbGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiY29uc3QgaW5zdGFuY2VPZkFueSA9IChvYmplY3QsIGNvbnN0cnVjdG9ycykgPT4gY29uc3RydWN0b3JzLnNvbWUoKGMpID0+IG9iamVjdCBpbnN0YW5jZW9mIGMpO1xuXG5sZXQgaWRiUHJveHlhYmxlVHlwZXM7XG5sZXQgY3Vyc29yQWR2YW5jZU1ldGhvZHM7XG4vLyBUaGlzIGlzIGEgZnVuY3Rpb24gdG8gcHJldmVudCBpdCB0aHJvd2luZyB1cCBpbiBub2RlIGVudmlyb25tZW50cy5cbmZ1bmN0aW9uIGdldElkYlByb3h5YWJsZVR5cGVzKCkge1xuICAgIHJldHVybiAoaWRiUHJveHlhYmxlVHlwZXMgfHxcbiAgICAgICAgKGlkYlByb3h5YWJsZVR5cGVzID0gW1xuICAgICAgICAgICAgSURCRGF0YWJhc2UsXG4gICAgICAgICAgICBJREJPYmplY3RTdG9yZSxcbiAgICAgICAgICAgIElEQkluZGV4LFxuICAgICAgICAgICAgSURCQ3Vyc29yLFxuICAgICAgICAgICAgSURCVHJhbnNhY3Rpb24sXG4gICAgICAgIF0pKTtcbn1cbi8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLlxuZnVuY3Rpb24gZ2V0Q3Vyc29yQWR2YW5jZU1ldGhvZHMoKSB7XG4gICAgcmV0dXJuIChjdXJzb3JBZHZhbmNlTWV0aG9kcyB8fFxuICAgICAgICAoY3Vyc29yQWR2YW5jZU1ldGhvZHMgPSBbXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmFkdmFuY2UsXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmNvbnRpbnVlLFxuICAgICAgICAgICAgSURCQ3Vyc29yLnByb3RvdHlwZS5jb250aW51ZVByaW1hcnlLZXksXG4gICAgICAgIF0pKTtcbn1cbmNvbnN0IGN1cnNvclJlcXVlc3RNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgdHJhbnNhY3Rpb25Eb25lTWFwID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHRyYW5zYWN0aW9uU3RvcmVOYW1lc01hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCB0cmFuc2Zvcm1DYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCByZXZlcnNlVHJhbnNmb3JtQ2FjaGUgPSBuZXcgV2Vha01hcCgpO1xuZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5saXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICByZXF1ZXN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHN1Y2Nlc3MgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKHdyYXAocmVxdWVzdC5yZXN1bHQpKTtcbiAgICAgICAgICAgIHVubGlzdGVuKCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVycm9yID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgc3VjY2Vzcyk7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCBlcnJvcik7XG4gICAgfSk7XG4gICAgcHJvbWlzZVxuICAgICAgICAudGhlbigodmFsdWUpID0+IHtcbiAgICAgICAgLy8gU2luY2UgY3Vyc29yaW5nIHJldXNlcyB0aGUgSURCUmVxdWVzdCAoKnNpZ2gqKSwgd2UgY2FjaGUgaXQgZm9yIGxhdGVyIHJldHJpZXZhbFxuICAgICAgICAvLyAoc2VlIHdyYXBGdW5jdGlvbikuXG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQkN1cnNvcikge1xuICAgICAgICAgICAgY3Vyc29yUmVxdWVzdE1hcC5zZXQodmFsdWUsIHJlcXVlc3QpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENhdGNoaW5nIHRvIGF2b2lkIFwiVW5jYXVnaHQgUHJvbWlzZSBleGNlcHRpb25zXCJcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4geyB9KTtcbiAgICAvLyBUaGlzIG1hcHBpbmcgZXhpc3RzIGluIHJldmVyc2VUcmFuc2Zvcm1DYWNoZSBidXQgZG9lc24ndCBkb2Vzbid0IGV4aXN0IGluIHRyYW5zZm9ybUNhY2hlLiBUaGlzXG4gICAgLy8gaXMgYmVjYXVzZSB3ZSBjcmVhdGUgbWFueSBwcm9taXNlcyBmcm9tIGEgc2luZ2xlIElEQlJlcXVlc3QuXG4gICAgcmV2ZXJzZVRyYW5zZm9ybUNhY2hlLnNldChwcm9taXNlLCByZXF1ZXN0KTtcbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbih0eCkge1xuICAgIC8vIEVhcmx5IGJhaWwgaWYgd2UndmUgYWxyZWFkeSBjcmVhdGVkIGEgZG9uZSBwcm9taXNlIGZvciB0aGlzIHRyYW5zYWN0aW9uLlxuICAgIGlmICh0cmFuc2FjdGlvbkRvbmVNYXAuaGFzKHR4KSlcbiAgICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGRvbmUgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHVubGlzdGVuID0gKCkgPT4ge1xuICAgICAgICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7XG4gICAgICAgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgZXJyb3IpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBjb21wbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIHVubGlzdGVuKCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVycm9yID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KHR4LmVycm9yIHx8IG5ldyBET01FeGNlcHRpb24oJ0Fib3J0RXJyb3InLCAnQWJvcnRFcnJvcicpKTtcbiAgICAgICAgICAgIHVubGlzdGVuKCk7XG4gICAgICAgIH07XG4gICAgICAgIHR4LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbXBsZXRlJywgY29tcGxldGUpO1xuICAgICAgICB0eC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7XG4gICAgfSk7XG4gICAgLy8gQ2FjaGUgaXQgZm9yIGxhdGVyIHJldHJpZXZhbC5cbiAgICB0cmFuc2FjdGlvbkRvbmVNYXAuc2V0KHR4LCBkb25lKTtcbn1cbmxldCBpZGJQcm94eVRyYXBzID0ge1xuICAgIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7XG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBJREJUcmFuc2FjdGlvbikge1xuICAgICAgICAgICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgdHJhbnNhY3Rpb24uZG9uZS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnZG9uZScpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uRG9uZU1hcC5nZXQodGFyZ2V0KTtcbiAgICAgICAgICAgIC8vIFBvbHlmaWxsIGZvciBvYmplY3RTdG9yZU5hbWVzIGJlY2F1c2Ugb2YgRWRnZS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnb2JqZWN0U3RvcmVOYW1lcycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0Lm9iamVjdFN0b3JlTmFtZXMgfHwgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTWFrZSB0eC5zdG9yZSByZXR1cm4gdGhlIG9ubHkgc3RvcmUgaW4gdGhlIHRyYW5zYWN0aW9uLCBvciB1bmRlZmluZWQgaWYgdGhlcmUgYXJlIG1hbnkuXG4gICAgICAgICAgICBpZiAocHJvcCA9PT0gJ3N0b3JlJykge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzFdXG4gICAgICAgICAgICAgICAgICAgID8gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIDogcmVjZWl2ZXIub2JqZWN0U3RvcmUocmVjZWl2ZXIub2JqZWN0U3RvcmVOYW1lc1swXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gRWxzZSB0cmFuc2Zvcm0gd2hhdGV2ZXIgd2UgZ2V0IGJhY2suXG4gICAgICAgIHJldHVybiB3cmFwKHRhcmdldFtwcm9wXSk7XG4gICAgfSxcbiAgICBzZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSkge1xuICAgICAgICB0YXJnZXRbcHJvcF0gPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBoYXModGFyZ2V0LCBwcm9wKSB7XG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBJREJUcmFuc2FjdGlvbiAmJlxuICAgICAgICAgICAgKHByb3AgPT09ICdkb25lJyB8fCBwcm9wID09PSAnc3RvcmUnKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3AgaW4gdGFyZ2V0O1xuICAgIH0sXG59O1xuZnVuY3Rpb24gcmVwbGFjZVRyYXBzKGNhbGxiYWNrKSB7XG4gICAgaWRiUHJveHlUcmFwcyA9IGNhbGxiYWNrKGlkYlByb3h5VHJhcHMpO1xufVxuZnVuY3Rpb24gd3JhcEZ1bmN0aW9uKGZ1bmMpIHtcbiAgICAvLyBEdWUgdG8gZXhwZWN0ZWQgb2JqZWN0IGVxdWFsaXR5ICh3aGljaCBpcyBlbmZvcmNlZCBieSB0aGUgY2FjaGluZyBpbiBgd3JhcGApLCB3ZVxuICAgIC8vIG9ubHkgY3JlYXRlIG9uZSBuZXcgZnVuYyBwZXIgZnVuYy5cbiAgICAvLyBFZGdlIGRvZXNuJ3Qgc3VwcG9ydCBvYmplY3RTdG9yZU5hbWVzIChib29vKSwgc28gd2UgcG9seWZpbGwgaXQgaGVyZS5cbiAgICBpZiAoZnVuYyA9PT0gSURCRGF0YWJhc2UucHJvdG90eXBlLnRyYW5zYWN0aW9uICYmXG4gICAgICAgICEoJ29iamVjdFN0b3JlTmFtZXMnIGluIElEQlRyYW5zYWN0aW9uLnByb3RvdHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzdG9yZU5hbWVzLCAuLi5hcmdzKSB7XG4gICAgICAgICAgICBjb25zdCB0eCA9IGZ1bmMuY2FsbCh1bndyYXAodGhpcyksIHN0b3JlTmFtZXMsIC4uLmFyZ3MpO1xuICAgICAgICAgICAgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwLnNldCh0eCwgc3RvcmVOYW1lcy5zb3J0ID8gc3RvcmVOYW1lcy5zb3J0KCkgOiBbc3RvcmVOYW1lc10pO1xuICAgICAgICAgICAgcmV0dXJuIHdyYXAodHgpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvLyBDdXJzb3IgbWV0aG9kcyBhcmUgc3BlY2lhbCwgYXMgdGhlIGJlaGF2aW91ciBpcyBhIGxpdHRsZSBtb3JlIGRpZmZlcmVudCB0byBzdGFuZGFyZCBJREIuIEluXG4gICAgLy8gSURCLCB5b3UgYWR2YW5jZSB0aGUgY3Vyc29yIGFuZCB3YWl0IGZvciBhIG5ldyAnc3VjY2Vzcycgb24gdGhlIElEQlJlcXVlc3QgdGhhdCBnYXZlIHlvdSB0aGVcbiAgICAvLyBjdXJzb3IuIEl0J3Mga2luZGEgbGlrZSBhIHByb21pc2UgdGhhdCBjYW4gcmVzb2x2ZSB3aXRoIG1hbnkgdmFsdWVzLiBUaGF0IGRvZXNuJ3QgbWFrZSBzZW5zZVxuICAgIC8vIHdpdGggcmVhbCBwcm9taXNlcywgc28gZWFjaCBhZHZhbmNlIG1ldGhvZHMgcmV0dXJucyBhIG5ldyBwcm9taXNlIGZvciB0aGUgY3Vyc29yIG9iamVjdCwgb3JcbiAgICAvLyB1bmRlZmluZWQgaWYgdGhlIGVuZCBvZiB0aGUgY3Vyc29yIGhhcyBiZWVuIHJlYWNoZWQuXG4gICAgaWYgKGdldEN1cnNvckFkdmFuY2VNZXRob2RzKCkuaW5jbHVkZXMoZnVuYykpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlXG4gICAgICAgICAgICAvLyB0aGUgb3JpZ2luYWwgb2JqZWN0LlxuICAgICAgICAgICAgZnVuYy5hcHBseSh1bndyYXAodGhpcyksIGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHdyYXAoY3Vyc29yUmVxdWVzdE1hcC5nZXQodGhpcykpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgLy8gQ2FsbGluZyB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gd2l0aCB0aGUgcHJveHkgYXMgJ3RoaXMnIGNhdXNlcyBJTExFR0FMIElOVk9DQVRJT04sIHNvIHdlIHVzZVxuICAgICAgICAvLyB0aGUgb3JpZ2luYWwgb2JqZWN0LlxuICAgICAgICByZXR1cm4gd3JhcChmdW5jLmFwcGx5KHVud3JhcCh0aGlzKSwgYXJncykpO1xuICAgIH07XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm1DYWNoYWJsZVZhbHVlKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgcmV0dXJuIHdyYXBGdW5jdGlvbih2YWx1ZSk7XG4gICAgLy8gVGhpcyBkb2Vzbid0IHJldHVybiwgaXQganVzdCBjcmVhdGVzIGEgJ2RvbmUnIHByb21pc2UgZm9yIHRoZSB0cmFuc2FjdGlvbixcbiAgICAvLyB3aGljaCBpcyBsYXRlciByZXR1cm5lZCBmb3IgdHJhbnNhY3Rpb24uZG9uZSAoc2VlIGlkYk9iamVjdEhhbmRsZXIpLlxuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKVxuICAgICAgICBjYWNoZURvbmVQcm9taXNlRm9yVHJhbnNhY3Rpb24odmFsdWUpO1xuICAgIGlmIChpbnN0YW5jZU9mQW55KHZhbHVlLCBnZXRJZGJQcm94eWFibGVUeXBlcygpKSlcbiAgICAgICAgcmV0dXJuIG5ldyBQcm94eSh2YWx1ZSwgaWRiUHJveHlUcmFwcyk7XG4gICAgLy8gUmV0dXJuIHRoZSBzYW1lIHZhbHVlIGJhY2sgaWYgd2UncmUgbm90IGdvaW5nIHRvIHRyYW5zZm9ybSBpdC5cbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiB3cmFwKHZhbHVlKSB7XG4gICAgLy8gV2Ugc29tZXRpbWVzIGdlbmVyYXRlIG11bHRpcGxlIHByb21pc2VzIGZyb20gYSBzaW5nbGUgSURCUmVxdWVzdCAoZWcgd2hlbiBjdXJzb3JpbmcpLCBiZWNhdXNlXG4gICAgLy8gSURCIGlzIHdlaXJkIGFuZCBhIHNpbmdsZSBJREJSZXF1ZXN0IGNhbiB5aWVsZCBtYW55IHJlc3BvbnNlcywgc28gdGhlc2UgY2FuJ3QgYmUgY2FjaGVkLlxuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIElEQlJlcXVlc3QpXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KHZhbHVlKTtcbiAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IHRyYW5zZm9ybWVkIHRoaXMgdmFsdWUgYmVmb3JlLCByZXVzZSB0aGUgdHJhbnNmb3JtZWQgdmFsdWUuXG4gICAgLy8gVGhpcyBpcyBmYXN0ZXIsIGJ1dCBpdCBhbHNvIHByb3ZpZGVzIG9iamVjdCBlcXVhbGl0eS5cbiAgICBpZiAodHJhbnNmb3JtQ2FjaGUuaGFzKHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIHRyYW5zZm9ybUNhY2hlLmdldCh2YWx1ZSk7XG4gICAgY29uc3QgbmV3VmFsdWUgPSB0cmFuc2Zvcm1DYWNoYWJsZVZhbHVlKHZhbHVlKTtcbiAgICAvLyBOb3QgYWxsIHR5cGVzIGFyZSB0cmFuc2Zvcm1lZC5cbiAgICAvLyBUaGVzZSBtYXkgYmUgcHJpbWl0aXZlIHR5cGVzLCBzbyB0aGV5IGNhbid0IGJlIFdlYWtNYXAga2V5cy5cbiAgICBpZiAobmV3VmFsdWUgIT09IHZhbHVlKSB7XG4gICAgICAgIHRyYW5zZm9ybUNhY2hlLnNldCh2YWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KG5ld1ZhbHVlLCB2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdWYWx1ZTtcbn1cbmNvbnN0IHVud3JhcCA9ICh2YWx1ZSkgPT4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlLmdldCh2YWx1ZSk7XG5cbmV4cG9ydCB7IHJldmVyc2VUcmFuc2Zvcm1DYWNoZSBhcyBhLCBpbnN0YW5jZU9mQW55IGFzIGksIHJlcGxhY2VUcmFwcyBhcyByLCB1bndyYXAgYXMgdSwgd3JhcCBhcyB3IH07XG4iLCJpbXBvcnQgeyB3IGFzIHdyYXAsIHIgYXMgcmVwbGFjZVRyYXBzIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5leHBvcnQgeyB1IGFzIHVud3JhcCwgdyBhcyB3cmFwIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5cbi8qKlxuICogT3BlbiBhIGRhdGFiYXNlLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGRhdGFiYXNlLlxuICogQHBhcmFtIHZlcnNpb24gU2NoZW1hIHZlcnNpb24uXG4gKiBAcGFyYW0gY2FsbGJhY2tzIEFkZGl0aW9uYWwgY2FsbGJhY2tzLlxuICovXG5mdW5jdGlvbiBvcGVuREIobmFtZSwgdmVyc2lvbiwgeyBibG9ja2VkLCB1cGdyYWRlLCBibG9ja2luZywgdGVybWluYXRlZCB9ID0ge30pIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4obmFtZSwgdmVyc2lvbik7XG4gICAgY29uc3Qgb3BlblByb21pc2UgPSB3cmFwKHJlcXVlc3QpO1xuICAgIGlmICh1cGdyYWRlKSB7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigndXBncmFkZW5lZWRlZCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdXBncmFkZSh3cmFwKHJlcXVlc3QucmVzdWx0KSwgZXZlbnQub2xkVmVyc2lvbiwgZXZlbnQubmV3VmVyc2lvbiwgd3JhcChyZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoYmxvY2tlZClcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKCkgPT4gYmxvY2tlZCgpKTtcbiAgICBvcGVuUHJvbWlzZVxuICAgICAgICAudGhlbigoZGIpID0+IHtcbiAgICAgICAgaWYgKHRlcm1pbmF0ZWQpXG4gICAgICAgICAgICBkYi5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsICgpID0+IHRlcm1pbmF0ZWQoKSk7XG4gICAgICAgIGlmIChibG9ja2luZylcbiAgICAgICAgICAgIGRiLmFkZEV2ZW50TGlzdGVuZXIoJ3ZlcnNpb25jaGFuZ2UnLCAoKSA9PiBibG9ja2luZygpKTtcbiAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4geyB9KTtcbiAgICByZXR1cm4gb3BlblByb21pc2U7XG59XG4vKipcbiAqIERlbGV0ZSBhIGRhdGFiYXNlLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGRhdGFiYXNlLlxuICovXG5mdW5jdGlvbiBkZWxldGVEQihuYW1lLCB7IGJsb2NrZWQgfSA9IHt9KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShuYW1lKTtcbiAgICBpZiAoYmxvY2tlZClcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKCkgPT4gYmxvY2tlZCgpKTtcbiAgICByZXR1cm4gd3JhcChyZXF1ZXN0KS50aGVuKCgpID0+IHVuZGVmaW5lZCk7XG59XG5cbmNvbnN0IHJlYWRNZXRob2RzID0gWydnZXQnLCAnZ2V0S2V5JywgJ2dldEFsbCcsICdnZXRBbGxLZXlzJywgJ2NvdW50J107XG5jb25zdCB3cml0ZU1ldGhvZHMgPSBbJ3B1dCcsICdhZGQnLCAnZGVsZXRlJywgJ2NsZWFyJ107XG5jb25zdCBjYWNoZWRNZXRob2RzID0gbmV3IE1hcCgpO1xuZnVuY3Rpb24gZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkge1xuICAgIGlmICghKHRhcmdldCBpbnN0YW5jZW9mIElEQkRhdGFiYXNlICYmXG4gICAgICAgICEocHJvcCBpbiB0YXJnZXQpICYmXG4gICAgICAgIHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoY2FjaGVkTWV0aG9kcy5nZXQocHJvcCkpXG4gICAgICAgIHJldHVybiBjYWNoZWRNZXRob2RzLmdldChwcm9wKTtcbiAgICBjb25zdCB0YXJnZXRGdW5jTmFtZSA9IHByb3AucmVwbGFjZSgvRnJvbUluZGV4JC8sICcnKTtcbiAgICBjb25zdCB1c2VJbmRleCA9IHByb3AgIT09IHRhcmdldEZ1bmNOYW1lO1xuICAgIGNvbnN0IGlzV3JpdGUgPSB3cml0ZU1ldGhvZHMuaW5jbHVkZXModGFyZ2V0RnVuY05hbWUpO1xuICAgIGlmIChcbiAgICAvLyBCYWlsIGlmIHRoZSB0YXJnZXQgZG9lc24ndCBleGlzdCBvbiB0aGUgdGFyZ2V0LiBFZywgZ2V0QWxsIGlzbid0IGluIEVkZ2UuXG4gICAgISh0YXJnZXRGdW5jTmFtZSBpbiAodXNlSW5kZXggPyBJREJJbmRleCA6IElEQk9iamVjdFN0b3JlKS5wcm90b3R5cGUpIHx8XG4gICAgICAgICEoaXNXcml0ZSB8fCByZWFkTWV0aG9kcy5pbmNsdWRlcyh0YXJnZXRGdW5jTmFtZSkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWV0aG9kID0gYXN5bmMgZnVuY3Rpb24gKHN0b3JlTmFtZSwgLi4uYXJncykge1xuICAgICAgICAvLyBpc1dyaXRlID8gJ3JlYWR3cml0ZScgOiB1bmRlZmluZWQgZ3ppcHBzIGJldHRlciwgYnV0IGZhaWxzIGluIEVkZ2UgOihcbiAgICAgICAgY29uc3QgdHggPSB0aGlzLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgaXNXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5Jyk7XG4gICAgICAgIGxldCB0YXJnZXQgPSB0eC5zdG9yZTtcbiAgICAgICAgaWYgKHVzZUluZGV4KVxuICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LmluZGV4KGFyZ3Muc2hpZnQoKSk7XG4gICAgICAgIC8vIE11c3QgcmVqZWN0IGlmIG9wIHJlamVjdHMuXG4gICAgICAgIC8vIElmIGl0J3MgYSB3cml0ZSBvcGVyYXRpb24sIG11c3QgcmVqZWN0IGlmIHR4LmRvbmUgcmVqZWN0cy5cbiAgICAgICAgLy8gTXVzdCByZWplY3Qgd2l0aCBvcCByZWplY3Rpb24gZmlyc3QuXG4gICAgICAgIC8vIE11c3QgcmVzb2x2ZSB3aXRoIG9wIHZhbHVlLlxuICAgICAgICAvLyBNdXN0IGhhbmRsZSBib3RoIHByb21pc2VzIChubyB1bmhhbmRsZWQgcmVqZWN0aW9ucylcbiAgICAgICAgcmV0dXJuIChhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICB0YXJnZXRbdGFyZ2V0RnVuY05hbWVdKC4uLmFyZ3MpLFxuICAgICAgICAgICAgaXNXcml0ZSAmJiB0eC5kb25lLFxuICAgICAgICBdKSlbMF07XG4gICAgfTtcbiAgICBjYWNoZWRNZXRob2RzLnNldChwcm9wLCBtZXRob2QpO1xuICAgIHJldHVybiBtZXRob2Q7XG59XG5yZXBsYWNlVHJhcHMoKG9sZFRyYXBzKSA9PiAoe1xuICAgIC4uLm9sZFRyYXBzLFxuICAgIGdldDogKHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpID0+IGdldE1ldGhvZCh0YXJnZXQsIHByb3ApIHx8IG9sZFRyYXBzLmdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSxcbiAgICBoYXM6ICh0YXJnZXQsIHByb3ApID0+ICEhZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkgfHwgb2xkVHJhcHMuaGFzKHRhcmdldCwgcHJvcCksXG59KSk7XG5cbmV4cG9ydCB7IGRlbGV0ZURCLCBvcGVuREIgfTtcbiIsImltcG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50Q29udGFpbmVyIH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQgeyBMb2dnZXIsIHNldFVzZXJMb2dIYW5kbGVyLCBzZXRMb2dMZXZlbCBhcyBzZXRMb2dMZXZlbCQxIH0gZnJvbSAnQGZpcmViYXNlL2xvZ2dlcic7XG5pbXBvcnQgeyBFcnJvckZhY3RvcnksIGRlZXBFcXVhbCwgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcsIGlzSW5kZXhlZERCQXZhaWxhYmxlLCB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuZXhwb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IG9wZW5EQiB9IGZyb20gJ2lkYic7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwge1xyXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICB9XHJcbiAgICAvLyBJbiBpbml0aWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdpbGwgYmUgY2FsbGVkIGJ5IGluc3RhbGxhdGlvbnMgb25cclxuICAgIC8vIGF1dGggdG9rZW4gcmVmcmVzaCwgYW5kIGluc3RhbGxhdGlvbnMgd2lsbCBzZW5kIHRoaXMgc3RyaW5nLlxyXG4gICAgZ2V0UGxhdGZvcm1JbmZvU3RyaW5nKCkge1xyXG4gICAgICAgIGNvbnN0IHByb3ZpZGVycyA9IHRoaXMuY29udGFpbmVyLmdldFByb3ZpZGVycygpO1xyXG4gICAgICAgIC8vIExvb3AgdGhyb3VnaCBwcm92aWRlcnMgYW5kIGdldCBsaWJyYXJ5L3ZlcnNpb24gcGFpcnMgZnJvbSBhbnkgdGhhdCBhcmVcclxuICAgICAgICAvLyB2ZXJzaW9uIGNvbXBvbmVudHMuXHJcbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyc1xyXG4gICAgICAgICAgICAubWFwKHByb3ZpZGVyID0+IHtcclxuICAgICAgICAgICAgaWYgKGlzVmVyc2lvblNlcnZpY2VQcm92aWRlcihwcm92aWRlcikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBwcm92aWRlci5nZXRJbW1lZGlhdGUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHtzZXJ2aWNlLmxpYnJhcnl9LyR7c2VydmljZS52ZXJzaW9ufWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5maWx0ZXIobG9nU3RyaW5nID0+IGxvZ1N0cmluZylcclxuICAgICAgICAgICAgLmpvaW4oJyAnKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIHByb3ZpZGVyIGNoZWNrIGlmIHRoaXMgcHJvdmlkZXIgcHJvdmlkZXMgYSBWZXJzaW9uU2VydmljZVxyXG4gKlxyXG4gKiBOT1RFOiBVc2luZyBQcm92aWRlcjwnYXBwLXZlcnNpb24nPiBpcyBhIGhhY2sgdG8gaW5kaWNhdGUgdGhhdCB0aGUgcHJvdmlkZXJcclxuICogcHJvdmlkZXMgVmVyc2lvblNlcnZpY2UuIFRoZSBwcm92aWRlciBpcyBub3QgbmVjZXNzYXJpbHkgYSAnYXBwLXZlcnNpb24nXHJcbiAqIHByb3ZpZGVyLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyKHByb3ZpZGVyKSB7XHJcbiAgICBjb25zdCBjb21wb25lbnQgPSBwcm92aWRlci5nZXRDb21wb25lbnQoKTtcclxuICAgIHJldHVybiAoY29tcG9uZW50ID09PSBudWxsIHx8IGNvbXBvbmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29tcG9uZW50LnR5cGUpID09PSBcIlZFUlNJT05cIiAvKiBWRVJTSU9OICovO1xyXG59XG5cbmNvbnN0IG5hbWUkbyA9IFwiQGZpcmViYXNlL2FwcFwiO1xuY29uc3QgdmVyc2lvbiQxID0gXCIwLjcuMjVcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcignQGZpcmViYXNlL2FwcCcpO1xuXG5jb25zdCBuYW1lJG4gPSBcIkBmaXJlYmFzZS9hcHAtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbSA9IFwiQGZpcmViYXNlL2FuYWx5dGljcy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRsID0gXCJAZmlyZWJhc2UvYW5hbHl0aWNzXCI7XG5cbmNvbnN0IG5hbWUkayA9IFwiQGZpcmViYXNlL2FwcC1jaGVjay1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRqID0gXCJAZmlyZWJhc2UvYXBwLWNoZWNrXCI7XG5cbmNvbnN0IG5hbWUkaSA9IFwiQGZpcmViYXNlL2F1dGhcIjtcblxuY29uc3QgbmFtZSRoID0gXCJAZmlyZWJhc2UvYXV0aC1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRnID0gXCJAZmlyZWJhc2UvZGF0YWJhc2VcIjtcblxuY29uc3QgbmFtZSRmID0gXCJAZmlyZWJhc2UvZGF0YWJhc2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkZSA9IFwiQGZpcmViYXNlL2Z1bmN0aW9uc1wiO1xuXG5jb25zdCBuYW1lJGQgPSBcIkBmaXJlYmFzZS9mdW5jdGlvbnMtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkYyA9IFwiQGZpcmViYXNlL2luc3RhbGxhdGlvbnNcIjtcblxuY29uc3QgbmFtZSRiID0gXCJAZmlyZWJhc2UvaW5zdGFsbGF0aW9ucy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRhID0gXCJAZmlyZWJhc2UvbWVzc2FnaW5nXCI7XG5cbmNvbnN0IG5hbWUkOSA9IFwiQGZpcmViYXNlL21lc3NhZ2luZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ4ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2VcIjtcblxuY29uc3QgbmFtZSQ3ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkNiA9IFwiQGZpcmViYXNlL3JlbW90ZS1jb25maWdcIjtcblxuY29uc3QgbmFtZSQ1ID0gXCJAZmlyZWJhc2UvcmVtb3RlLWNvbmZpZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ0ID0gXCJAZmlyZWJhc2Uvc3RvcmFnZVwiO1xuXG5jb25zdCBuYW1lJDMgPSBcIkBmaXJlYmFzZS9zdG9yYWdlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDIgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmVcIjtcblxuY29uc3QgbmFtZSQxID0gXCJAZmlyZWJhc2UvZmlyZXN0b3JlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lID0gXCJmaXJlYmFzZVwiO1xuY29uc3QgdmVyc2lvbiA9IFwiOS44LjJcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGFwcCBuYW1lXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XHJcbmNvbnN0IFBMQVRGT1JNX0xPR19TVFJJTkcgPSB7XHJcbiAgICBbbmFtZSRvXTogJ2ZpcmUtY29yZScsXHJcbiAgICBbbmFtZSRuXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxyXG4gICAgW25hbWUkbF06ICdmaXJlLWFuYWx5dGljcycsXHJcbiAgICBbbmFtZSRtXTogJ2ZpcmUtYW5hbHl0aWNzLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRqXTogJ2ZpcmUtYXBwLWNoZWNrJyxcclxuICAgIFtuYW1lJGtdOiAnZmlyZS1hcHAtY2hlY2stY29tcGF0JyxcclxuICAgIFtuYW1lJGldOiAnZmlyZS1hdXRoJyxcclxuICAgIFtuYW1lJGhdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRnXTogJ2ZpcmUtcnRkYicsXHJcbiAgICBbbmFtZSRmXTogJ2ZpcmUtcnRkYi1jb21wYXQnLFxyXG4gICAgW25hbWUkZV06ICdmaXJlLWZuJyxcclxuICAgIFtuYW1lJGRdOiAnZmlyZS1mbi1jb21wYXQnLFxyXG4gICAgW25hbWUkY106ICdmaXJlLWlpZCcsXHJcbiAgICBbbmFtZSRiXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRhXTogJ2ZpcmUtZmNtJyxcclxuICAgIFtuYW1lJDldOiAnZmlyZS1mY20tY29tcGF0JyxcclxuICAgIFtuYW1lJDhdOiAnZmlyZS1wZXJmJyxcclxuICAgIFtuYW1lJDddOiAnZmlyZS1wZXJmLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ2XTogJ2ZpcmUtcmMnLFxyXG4gICAgW25hbWUkNV06ICdmaXJlLXJjLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ0XTogJ2ZpcmUtZ2NzJyxcclxuICAgIFtuYW1lJDNdOiAnZmlyZS1nY3MtY29tcGF0JyxcclxuICAgIFtuYW1lJDJdOiAnZmlyZS1mc3QnLFxyXG4gICAgW25hbWUkMV06ICdmaXJlLWZzdC1jb21wYXQnLFxyXG4gICAgJ2ZpcmUtanMnOiAnZmlyZS1qcycsXHJcbiAgICBbbmFtZV06ICdmaXJlLWpzLWFsbCdcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgX2FwcHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBSZWdpc3RlcmVkIGNvbXBvbmVudHMuXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY29uc3QgX2NvbXBvbmVudHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCBiZWluZyBhZGRlZCB0byB0aGlzIGFwcCdzIGNvbnRhaW5lclxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLCBlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIGFwcC5jb250YWluZXIuYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXJcclxuICogQHJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnQubmFtZTtcclxuICAgIGlmIChfY29tcG9uZW50cy5oYXMoY29tcG9uZW50TmFtZSkpIHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoYFRoZXJlIHdlcmUgbXVsdGlwbGUgYXR0ZW1wdHMgdG8gcmVnaXN0ZXIgY29tcG9uZW50ICR7Y29tcG9uZW50TmFtZX0uYCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgX2NvbXBvbmVudHMuc2V0KGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudCk7XHJcbiAgICAvLyBhZGQgdGhlIGNvbXBvbmVudCB0byBleGlzdGluZyBhcHAgaW5zdGFuY2VzXHJcbiAgICBmb3IgKGNvbnN0IGFwcCBvZiBfYXBwcy52YWx1ZXMoKSkge1xyXG4gICAgICAgIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBGaXJlYmFzZUFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB0aGUgcHJvdmlkZXIgZm9yIHRoZSBzZXJ2aWNlIHdpdGggdGhlIG1hdGNoaW5nIG5hbWVcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKSB7XHJcbiAgICBjb25zdCBoZWFydGJlYXRDb250cm9sbGVyID0gYXBwLmNvbnRhaW5lclxyXG4gICAgICAgIC5nZXRQcm92aWRlcignaGVhcnRiZWF0JylcclxuICAgICAgICAuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XHJcbiAgICBpZiAoaGVhcnRiZWF0Q29udHJvbGxlcikge1xyXG4gICAgICAgIHZvaWQgaGVhcnRiZWF0Q29udHJvbGxlci50cmlnZ2VySGVhcnRiZWF0KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXBwLmNvbnRhaW5lci5nZXRQcm92aWRlcihuYW1lKTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSBuYW1lIC0gc2VydmljZSBuYW1lXHJcbiAqIEBwYXJhbSBpbnN0YW5jZUlkZW50aWZpZXIgLSBzZXJ2aWNlIGluc3RhbmNlIGlkZW50aWZpZXIgaW4gY2FzZSB0aGUgc2VydmljZSBzdXBwb3J0cyBtdWx0aXBsZSBpbnN0YW5jZXNcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKGFwcCwgbmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKS5jbGVhckluc3RhbmNlKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbn1cclxuLyoqXHJcbiAqIFRlc3Qgb25seVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9jbGVhckNvbXBvbmVudHMoKSB7XHJcbiAgICBfY29tcG9uZW50cy5jbGVhcigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IEVSUk9SUyA9IHtcclxuICAgIFtcIm5vLWFwcFwiIC8qIE5PX0FQUCAqL106IFwiTm8gRmlyZWJhc2UgQXBwICd7JGFwcE5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xyXG4gICAgICAgICdjYWxsIEZpcmViYXNlIEFwcC5pbml0aWFsaXplQXBwKCknLFxyXG4gICAgW1wiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovXTogXCJJbGxlZ2FsIEFwcCBuYW1lOiAneyRhcHBOYW1lfVwiLFxyXG4gICAgW1wiZHVwbGljYXRlLWFwcFwiIC8qIERVUExJQ0FURV9BUFAgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBleGlzdHMgd2l0aCBkaWZmZXJlbnQgb3B0aW9ucyBvciBjb25maWdcIixcclxuICAgIFtcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXHJcbiAgICBbXCJpbnZhbGlkLWFwcC1hcmd1bWVudFwiIC8qIElOVkFMSURfQVBQX0FSR1VNRU5UICovXTogJ2ZpcmViYXNlLnskYXBwTmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcclxuICAgICAgICAnRmlyZWJhc2UgQXBwIGluc3RhbmNlLicsXHJcbiAgICBbXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovXTogJ0ZpcnN0IGFyZ3VtZW50IHRvIGBvbkxvZ2AgbXVzdCBiZSBudWxsIG9yIGEgZnVuY3Rpb24uJyxcclxuICAgIFtcInN0b3JhZ2Utb3BlblwiIC8qIFNUT1JBR0VfT1BFTiAqL106ICdFcnJvciB0aHJvd24gd2hlbiBvcGVuaW5nIHN0b3JhZ2UuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxyXG4gICAgW1wic3RvcmFnZS1nZXRcIiAvKiBTVE9SQUdFX0dFVCAqL106ICdFcnJvciB0aHJvd24gd2hlbiByZWFkaW5nIGZyb20gc3RvcmFnZS4gT3JpZ2luYWwgZXJyb3I6IHskb3JpZ2luYWxFcnJvck1lc3NhZ2V9LicsXHJcbiAgICBbXCJzdG9yYWdlLXNldFwiIC8qIFNUT1JBR0VfV1JJVEUgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gd3JpdGluZyB0byBzdG9yYWdlLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcclxuICAgIFtcInN0b3JhZ2UtZGVsZXRlXCIgLyogU1RPUkFHRV9ERUxFVEUgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gZGVsZXRpbmcgZnJvbSBzdG9yYWdlLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJ1xyXG59O1xyXG5jb25zdCBFUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXBwJywgJ0ZpcmViYXNlJywgRVJST1JTKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgRmlyZWJhc2VBcHBJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9XHJcbiAgICAgICAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENvbXBvbmVudChuZXcgQ29tcG9uZW50KCdhcHAnLCAoKSA9PiB0aGlzLCBcIlBVQkxJQ1wiIC8qIFBVQkxJQyAqLykpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDtcclxuICAgIH1cclxuICAgIHNldCBhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBuYW1lKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcclxuICAgIH1cclxuICAgIGdldCBvcHRpb25zKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcclxuICAgIH1cclxuICAgIGdldCBjb25maWcoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWc7XHJcbiAgICB9XHJcbiAgICBnZXQgY29udGFpbmVyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNEZWxldGVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0RlbGV0ZWQ7XHJcbiAgICB9XHJcbiAgICBzZXQgaXNEZWxldGVkKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2lzRGVsZXRlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cclxuICAgICAqIHVzZSBiZWZvcmUgcGVyZm9ybWluZyBBUEkgYWN0aW9ucyBvbiB0aGUgQXBwLlxyXG4gICAgICovXHJcbiAgICBjaGVja0Rlc3Ryb3llZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJhcHAtZGVsZXRlZFwiIC8qIEFQUF9ERUxFVEVEICovLCB7IGFwcE5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgY3VycmVudCBTREsgdmVyc2lvbi5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgU0RLX1ZFUlNJT04gPSB2ZXJzaW9uO1xyXG5mdW5jdGlvbiBpbml0aWFsaXplQXBwKG9wdGlvbnMsIHJhd0NvbmZpZyA9IHt9KSB7XHJcbiAgICBpZiAodHlwZW9mIHJhd0NvbmZpZyAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICBjb25zdCBuYW1lID0gcmF3Q29uZmlnO1xyXG4gICAgICAgIHJhd0NvbmZpZyA9IHsgbmFtZSB9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29uZmlnID0gT2JqZWN0LmFzc2lnbih7IG5hbWU6IERFRkFVTFRfRU5UUllfTkFNRSwgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkOiBmYWxzZSB9LCByYXdDb25maWcpO1xyXG4gICAgY29uc3QgbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xyXG4gICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovLCB7XHJcbiAgICAgICAgICAgIGFwcE5hbWU6IFN0cmluZyhuYW1lKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZXhpc3RpbmdBcHAgPSBfYXBwcy5nZXQobmFtZSk7XHJcbiAgICBpZiAoZXhpc3RpbmdBcHApIHtcclxuICAgICAgICAvLyByZXR1cm4gdGhlIGV4aXN0aW5nIGFwcCBpZiBvcHRpb25zIGFuZCBjb25maWcgZGVlcCBlcXVhbCB0aGUgb25lcyBpbiB0aGUgZXhpc3RpbmcgYXBwLlxyXG4gICAgICAgIGlmIChkZWVwRXF1YWwob3B0aW9ucywgZXhpc3RpbmdBcHAub3B0aW9ucykgJiZcclxuICAgICAgICAgICAgZGVlcEVxdWFsKGNvbmZpZywgZXhpc3RpbmdBcHAuY29uZmlnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdBcHA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImR1cGxpY2F0ZS1hcHBcIiAvKiBEVVBMSUNBVEVfQVBQICovLCB7IGFwcE5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbXBvbmVudENvbnRhaW5lcihuYW1lKTtcclxuICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIF9jb21wb25lbnRzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmFkZENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmV3QXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBjb25maWcsIGNvbnRhaW5lcik7XHJcbiAgICBfYXBwcy5zZXQobmFtZSwgbmV3QXBwKTtcclxuICAgIHJldHVybiBuZXdBcHA7XHJcbn1cclxuLyoqXHJcbiAqIFJldHJpZXZlcyBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZS5cclxuICpcclxuICogV2hlbiBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHMsIHRoZSBkZWZhdWx0IGFwcCBpcyByZXR1cm5lZC4gV2hlbiBhbiBhcHAgbmFtZVxyXG4gKiBpcyBwcm92aWRlZCwgdGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoYXQgbmFtZSBpcyByZXR1cm5lZC5cclxuICpcclxuICogQW4gZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGUgYXBwIGJlaW5nIHJldHJpZXZlZCBoYXMgbm90IHlldCBiZWVuXHJcbiAqIGluaXRpYWxpemVkLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiB0aGUgZGVmYXVsdCBhcHBcclxuICogY29uc3QgYXBwID0gZ2V0QXBwKCk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiBhIG5hbWVkIGFwcFxyXG4gKiBjb25zdCBvdGhlckFwcCA9IGdldEFwcChcIm90aGVyQXBwXCIpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIG5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBhcHAgdG8gcmV0dXJuLiBJZiBubyBuYW1lIGlzXHJcbiAqICAgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IGlzIGBcIltERUZBVUxUXVwiYC5cclxuICpcclxuICogQHJldHVybnMgVGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm92aWRlZCBhcHAgbmFtZS5cclxuICogICBJZiBubyBhcHAgbmFtZSBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgYXBwIGlzIHJldHVybmVkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBcHAobmFtZSA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xyXG4gICAgY29uc3QgYXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcIm5vLWFwcFwiIC8qIE5PX0FQUCAqLywgeyBhcHBOYW1lOiBuYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFwcDtcclxufVxyXG4vKipcclxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXBwcygpIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKF9hcHBzLnZhbHVlcygpKTtcclxufVxyXG4vKipcclxuICogUmVuZGVycyB0aGlzIGFwcCB1bnVzYWJsZSBhbmQgZnJlZXMgdGhlIHJlc291cmNlcyBvZiBhbGwgYXNzb2NpYXRlZFxyXG4gKiBzZXJ2aWNlcy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBkZWxldGVBcHAoYXBwKVxyXG4gKiAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coXCJBcHAgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbiAqICAgfSlcclxuICogICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICogICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVsZXRpbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAqICAgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwKSB7XHJcbiAgICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XHJcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgX2FwcHMuZGVsZXRlKG5hbWUpO1xyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGFwcC5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4gcHJvdmlkZXIuZGVsZXRlKCkpKTtcclxuICAgICAgICBhcHAuaXNEZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXHJcbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXHJcbiAqIEBwYXJhbSB2ZXJzaW9uIC0gQ3VycmVudCB2ZXJzaW9uIG9mIHRoYXQgbGlicmFyeS5cclxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJWZXJzaW9uKGxpYnJhcnlLZXlPck5hbWUsIHZlcnNpb24sIHZhcmlhbnQpIHtcclxuICAgIHZhciBfYTtcclxuICAgIC8vIFRPRE86IFdlIGNhbiB1c2UgdGhpcyBjaGVjayB0byB3aGl0ZWxpc3Qgc3RyaW5ncyB3aGVuL2lmIHdlIHNldCB1cFxyXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXHJcbiAgICBsZXQgbGlicmFyeSA9IChfYSA9IFBMQVRGT1JNX0xPR19TVFJJTkdbbGlicmFyeUtleU9yTmFtZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxpYnJhcnlLZXlPck5hbWU7XHJcbiAgICBpZiAodmFyaWFudCkge1xyXG4gICAgICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpYnJhcnlNaXNtYXRjaCA9IGxpYnJhcnkubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgd2FybmluZyA9IFtcclxuICAgICAgICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgbGlicmFyeSBuYW1lIFwiJHtsaWJyYXJ5fVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCAmJiB2ZXJzaW9uTWlzbWF0Y2gpIHtcclxuICAgICAgICAgICAgd2FybmluZy5wdXNoKCdhbmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZlcnNpb25NaXNtYXRjaCkge1xyXG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goYHZlcnNpb24gbmFtZSBcIiR7dmVyc2lvbn1cIiBjb250YWlucyBpbGxlZ2FsIGNoYXJhY3RlcnMgKHdoaXRlc3BhY2Ugb3IgXCIvXCIpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChgJHtsaWJyYXJ5fS12ZXJzaW9uYCwgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSwgXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLykpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cclxuICogQHBhcmFtIGxvZ0NhbGxiYWNrIC0gQW4gb3B0aW9uYWwgY3VzdG9tIGxvZyBoYW5kbGVyIHRoYXQgZXhlY3V0ZXMgdXNlciBjb2RlIHdoZW5ldmVyXHJcbiAqIHRoZSBGaXJlYmFzZSBTREsgbWFrZXMgYSBsb2dnaW5nIGNhbGwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIG9uTG9nKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBpZiAobG9nQ2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGxvZ0NhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovKTtcclxuICAgIH1cclxuICAgIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKTtcclxufVxyXG4vKipcclxuICogU2V0cyBsb2cgbGV2ZWwgZm9yIGFsbCBGaXJlYmFzZSBTREtzLlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgYXJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgaW5mb2AsIGVycm9ycyBhcmUgbG9nZ2VkLCBidXQgYGRlYnVnYCBhbmRcclxuICogYHZlcmJvc2VgIGxvZ3MgYXJlIG5vdCkuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxvZ0xldmVsKSB7XHJcbiAgICBzZXRMb2dMZXZlbCQxKGxvZ0xldmVsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBEQl9OQU1FID0gJ2ZpcmViYXNlLWhlYXJ0YmVhdC1kYXRhYmFzZSc7XHJcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xyXG5jb25zdCBTVE9SRV9OQU1FID0gJ2ZpcmViYXNlLWhlYXJ0YmVhdC1zdG9yZSc7XHJcbmxldCBkYlByb21pc2UgPSBudWxsO1xyXG5mdW5jdGlvbiBnZXREYlByb21pc2UoKSB7XHJcbiAgICBpZiAoIWRiUHJvbWlzZSkge1xyXG4gICAgICAgIGRiUHJvbWlzZSA9IG9wZW5EQihEQl9OQU1FLCBEQl9WRVJTSU9OLCB7XHJcbiAgICAgICAgICAgIHVwZ3JhZGU6IChkYiwgb2xkVmVyc2lvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgdXNlICdicmVhaycgaW4gdGhpcyBzd2l0Y2ggc3RhdGVtZW50LCB0aGUgZmFsbC10aHJvdWdoXHJcbiAgICAgICAgICAgICAgICAvLyBiZWhhdmlvciBpcyB3aGF0IHdlIHdhbnQsIGJlY2F1c2UgaWYgdGhlcmUgYXJlIG11bHRpcGxlIHZlcnNpb25zIGJldHdlZW5cclxuICAgICAgICAgICAgICAgIC8vIHRoZSBvbGQgdmVyc2lvbiBhbmQgdGhlIGN1cnJlbnQgdmVyc2lvbiwgd2Ugd2FudCBBTEwgdGhlIG1pZ3JhdGlvbnNcclxuICAgICAgICAgICAgICAgIC8vIHRoYXQgY29ycmVzcG9uZCB0byB0aG9zZSB2ZXJzaW9ucyB0byBydW4sIG5vdCBvbmx5IHRoZSBsYXN0IG9uZS5cclxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZWZhdWx0LWNhc2VcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAob2xkVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoU1RPUkVfTkFNRSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJzdG9yYWdlLW9wZW5cIiAvKiBTVE9SQUdFX09QRU4gKi8sIHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlLm1lc3NhZ2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGJQcm9taXNlO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQihhcHApIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcclxuICAgICAgICByZXR1cm4gZGJcclxuICAgICAgICAgICAgLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUpXHJcbiAgICAgICAgICAgIC5vYmplY3RTdG9yZShTVE9SRV9OQU1FKVxyXG4gICAgICAgICAgICAuZ2V0KGNvbXB1dGVLZXkoYXBwKSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwic3RvcmFnZS1nZXRcIiAvKiBTVE9SQUdFX0dFVCAqLywge1xyXG4gICAgICAgICAgICBvcmlnaW5hbEVycm9yTWVzc2FnZTogZS5tZXNzYWdlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gd3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIoYXBwLCBoZWFydGJlYXRPYmplY3QpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcclxuICAgICAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFNUT1JFX05BTUUpO1xyXG4gICAgICAgIGF3YWl0IG9iamVjdFN0b3JlLnB1dChoZWFydGJlYXRPYmplY3QsIGNvbXB1dGVLZXkoYXBwKSk7XHJcbiAgICAgICAgcmV0dXJuIHR4LmRvbmU7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwic3RvcmFnZS1zZXRcIiAvKiBTVE9SQUdFX1dSSVRFICovLCB7XHJcbiAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlLm1lc3NhZ2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjb21wdXRlS2V5KGFwcCkge1xyXG4gICAgcmV0dXJuIGAke2FwcC5uYW1lfSEke2FwcC5vcHRpb25zLmFwcElkfWA7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgTUFYX0hFQURFUl9CWVRFUyA9IDEwMjQ7XHJcbi8vIDMwIGRheXNcclxuY29uc3QgU1RPUkVEX0hFQVJUQkVBVF9SRVRFTlRJT05fTUFYX01JTExJUyA9IDMwICogMjQgKiA2MCAqIDYwICogMTAwMDtcclxuY2xhc3MgSGVhcnRiZWF0U2VydmljZUltcGwge1xyXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSW4tbWVtb3J5IGNhY2hlIGZvciBoZWFydGJlYXRzLCB1c2VkIGJ5IGdldEhlYXJ0YmVhdHNIZWFkZXIoKSB0byBnZW5lcmF0ZVxyXG4gICAgICAgICAqIHRoZSBoZWFkZXIgc3RyaW5nLlxyXG4gICAgICAgICAqIFN0b3JlcyBvbmUgcmVjb3JkIHBlciBkYXRlLiBUaGlzIHdpbGwgYmUgY29uc29saWRhdGVkIGludG8gdGhlIHN0YW5kYXJkXHJcbiAgICAgICAgICogZm9ybWF0IG9mIG9uZSByZWNvcmQgcGVyIHVzZXIgYWdlbnQgc3RyaW5nIGJlZm9yZSBiZWluZyBzZW50IGFzIGEgaGVhZGVyLlxyXG4gICAgICAgICAqIFBvcHVsYXRlZCBmcm9tIGluZGV4ZWREQiB3aGVuIHRoZSBjb250cm9sbGVyIGlzIGluc3RhbnRpYXRlZCBhbmQgc2hvdWxkXHJcbiAgICAgICAgICogYmUga2VwdCBpbiBzeW5jIHdpdGggaW5kZXhlZERCLlxyXG4gICAgICAgICAqIExlYXZlIHB1YmxpYyBmb3IgZWFzaWVyIHRlc3RpbmcuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlID0gbnVsbDtcclxuICAgICAgICBjb25zdCBhcHAgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwJykuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgdGhpcy5fc3RvcmFnZSA9IG5ldyBIZWFydGJlYXRTdG9yYWdlSW1wbChhcHApO1xyXG4gICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2UgPSB0aGlzLl9zdG9yYWdlLnJlYWQoKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHRvIHJlcG9ydCBhIGhlYXJ0YmVhdC4gVGhlIGZ1bmN0aW9uIHdpbGwgZ2VuZXJhdGVcclxuICAgICAqIGEgSGVhcnRiZWF0c0J5VXNlckFnZW50IG9iamVjdCwgdXBkYXRlIGhlYXJ0YmVhdHNDYWNoZSwgYW5kIHBlcnNpc3QgaXRcclxuICAgICAqIHRvIEluZGV4ZWREQi5cclxuICAgICAqIE5vdGUgdGhhdCB3ZSBvbmx5IHN0b3JlIG9uZSBoZWFydGJlYXQgcGVyIGRheS4gU28gaWYgYSBoZWFydGJlYXQgZm9yIHRvZGF5IGlzXHJcbiAgICAgKiBhbHJlYWR5IGxvZ2dlZCwgc3Vic2VxdWVudCBjYWxscyB0byB0aGlzIGZ1bmN0aW9uIGluIHRoZSBzYW1lIGRheSB3aWxsIGJlIGlnbm9yZWQuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHRyaWdnZXJIZWFydGJlYXQoKSB7XHJcbiAgICAgICAgY29uc3QgcGxhdGZvcm1Mb2dnZXIgPSB0aGlzLmNvbnRhaW5lclxyXG4gICAgICAgICAgICAuZ2V0UHJvdmlkZXIoJ3BsYXRmb3JtLWxvZ2dlcicpXHJcbiAgICAgICAgICAgIC5nZXRJbW1lZGlhdGUoKTtcclxuICAgICAgICAvLyBUaGlzIGlzIHRoZSBcIkZpcmViYXNlIHVzZXIgYWdlbnRcIiBzdHJpbmcgZnJvbSB0aGUgcGxhdGZvcm0gbG9nZ2VyXHJcbiAgICAgICAgLy8gc2VydmljZSwgbm90IHRoZSBicm93c2VyIHVzZXIgYWdlbnQuXHJcbiAgICAgICAgY29uc3QgYWdlbnQgPSBwbGF0Zm9ybUxvZ2dlci5nZXRQbGF0Zm9ybUluZm9TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBkYXRlID0gZ2V0VVRDRGF0ZVN0cmluZygpO1xyXG4gICAgICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlID0gYXdhaXQgdGhpcy5faGVhcnRiZWF0c0NhY2hlUHJvbWlzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRG8gbm90IHN0b3JlIGEgaGVhcnRiZWF0IGlmIG9uZSBpcyBhbHJlYWR5IHN0b3JlZCBmb3IgdGhpcyBkYXlcclxuICAgICAgICAvLyBvciBpZiBhIGhlYWRlciBoYXMgYWxyZWFkeSBiZWVuIHNlbnQgdG9kYXkuXHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5sYXN0U2VudEhlYXJ0YmVhdERhdGUgPT09IGRhdGUgfHxcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMuc29tZShzaW5nbGVEYXRlSGVhcnRiZWF0ID0+IHNpbmdsZURhdGVIZWFydGJlYXQuZGF0ZSA9PT0gZGF0ZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUgaXMgbm8gZW50cnkgZm9yIHRoaXMgZGF0ZS4gQ3JlYXRlIG9uZS5cclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMucHVzaCh7IGRhdGUsIGFnZW50IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBSZW1vdmUgZW50cmllcyBvbGRlciB0aGFuIDMwIGRheXMuXHJcbiAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cy5maWx0ZXIoc2luZ2xlRGF0ZUhlYXJ0YmVhdCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGhiVGltZXN0YW1wID0gbmV3IERhdGUoc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlKS52YWx1ZU9mKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBub3cgLSBoYlRpbWVzdGFtcCA8PSBTVE9SRURfSEVBUlRCRUFUX1JFVEVOVElPTl9NQVhfTUlMTElTO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zdG9yYWdlLm92ZXJ3cml0ZSh0aGlzLl9oZWFydGJlYXRzQ2FjaGUpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgYmFzZTY0IGVuY29kZWQgc3RyaW5nIHdoaWNoIGNhbiBiZSBhdHRhY2hlZCB0byB0aGUgaGVhcnRiZWF0LXNwZWNpZmljIGhlYWRlciBkaXJlY3RseS5cclxuICAgICAqIEl0IGFsc28gY2xlYXJzIGFsbCBoZWFydGJlYXRzIGZyb20gbWVtb3J5IGFzIHdlbGwgYXMgaW4gSW5kZXhlZERCLlxyXG4gICAgICpcclxuICAgICAqIE5PVEU6IENvbnN1bWluZyBwcm9kdWN0IFNES3Mgc2hvdWxkIG5vdCBzZW5kIHRoZSBoZWFkZXIgaWYgdGhpcyBtZXRob2RcclxuICAgICAqIHJldHVybnMgYW4gZW1wdHkgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBnZXRIZWFydGJlYXRzSGVhZGVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5faGVhcnRiZWF0c0NhY2hlUHJvbWlzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgaXQncyBzdGlsbCBudWxsIG9yIHRoZSBhcnJheSBpcyBlbXB0eSwgdGhlcmUgaXMgbm8gZGF0YSB0byBzZW5kLlxyXG4gICAgICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPT09IG51bGwgfHxcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IGdldFVUQ0RhdGVTdHJpbmcoKTtcclxuICAgICAgICAvLyBFeHRyYWN0IGFzIG1hbnkgaGVhcnRiZWF0cyBmcm9tIHRoZSBjYWNoZSBhcyB3aWxsIGZpdCB1bmRlciB0aGUgc2l6ZSBsaW1pdC5cclxuICAgICAgICBjb25zdCB7IGhlYXJ0YmVhdHNUb1NlbmQsIHVuc2VudEVudHJpZXMgfSA9IGV4dHJhY3RIZWFydGJlYXRzRm9ySGVhZGVyKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJTdHJpbmcgPSBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeSh7IHZlcnNpb246IDIsIGhlYXJ0YmVhdHM6IGhlYXJ0YmVhdHNUb1NlbmQgfSkpO1xyXG4gICAgICAgIC8vIFN0b3JlIGxhc3Qgc2VudCBkYXRlIHRvIHByZXZlbnQgYW5vdGhlciBiZWluZyBsb2dnZWQvc2VudCBmb3IgdGhlIHNhbWUgZGF5LlxyXG4gICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5sYXN0U2VudEhlYXJ0YmVhdERhdGUgPSBkYXRlO1xyXG4gICAgICAgIGlmICh1bnNlbnRFbnRyaWVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gU3RvcmUgYW55IHVuc2VudCBlbnRyaWVzIGlmIHRoZXkgZXhpc3QuXHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzID0gdW5zZW50RW50cmllcztcclxuICAgICAgICAgICAgLy8gVGhpcyBzZWVtcyBtb3JlIGxpa2VseSB0aGFuIGVtcHR5aW5nIHRoZSBhcnJheSAoYmVsb3cpIHRvIGxlYWQgdG8gc29tZSBvZGQgc3RhdGVcclxuICAgICAgICAgICAgLy8gc2luY2UgdGhlIGNhY2hlIGlzbid0IGVtcHR5IGFuZCB0aGlzIHdpbGwgYmUgY2FsbGVkIGFnYWluIG9uIHRoZSBuZXh0IHJlcXVlc3QsXHJcbiAgICAgICAgICAgIC8vIGFuZCBpcyBwcm9iYWJseSBzYWZlc3QgaWYgd2UgYXdhaXQgaXQuXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cyA9IFtdO1xyXG4gICAgICAgICAgICAvLyBEbyBub3Qgd2FpdCBmb3IgdGhpcywgdG8gcmVkdWNlIGxhdGVuY3kuXHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5fc3RvcmFnZS5vdmVyd3JpdGUodGhpcy5faGVhcnRiZWF0c0NhY2hlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhlYWRlclN0cmluZztcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZXRVVENEYXRlU3RyaW5nKCkge1xyXG4gICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpO1xyXG4gICAgLy8gUmV0dXJucyBkYXRlIGZvcm1hdCAnWVlZWS1NTS1ERCdcclxuICAgIHJldHVybiB0b2RheS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCAxMCk7XHJcbn1cclxuZnVuY3Rpb24gZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIoaGVhcnRiZWF0c0NhY2hlLCBtYXhTaXplID0gTUFYX0hFQURFUl9CWVRFUykge1xyXG4gICAgLy8gSGVhcnRiZWF0cyBncm91cGVkIGJ5IHVzZXIgYWdlbnQgaW4gdGhlIHN0YW5kYXJkIGZvcm1hdCB0byBiZSBzZW50IGluXHJcbiAgICAvLyB0aGUgaGVhZGVyLlxyXG4gICAgY29uc3QgaGVhcnRiZWF0c1RvU2VuZCA9IFtdO1xyXG4gICAgLy8gU2luZ2xlIGRhdGUgZm9ybWF0IGhlYXJ0YmVhdHMgdGhhdCBhcmUgbm90IHNlbnQuXHJcbiAgICBsZXQgdW5zZW50RW50cmllcyA9IGhlYXJ0YmVhdHNDYWNoZS5zbGljZSgpO1xyXG4gICAgZm9yIChjb25zdCBzaW5nbGVEYXRlSGVhcnRiZWF0IG9mIGhlYXJ0YmVhdHNDYWNoZSkge1xyXG4gICAgICAgIC8vIExvb2sgZm9yIGFuIGV4aXN0aW5nIGVudHJ5IHdpdGggdGhlIHNhbWUgdXNlciBhZ2VudC5cclxuICAgICAgICBjb25zdCBoZWFydGJlYXRFbnRyeSA9IGhlYXJ0YmVhdHNUb1NlbmQuZmluZChoYiA9PiBoYi5hZ2VudCA9PT0gc2luZ2xlRGF0ZUhlYXJ0YmVhdC5hZ2VudCk7XHJcbiAgICAgICAgaWYgKCFoZWFydGJlYXRFbnRyeSkge1xyXG4gICAgICAgICAgICAvLyBJZiBubyBlbnRyeSBmb3IgdGhpcyB1c2VyIGFnZW50IGV4aXN0cywgY3JlYXRlIG9uZS5cclxuICAgICAgICAgICAgaGVhcnRiZWF0c1RvU2VuZC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGFnZW50OiBzaW5nbGVEYXRlSGVhcnRiZWF0LmFnZW50LFxyXG4gICAgICAgICAgICAgICAgZGF0ZXM6IFtzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGVdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoY291bnRCeXRlcyhoZWFydGJlYXRzVG9TZW5kKSA+IG1heFNpemUpIHtcclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBoZWFkZXIgd291bGQgZXhjZWVkIG1heCBzaXplLCByZW1vdmUgdGhlIGFkZGVkIGhlYXJ0YmVhdFxyXG4gICAgICAgICAgICAgICAgLy8gZW50cnkgYW5kIHN0b3AgYWRkaW5nIHRvIHRoZSBoZWFkZXIuXHJcbiAgICAgICAgICAgICAgICBoZWFydGJlYXRzVG9TZW5kLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdEVudHJ5LmRhdGVzLnB1c2goc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlKTtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIGhlYWRlciB3b3VsZCBleGNlZWQgbWF4IHNpemUsIHJlbW92ZSB0aGUgYWRkZWQgZGF0ZVxyXG4gICAgICAgICAgICAvLyBhbmQgc3RvcCBhZGRpbmcgdG8gdGhlIGhlYWRlci5cclxuICAgICAgICAgICAgaWYgKGNvdW50Qnl0ZXMoaGVhcnRiZWF0c1RvU2VuZCkgPiBtYXhTaXplKSB7XHJcbiAgICAgICAgICAgICAgICBoZWFydGJlYXRFbnRyeS5kYXRlcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFBvcCB1bnNlbnQgZW50cnkgZnJvbSBxdWV1ZS4gKFNraXBwZWQgaWYgYWRkaW5nIHRoZSBlbnRyeSBleGNlZWRlZFxyXG4gICAgICAgIC8vIHF1b3RhIGFuZCB0aGUgbG9vcCBicmVha3MgZWFybHkuKVxyXG4gICAgICAgIHVuc2VudEVudHJpZXMgPSB1bnNlbnRFbnRyaWVzLnNsaWNlKDEpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoZWFydGJlYXRzVG9TZW5kLFxyXG4gICAgICAgIHVuc2VudEVudHJpZXNcclxuICAgIH07XHJcbn1cclxuY2xhc3MgSGVhcnRiZWF0U3RvcmFnZUltcGwge1xyXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5fY2FuVXNlSW5kZXhlZERCUHJvbWlzZSA9IHRoaXMucnVuSW5kZXhlZERCRW52aXJvbm1lbnRDaGVjaygpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgcnVuSW5kZXhlZERCRW52aXJvbm1lbnRDaGVjaygpIHtcclxuICAgICAgICBpZiAoIWlzSW5kZXhlZERCQXZhaWxhYmxlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4gdHJ1ZSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWFkIGFsbCBoZWFydGJlYXRzLlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZWFkKCkge1xyXG4gICAgICAgIGNvbnN0IGNhblVzZUluZGV4ZWREQiA9IGF3YWl0IHRoaXMuX2NhblVzZUluZGV4ZWREQlByb21pc2U7XHJcbiAgICAgICAgaWYgKCFjYW5Vc2VJbmRleGVkREIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgaGVhcnRiZWF0czogW10gfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkYkhlYXJ0YmVhdE9iamVjdCA9IGF3YWl0IHJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQih0aGlzLmFwcCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpZGJIZWFydGJlYXRPYmplY3QgfHwgeyBoZWFydGJlYXRzOiBbXSB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIG92ZXJ3cml0ZSB0aGUgc3RvcmFnZSB3aXRoIHRoZSBwcm92aWRlZCBoZWFydGJlYXRzXHJcbiAgICBhc3luYyBvdmVyd3JpdGUoaGVhcnRiZWF0c09iamVjdCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xyXG4gICAgICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdCA9IGF3YWl0IHRoaXMucmVhZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gd3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIodGhpcy5hcHAsIHtcclxuICAgICAgICAgICAgICAgIGxhc3RTZW50SGVhcnRiZWF0RGF0ZTogKF9hID0gaGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUsXHJcbiAgICAgICAgICAgICAgICBoZWFydGJlYXRzOiBoZWFydGJlYXRzT2JqZWN0LmhlYXJ0YmVhdHNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gYWRkIGhlYXJ0YmVhdHNcclxuICAgIGFzeW5jIGFkZChoZWFydGJlYXRzT2JqZWN0KSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIGNvbnN0IGNhblVzZUluZGV4ZWREQiA9IGF3YWl0IHRoaXMuX2NhblVzZUluZGV4ZWREQlByb21pc2U7XHJcbiAgICAgICAgaWYgKCFjYW5Vc2VJbmRleGVkREIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0ID0gYXdhaXQgdGhpcy5yZWFkKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQih0aGlzLmFwcCwge1xyXG4gICAgICAgICAgICAgICAgbGFzdFNlbnRIZWFydGJlYXREYXRlOiAoX2EgPSBoZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSxcclxuICAgICAgICAgICAgICAgIGhlYXJ0YmVhdHM6IFtcclxuICAgICAgICAgICAgICAgICAgICAuLi5leGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QuaGVhcnRiZWF0cyxcclxuICAgICAgICAgICAgICAgICAgICAuLi5oZWFydGJlYXRzT2JqZWN0LmhlYXJ0YmVhdHNcclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgYnl0ZXMgb2YgYSBIZWFydGJlYXRzQnlVc2VyQWdlbnQgYXJyYXkgYWZ0ZXIgYmVpbmcgd3JhcHBlZFxyXG4gKiBpbiBhIHBsYXRmb3JtIGxvZ2dpbmcgaGVhZGVyIEpTT04gb2JqZWN0LCBzdHJpbmdpZmllZCwgYW5kIGNvbnZlcnRlZFxyXG4gKiB0byBiYXNlIDY0LlxyXG4gKi9cclxuZnVuY3Rpb24gY291bnRCeXRlcyhoZWFydGJlYXRzQ2FjaGUpIHtcclxuICAgIC8vIGJhc2U2NCBoYXMgYSByZXN0cmljdGVkIHNldCBvZiBjaGFyYWN0ZXJzLCBhbGwgb2Ygd2hpY2ggc2hvdWxkIGJlIDEgYnl0ZS5cclxuICAgIHJldHVybiBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhcclxuICAgIC8vIGhlYXJ0YmVhdHNDYWNoZSB3cmFwcGVyIHByb3BlcnRpZXNcclxuICAgIEpTT04uc3RyaW5naWZ5KHsgdmVyc2lvbjogMiwgaGVhcnRiZWF0czogaGVhcnRiZWF0c0NhY2hlIH0pKS5sZW5ndGg7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJDb3JlQ29tcG9uZW50cyh2YXJpYW50KSB7XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudCgncGxhdGZvcm0tbG9nZ2VyJywgY29udGFpbmVyID0+IG5ldyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsKGNvbnRhaW5lciksIFwiUFJJVkFURVwiIC8qIFBSSVZBVEUgKi8pKTtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdoZWFydGJlYXQnLCBjb250YWluZXIgPT4gbmV3IEhlYXJ0YmVhdFNlcnZpY2VJbXBsKGNvbnRhaW5lciksIFwiUFJJVkFURVwiIC8qIFBSSVZBVEUgKi8pKTtcclxuICAgIC8vIFJlZ2lzdGVyIGBhcHBgIHBhY2thZ2UuXHJcbiAgICByZWdpc3RlclZlcnNpb24obmFtZSRvLCB2ZXJzaW9uJDEsIHZhcmlhbnQpO1xyXG4gICAgLy8gQlVJTERfVEFSR0VUIHdpbGwgYmUgcmVwbGFjZWQgYnkgdmFsdWVzIGxpa2UgZXNtNSwgZXNtMjAxNywgY2pzNSwgZXRjIGR1cmluZyB0aGUgY29tcGlsYXRpb25cclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJG8sIHZlcnNpb24kMSwgJ2VzbTIwMTcnKTtcclxuICAgIC8vIFJlZ2lzdGVyIHBsYXRmb3JtIFNESyBpZGVudGlmaWVyIChubyB2ZXJzaW9uKS5cclxuICAgIHJlZ2lzdGVyVmVyc2lvbignZmlyZS1qcycsICcnKTtcclxufVxuXG4vKipcclxuICogRmlyZWJhc2UgQXBwXHJcbiAqXHJcbiAqIEByZW1hcmtzIFRoaXMgcGFja2FnZSBjb29yZGluYXRlcyB0aGUgY29tbXVuaWNhdGlvbiBiZXR3ZWVuIHRoZSBkaWZmZXJlbnQgRmlyZWJhc2UgY29tcG9uZW50c1xyXG4gKiBAcGFja2FnZURvY3VtZW50YXRpb25cclxuICovXHJcbnJlZ2lzdGVyQ29yZUNvbXBvbmVudHMoJycpO1xuXG5leHBvcnQgeyBTREtfVkVSU0lPTiwgREVGQVVMVF9FTlRSWV9OQU1FIGFzIF9ERUZBVUxUX0VOVFJZX05BTUUsIF9hZGRDb21wb25lbnQsIF9hZGRPck92ZXJ3cml0ZUNvbXBvbmVudCwgX2FwcHMsIF9jbGVhckNvbXBvbmVudHMsIF9jb21wb25lbnRzLCBfZ2V0UHJvdmlkZXIsIF9yZWdpc3RlckNvbXBvbmVudCwgX3JlbW92ZVNlcnZpY2VJbnN0YW5jZSwgZGVsZXRlQXBwLCBnZXRBcHAsIGdldEFwcHMsIGluaXRpYWxpemVBcHAsIG9uTG9nLCByZWdpc3RlclZlcnNpb24sIHNldExvZ0xldmVsIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiaW1wb3J0IHsgcmVnaXN0ZXJWZXJzaW9uIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5leHBvcnQgKiBmcm9tICdAZmlyZWJhc2UvYXBwJztcblxudmFyIG5hbWUgPSBcImZpcmViYXNlXCI7XG52YXIgdmVyc2lvbiA9IFwiOS44LjJcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxucmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdhcHAnKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiIsInZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG52YXIgZXNtID0ge307XG5cbi8qXG5cbiBDb3B5cmlnaHQgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLlxuIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4qL1xudmFyIGssZ29vZz1nb29nfHx7fSxsPWNvbW1vbmpzR2xvYmFsfHxzZWxmO2Z1bmN0aW9uIGFhKCl7fWZ1bmN0aW9uIGJhKGEpe3ZhciBiPXR5cGVvZiBhO2I9XCJvYmplY3RcIiE9Yj9iOmE/QXJyYXkuaXNBcnJheShhKT9cImFycmF5XCI6YjpcIm51bGxcIjtyZXR1cm4gXCJhcnJheVwiPT1ifHxcIm9iamVjdFwiPT1iJiZcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGh9ZnVuY3Rpb24gcChhKXt2YXIgYj10eXBlb2YgYTtyZXR1cm4gXCJvYmplY3RcIj09YiYmbnVsbCE9YXx8XCJmdW5jdGlvblwiPT1ifWZ1bmN0aW9uIGRhKGEpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxlYSkmJmFbZWFdfHwoYVtlYV09KytmYSl9dmFyIGVhPVwiY2xvc3VyZV91aWRfXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCksZmE9MDtmdW5jdGlvbiBoYShhLGIsYyl7cmV0dXJuIGEuY2FsbC5hcHBseShhLmJpbmQsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIGlhKGEsYixjKXtpZighYSl0aHJvdyBFcnJvcigpO2lmKDI8YXJndW1lbnRzLmxlbmd0aCl7dmFyIGQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBmdW5jdGlvbigpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7QXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkoZSxkKTtyZXR1cm4gYS5hcHBseShiLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIHEoYSxiLGMpe0Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kJiYtMSE9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQudG9TdHJpbmcoKS5pbmRleE9mKFwibmF0aXZlIGNvZGVcIik/cT1oYTpxPWlhO3JldHVybiBxLmFwcGx5KG51bGwsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIGphKGEsYil7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3ZhciBkPWMuc2xpY2UoKTtkLnB1c2guYXBwbHkoZCxhcmd1bWVudHMpO3JldHVybiBhLmFwcGx5KHRoaXMsZCl9fWZ1bmN0aW9uIHQoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EuWj1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EuVmI9ZnVuY3Rpb24oZCxlLGYpe2Zvcih2YXIgaD1BcnJheShhcmd1bWVudHMubGVuZ3RoLTIpLG49MjtuPGFyZ3VtZW50cy5sZW5ndGg7bisrKWhbbi0yXT1hcmd1bWVudHNbbl07cmV0dXJuIGIucHJvdG90eXBlW2VdLmFwcGx5KGQsaCl9O31mdW5jdGlvbiB2KCl7dGhpcy5zPXRoaXMuczt0aGlzLm89dGhpcy5vO312YXIga2E9MCxsYT17fTt2LnByb3RvdHlwZS5zPSExO3YucHJvdG90eXBlLm5hPWZ1bmN0aW9uKCl7aWYoIXRoaXMucyYmKHRoaXMucz0hMCx0aGlzLk0oKSwwIT1rYSkpe3ZhciBhPWRhKHRoaXMpO2RlbGV0ZSBsYVthXTt9fTt2LnByb3RvdHlwZS5NPWZ1bmN0aW9uKCl7aWYodGhpcy5vKWZvcig7dGhpcy5vLmxlbmd0aDspdGhpcy5vLnNoaWZ0KCkoKTt9O2NvbnN0IG1hPUFycmF5LnByb3RvdHlwZS5pbmRleE9mP2Z1bmN0aW9uKGEsYil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoYSxiLHZvaWQgMCl9OmZ1bmN0aW9uKGEsYil7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBcInN0cmluZ1wiIT09dHlwZW9mIGJ8fDEhPWIubGVuZ3RoPy0xOmEuaW5kZXhPZihiLDApO2ZvcihsZXQgYz0wO2M8YS5sZW5ndGg7YysrKWlmKGMgaW4gYSYmYVtjXT09PWIpcmV0dXJuIGM7cmV0dXJuIC0xfSxuYT1BcnJheS5wcm90b3R5cGUuZm9yRWFjaD9mdW5jdGlvbihhLGIsYyl7QXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChhLGIsYyk7fTpmdW5jdGlvbihhLGIsYyl7Y29uc3QgZD1hLmxlbmd0aCxlPVwic3RyaW5nXCI9PT10eXBlb2YgYT9hLnNwbGl0KFwiXCIpOmE7Zm9yKGxldCBmPTA7ZjxkO2YrKylmIGluIGUmJmIuY2FsbChjLGVbZl0sZixhKTt9O1xuZnVuY3Rpb24gb2EoYSl7YTp7dmFyIGI9cGE7Y29uc3QgYz1hLmxlbmd0aCxkPVwic3RyaW5nXCI9PT10eXBlb2YgYT9hLnNwbGl0KFwiXCIpOmE7Zm9yKGxldCBlPTA7ZTxjO2UrKylpZihlIGluIGQmJmIuY2FsbCh2b2lkIDAsZFtlXSxlLGEpKXtiPWU7YnJlYWsgYX1iPS0xO31yZXR1cm4gMD5iP251bGw6XCJzdHJpbmdcIj09PXR5cGVvZiBhP2EuY2hhckF0KGIpOmFbYl19ZnVuY3Rpb24gcWEoYSl7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sYXJndW1lbnRzKX1mdW5jdGlvbiByYShhKXtjb25zdCBiPWEubGVuZ3RoO2lmKDA8Yil7Y29uc3QgYz1BcnJheShiKTtmb3IobGV0IGQ9MDtkPGI7ZCsrKWNbZF09YVtkXTtyZXR1cm4gY31yZXR1cm4gW119ZnVuY3Rpb24gc2EoYSl7cmV0dXJuIC9eW1xcc1xceGEwXSokLy50ZXN0KGEpfXZhciB0YT1TdHJpbmcucHJvdG90eXBlLnRyaW0/ZnVuY3Rpb24oYSl7cmV0dXJuIGEudHJpbSgpfTpmdW5jdGlvbihhKXtyZXR1cm4gL15bXFxzXFx4YTBdKihbXFxzXFxTXSo/KVtcXHNcXHhhMF0qJC8uZXhlYyhhKVsxXX07ZnVuY3Rpb24gdyhhLGIpe3JldHVybiAtMSE9YS5pbmRleE9mKGIpfWZ1bmN0aW9uIHVhKGEsYil7cmV0dXJuIGE8Yj8tMTphPmI/MTowfXZhciB4O2E6e3ZhciB2YT1sLm5hdmlnYXRvcjtpZih2YSl7dmFyIHdhPXZhLnVzZXJBZ2VudDtpZih3YSl7eD13YTticmVhayBhfX14PVwiXCI7fWZ1bmN0aW9uIHhhKGEsYixjKXtmb3IoY29uc3QgZCBpbiBhKWIuY2FsbChjLGFbZF0sZCxhKTt9ZnVuY3Rpb24geWEoYSl7Y29uc3QgYj17fTtmb3IoY29uc3QgYyBpbiBhKWJbY109YVtjXTtyZXR1cm4gYn12YXIgemE9XCJjb25zdHJ1Y3RvciBoYXNPd25Qcm9wZXJ0eSBpc1Byb3RvdHlwZU9mIHByb3BlcnR5SXNFbnVtZXJhYmxlIHRvTG9jYWxlU3RyaW5nIHRvU3RyaW5nIHZhbHVlT2ZcIi5zcGxpdChcIiBcIik7ZnVuY3Rpb24gQWEoYSxiKXtsZXQgYyxkO2ZvcihsZXQgZT0xO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspe2Q9YXJndW1lbnRzW2VdO2ZvcihjIGluIGQpYVtjXT1kW2NdO2ZvcihsZXQgZj0wO2Y8emEubGVuZ3RoO2YrKyljPXphW2ZdLE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLGMpJiYoYVtjXT1kW2NdKTt9fWZ1bmN0aW9uIENhKGEpe0NhW1wiIFwiXShhKTtyZXR1cm4gYX1DYVtcIiBcIl09YWE7ZnVuY3Rpb24gRmEoYSl7dmFyIGI9R2E7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLDkpP2JbOV06Yls5XT1hKDkpfXZhciBIYT13KHgsXCJPcGVyYVwiKSx5PXcoeCxcIlRyaWRlbnRcIil8fHcoeCxcIk1TSUVcIiksSWE9dyh4LFwiRWRnZVwiKSxKYT1JYXx8eSxLYT13KHgsXCJHZWNrb1wiKSYmISh3KHgudG9Mb3dlckNhc2UoKSxcIndlYmtpdFwiKSYmIXcoeCxcIkVkZ2VcIikpJiYhKHcoeCxcIlRyaWRlbnRcIil8fHcoeCxcIk1TSUVcIikpJiYhdyh4LFwiRWRnZVwiKSxMYT13KHgudG9Mb3dlckNhc2UoKSxcIndlYmtpdFwiKSYmIXcoeCxcIkVkZ2VcIik7ZnVuY3Rpb24gTWEoKXt2YXIgYT1sLmRvY3VtZW50O3JldHVybiBhP2EuZG9jdW1lbnRNb2RlOnZvaWQgMH12YXIgTmE7XG5hOnt2YXIgT2E9XCJcIixQYT1mdW5jdGlvbigpe3ZhciBhPXg7aWYoS2EpcmV0dXJuIC9ydjooW15cXCk7XSspKFxcKXw7KS8uZXhlYyhhKTtpZihJYSlyZXR1cm4gL0VkZ2VcXC8oW1xcZFxcLl0rKS8uZXhlYyhhKTtpZih5KXJldHVybiAvXFxiKD86TVNJRXxydilbOiBdKFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7aWYoTGEpcmV0dXJuIC9XZWJLaXRcXC8oXFxTKykvLmV4ZWMoYSk7aWYoSGEpcmV0dXJuIC8oPzpWZXJzaW9uKVsgXFwvXT8oXFxTKykvLmV4ZWMoYSl9KCk7UGEmJihPYT1QYT9QYVsxXTpcIlwiKTtpZih5KXt2YXIgUWE9TWEoKTtpZihudWxsIT1RYSYmUWE+cGFyc2VGbG9hdChPYSkpe05hPVN0cmluZyhRYSk7YnJlYWsgYX19TmE9T2E7fXZhciBHYT17fTtcbmZ1bmN0aW9uIFJhKCl7cmV0dXJuIEZhKGZ1bmN0aW9uKCl7bGV0IGE9MDtjb25zdCBiPXRhKFN0cmluZyhOYSkpLnNwbGl0KFwiLlwiKSxjPXRhKFwiOVwiKS5zcGxpdChcIi5cIiksZD1NYXRoLm1heChiLmxlbmd0aCxjLmxlbmd0aCk7Zm9yKGxldCBoPTA7MD09YSYmaDxkO2grKyl7dmFyIGU9YltoXXx8XCJcIixmPWNbaF18fFwiXCI7ZG97ZT0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhlKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO2Y9LyhcXGQqKShcXEQqKSguKikvLmV4ZWMoZil8fFtcIlwiLFwiXCIsXCJcIixcIlwiXTtpZigwPT1lWzBdLmxlbmd0aCYmMD09ZlswXS5sZW5ndGgpYnJlYWs7YT11YSgwPT1lWzFdLmxlbmd0aD8wOnBhcnNlSW50KGVbMV0sMTApLDA9PWZbMV0ubGVuZ3RoPzA6cGFyc2VJbnQoZlsxXSwxMCkpfHx1YSgwPT1lWzJdLmxlbmd0aCwwPT1mWzJdLmxlbmd0aCl8fHVhKGVbMl0sZlsyXSk7ZT1lWzNdO2Y9ZlszXTt9d2hpbGUoMD09YSl9cmV0dXJuIDA8PWF9KX12YXIgU2E7XG5pZihsLmRvY3VtZW50JiZ5KXt2YXIgVGE9TWEoKTtTYT1UYT9UYTpwYXJzZUludChOYSwxMCl8fHZvaWQgMDt9ZWxzZSBTYT12b2lkIDA7dmFyIFVhPVNhO3ZhciBWYT1mdW5jdGlvbigpe2lmKCFsLmFkZEV2ZW50TGlzdGVuZXJ8fCFPYmplY3QuZGVmaW5lUHJvcGVydHkpcmV0dXJuICExO3ZhciBhPSExLGI9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwicGFzc2l2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXthPSEwO319KTt0cnl7bC5hZGRFdmVudExpc3RlbmVyKFwidGVzdFwiLGFhLGIpLGwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRlc3RcIixhYSxiKTt9Y2F0Y2goYyl7fXJldHVybiBhfSgpO2Z1bmN0aW9uIHooYSxiKXt0aGlzLnR5cGU9YTt0aGlzLmc9dGhpcy50YXJnZXQ9Yjt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITE7fXoucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXt0aGlzLmRlZmF1bHRQcmV2ZW50ZWQ9ITA7fTtmdW5jdGlvbiBBKGEsYil7ei5jYWxsKHRoaXMsYT9hLnR5cGU6XCJcIik7dGhpcy5yZWxhdGVkVGFyZ2V0PXRoaXMuZz10aGlzLnRhcmdldD1udWxsO3RoaXMuYnV0dG9uPXRoaXMuc2NyZWVuWT10aGlzLnNjcmVlblg9dGhpcy5jbGllbnRZPXRoaXMuY2xpZW50WD0wO3RoaXMua2V5PVwiXCI7dGhpcy5tZXRhS2V5PXRoaXMuc2hpZnRLZXk9dGhpcy5hbHRLZXk9dGhpcy5jdHJsS2V5PSExO3RoaXMuc3RhdGU9bnVsbDt0aGlzLnBvaW50ZXJJZD0wO3RoaXMucG9pbnRlclR5cGU9XCJcIjt0aGlzLmk9bnVsbDtpZihhKXt2YXIgYz10aGlzLnR5cGU9YS50eXBlLGQ9YS5jaGFuZ2VkVG91Y2hlcyYmYS5jaGFuZ2VkVG91Y2hlcy5sZW5ndGg/YS5jaGFuZ2VkVG91Y2hlc1swXTpudWxsO3RoaXMudGFyZ2V0PWEudGFyZ2V0fHxhLnNyY0VsZW1lbnQ7dGhpcy5nPWI7aWYoYj1hLnJlbGF0ZWRUYXJnZXQpe2lmKEthKXthOnt0cnl7Q2EoYi5ub2RlTmFtZSk7dmFyIGU9ITA7YnJlYWsgYX1jYXRjaChmKXt9ZT1cbiExO31lfHwoYj1udWxsKTt9fWVsc2UgXCJtb3VzZW92ZXJcIj09Yz9iPWEuZnJvbUVsZW1lbnQ6XCJtb3VzZW91dFwiPT1jJiYoYj1hLnRvRWxlbWVudCk7dGhpcy5yZWxhdGVkVGFyZ2V0PWI7ZD8odGhpcy5jbGllbnRYPXZvaWQgMCE9PWQuY2xpZW50WD9kLmNsaWVudFg6ZC5wYWdlWCx0aGlzLmNsaWVudFk9dm9pZCAwIT09ZC5jbGllbnRZP2QuY2xpZW50WTpkLnBhZ2VZLHRoaXMuc2NyZWVuWD1kLnNjcmVlblh8fDAsdGhpcy5zY3JlZW5ZPWQuc2NyZWVuWXx8MCk6KHRoaXMuY2xpZW50WD12b2lkIDAhPT1hLmNsaWVudFg/YS5jbGllbnRYOmEucGFnZVgsdGhpcy5jbGllbnRZPXZvaWQgMCE9PWEuY2xpZW50WT9hLmNsaWVudFk6YS5wYWdlWSx0aGlzLnNjcmVlblg9YS5zY3JlZW5YfHwwLHRoaXMuc2NyZWVuWT1hLnNjcmVlbll8fDApO3RoaXMuYnV0dG9uPWEuYnV0dG9uO3RoaXMua2V5PWEua2V5fHxcIlwiO3RoaXMuY3RybEtleT1hLmN0cmxLZXk7dGhpcy5hbHRLZXk9YS5hbHRLZXk7dGhpcy5zaGlmdEtleT1cbmEuc2hpZnRLZXk7dGhpcy5tZXRhS2V5PWEubWV0YUtleTt0aGlzLnBvaW50ZXJJZD1hLnBvaW50ZXJJZHx8MDt0aGlzLnBvaW50ZXJUeXBlPVwic3RyaW5nXCI9PT10eXBlb2YgYS5wb2ludGVyVHlwZT9hLnBvaW50ZXJUeXBlOldhW2EucG9pbnRlclR5cGVdfHxcIlwiO3RoaXMuc3RhdGU9YS5zdGF0ZTt0aGlzLmk9YTthLmRlZmF1bHRQcmV2ZW50ZWQmJkEuWi5oLmNhbGwodGhpcyk7fX10KEEseik7dmFyIFdhPXsyOlwidG91Y2hcIiwzOlwicGVuXCIsNDpcIm1vdXNlXCJ9O0EucHJvdG90eXBlLmg9ZnVuY3Rpb24oKXtBLlouaC5jYWxsKHRoaXMpO3ZhciBhPXRoaXMuaTthLnByZXZlbnREZWZhdWx0P2EucHJldmVudERlZmF1bHQoKTphLnJldHVyblZhbHVlPSExO307dmFyIEI9XCJjbG9zdXJlX2xpc3RlbmFibGVfXCIrKDFFNipNYXRoLnJhbmRvbSgpfDApO3ZhciBYYT0wO2Z1bmN0aW9uIFlhKGEsYixjLGQsZSl7dGhpcy5saXN0ZW5lcj1hO3RoaXMucHJveHk9bnVsbDt0aGlzLnNyYz1iO3RoaXMudHlwZT1jO3RoaXMuY2FwdHVyZT0hIWQ7dGhpcy5pYT1lO3RoaXMua2V5PSsrWGE7dGhpcy5jYT10aGlzLmZhPSExO31mdW5jdGlvbiBaYShhKXthLmNhPSEwO2EubGlzdGVuZXI9bnVsbDthLnByb3h5PW51bGw7YS5zcmM9bnVsbDthLmlhPW51bGw7fWZ1bmN0aW9uICRhKGEpe3RoaXMuc3JjPWE7dGhpcy5nPXt9O3RoaXMuaD0wO30kYS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGY9YS50b1N0cmluZygpO2E9dGhpcy5nW2ZdO2F8fChhPXRoaXMuZ1tmXT1bXSx0aGlzLmgrKyk7dmFyIGg9YWIoYSxiLGQsZSk7LTE8aD8oYj1hW2hdLGN8fChiLmZhPSExKSk6KGI9bmV3IFlhKGIsdGhpcy5zcmMsZiwhIWQsZSksYi5mYT1jLGEucHVzaChiKSk7cmV0dXJuIGJ9O2Z1bmN0aW9uIGJiKGEsYil7dmFyIGM9Yi50eXBlO2lmKGMgaW4gYS5nKXt2YXIgZD1hLmdbY10sZT1tYShkLGIpLGY7KGY9MDw9ZSkmJkFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChkLGUsMSk7ZiYmKFphKGIpLDA9PWEuZ1tjXS5sZW5ndGgmJihkZWxldGUgYS5nW2NdLGEuaC0tKSk7fX1cbmZ1bmN0aW9uIGFiKGEsYixjLGQpe2Zvcih2YXIgZT0wO2U8YS5sZW5ndGg7KytlKXt2YXIgZj1hW2VdO2lmKCFmLmNhJiZmLmxpc3RlbmVyPT1iJiZmLmNhcHR1cmU9PSEhYyYmZi5pYT09ZClyZXR1cm4gZX1yZXR1cm4gLTF9dmFyIGNiPVwiY2xvc3VyZV9sbV9cIisoMUU2Kk1hdGgucmFuZG9tKCl8MCksZGI9e307ZnVuY3Rpb24gZmIoYSxiLGMsZCxlKXtpZihkJiZkLm9uY2UpcmV0dXJuIGdiKGEsYixjLGQsZSk7aWYoQXJyYXkuaXNBcnJheShiKSl7Zm9yKHZhciBmPTA7ZjxiLmxlbmd0aDtmKyspZmIoYSxiW2ZdLGMsZCxlKTtyZXR1cm4gbnVsbH1jPWhiKGMpO3JldHVybiBhJiZhW0JdP2EuTihiLGMscChkKT8hIWQuY2FwdHVyZTohIWQsZSk6aWIoYSxiLGMsITEsZCxlKX1cbmZ1bmN0aW9uIGliKGEsYixjLGQsZSxmKXtpZighYil0aHJvdyBFcnJvcihcIkludmFsaWQgZXZlbnQgdHlwZVwiKTt2YXIgaD1wKGUpPyEhZS5jYXB0dXJlOiEhZSxuPWpiKGEpO258fChhW2NiXT1uPW5ldyAkYShhKSk7Yz1uLmFkZChiLGMsZCxoLGYpO2lmKGMucHJveHkpcmV0dXJuIGM7ZD1rYigpO2MucHJveHk9ZDtkLnNyYz1hO2QubGlzdGVuZXI9YztpZihhLmFkZEV2ZW50TGlzdGVuZXIpVmF8fChlPWgpLHZvaWQgMD09PWUmJihlPSExKSxhLmFkZEV2ZW50TGlzdGVuZXIoYi50b1N0cmluZygpLGQsZSk7ZWxzZSBpZihhLmF0dGFjaEV2ZW50KWEuYXR0YWNoRXZlbnQobGIoYi50b1N0cmluZygpKSxkKTtlbHNlIGlmKGEuYWRkTGlzdGVuZXImJmEucmVtb3ZlTGlzdGVuZXIpYS5hZGRMaXN0ZW5lcihkKTtlbHNlIHRocm93IEVycm9yKFwiYWRkRXZlbnRMaXN0ZW5lciBhbmQgYXR0YWNoRXZlbnQgYXJlIHVuYXZhaWxhYmxlLlwiKTtyZXR1cm4gY31cbmZ1bmN0aW9uIGtiKCl7ZnVuY3Rpb24gYShjKXtyZXR1cm4gYi5jYWxsKGEuc3JjLGEubGlzdGVuZXIsYyl9dmFyIGI9bWI7cmV0dXJuIGF9ZnVuY3Rpb24gZ2IoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKXtmb3IodmFyIGY9MDtmPGIubGVuZ3RoO2YrKylnYihhLGJbZl0sYyxkLGUpO3JldHVybiBudWxsfWM9aGIoYyk7cmV0dXJuIGEmJmFbQl0/YS5PKGIsYyxwKGQpPyEhZC5jYXB0dXJlOiEhZCxlKTppYihhLGIsYywhMCxkLGUpfVxuZnVuY3Rpb24gbmIoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKWZvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKW5iKGEsYltmXSxjLGQsZSk7ZWxzZSAoZD1wKGQpPyEhZC5jYXB0dXJlOiEhZCxjPWhiKGMpLGEmJmFbQl0pPyhhPWEuaSxiPVN0cmluZyhiKS50b1N0cmluZygpLGIgaW4gYS5nJiYoZj1hLmdbYl0sYz1hYihmLGMsZCxlKSwtMTxjJiYoWmEoZltjXSksQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGYsYywxKSwwPT1mLmxlbmd0aCYmKGRlbGV0ZSBhLmdbYl0sYS5oLS0pKSkpOmEmJihhPWpiKGEpKSYmKGI9YS5nW2IudG9TdHJpbmcoKV0sYT0tMSxiJiYoYT1hYihiLGMsZCxlKSksKGM9LTE8YT9iW2FdOm51bGwpJiZvYihjKSk7fVxuZnVuY3Rpb24gb2IoYSl7aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBhJiZhJiYhYS5jYSl7dmFyIGI9YS5zcmM7aWYoYiYmYltCXSliYihiLmksYSk7ZWxzZSB7dmFyIGM9YS50eXBlLGQ9YS5wcm94eTtiLnJlbW92ZUV2ZW50TGlzdGVuZXI/Yi5yZW1vdmVFdmVudExpc3RlbmVyKGMsZCxhLmNhcHR1cmUpOmIuZGV0YWNoRXZlbnQ/Yi5kZXRhY2hFdmVudChsYihjKSxkKTpiLmFkZExpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyKGQpOyhjPWpiKGIpKT8oYmIoYyxhKSwwPT1jLmgmJihjLnNyYz1udWxsLGJbY2JdPW51bGwpKTpaYShhKTt9fX1mdW5jdGlvbiBsYihhKXtyZXR1cm4gYSBpbiBkYj9kYlthXTpkYlthXT1cIm9uXCIrYX1mdW5jdGlvbiBtYihhLGIpe2lmKGEuY2EpYT0hMDtlbHNlIHtiPW5ldyBBKGIsdGhpcyk7dmFyIGM9YS5saXN0ZW5lcixkPWEuaWF8fGEuc3JjO2EuZmEmJm9iKGEpO2E9Yy5jYWxsKGQsYik7fXJldHVybiBhfVxuZnVuY3Rpb24gamIoYSl7YT1hW2NiXTtyZXR1cm4gYSBpbnN0YW5jZW9mICRhP2E6bnVsbH12YXIgcGI9XCJfX2Nsb3N1cmVfZXZlbnRzX2ZuX1wiKygxRTkqTWF0aC5yYW5kb20oKT4+PjApO2Z1bmN0aW9uIGhiKGEpe2lmKFwiZnVuY3Rpb25cIj09PXR5cGVvZiBhKXJldHVybiBhO2FbcGJdfHwoYVtwYl09ZnVuY3Rpb24oYil7cmV0dXJuIGEuaGFuZGxlRXZlbnQoYil9KTtyZXR1cm4gYVtwYl19ZnVuY3Rpb24gQygpe3YuY2FsbCh0aGlzKTt0aGlzLmk9bmV3ICRhKHRoaXMpO3RoaXMuUD10aGlzO3RoaXMuST1udWxsO310KEMsdik7Qy5wcm90b3R5cGVbQl09ITA7Qy5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtuYih0aGlzLGEsYixjLGQpO307XG5mdW5jdGlvbiBEKGEsYil7dmFyIGMsZD1hLkk7aWYoZClmb3IoYz1bXTtkO2Q9ZC5JKWMucHVzaChkKTthPWEuUDtkPWIudHlwZXx8YjtpZihcInN0cmluZ1wiPT09dHlwZW9mIGIpYj1uZXcgeihiLGEpO2Vsc2UgaWYoYiBpbnN0YW5jZW9mIHopYi50YXJnZXQ9Yi50YXJnZXR8fGE7ZWxzZSB7dmFyIGU9YjtiPW5ldyB6KGQsYSk7QWEoYixlKTt9ZT0hMDtpZihjKWZvcih2YXIgZj1jLmxlbmd0aC0xOzA8PWY7Zi0tKXt2YXIgaD1iLmc9Y1tmXTtlPXFiKGgsZCwhMCxiKSYmZTt9aD1iLmc9YTtlPXFiKGgsZCwhMCxiKSYmZTtlPXFiKGgsZCwhMSxiKSYmZTtpZihjKWZvcihmPTA7ZjxjLmxlbmd0aDtmKyspaD1iLmc9Y1tmXSxlPXFiKGgsZCwhMSxiKSYmZTt9XG5DLnByb3RvdHlwZS5NPWZ1bmN0aW9uKCl7Qy5aLk0uY2FsbCh0aGlzKTtpZih0aGlzLmkpe3ZhciBhPXRoaXMuaSxjO2ZvcihjIGluIGEuZyl7Zm9yKHZhciBkPWEuZ1tjXSxlPTA7ZTxkLmxlbmd0aDtlKyspWmEoZFtlXSk7ZGVsZXRlIGEuZ1tjXTthLmgtLTt9fXRoaXMuST1udWxsO307Qy5wcm90b3R5cGUuTj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5pLmFkZChTdHJpbmcoYSksYiwhMSxjLGQpfTtDLnByb3RvdHlwZS5PPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmkuYWRkKFN0cmluZyhhKSxiLCEwLGMsZCl9O1xuZnVuY3Rpb24gcWIoYSxiLGMsZCl7Yj1hLmkuZ1tTdHJpbmcoYildO2lmKCFiKXJldHVybiAhMDtiPWIuY29uY2F0KCk7Zm9yKHZhciBlPSEwLGY9MDtmPGIubGVuZ3RoOysrZil7dmFyIGg9YltmXTtpZihoJiYhaC5jYSYmaC5jYXB0dXJlPT1jKXt2YXIgbj1oLmxpc3RlbmVyLHU9aC5pYXx8aC5zcmM7aC5mYSYmYmIoYS5pLGgpO2U9ITEhPT1uLmNhbGwodSxkKSYmZTt9fXJldHVybiBlJiYhZC5kZWZhdWx0UHJldmVudGVkfXZhciByYj1sLkpTT04uc3RyaW5naWZ5O2Z1bmN0aW9uIHNiKCl7dmFyIGE9dGI7bGV0IGI9bnVsbDthLmcmJihiPWEuZyxhLmc9YS5nLm5leHQsYS5nfHwoYS5oPW51bGwpLGIubmV4dD1udWxsKTtyZXR1cm4gYn1jbGFzcyB1Yntjb25zdHJ1Y3Rvcigpe3RoaXMuaD10aGlzLmc9bnVsbDt9YWRkKGEsYil7Y29uc3QgYz12Yi5nZXQoKTtjLnNldChhLGIpO3RoaXMuaD90aGlzLmgubmV4dD1jOnRoaXMuZz1jO3RoaXMuaD1jO319dmFyIHZiPW5ldyBjbGFzc3tjb25zdHJ1Y3RvcihhLGIpe3RoaXMuaT1hO3RoaXMuaj1iO3RoaXMuaD0wO3RoaXMuZz1udWxsO31nZXQoKXtsZXQgYTswPHRoaXMuaD8odGhpcy5oLS0sYT10aGlzLmcsdGhpcy5nPWEubmV4dCxhLm5leHQ9bnVsbCk6YT10aGlzLmkoKTtyZXR1cm4gYX19KCgpPT5uZXcgd2IsYT0+YS5yZXNldCgpKTtcbmNsYXNzIHdie2NvbnN0cnVjdG9yKCl7dGhpcy5uZXh0PXRoaXMuZz10aGlzLmg9bnVsbDt9c2V0KGEsYil7dGhpcy5oPWE7dGhpcy5nPWI7dGhpcy5uZXh0PW51bGw7fXJlc2V0KCl7dGhpcy5uZXh0PXRoaXMuZz10aGlzLmg9bnVsbDt9fWZ1bmN0aW9uIHliKGEpe2wuc2V0VGltZW91dCgoKT0+e3Rocm93IGE7fSwwKTt9ZnVuY3Rpb24gemIoYSxiKXtBYnx8QmIoKTtDYnx8KEFiKCksQ2I9ITApO3RiLmFkZChhLGIpO312YXIgQWI7ZnVuY3Rpb24gQmIoKXt2YXIgYT1sLlByb21pc2UucmVzb2x2ZSh2b2lkIDApO0FiPWZ1bmN0aW9uKCl7YS50aGVuKERiKTt9O312YXIgQ2I9ITEsdGI9bmV3IHViO2Z1bmN0aW9uIERiKCl7Zm9yKHZhciBhO2E9c2IoKTspe3RyeXthLmguY2FsbChhLmcpO31jYXRjaChjKXt5YihjKTt9dmFyIGI9dmI7Yi5qKGEpOzEwMD5iLmgmJihiLmgrKyxhLm5leHQ9Yi5nLGIuZz1hKTt9Q2I9ITE7fWZ1bmN0aW9uIEViKGEsYil7Qy5jYWxsKHRoaXMpO3RoaXMuaD1hfHwxO3RoaXMuZz1ifHxsO3RoaXMuaj1xKHRoaXMua2IsdGhpcyk7dGhpcy5sPURhdGUubm93KCk7fXQoRWIsQyk7az1FYi5wcm90b3R5cGU7ay5kYT0hMTtrLlM9bnVsbDtrLmtiPWZ1bmN0aW9uKCl7aWYodGhpcy5kYSl7dmFyIGE9RGF0ZS5ub3coKS10aGlzLmw7MDxhJiZhPC44KnRoaXMuaD90aGlzLlM9dGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLHRoaXMuaC1hKToodGhpcy5TJiYodGhpcy5nLmNsZWFyVGltZW91dCh0aGlzLlMpLHRoaXMuUz1udWxsKSxEKHRoaXMsXCJ0aWNrXCIpLHRoaXMuZGEmJihGYih0aGlzKSx0aGlzLnN0YXJ0KCkpKTt9fTtrLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5kYT0hMDt0aGlzLlN8fCh0aGlzLlM9dGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLHRoaXMuaCksdGhpcy5sPURhdGUubm93KCkpO307XG5mdW5jdGlvbiBGYihhKXthLmRhPSExO2EuUyYmKGEuZy5jbGVhclRpbWVvdXQoYS5TKSxhLlM9bnVsbCk7fWsuTT1mdW5jdGlvbigpe0ViLlouTS5jYWxsKHRoaXMpO0ZiKHRoaXMpO2RlbGV0ZSB0aGlzLmc7fTtmdW5jdGlvbiBHYihhLGIsYyl7aWYoXCJmdW5jdGlvblwiPT09dHlwZW9mIGEpYyYmKGE9cShhLGMpKTtlbHNlIGlmKGEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuaGFuZGxlRXZlbnQpYT1xKGEuaGFuZGxlRXZlbnQsYSk7ZWxzZSB0aHJvdyBFcnJvcihcIkludmFsaWQgbGlzdGVuZXIgYXJndW1lbnRcIik7cmV0dXJuIDIxNDc0ODM2NDc8TnVtYmVyKGIpPy0xOmwuc2V0VGltZW91dChhLGJ8fDApfWZ1bmN0aW9uIEhiKGEpe2EuZz1HYigoKT0+e2EuZz1udWxsO2EuaSYmKGEuaT0hMSxIYihhKSk7fSxhLmopO2NvbnN0IGI9YS5oO2EuaD1udWxsO2EubS5hcHBseShudWxsLGIpO31jbGFzcyBJYiBleHRlbmRzIHZ7Y29uc3RydWN0b3IoYSxiKXtzdXBlcigpO3RoaXMubT1hO3RoaXMuaj1iO3RoaXMuaD1udWxsO3RoaXMuaT0hMTt0aGlzLmc9bnVsbDt9bChhKXt0aGlzLmg9YXJndW1lbnRzO3RoaXMuZz90aGlzLmk9ITA6SGIodGhpcyk7fU0oKXtzdXBlci5NKCk7dGhpcy5nJiYobC5jbGVhclRpbWVvdXQodGhpcy5nKSx0aGlzLmc9bnVsbCx0aGlzLmk9ITEsdGhpcy5oPW51bGwpO319ZnVuY3Rpb24gRShhKXt2LmNhbGwodGhpcyk7dGhpcy5oPWE7dGhpcy5nPXt9O310KEUsdik7dmFyIEpiPVtdO2Z1bmN0aW9uIEtiKGEsYixjLGQpe0FycmF5LmlzQXJyYXkoYyl8fChjJiYoSmJbMF09Yy50b1N0cmluZygpKSxjPUpiKTtmb3IodmFyIGU9MDtlPGMubGVuZ3RoO2UrKyl7dmFyIGY9ZmIoYixjW2VdLGR8fGEuaGFuZGxlRXZlbnQsITEsYS5ofHxhKTtpZighZilicmVhazthLmdbZi5rZXldPWY7fX1mdW5jdGlvbiBMYihhKXt4YShhLmcsZnVuY3Rpb24oYixjKXt0aGlzLmcuaGFzT3duUHJvcGVydHkoYykmJm9iKGIpO30sYSk7YS5nPXt9O31FLnByb3RvdHlwZS5NPWZ1bmN0aW9uKCl7RS5aLk0uY2FsbCh0aGlzKTtMYih0aGlzKTt9O0UucHJvdG90eXBlLmhhbmRsZUV2ZW50PWZ1bmN0aW9uKCl7dGhyb3cgRXJyb3IoXCJFdmVudEhhbmRsZXIuaGFuZGxlRXZlbnQgbm90IGltcGxlbWVudGVkXCIpO307ZnVuY3Rpb24gTWIoKXt0aGlzLmc9ITA7fU1iLnByb3RvdHlwZS5BYT1mdW5jdGlvbigpe3RoaXMuZz0hMTt9O2Z1bmN0aW9uIE5iKGEsYixjLGQsZSxmKXthLmluZm8oZnVuY3Rpb24oKXtpZihhLmcpaWYoZil7dmFyIGg9XCJcIjtmb3IodmFyIG49Zi5zcGxpdChcIiZcIiksdT0wO3U8bi5sZW5ndGg7dSsrKXt2YXIgbT1uW3VdLnNwbGl0KFwiPVwiKTtpZigxPG0ubGVuZ3RoKXt2YXIgcj1tWzBdO209bVsxXTt2YXIgRz1yLnNwbGl0KFwiX1wiKTtoPTI8PUcubGVuZ3RoJiZcInR5cGVcIj09R1sxXT9oKyhyK1wiPVwiK20rXCImXCIpOmgrKHIrXCI9cmVkYWN0ZWQmXCIpO319fWVsc2UgaD1udWxsO2Vsc2UgaD1mO3JldHVybiBcIlhNTEhUVFAgUkVRIChcIitkK1wiKSBbYXR0ZW1wdCBcIitlK1wiXTogXCIrYitcIlxcblwiK2MrXCJcXG5cIitofSk7fVxuZnVuY3Rpb24gT2IoYSxiLGMsZCxlLGYsaCl7YS5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuIFwiWE1MSFRUUCBSRVNQIChcIitkK1wiKSBbIGF0dGVtcHQgXCIrZStcIl06IFwiK2IrXCJcXG5cIitjK1wiXFxuXCIrZitcIiBcIitofSk7fWZ1bmN0aW9uIEYoYSxiLGMsZCl7YS5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuIFwiWE1MSFRUUCBURVhUIChcIitiK1wiKTogXCIrUGIoYSxjKSsoZD9cIiBcIitkOlwiXCIpfSk7fWZ1bmN0aW9uIFFiKGEsYil7YS5pbmZvKGZ1bmN0aW9uKCl7cmV0dXJuIFwiVElNRU9VVDogXCIrYn0pO31NYi5wcm90b3R5cGUuaW5mbz1mdW5jdGlvbigpe307XG5mdW5jdGlvbiBQYihhLGIpe2lmKCFhLmcpcmV0dXJuIGI7aWYoIWIpcmV0dXJuIG51bGw7dHJ5e3ZhciBjPUpTT04ucGFyc2UoYik7aWYoYylmb3IoYT0wO2E8Yy5sZW5ndGg7YSsrKWlmKEFycmF5LmlzQXJyYXkoY1thXSkpe3ZhciBkPWNbYV07aWYoISgyPmQubGVuZ3RoKSl7dmFyIGU9ZFsxXTtpZihBcnJheS5pc0FycmF5KGUpJiYhKDE+ZS5sZW5ndGgpKXt2YXIgZj1lWzBdO2lmKFwibm9vcFwiIT1mJiZcInN0b3BcIiE9ZiYmXCJjbG9zZVwiIT1mKWZvcih2YXIgaD0xO2g8ZS5sZW5ndGg7aCsrKWVbaF09XCJcIjt9fX1yZXR1cm4gcmIoYyl9Y2F0Y2gobil7cmV0dXJuIGJ9fXZhciBIPXt9LFJiPW51bGw7ZnVuY3Rpb24gU2IoKXtyZXR1cm4gUmI9UmJ8fG5ldyBDfUguTWE9XCJzZXJ2ZXJyZWFjaGFiaWxpdHlcIjtmdW5jdGlvbiBUYihhKXt6LmNhbGwodGhpcyxILk1hLGEpO310KFRiLHopO2Z1bmN0aW9uIEkoYSl7Y29uc3QgYj1TYigpO0QoYixuZXcgVGIoYixhKSk7fUguU1RBVF9FVkVOVD1cInN0YXRldmVudFwiO2Z1bmN0aW9uIFViKGEsYil7ei5jYWxsKHRoaXMsSC5TVEFUX0VWRU5ULGEpO3RoaXMuc3RhdD1iO310KFViLHopO2Z1bmN0aW9uIEooYSl7Y29uc3QgYj1TYigpO0QoYixuZXcgVWIoYixhKSk7fUguTmE9XCJ0aW1pbmdldmVudFwiO2Z1bmN0aW9uIFZiKGEsYil7ei5jYWxsKHRoaXMsSC5OYSxhKTt0aGlzLnNpemU9Yjt9dChWYix6KTtcbmZ1bmN0aW9uIEsoYSxiKXtpZihcImZ1bmN0aW9uXCIhPT10eXBlb2YgYSl0aHJvdyBFcnJvcihcIkZuIG11c3Qgbm90IGJlIG51bGwgYW5kIG11c3QgYmUgYSBmdW5jdGlvblwiKTtyZXR1cm4gbC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YSgpO30sYil9dmFyIFdiPXtOT19FUlJPUjowLGxiOjEseWI6Mix4YjozLHNiOjQsd2I6NSx6Yjo2LEphOjcsVElNRU9VVDo4LENiOjl9O3ZhciBYYj17cWI6XCJjb21wbGV0ZVwiLE1iOlwic3VjY2Vzc1wiLEthOlwiZXJyb3JcIixKYTpcImFib3J0XCIsRWI6XCJyZWFkeVwiLEZiOlwicmVhZHlzdGF0ZWNoYW5nZVwiLFRJTUVPVVQ6XCJ0aW1lb3V0XCIsQWI6XCJpbmNyZW1lbnRhbGRhdGFcIixEYjpcInByb2dyZXNzXCIsdGI6XCJkb3dubG9hZHByb2dyZXNzXCIsVWI6XCJ1cGxvYWRwcm9ncmVzc1wifTtmdW5jdGlvbiBZYigpe31ZYi5wcm90b3R5cGUuaD1udWxsO2Z1bmN0aW9uIFpiKGEpe3JldHVybiBhLmh8fChhLmg9YS5pKCkpfWZ1bmN0aW9uICRiKCl7fXZhciBMPXtPUEVOOlwiYVwiLHBiOlwiYlwiLEthOlwiY1wiLEJiOlwiZFwifTtmdW5jdGlvbiBhYygpe3ouY2FsbCh0aGlzLFwiZFwiKTt9dChhYyx6KTtmdW5jdGlvbiBiYygpe3ouY2FsbCh0aGlzLFwiY1wiKTt9dChiYyx6KTt2YXIgY2M7ZnVuY3Rpb24gZGMoKXt9dChkYyxZYik7ZGMucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fTtkYy5wcm90b3R5cGUuaT1mdW5jdGlvbigpe3JldHVybiB7fX07Y2M9bmV3IGRjO2Z1bmN0aW9uIE0oYSxiLGMsZCl7dGhpcy5sPWE7dGhpcy5qPWI7dGhpcy5tPWM7dGhpcy5YPWR8fDE7dGhpcy5WPW5ldyBFKHRoaXMpO3RoaXMuUD1lYzthPUphPzEyNTp2b2lkIDA7dGhpcy5XPW5ldyBFYihhKTt0aGlzLkg9bnVsbDt0aGlzLmk9ITE7dGhpcy5zPXRoaXMuQT10aGlzLnY9dGhpcy5LPXRoaXMuRj10aGlzLlk9dGhpcy5CPW51bGw7dGhpcy5EPVtdO3RoaXMuZz1udWxsO3RoaXMuQz0wO3RoaXMubz10aGlzLnU9bnVsbDt0aGlzLk49LTE7dGhpcy5JPSExO3RoaXMuTz0wO3RoaXMuTD1udWxsO3RoaXMuYWE9dGhpcy5KPXRoaXMuJD10aGlzLlU9ITE7dGhpcy5oPW5ldyBmYzt9ZnVuY3Rpb24gZmMoKXt0aGlzLmk9bnVsbDt0aGlzLmc9XCJcIjt0aGlzLmg9ITE7fXZhciBlYz00NUUzLGdjPXt9LGhjPXt9O2s9TS5wcm90b3R5cGU7ay5zZXRUaW1lb3V0PWZ1bmN0aW9uKGEpe3RoaXMuUD1hO307XG5mdW5jdGlvbiBpYyhhLGIsYyl7YS5LPTE7YS52PWpjKE4oYikpO2Eucz1jO2EuVT0hMDtrYyhhLG51bGwpO31mdW5jdGlvbiBrYyhhLGIpe2EuRj1EYXRlLm5vdygpO2xjKGEpO2EuQT1OKGEudik7dmFyIGM9YS5BLGQ9YS5YO0FycmF5LmlzQXJyYXkoZCl8fChkPVtTdHJpbmcoZCldKTttYyhjLmgsXCJ0XCIsZCk7YS5DPTA7Yz1hLmwuSDthLmg9bmV3IGZjO2EuZz1uYyhhLmwsYz9iOm51bGwsIWEucyk7MDxhLk8mJihhLkw9bmV3IEliKHEoYS5JYSxhLGEuZyksYS5PKSk7S2IoYS5WLGEuZyxcInJlYWR5c3RhdGVjaGFuZ2VcIixhLmdiKTtiPWEuSD95YShhLkgpOnt9O2Eucz8oYS51fHwoYS51PVwiUE9TVFwiKSxiW1wiQ29udGVudC1UeXBlXCJdPVwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsYS5nLmVhKGEuQSxhLnUsYS5zLGIpKTooYS51PVwiR0VUXCIsYS5nLmVhKGEuQSxhLnUsbnVsbCxiKSk7SSgxKTtOYihhLmosYS51LGEuQSxhLm0sYS5YLGEucyk7fVxuay5nYj1mdW5jdGlvbihhKXthPWEudGFyZ2V0O2NvbnN0IGI9dGhpcy5MO2ImJjM9PU8oYSk/Yi5sKCk6dGhpcy5JYShhKTt9O1xuay5JYT1mdW5jdGlvbihhKXt0cnl7aWYoYT09dGhpcy5nKWE6e2NvbnN0IHI9Tyh0aGlzLmcpO3ZhciBiPXRoaXMuZy5EYSgpO2NvbnN0IEc9dGhpcy5nLmJhKCk7aWYoISgzPnIpJiYoMyE9cnx8SmF8fHRoaXMuZyYmKHRoaXMuaC5ofHx0aGlzLmcuZ2EoKXx8b2ModGhpcy5nKSkpKXt0aGlzLkl8fDQhPXJ8fDc9PWJ8fCg4PT1ifHwwPj1HP0koMyk6SSgyKSk7cGModGhpcyk7dmFyIGM9dGhpcy5nLmJhKCk7dGhpcy5OPWM7YjppZihxYyh0aGlzKSl7dmFyIGQ9b2ModGhpcy5nKTthPVwiXCI7dmFyIGU9ZC5sZW5ndGgsZj00PT1PKHRoaXMuZyk7aWYoIXRoaXMuaC5pKXtpZihcInVuZGVmaW5lZFwiPT09dHlwZW9mIFRleHREZWNvZGVyKXtQKHRoaXMpO3JjKHRoaXMpO3ZhciBoPVwiXCI7YnJlYWsgYn10aGlzLmguaT1uZXcgbC5UZXh0RGVjb2Rlcjt9Zm9yKGI9MDtiPGU7YisrKXRoaXMuaC5oPSEwLGErPXRoaXMuaC5pLmRlY29kZShkW2JdLHtzdHJlYW06ZiYmYj09ZS0xfSk7ZC5zcGxpY2UoMCxcbmUpO3RoaXMuaC5nKz1hO3RoaXMuQz0wO2g9dGhpcy5oLmc7fWVsc2UgaD10aGlzLmcuZ2EoKTt0aGlzLmk9MjAwPT1jO09iKHRoaXMuaix0aGlzLnUsdGhpcy5BLHRoaXMubSx0aGlzLlgscixjKTtpZih0aGlzLmkpe2lmKHRoaXMuJCYmIXRoaXMuSil7Yjp7aWYodGhpcy5nKXt2YXIgbix1PXRoaXMuZztpZigobj11Lmc/dS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIik6bnVsbCkmJiFzYShuKSl7dmFyIG09bjticmVhayBifX1tPW51bGw7fWlmKGM9bSlGKHRoaXMuaix0aGlzLm0sYyxcIkluaXRpYWwgaGFuZHNoYWtlIHJlc3BvbnNlIHZpYSBYLUhUVFAtSW5pdGlhbC1SZXNwb25zZVwiKSx0aGlzLko9ITAsc2ModGhpcyxjKTtlbHNlIHt0aGlzLmk9ITE7dGhpcy5vPTM7SigxMik7UCh0aGlzKTtyYyh0aGlzKTticmVhayBhfX10aGlzLlU/KHRjKHRoaXMscixoKSxKYSYmdGhpcy5pJiYzPT1yJiYoS2IodGhpcy5WLHRoaXMuVyxcInRpY2tcIix0aGlzLmZiKSxcbnRoaXMuVy5zdGFydCgpKSk6KEYodGhpcy5qLHRoaXMubSxoLG51bGwpLHNjKHRoaXMsaCkpOzQ9PXImJlAodGhpcyk7dGhpcy5pJiYhdGhpcy5JJiYoND09cj91Yyh0aGlzLmwsdGhpcyk6KHRoaXMuaT0hMSxsYyh0aGlzKSkpO31lbHNlIDQwMD09YyYmMDxoLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKT8odGhpcy5vPTMsSigxMikpOih0aGlzLm89MCxKKDEzKSksUCh0aGlzKSxyYyh0aGlzKTt9fX1jYXRjaChyKXt9ZmluYWxseXt9fTtmdW5jdGlvbiBxYyhhKXtyZXR1cm4gYS5nP1wiR0VUXCI9PWEudSYmMiE9YS5LJiZhLmwuQmE6ITF9XG5mdW5jdGlvbiB0YyhhLGIsYyl7bGV0IGQ9ITAsZTtmb3IoOyFhLkkmJmEuQzxjLmxlbmd0aDspaWYoZT12YyhhLGMpLGU9PWhjKXs0PT1iJiYoYS5vPTQsSigxNCksZD0hMSk7RihhLmosYS5tLG51bGwsXCJbSW5jb21wbGV0ZSBSZXNwb25zZV1cIik7YnJlYWt9ZWxzZSBpZihlPT1nYyl7YS5vPTQ7SigxNSk7RihhLmosYS5tLGMsXCJbSW52YWxpZCBDaHVua11cIik7ZD0hMTticmVha31lbHNlIEYoYS5qLGEubSxlLG51bGwpLHNjKGEsZSk7cWMoYSkmJmUhPWhjJiZlIT1nYyYmKGEuaC5nPVwiXCIsYS5DPTApOzQhPWJ8fDAhPWMubGVuZ3RofHxhLmguaHx8KGEubz0xLEooMTYpLGQ9ITEpO2EuaT1hLmkmJmQ7ZD8wPGMubGVuZ3RoJiYhYS5hYSYmKGEuYWE9ITAsYj1hLmwsYi5nPT1hJiZiLiQmJiFiLkwmJihiLmguaW5mbyhcIkdyZWF0LCBubyBidWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQuIEJ5dGVzIHJlY2VpdmVkOiBcIitjLmxlbmd0aCksd2MoYiksYi5MPSEwLEooMTEpKSk6KEYoYS5qLGEubSxcbmMsXCJbSW52YWxpZCBDaHVua2VkIFJlc3BvbnNlXVwiKSxQKGEpLHJjKGEpKTt9ay5mYj1mdW5jdGlvbigpe2lmKHRoaXMuZyl7dmFyIGE9Tyh0aGlzLmcpLGI9dGhpcy5nLmdhKCk7dGhpcy5DPGIubGVuZ3RoJiYocGModGhpcyksdGModGhpcyxhLGIpLHRoaXMuaSYmNCE9YSYmbGModGhpcykpO319O2Z1bmN0aW9uIHZjKGEsYil7dmFyIGM9YS5DLGQ9Yi5pbmRleE9mKFwiXFxuXCIsYyk7aWYoLTE9PWQpcmV0dXJuIGhjO2M9TnVtYmVyKGIuc3Vic3RyaW5nKGMsZCkpO2lmKGlzTmFOKGMpKXJldHVybiBnYztkKz0xO2lmKGQrYz5iLmxlbmd0aClyZXR1cm4gaGM7Yj1iLnN1YnN0cihkLGMpO2EuQz1kK2M7cmV0dXJuIGJ9ay5jYW5jZWw9ZnVuY3Rpb24oKXt0aGlzLkk9ITA7UCh0aGlzKTt9O2Z1bmN0aW9uIGxjKGEpe2EuWT1EYXRlLm5vdygpK2EuUDt4YyhhLGEuUCk7fVxuZnVuY3Rpb24geGMoYSxiKXtpZihudWxsIT1hLkIpdGhyb3cgRXJyb3IoXCJXYXRjaERvZyB0aW1lciBub3QgbnVsbFwiKTthLkI9SyhxKGEuZWIsYSksYik7fWZ1bmN0aW9uIHBjKGEpe2EuQiYmKGwuY2xlYXJUaW1lb3V0KGEuQiksYS5CPW51bGwpO31rLmViPWZ1bmN0aW9uKCl7dGhpcy5CPW51bGw7Y29uc3QgYT1EYXRlLm5vdygpOzA8PWEtdGhpcy5ZPyhRYih0aGlzLmosdGhpcy5BKSwyIT10aGlzLksmJihJKDMpLEooMTcpKSxQKHRoaXMpLHRoaXMubz0yLHJjKHRoaXMpKTp4Yyh0aGlzLHRoaXMuWS1hKTt9O2Z1bmN0aW9uIHJjKGEpezA9PWEubC5HfHxhLkl8fHVjKGEubCxhKTt9ZnVuY3Rpb24gUChhKXtwYyhhKTt2YXIgYj1hLkw7YiYmXCJmdW5jdGlvblwiPT10eXBlb2YgYi5uYSYmYi5uYSgpO2EuTD1udWxsO0ZiKGEuVyk7TGIoYS5WKTthLmcmJihiPWEuZyxhLmc9bnVsbCxiLmFib3J0KCksYi5uYSgpKTt9XG5mdW5jdGlvbiBzYyhhLGIpe3RyeXt2YXIgYz1hLmw7aWYoMCE9Yy5HJiYoYy5nPT1hfHx5YyhjLmksYSkpKWlmKGMuST1hLk4sIWEuSiYmeWMoYy5pLGEpJiYzPT1jLkcpe3RyeXt2YXIgZD1jLkNhLmcucGFyc2UoYik7fWNhdGNoKG0pe2Q9bnVsbDt9aWYoQXJyYXkuaXNBcnJheShkKSYmMz09ZC5sZW5ndGgpe3ZhciBlPWQ7aWYoMD09ZVswXSlhOntpZighYy51KXtpZihjLmcpaWYoYy5nLkYrM0UzPGEuRil6YyhjKSxBYyhjKTtlbHNlIGJyZWFrIGE7QmMoYyk7SigxOCk7fX1lbHNlIGMudGE9ZVsxXSwwPGMudGEtYy5VJiYzNzUwMD5lWzJdJiZjLk4mJjA9PWMuQSYmIWMudiYmKGMudj1LKHEoYy5hYixjKSw2RTMpKTtpZigxPj1DYyhjLmkpJiZjLmthKXt0cnl7Yy5rYSgpO31jYXRjaChtKXt9Yy5rYT12b2lkIDA7fX1lbHNlIFEoYywxMSk7fWVsc2UgaWYoKGEuSnx8Yy5nPT1hKSYmemMoYyksIXNhKGIpKWZvcihlPWMuQ2EuZy5wYXJzZShiKSxiPTA7YjxlLmxlbmd0aDtiKyspe2xldCBtPWVbYl07XG5jLlU9bVswXTttPW1bMV07aWYoMj09Yy5HKWlmKFwiY1wiPT1tWzBdKXtjLko9bVsxXTtjLmxhPW1bMl07Y29uc3Qgcj1tWzNdO251bGwhPXImJihjLm1hPXIsYy5oLmluZm8oXCJWRVI9XCIrYy5tYSkpO2NvbnN0IEc9bVs0XTtudWxsIT1HJiYoYy56YT1HLGMuaC5pbmZvKFwiU1ZFUj1cIitjLnphKSk7Y29uc3QgRGE9bVs1XTtudWxsIT1EYSYmXCJudW1iZXJcIj09PXR5cGVvZiBEYSYmMDxEYSYmKGQ9MS41KkRhLGMuSz1kLGMuaC5pbmZvKFwiYmFja0NoYW5uZWxSZXF1ZXN0VGltZW91dE1zXz1cIitkKSk7ZD1jO2NvbnN0IGNhPWEuZztpZihjYSl7Y29uc3QgRWE9Y2EuZz9jYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKTpudWxsO2lmKEVhKXt2YXIgZj1kLmk7IWYuZyYmKHcoRWEsXCJzcGR5XCIpfHx3KEVhLFwicXVpY1wiKXx8dyhFYSxcImgyXCIpKSYmKGYuaj1mLmwsZi5nPW5ldyBTZXQsZi5oJiYoRGMoZixmLmgpLGYuaD1udWxsKSk7fWlmKGQuRCl7Y29uc3QgeGI9XG5jYS5nP2NhLmcuZ2V0UmVzcG9uc2VIZWFkZXIoXCJYLUhUVFAtU2Vzc2lvbi1JZFwiKTpudWxsO3hiJiYoZC5zYT14YixSKGQuRixkLkQseGIpKTt9fWMuRz0zO2MuaiYmYy5qLnhhKCk7Yy4kJiYoYy5PPURhdGUubm93KCktYS5GLGMuaC5pbmZvKFwiSGFuZHNoYWtlIFJUVDogXCIrYy5PK1wibXNcIikpO2Q9Yzt2YXIgaD1hO2Qub2E9RWMoZCxkLkg/ZC5sYTpudWxsLGQuVyk7aWYoaC5KKXtGYyhkLmksaCk7dmFyIG49aCx1PWQuSzt1JiZuLnNldFRpbWVvdXQodSk7bi5CJiYocGMobiksbGMobikpO2QuZz1oO31lbHNlIEdjKGQpOzA8Yy5sLmxlbmd0aCYmSGMoYyk7fWVsc2UgXCJzdG9wXCIhPW1bMF0mJlwiY2xvc2VcIiE9bVswXXx8UShjLDcpO2Vsc2UgMz09Yy5HJiYoXCJzdG9wXCI9PW1bMF18fFwiY2xvc2VcIj09bVswXT9cInN0b3BcIj09bVswXT9RKGMsNyk6SWMoYyk6XCJub29wXCIhPW1bMF0mJmMuaiYmYy5qLndhKG0pLGMuQT0wKTt9SSg0KTt9Y2F0Y2gobSl7fX1mdW5jdGlvbiBKYyhhKXtpZihhLlImJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuUilyZXR1cm4gYS5SKCk7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKXJldHVybiBhLnNwbGl0KFwiXCIpO2lmKGJhKGEpKXtmb3IodmFyIGI9W10sYz1hLmxlbmd0aCxkPTA7ZDxjO2QrKyliLnB1c2goYVtkXSk7cmV0dXJuIGJ9Yj1bXTtjPTA7Zm9yKGQgaW4gYSliW2MrK109YVtkXTtyZXR1cm4gYn1cbmZ1bmN0aW9uIEtjKGEsYil7aWYoYS5mb3JFYWNoJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmZvckVhY2gpYS5mb3JFYWNoKGIsdm9pZCAwKTtlbHNlIGlmKGJhKGEpfHxcInN0cmluZ1wiPT09dHlwZW9mIGEpbmEoYSxiLHZvaWQgMCk7ZWxzZSB7aWYoYS5UJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLlQpdmFyIGM9YS5UKCk7ZWxzZSBpZihhLlImJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuUiljPXZvaWQgMDtlbHNlIGlmKGJhKGEpfHxcInN0cmluZ1wiPT09dHlwZW9mIGEpe2M9W107Zm9yKHZhciBkPWEubGVuZ3RoLGU9MDtlPGQ7ZSsrKWMucHVzaChlKTt9ZWxzZSBmb3IoZSBpbiBjPVtdLGQ9MCxhKWNbZCsrXT1lO2Q9SmMoYSk7ZT1kLmxlbmd0aDtmb3IodmFyIGY9MDtmPGU7ZisrKWIuY2FsbCh2b2lkIDAsZFtmXSxjJiZjW2ZdLGEpO319ZnVuY3Rpb24gUyhhLGIpe3RoaXMuaD17fTt0aGlzLmc9W107dGhpcy5pPTA7dmFyIGM9YXJndW1lbnRzLmxlbmd0aDtpZigxPGMpe2lmKGMlMil0aHJvdyBFcnJvcihcIlVuZXZlbiBudW1iZXIgb2YgYXJndW1lbnRzXCIpO2Zvcih2YXIgZD0wO2Q8YztkKz0yKXRoaXMuc2V0KGFyZ3VtZW50c1tkXSxhcmd1bWVudHNbZCsxXSk7fWVsc2UgaWYoYSlpZihhIGluc3RhbmNlb2YgUylmb3IoYz1hLlQoKSxkPTA7ZDxjLmxlbmd0aDtkKyspdGhpcy5zZXQoY1tkXSxhLmdldChjW2RdKSk7ZWxzZSBmb3IoZCBpbiBhKXRoaXMuc2V0KGQsYVtkXSk7fWs9Uy5wcm90b3R5cGU7ay5SPWZ1bmN0aW9uKCl7TGModGhpcyk7Zm9yKHZhciBhPVtdLGI9MDtiPHRoaXMuZy5sZW5ndGg7YisrKWEucHVzaCh0aGlzLmhbdGhpcy5nW2JdXSk7cmV0dXJuIGF9O2suVD1mdW5jdGlvbigpe0xjKHRoaXMpO3JldHVybiB0aGlzLmcuY29uY2F0KCl9O1xuZnVuY3Rpb24gTGMoYSl7aWYoYS5pIT1hLmcubGVuZ3RoKXtmb3IodmFyIGI9MCxjPTA7YjxhLmcubGVuZ3RoOyl7dmFyIGQ9YS5nW2JdO1QoYS5oLGQpJiYoYS5nW2MrK109ZCk7YisrO31hLmcubGVuZ3RoPWM7fWlmKGEuaSE9YS5nLmxlbmd0aCl7dmFyIGU9e307Zm9yKGM9Yj0wO2I8YS5nLmxlbmd0aDspZD1hLmdbYl0sVChlLGQpfHwoYS5nW2MrK109ZCxlW2RdPTEpLGIrKzthLmcubGVuZ3RoPWM7fX1rLmdldD1mdW5jdGlvbihhLGIpe3JldHVybiBUKHRoaXMuaCxhKT90aGlzLmhbYV06Yn07ay5zZXQ9ZnVuY3Rpb24oYSxiKXtUKHRoaXMuaCxhKXx8KHRoaXMuaSsrLHRoaXMuZy5wdXNoKGEpKTt0aGlzLmhbYV09Yjt9O2suZm9yRWFjaD1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLlQoKSxkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBlPWNbZF0sZj10aGlzLmdldChlKTthLmNhbGwoYixmLGUsdGhpcyk7fX07XG5mdW5jdGlvbiBUKGEsYil7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLGIpfXZhciBNYz0vXig/OihbXjovPyMuXSspOik/KD86XFwvXFwvKD86KFteXFxcXC8/I10qKUApPyhbXlxcXFwvPyNdKj8pKD86OihbMC05XSspKT8oPz1bXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcPyhbXiNdKikpPyg/OiMoW1xcc1xcU10qKSk/JC87ZnVuY3Rpb24gTmMoYSxiKXtpZihhKXthPWEuc3BsaXQoXCImXCIpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgZD1hW2NdLmluZGV4T2YoXCI9XCIpLGU9bnVsbDtpZigwPD1kKXt2YXIgZj1hW2NdLnN1YnN0cmluZygwLGQpO2U9YVtjXS5zdWJzdHJpbmcoZCsxKTt9ZWxzZSBmPWFbY107YihmLGU/ZGVjb2RlVVJJQ29tcG9uZW50KGUucmVwbGFjZSgvXFwrL2csXCIgXCIpKTpcIlwiKTt9fX1mdW5jdGlvbiBVKGEsYil7dGhpcy5pPXRoaXMucz10aGlzLmo9XCJcIjt0aGlzLm09bnVsbDt0aGlzLm89dGhpcy5sPVwiXCI7dGhpcy5nPSExO2lmKGEgaW5zdGFuY2VvZiBVKXt0aGlzLmc9dm9pZCAwIT09Yj9iOmEuZztPYyh0aGlzLGEuaik7dGhpcy5zPWEucztQYyh0aGlzLGEuaSk7UWModGhpcyxhLm0pO3RoaXMubD1hLmw7Yj1hLmg7dmFyIGM9bmV3IFJjO2MuaT1iLmk7Yi5nJiYoYy5nPW5ldyBTKGIuZyksYy5oPWIuaCk7U2ModGhpcyxjKTt0aGlzLm89YS5vO31lbHNlIGEmJihjPVN0cmluZyhhKS5tYXRjaChNYykpPyh0aGlzLmc9ISFiLE9jKHRoaXMsY1sxXXx8XCJcIiwhMCksdGhpcy5zPVRjKGNbMl18fFwiXCIpLFBjKHRoaXMsY1szXXx8XCJcIiwhMCksUWModGhpcyxjWzRdKSx0aGlzLmw9VGMoY1s1XXx8XCJcIiwhMCksU2ModGhpcyxjWzZdfHxcIlwiLCEwKSx0aGlzLm89VGMoY1s3XXx8XCJcIikpOih0aGlzLmc9ISFiLHRoaXMuaD1uZXcgUmMobnVsbCx0aGlzLmcpKTt9XG5VLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBhPVtdLGI9dGhpcy5qO2ImJmEucHVzaChVYyhiLFZjLCEwKSxcIjpcIik7dmFyIGM9dGhpcy5pO2lmKGN8fFwiZmlsZVwiPT1iKWEucHVzaChcIi8vXCIpLChiPXRoaXMucykmJmEucHVzaChVYyhiLFZjLCEwKSxcIkBcIiksYS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoYykpLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZyxcIiUkMVwiKSksYz10aGlzLm0sbnVsbCE9YyYmYS5wdXNoKFwiOlwiLFN0cmluZyhjKSk7aWYoYz10aGlzLmwpdGhpcy5pJiZcIi9cIiE9Yy5jaGFyQXQoMCkmJmEucHVzaChcIi9cIiksYS5wdXNoKFVjKGMsXCIvXCI9PWMuY2hhckF0KDApP1djOlhjLCEwKSk7KGM9dGhpcy5oLnRvU3RyaW5nKCkpJiZhLnB1c2goXCI/XCIsYyk7KGM9dGhpcy5vKSYmYS5wdXNoKFwiI1wiLFVjKGMsWWMpKTtyZXR1cm4gYS5qb2luKFwiXCIpfTtmdW5jdGlvbiBOKGEpe3JldHVybiBuZXcgVShhKX1cbmZ1bmN0aW9uIE9jKGEsYixjKXthLmo9Yz9UYyhiLCEwKTpiO2EuaiYmKGEuaj1hLmoucmVwbGFjZSgvOiQvLFwiXCIpKTt9ZnVuY3Rpb24gUGMoYSxiLGMpe2EuaT1jP1RjKGIsITApOmI7fWZ1bmN0aW9uIFFjKGEsYil7aWYoYil7Yj1OdW1iZXIoYik7aWYoaXNOYU4oYil8fDA+Yil0aHJvdyBFcnJvcihcIkJhZCBwb3J0IG51bWJlciBcIitiKTthLm09Yjt9ZWxzZSBhLm09bnVsbDt9ZnVuY3Rpb24gU2MoYSxiLGMpe2IgaW5zdGFuY2VvZiBSYz8oYS5oPWIsWmMoYS5oLGEuZykpOihjfHwoYj1VYyhiLCRjKSksYS5oPW5ldyBSYyhiLGEuZykpO31mdW5jdGlvbiBSKGEsYixjKXthLmguc2V0KGIsYyk7fWZ1bmN0aW9uIGpjKGEpe1IoYSxcInp4XCIsTWF0aC5mbG9vcigyMTQ3NDgzNjQ4Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDM2KStNYXRoLmFicyhNYXRoLmZsb29yKDIxNDc0ODM2NDgqTWF0aC5yYW5kb20oKSleRGF0ZS5ub3coKSkudG9TdHJpbmcoMzYpKTtyZXR1cm4gYX1cbmZ1bmN0aW9uIGFkKGEpe3JldHVybiBhIGluc3RhbmNlb2YgVT9OKGEpOm5ldyBVKGEsdm9pZCAwKX1mdW5jdGlvbiBiZChhLGIsYyxkKXt2YXIgZT1uZXcgVShudWxsLHZvaWQgMCk7YSYmT2MoZSxhKTtiJiZQYyhlLGIpO2MmJlFjKGUsYyk7ZCYmKGUubD1kKTtyZXR1cm4gZX1mdW5jdGlvbiBUYyhhLGIpe3JldHVybiBhP2I/ZGVjb2RlVVJJKGEucmVwbGFjZSgvJTI1L2csXCIlMjUyNVwiKSk6ZGVjb2RlVVJJQ29tcG9uZW50KGEpOlwiXCJ9ZnVuY3Rpb24gVWMoYSxiLGMpe3JldHVybiBcInN0cmluZ1wiPT09dHlwZW9mIGE/KGE9ZW5jb2RlVVJJKGEpLnJlcGxhY2UoYixjZCksYyYmKGE9YS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csXCIlJDFcIikpLGEpOm51bGx9ZnVuY3Rpb24gY2QoYSl7YT1hLmNoYXJDb2RlQXQoMCk7cmV0dXJuIFwiJVwiKyhhPj40JjE1KS50b1N0cmluZygxNikrKGEmMTUpLnRvU3RyaW5nKDE2KX1cbnZhciBWYz0vWyNcXC9cXD9AXS9nLFhjPS9bI1xcPzpdL2csV2M9L1sjXFw/XS9nLCRjPS9bI1xcP0BdL2csWWM9LyMvZztmdW5jdGlvbiBSYyhhLGIpe3RoaXMuaD10aGlzLmc9bnVsbDt0aGlzLmk9YXx8bnVsbDt0aGlzLmo9ISFiO31mdW5jdGlvbiBWKGEpe2EuZ3x8KGEuZz1uZXcgUyxhLmg9MCxhLmkmJk5jKGEuaSxmdW5jdGlvbihiLGMpe2EuYWRkKGRlY29kZVVSSUNvbXBvbmVudChiLnJlcGxhY2UoL1xcKy9nLFwiIFwiKSksYyk7fSkpO31rPVJjLnByb3RvdHlwZTtrLmFkZD1mdW5jdGlvbihhLGIpe1YodGhpcyk7dGhpcy5pPW51bGw7YT1XKHRoaXMsYSk7dmFyIGM9dGhpcy5nLmdldChhKTtjfHx0aGlzLmcuc2V0KGEsYz1bXSk7Yy5wdXNoKGIpO3RoaXMuaCs9MTtyZXR1cm4gdGhpc307XG5mdW5jdGlvbiBkZChhLGIpe1YoYSk7Yj1XKGEsYik7VChhLmcuaCxiKSYmKGEuaT1udWxsLGEuaC09YS5nLmdldChiKS5sZW5ndGgsYT1hLmcsVChhLmgsYikmJihkZWxldGUgYS5oW2JdLGEuaS0tLGEuZy5sZW5ndGg+MiphLmkmJkxjKGEpKSk7fWZ1bmN0aW9uIGVkKGEsYil7VihhKTtiPVcoYSxiKTtyZXR1cm4gVChhLmcuaCxiKX1rLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXtWKHRoaXMpO3RoaXMuZy5mb3JFYWNoKGZ1bmN0aW9uKGMsZCl7bmEoYyxmdW5jdGlvbihlKXthLmNhbGwoYixlLGQsdGhpcyk7fSx0aGlzKTt9LHRoaXMpO307ay5UPWZ1bmN0aW9uKCl7Vih0aGlzKTtmb3IodmFyIGE9dGhpcy5nLlIoKSxiPXRoaXMuZy5UKCksYz1bXSxkPTA7ZDxiLmxlbmd0aDtkKyspZm9yKHZhciBlPWFbZF0sZj0wO2Y8ZS5sZW5ndGg7ZisrKWMucHVzaChiW2RdKTtyZXR1cm4gY307XG5rLlI9ZnVuY3Rpb24oYSl7Vih0aGlzKTt2YXIgYj1bXTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpZWQodGhpcyxhKSYmKGI9cWEoYix0aGlzLmcuZ2V0KFcodGhpcyxhKSkpKTtlbHNlIHthPXRoaXMuZy5SKCk7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspYj1xYShiLGFbY10pO31yZXR1cm4gYn07ay5zZXQ9ZnVuY3Rpb24oYSxiKXtWKHRoaXMpO3RoaXMuaT1udWxsO2E9Vyh0aGlzLGEpO2VkKHRoaXMsYSkmJih0aGlzLmgtPXRoaXMuZy5nZXQoYSkubGVuZ3RoKTt0aGlzLmcuc2V0KGEsW2JdKTt0aGlzLmgrPTE7cmV0dXJuIHRoaXN9O2suZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuIGI7YT10aGlzLlIoYSk7cmV0dXJuIDA8YS5sZW5ndGg/U3RyaW5nKGFbMF0pOmJ9O2Z1bmN0aW9uIG1jKGEsYixjKXtkZChhLGIpOzA8Yy5sZW5ndGgmJihhLmk9bnVsbCxhLmcuc2V0KFcoYSxiKSxyYShjKSksYS5oKz1jLmxlbmd0aCk7fVxuay50b1N0cmluZz1mdW5jdGlvbigpe2lmKHRoaXMuaSlyZXR1cm4gdGhpcy5pO2lmKCF0aGlzLmcpcmV0dXJuIFwiXCI7Zm9yKHZhciBhPVtdLGI9dGhpcy5nLlQoKSxjPTA7YzxiLmxlbmd0aDtjKyspe3ZhciBkPWJbY10sZT1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKTtkPXRoaXMuUihkKTtmb3IodmFyIGY9MDtmPGQubGVuZ3RoO2YrKyl7dmFyIGg9ZTtcIlwiIT09ZFtmXSYmKGgrPVwiPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoZFtmXSkpKTthLnB1c2goaCk7fX1yZXR1cm4gdGhpcy5pPWEuam9pbihcIiZcIil9O2Z1bmN0aW9uIFcoYSxiKXtiPVN0cmluZyhiKTthLmomJihiPWIudG9Mb3dlckNhc2UoKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gWmMoYSxiKXtiJiYhYS5qJiYoVihhKSxhLmk9bnVsbCxhLmcuZm9yRWFjaChmdW5jdGlvbihjLGQpe3ZhciBlPWQudG9Mb3dlckNhc2UoKTtkIT1lJiYoZGQodGhpcyxkKSxtYyh0aGlzLGUsYykpO30sYSkpO2Euaj1iO312YXIgZmQ9Y2xhc3N7Y29uc3RydWN0b3IoYSxiKXt0aGlzLmg9YTt0aGlzLmc9Yjt9fTtmdW5jdGlvbiBnZChhKXt0aGlzLmw9YXx8aGQ7bC5QZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmc/KGE9bC5wZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKFwibmF2aWdhdGlvblwiKSxhPTA8YS5sZW5ndGgmJihcImhxXCI9PWFbMF0ubmV4dEhvcFByb3RvY29sfHxcImgyXCI9PWFbMF0ubmV4dEhvcFByb3RvY29sKSk6YT0hIShsLmcmJmwuZy5FYSYmbC5nLkVhKCkmJmwuZy5FYSgpLlpiKTt0aGlzLmo9YT90aGlzLmw6MTt0aGlzLmc9bnVsbDsxPHRoaXMuaiYmKHRoaXMuZz1uZXcgU2V0KTt0aGlzLmg9bnVsbDt0aGlzLmk9W107fXZhciBoZD0xMDtmdW5jdGlvbiBpZChhKXtyZXR1cm4gYS5oPyEwOmEuZz9hLmcuc2l6ZT49YS5qOiExfWZ1bmN0aW9uIENjKGEpe3JldHVybiBhLmg/MTphLmc/YS5nLnNpemU6MH1mdW5jdGlvbiB5YyhhLGIpe3JldHVybiBhLmg/YS5oPT1iOmEuZz9hLmcuaGFzKGIpOiExfWZ1bmN0aW9uIERjKGEsYil7YS5nP2EuZy5hZGQoYik6YS5oPWI7fVxuZnVuY3Rpb24gRmMoYSxiKXthLmgmJmEuaD09Yj9hLmg9bnVsbDphLmcmJmEuZy5oYXMoYikmJmEuZy5kZWxldGUoYik7fWdkLnByb3RvdHlwZS5jYW5jZWw9ZnVuY3Rpb24oKXt0aGlzLmk9amQodGhpcyk7aWYodGhpcy5oKXRoaXMuaC5jYW5jZWwoKSx0aGlzLmg9bnVsbDtlbHNlIGlmKHRoaXMuZyYmMCE9PXRoaXMuZy5zaXplKXtmb3IoY29uc3QgYSBvZiB0aGlzLmcudmFsdWVzKCkpYS5jYW5jZWwoKTt0aGlzLmcuY2xlYXIoKTt9fTtmdW5jdGlvbiBqZChhKXtpZihudWxsIT1hLmgpcmV0dXJuIGEuaS5jb25jYXQoYS5oLkQpO2lmKG51bGwhPWEuZyYmMCE9PWEuZy5zaXplKXtsZXQgYj1hLmk7Zm9yKGNvbnN0IGMgb2YgYS5nLnZhbHVlcygpKWI9Yi5jb25jYXQoYy5EKTtyZXR1cm4gYn1yZXR1cm4gcmEoYS5pKX1mdW5jdGlvbiBrZCgpe31rZC5wcm90b3R5cGUuc3RyaW5naWZ5PWZ1bmN0aW9uKGEpe3JldHVybiBsLkpTT04uc3RyaW5naWZ5KGEsdm9pZCAwKX07a2QucHJvdG90eXBlLnBhcnNlPWZ1bmN0aW9uKGEpe3JldHVybiBsLkpTT04ucGFyc2UoYSx2b2lkIDApfTtmdW5jdGlvbiBsZCgpe3RoaXMuZz1uZXcga2Q7fWZ1bmN0aW9uIG1kKGEsYixjKXtjb25zdCBkPWN8fFwiXCI7dHJ5e0tjKGEsZnVuY3Rpb24oZSxmKXtsZXQgaD1lO3AoZSkmJihoPXJiKGUpKTtiLnB1c2goZCtmK1wiPVwiK2VuY29kZVVSSUNvbXBvbmVudChoKSk7fSk7fWNhdGNoKGUpe3Rocm93IGIucHVzaChkK1widHlwZT1cIitlbmNvZGVVUklDb21wb25lbnQoXCJfYmFkbWFwXCIpKSxlO319ZnVuY3Rpb24gbmQoYSxiKXtjb25zdCBjPW5ldyBNYjtpZihsLkltYWdlKXtjb25zdCBkPW5ldyBJbWFnZTtkLm9ubG9hZD1qYShvZCxjLGQsXCJUZXN0TG9hZEltYWdlOiBsb2FkZWRcIiwhMCxiKTtkLm9uZXJyb3I9amEob2QsYyxkLFwiVGVzdExvYWRJbWFnZTogZXJyb3JcIiwhMSxiKTtkLm9uYWJvcnQ9amEob2QsYyxkLFwiVGVzdExvYWRJbWFnZTogYWJvcnRcIiwhMSxiKTtkLm9udGltZW91dD1qYShvZCxjLGQsXCJUZXN0TG9hZEltYWdlOiB0aW1lb3V0XCIsITEsYik7bC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aWYoZC5vbnRpbWVvdXQpZC5vbnRpbWVvdXQoKTt9LDFFNCk7ZC5zcmM9YTt9ZWxzZSBiKCExKTt9ZnVuY3Rpb24gb2QoYSxiLGMsZCxlKXt0cnl7Yi5vbmxvYWQ9bnVsbCxiLm9uZXJyb3I9bnVsbCxiLm9uYWJvcnQ9bnVsbCxiLm9udGltZW91dD1udWxsLGUoZCk7fWNhdGNoKGYpe319ZnVuY3Rpb24gcGQoYSl7dGhpcy5sPWEuJGJ8fG51bGw7dGhpcy5qPWEuaWJ8fCExO310KHBkLFliKTtwZC5wcm90b3R5cGUuZz1mdW5jdGlvbigpe3JldHVybiBuZXcgcWQodGhpcy5sLHRoaXMuail9O3BkLnByb3RvdHlwZS5pPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBhfX0oe30pO2Z1bmN0aW9uIHFkKGEsYil7Qy5jYWxsKHRoaXMpO3RoaXMuRD1hO3RoaXMudT1iO3RoaXMubT12b2lkIDA7dGhpcy5yZWFkeVN0YXRlPXJkO3RoaXMuc3RhdHVzPTA7dGhpcy5yZXNwb25zZVR5cGU9dGhpcy5yZXNwb25zZVRleHQ9dGhpcy5yZXNwb25zZT10aGlzLnN0YXR1c1RleHQ9XCJcIjt0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsO3RoaXMudj1uZXcgSGVhZGVyczt0aGlzLmg9bnVsbDt0aGlzLkM9XCJHRVRcIjt0aGlzLkI9XCJcIjt0aGlzLmc9ITE7dGhpcy5BPXRoaXMuaj10aGlzLmw9bnVsbDt9dChxZCxDKTt2YXIgcmQ9MDtrPXFkLnByb3RvdHlwZTtcbmsub3Blbj1mdW5jdGlvbihhLGIpe2lmKHRoaXMucmVhZHlTdGF0ZSE9cmQpdGhyb3cgdGhpcy5hYm9ydCgpLEVycm9yKFwiRXJyb3IgcmVvcGVuaW5nIGEgY29ubmVjdGlvblwiKTt0aGlzLkM9YTt0aGlzLkI9Yjt0aGlzLnJlYWR5U3RhdGU9MTtzZCh0aGlzKTt9O2suc2VuZD1mdW5jdGlvbihhKXtpZigxIT10aGlzLnJlYWR5U3RhdGUpdGhyb3cgdGhpcy5hYm9ydCgpLEVycm9yKFwibmVlZCB0byBjYWxsIG9wZW4oKSBmaXJzdC4gXCIpO3RoaXMuZz0hMDtjb25zdCBiPXtoZWFkZXJzOnRoaXMudixtZXRob2Q6dGhpcy5DLGNyZWRlbnRpYWxzOnRoaXMubSxjYWNoZTp2b2lkIDB9O2EmJihiLmJvZHk9YSk7KHRoaXMuRHx8bCkuZmV0Y2gobmV3IFJlcXVlc3QodGhpcy5CLGIpKS50aGVuKHRoaXMuVmEuYmluZCh0aGlzKSx0aGlzLmhhLmJpbmQodGhpcykpO307XG5rLmFib3J0PWZ1bmN0aW9uKCl7dGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dD1cIlwiO3RoaXMudj1uZXcgSGVhZGVyczt0aGlzLnN0YXR1cz0wO3RoaXMuaiYmdGhpcy5qLmNhbmNlbChcIlJlcXVlc3Qgd2FzIGFib3J0ZWQuXCIpOzE8PXRoaXMucmVhZHlTdGF0ZSYmdGhpcy5nJiY0IT10aGlzLnJlYWR5U3RhdGUmJih0aGlzLmc9ITEsdGQodGhpcykpO3RoaXMucmVhZHlTdGF0ZT1yZDt9O1xuay5WYT1mdW5jdGlvbihhKXtpZih0aGlzLmcmJih0aGlzLmw9YSx0aGlzLmh8fCh0aGlzLnN0YXR1cz10aGlzLmwuc3RhdHVzLHRoaXMuc3RhdHVzVGV4dD10aGlzLmwuc3RhdHVzVGV4dCx0aGlzLmg9YS5oZWFkZXJzLHRoaXMucmVhZHlTdGF0ZT0yLHNkKHRoaXMpKSx0aGlzLmcmJih0aGlzLnJlYWR5U3RhdGU9MyxzZCh0aGlzKSx0aGlzLmcpKSlpZihcImFycmF5YnVmZmVyXCI9PT10aGlzLnJlc3BvbnNlVHlwZSlhLmFycmF5QnVmZmVyKCkudGhlbih0aGlzLlRhLmJpbmQodGhpcyksdGhpcy5oYS5iaW5kKHRoaXMpKTtlbHNlIGlmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSYmXCJib2R5XCJpbiBhKXt0aGlzLmo9YS5ib2R5LmdldFJlYWRlcigpO2lmKHRoaXMudSl7aWYodGhpcy5yZXNwb25zZVR5cGUpdGhyb3cgRXJyb3IoJ3Jlc3BvbnNlVHlwZSBtdXN0IGJlIGVtcHR5IGZvciBcInN0cmVhbUJpbmFyeUNodW5rc1wiIG1vZGUgcmVzcG9uc2VzLicpO3RoaXMucmVzcG9uc2U9XG5bXTt9ZWxzZSB0aGlzLnJlc3BvbnNlPXRoaXMucmVzcG9uc2VUZXh0PVwiXCIsdGhpcy5BPW5ldyBUZXh0RGVjb2Rlcjt1ZCh0aGlzKTt9ZWxzZSBhLnRleHQoKS50aGVuKHRoaXMuVWEuYmluZCh0aGlzKSx0aGlzLmhhLmJpbmQodGhpcykpO307ZnVuY3Rpb24gdWQoYSl7YS5qLnJlYWQoKS50aGVuKGEuU2EuYmluZChhKSkuY2F0Y2goYS5oYS5iaW5kKGEpKTt9ay5TYT1mdW5jdGlvbihhKXtpZih0aGlzLmcpe2lmKHRoaXMudSYmYS52YWx1ZSl0aGlzLnJlc3BvbnNlLnB1c2goYS52YWx1ZSk7ZWxzZSBpZighdGhpcy51KXt2YXIgYj1hLnZhbHVlP2EudmFsdWU6bmV3IFVpbnQ4QXJyYXkoMCk7aWYoYj10aGlzLkEuZGVjb2RlKGIse3N0cmVhbTohYS5kb25lfSkpdGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dCs9Yjt9YS5kb25lP3RkKHRoaXMpOnNkKHRoaXMpOzM9PXRoaXMucmVhZHlTdGF0ZSYmdWQodGhpcyk7fX07XG5rLlVhPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQ9YSx0ZCh0aGlzKSk7fTtrLlRhPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9YSx0ZCh0aGlzKSk7fTtrLmhhPWZ1bmN0aW9uKCl7dGhpcy5nJiZ0ZCh0aGlzKTt9O2Z1bmN0aW9uIHRkKGEpe2EucmVhZHlTdGF0ZT00O2EubD1udWxsO2Euaj1udWxsO2EuQT1udWxsO3NkKGEpO31rLnNldFJlcXVlc3RIZWFkZXI9ZnVuY3Rpb24oYSxiKXt0aGlzLnYuYXBwZW5kKGEsYik7fTtrLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmg/dGhpcy5oLmdldChhLnRvTG93ZXJDYXNlKCkpfHxcIlwiOlwiXCJ9O1xuay5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXtpZighdGhpcy5oKXJldHVybiBcIlwiO2NvbnN0IGE9W10sYj10aGlzLmguZW50cmllcygpO2Zvcih2YXIgYz1iLm5leHQoKTshYy5kb25lOyljPWMudmFsdWUsYS5wdXNoKGNbMF0rXCI6IFwiK2NbMV0pLGM9Yi5uZXh0KCk7cmV0dXJuIGEuam9pbihcIlxcclxcblwiKX07ZnVuY3Rpb24gc2QoYSl7YS5vbnJlYWR5c3RhdGVjaGFuZ2UmJmEub25yZWFkeXN0YXRlY2hhbmdlLmNhbGwoYSk7fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShxZC5wcm90b3R5cGUsXCJ3aXRoQ3JlZGVudGlhbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIFwiaW5jbHVkZVwiPT09dGhpcy5tfSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5tPWE/XCJpbmNsdWRlXCI6XCJzYW1lLW9yaWdpblwiO319KTt2YXIgdmQ9bC5KU09OLnBhcnNlO2Z1bmN0aW9uIFgoYSl7Qy5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgUzt0aGlzLnU9YXx8bnVsbDt0aGlzLmg9ITE7dGhpcy5DPXRoaXMuZz1udWxsO3RoaXMuSD1cIlwiO3RoaXMubT0wO3RoaXMuaj1cIlwiO3RoaXMubD10aGlzLkY9dGhpcy52PXRoaXMuRD0hMTt0aGlzLkI9MDt0aGlzLkE9bnVsbDt0aGlzLko9d2Q7dGhpcy5LPXRoaXMuTD0hMTt9dChYLEMpO3ZhciB3ZD1cIlwiLHhkPS9eaHR0cHM/JC9pLHlkPVtcIlBPU1RcIixcIlBVVFwiXTtrPVgucHJvdG90eXBlO1xuay5lYT1mdW5jdGlvbihhLGIsYyxkKXtpZih0aGlzLmcpdGhyb3cgRXJyb3IoXCJbZ29vZy5uZXQuWGhySW9dIE9iamVjdCBpcyBhY3RpdmUgd2l0aCBhbm90aGVyIHJlcXVlc3Q9XCIrdGhpcy5IK1wiOyBuZXdVcmk9XCIrYSk7Yj1iP2IudG9VcHBlckNhc2UoKTpcIkdFVFwiO3RoaXMuSD1hO3RoaXMuaj1cIlwiO3RoaXMubT0wO3RoaXMuRD0hMTt0aGlzLmg9ITA7dGhpcy5nPXRoaXMudT90aGlzLnUuZygpOmNjLmcoKTt0aGlzLkM9dGhpcy51P1piKHRoaXMudSk6WmIoY2MpO3RoaXMuZy5vbnJlYWR5c3RhdGVjaGFuZ2U9cSh0aGlzLkZhLHRoaXMpO3RyeXt0aGlzLkY9ITAsdGhpcy5nLm9wZW4oYixTdHJpbmcoYSksITApLHRoaXMuRj0hMTt9Y2F0Y2goZil7emQodGhpcyxmKTtyZXR1cm59YT1jfHxcIlwiO2NvbnN0IGU9bmV3IFModGhpcy5oZWFkZXJzKTtkJiZLYyhkLGZ1bmN0aW9uKGYsaCl7ZS5zZXQoaCxmKTt9KTtkPW9hKGUuVCgpKTtjPWwuRm9ybURhdGEmJmEgaW5zdGFuY2VvZiBsLkZvcm1EYXRhO1xuISgwPD1tYSh5ZCxiKSl8fGR8fGN8fGUuc2V0KFwiQ29udGVudC1UeXBlXCIsXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOFwiKTtlLmZvckVhY2goZnVuY3Rpb24oZixoKXt0aGlzLmcuc2V0UmVxdWVzdEhlYWRlcihoLGYpO30sdGhpcyk7dGhpcy5KJiYodGhpcy5nLnJlc3BvbnNlVHlwZT10aGlzLkopO1wid2l0aENyZWRlbnRpYWxzXCJpbiB0aGlzLmcmJnRoaXMuZy53aXRoQ3JlZGVudGlhbHMhPT10aGlzLkwmJih0aGlzLmcud2l0aENyZWRlbnRpYWxzPXRoaXMuTCk7dHJ5e0FkKHRoaXMpLDA8dGhpcy5CJiYoKHRoaXMuSz1CZCh0aGlzLmcpKT8odGhpcy5nLnRpbWVvdXQ9dGhpcy5CLHRoaXMuZy5vbnRpbWVvdXQ9cSh0aGlzLnBhLHRoaXMpKTp0aGlzLkE9R2IodGhpcy5wYSx0aGlzLkIsdGhpcykpLHRoaXMudj0hMCx0aGlzLmcuc2VuZChhKSx0aGlzLnY9ITE7fWNhdGNoKGYpe3pkKHRoaXMsZik7fX07XG5mdW5jdGlvbiBCZChhKXtyZXR1cm4geSYmUmEoKSYmXCJudW1iZXJcIj09PXR5cGVvZiBhLnRpbWVvdXQmJnZvaWQgMCE9PWEub250aW1lb3V0fWZ1bmN0aW9uIHBhKGEpe3JldHVybiBcImNvbnRlbnQtdHlwZVwiPT1hLnRvTG93ZXJDYXNlKCl9ay5wYT1mdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiZ0aGlzLmcmJih0aGlzLmo9XCJUaW1lZCBvdXQgYWZ0ZXIgXCIrdGhpcy5CK1wibXMsIGFib3J0aW5nXCIsdGhpcy5tPTgsRCh0aGlzLFwidGltZW91dFwiKSx0aGlzLmFib3J0KDgpKTt9O2Z1bmN0aW9uIHpkKGEsYil7YS5oPSExO2EuZyYmKGEubD0hMCxhLmcuYWJvcnQoKSxhLmw9ITEpO2Euaj1iO2EubT01O0NkKGEpO0RkKGEpO31mdW5jdGlvbiBDZChhKXthLkR8fChhLkQ9ITAsRChhLFwiY29tcGxldGVcIiksRChhLFwiZXJyb3JcIikpO31cbmsuYWJvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5nJiZ0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSx0aGlzLm09YXx8NyxEKHRoaXMsXCJjb21wbGV0ZVwiKSxEKHRoaXMsXCJhYm9ydFwiKSxEZCh0aGlzKSk7fTtrLk09ZnVuY3Rpb24oKXt0aGlzLmcmJih0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSksRGQodGhpcywhMCkpO1guWi5NLmNhbGwodGhpcyk7fTtrLkZhPWZ1bmN0aW9uKCl7dGhpcy5zfHwodGhpcy5GfHx0aGlzLnZ8fHRoaXMubD9FZCh0aGlzKTp0aGlzLmNiKCkpO307ay5jYj1mdW5jdGlvbigpe0VkKHRoaXMpO307XG5mdW5jdGlvbiBFZChhKXtpZihhLmgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiYoIWEuQ1sxXXx8NCE9TyhhKXx8MiE9YS5iYSgpKSlpZihhLnYmJjQ9PU8oYSkpR2IoYS5GYSwwLGEpO2Vsc2UgaWYoRChhLFwicmVhZHlzdGF0ZWNoYW5nZVwiKSw0PT1PKGEpKXthLmg9ITE7dHJ5e2NvbnN0IG49YS5iYSgpO2E6c3dpdGNoKG4pe2Nhc2UgMjAwOmNhc2UgMjAxOmNhc2UgMjAyOmNhc2UgMjA0OmNhc2UgMjA2OmNhc2UgMzA0OmNhc2UgMTIyMzp2YXIgYj0hMDticmVhayBhO2RlZmF1bHQ6Yj0hMTt9dmFyIGM7aWYoIShjPWIpKXt2YXIgZDtpZihkPTA9PT1uKXt2YXIgZT1TdHJpbmcoYS5IKS5tYXRjaChNYylbMV18fG51bGw7aWYoIWUmJmwuc2VsZiYmbC5zZWxmLmxvY2F0aW9uKXt2YXIgZj1sLnNlbGYubG9jYXRpb24ucHJvdG9jb2w7ZT1mLnN1YnN0cigwLGYubGVuZ3RoLTEpO31kPSF4ZC50ZXN0KGU/ZS50b0xvd2VyQ2FzZSgpOlwiXCIpO31jPWQ7fWlmKGMpRChhLFwiY29tcGxldGVcIiksRChhLFxuXCJzdWNjZXNzXCIpO2Vsc2Uge2EubT02O3RyeXt2YXIgaD0yPE8oYSk/YS5nLnN0YXR1c1RleHQ6XCJcIjt9Y2F0Y2godSl7aD1cIlwiO31hLmo9aCtcIiBbXCIrYS5iYSgpK1wiXVwiO0NkKGEpO319ZmluYWxseXtEZChhKTt9fX1mdW5jdGlvbiBEZChhLGIpe2lmKGEuZyl7QWQoYSk7Y29uc3QgYz1hLmcsZD1hLkNbMF0/YWE6bnVsbDthLmc9bnVsbDthLkM9bnVsbDtifHxEKGEsXCJyZWFkeVwiKTt0cnl7Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZDt9Y2F0Y2goZSl7fX19ZnVuY3Rpb24gQWQoYSl7YS5nJiZhLksmJihhLmcub250aW1lb3V0PW51bGwpO2EuQSYmKGwuY2xlYXJUaW1lb3V0KGEuQSksYS5BPW51bGwpO31mdW5jdGlvbiBPKGEpe3JldHVybiBhLmc/YS5nLnJlYWR5U3RhdGU6MH1rLmJhPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiAyPE8odGhpcyk/dGhpcy5nLnN0YXR1czotMX1jYXRjaChhKXtyZXR1cm4gLTF9fTtcbmsuZ2E9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHRoaXMuZz90aGlzLmcucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIFwiXCJ9fTtrLlFhPWZ1bmN0aW9uKGEpe2lmKHRoaXMuZyl7dmFyIGI9dGhpcy5nLnJlc3BvbnNlVGV4dDthJiYwPT1iLmluZGV4T2YoYSkmJihiPWIuc3Vic3RyaW5nKGEubGVuZ3RoKSk7cmV0dXJuIHZkKGIpfX07ZnVuY3Rpb24gb2MoYSl7dHJ5e2lmKCFhLmcpcmV0dXJuIG51bGw7aWYoXCJyZXNwb25zZVwiaW4gYS5nKXJldHVybiBhLmcucmVzcG9uc2U7c3dpdGNoKGEuSil7Y2FzZSB3ZDpjYXNlIFwidGV4dFwiOnJldHVybiBhLmcucmVzcG9uc2VUZXh0O2Nhc2UgXCJhcnJheWJ1ZmZlclwiOmlmKFwibW96UmVzcG9uc2VBcnJheUJ1ZmZlclwiaW4gYS5nKXJldHVybiBhLmcubW96UmVzcG9uc2VBcnJheUJ1ZmZlcn1yZXR1cm4gbnVsbH1jYXRjaChiKXtyZXR1cm4gbnVsbH19ay5EYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm19O1xuay5MYT1mdW5jdGlvbigpe3JldHVybiBcInN0cmluZ1wiPT09dHlwZW9mIHRoaXMuaj90aGlzLmo6U3RyaW5nKHRoaXMuail9O2Z1bmN0aW9uIEZkKGEpe2xldCBiPVwiXCI7eGEoYSxmdW5jdGlvbihjLGQpe2IrPWQ7Yis9XCI6XCI7Yis9YztiKz1cIlxcclxcblwiO30pO3JldHVybiBifWZ1bmN0aW9uIEdkKGEsYixjKXthOntmb3IoZCBpbiBjKXt2YXIgZD0hMTticmVhayBhfWQ9ITA7fWR8fChjPUZkKGMpLFwic3RyaW5nXCI9PT10eXBlb2YgYT8obnVsbCE9YyYmZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSkpOlIoYSxiLGMpKTt9ZnVuY3Rpb24gSGQoYSxiLGMpe3JldHVybiBjJiZjLmludGVybmFsQ2hhbm5lbFBhcmFtcz9jLmludGVybmFsQ2hhbm5lbFBhcmFtc1thXXx8YjpifVxuZnVuY3Rpb24gSWQoYSl7dGhpcy56YT0wO3RoaXMubD1bXTt0aGlzLmg9bmV3IE1iO3RoaXMubGE9dGhpcy5vYT10aGlzLkY9dGhpcy5XPXRoaXMuZz10aGlzLnNhPXRoaXMuRD10aGlzLmFhPXRoaXMubz10aGlzLlA9dGhpcy5zPW51bGw7dGhpcy5aYT10aGlzLlY9MDt0aGlzLlhhPUhkKFwiZmFpbEZhc3RcIiwhMSxhKTt0aGlzLk49dGhpcy52PXRoaXMudT10aGlzLm09dGhpcy5qPW51bGw7dGhpcy5YPSEwO3RoaXMuST10aGlzLnRhPXRoaXMuVT0tMTt0aGlzLlk9dGhpcy5BPXRoaXMuQz0wO3RoaXMuUGE9SGQoXCJiYXNlUmV0cnlEZWxheU1zXCIsNUUzLGEpO3RoaXMuJGE9SGQoXCJyZXRyeURlbGF5U2VlZE1zXCIsMUU0LGEpO3RoaXMuWWE9SGQoXCJmb3J3YXJkQ2hhbm5lbE1heFJldHJpZXNcIiwyLGEpO3RoaXMucmE9SGQoXCJmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXNcIiwyRTQsYSk7dGhpcy5xYT1hJiZhLnhtbEh0dHBGYWN0b3J5fHx2b2lkIDA7dGhpcy5CYT1hJiZhLllifHwhMTtcbnRoaXMuSz12b2lkIDA7dGhpcy5IPWEmJmEuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy5KPVwiXCI7dGhpcy5pPW5ldyBnZChhJiZhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO3RoaXMuQ2E9bmV3IGxkO3RoaXMuamE9YSYmYS5mYXN0SGFuZHNoYWtlfHwhMTt0aGlzLlJhPWEmJmEuV2J8fCExO2EmJmEuQWEmJnRoaXMuaC5BYSgpO2EmJmEuZm9yY2VMb25nUG9sbGluZyYmKHRoaXMuWD0hMSk7dGhpcy4kPSF0aGlzLmphJiZ0aGlzLlgmJmEmJmEuZGV0ZWN0QnVmZmVyaW5nUHJveHl8fCExO3RoaXMua2E9dm9pZCAwO3RoaXMuTz0wO3RoaXMuTD0hMTt0aGlzLkI9bnVsbDt0aGlzLldhPSFhfHwhMSE9PWEuWGI7fWs9SWQucHJvdG90eXBlO2subWE9ODtrLkc9MTtcbmZ1bmN0aW9uIEljKGEpe0pkKGEpO2lmKDM9PWEuRyl7dmFyIGI9YS5WKyssYz1OKGEuRik7UihjLFwiU0lEXCIsYS5KKTtSKGMsXCJSSURcIixiKTtSKGMsXCJUWVBFXCIsXCJ0ZXJtaW5hdGVcIik7S2QoYSxjKTtiPW5ldyBNKGEsYS5oLGIsdm9pZCAwKTtiLks9MjtiLnY9amMoTihjKSk7Yz0hMTtsLm5hdmlnYXRvciYmbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbiYmKGM9bC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihiLnYudG9TdHJpbmcoKSxcIlwiKSk7IWMmJmwuSW1hZ2UmJigobmV3IEltYWdlKS5zcmM9Yi52LGM9ITApO2N8fChiLmc9bmMoYi5sLG51bGwpLGIuZy5lYShiLnYpKTtiLkY9RGF0ZS5ub3coKTtsYyhiKTt9TGQoYSk7fWsuaGI9ZnVuY3Rpb24oYSl7dHJ5e3RoaXMuaC5pbmZvKFwiT3JpZ2luIFRyaWFscyBpbnZva2VkOiBcIithKTt9Y2F0Y2goYil7fX07ZnVuY3Rpb24gQWMoYSl7YS5nJiYod2MoYSksYS5nLmNhbmNlbCgpLGEuZz1udWxsKTt9XG5mdW5jdGlvbiBKZChhKXtBYyhhKTthLnUmJihsLmNsZWFyVGltZW91dChhLnUpLGEudT1udWxsKTt6YyhhKTthLmkuY2FuY2VsKCk7YS5tJiYoXCJudW1iZXJcIj09PXR5cGVvZiBhLm0mJmwuY2xlYXJUaW1lb3V0KGEubSksYS5tPW51bGwpO31mdW5jdGlvbiBNZChhLGIpe2EubC5wdXNoKG5ldyBmZChhLlphKyssYikpOzM9PWEuRyYmSGMoYSk7fWZ1bmN0aW9uIEhjKGEpe2lkKGEuaSl8fGEubXx8KGEubT0hMCx6YihhLkhhLGEpLGEuQz0wKTt9ZnVuY3Rpb24gTmQoYSxiKXtpZihDYyhhLmkpPj1hLmkuai0oYS5tPzE6MCkpcmV0dXJuICExO2lmKGEubSlyZXR1cm4gYS5sPWIuRC5jb25jYXQoYS5sKSwhMDtpZigxPT1hLkd8fDI9PWEuR3x8YS5DPj0oYS5YYT8wOmEuWWEpKXJldHVybiAhMTthLm09SyhxKGEuSGEsYSxiKSxPZChhLGEuQykpO2EuQysrO3JldHVybiAhMH1cbmsuSGE9ZnVuY3Rpb24oYSl7aWYodGhpcy5tKWlmKHRoaXMubT1udWxsLDE9PXRoaXMuRyl7aWYoIWEpe3RoaXMuVj1NYXRoLmZsb29yKDFFNSpNYXRoLnJhbmRvbSgpKTthPXRoaXMuVisrO2NvbnN0IGU9bmV3IE0odGhpcyx0aGlzLmgsYSx2b2lkIDApO2xldCBmPXRoaXMuczt0aGlzLlAmJihmPyhmPXlhKGYpLEFhKGYsdGhpcy5QKSk6Zj10aGlzLlApO251bGw9PT10aGlzLm8mJihlLkg9Zik7aWYodGhpcy5qYSlhOnt2YXIgYj0wO2Zvcih2YXIgYz0wO2M8dGhpcy5sLmxlbmd0aDtjKyspe2I6e3ZhciBkPXRoaXMubFtjXTtpZihcIl9fZGF0YV9fXCJpbiBkLmcmJihkPWQuZy5fX2RhdGFfXyxcInN0cmluZ1wiPT09dHlwZW9mIGQpKXtkPWQubGVuZ3RoO2JyZWFrIGJ9ZD12b2lkIDA7fWlmKHZvaWQgMD09PWQpYnJlYWs7Yis9ZDtpZig0MDk2PGIpe2I9YzticmVhayBhfWlmKDQwOTY9PT1ifHxjPT09dGhpcy5sLmxlbmd0aC0xKXtiPWMrMTticmVhayBhfX1iPTFFMzt9ZWxzZSBiPTFFMztiPVxuUGQodGhpcyxlLGIpO2M9Tih0aGlzLkYpO1IoYyxcIlJJRFwiLGEpO1IoYyxcIkNWRVJcIiwyMik7dGhpcy5EJiZSKGMsXCJYLUhUVFAtU2Vzc2lvbi1JZFwiLHRoaXMuRCk7S2QodGhpcyxjKTt0aGlzLm8mJmYmJkdkKGMsdGhpcy5vLGYpO0RjKHRoaXMuaSxlKTt0aGlzLlJhJiZSKGMsXCJUWVBFXCIsXCJpbml0XCIpO3RoaXMuamE/KFIoYyxcIiRyZXFcIixiKSxSKGMsXCJTSURcIixcIm51bGxcIiksZS4kPSEwLGljKGUsYyxudWxsKSk6aWMoZSxjLGIpO3RoaXMuRz0yO319ZWxzZSAzPT10aGlzLkcmJihhP1FkKHRoaXMsYSk6MD09dGhpcy5sLmxlbmd0aHx8aWQodGhpcy5pKXx8UWQodGhpcykpO307XG5mdW5jdGlvbiBRZChhLGIpe3ZhciBjO2I/Yz1iLm06Yz1hLlYrKztjb25zdCBkPU4oYS5GKTtSKGQsXCJTSURcIixhLkopO1IoZCxcIlJJRFwiLGMpO1IoZCxcIkFJRFwiLGEuVSk7S2QoYSxkKTthLm8mJmEucyYmR2QoZCxhLm8sYS5zKTtjPW5ldyBNKGEsYS5oLGMsYS5DKzEpO251bGw9PT1hLm8mJihjLkg9YS5zKTtiJiYoYS5sPWIuRC5jb25jYXQoYS5sKSk7Yj1QZChhLGMsMUUzKTtjLnNldFRpbWVvdXQoTWF0aC5yb3VuZCguNSphLnJhKStNYXRoLnJvdW5kKC41KmEucmEqTWF0aC5yYW5kb20oKSkpO0RjKGEuaSxjKTtpYyhjLGQsYik7fWZ1bmN0aW9uIEtkKGEsYil7YS5qJiZLYyh7fSxmdW5jdGlvbihjLGQpe1IoYixkLGMpO30pO31cbmZ1bmN0aW9uIFBkKGEsYixjKXtjPU1hdGgubWluKGEubC5sZW5ndGgsYyk7dmFyIGQ9YS5qP3EoYS5qLk9hLGEuaixhKTpudWxsO2E6e3ZhciBlPWEubDtsZXQgZj0tMTtmb3IoOzspe2NvbnN0IGg9W1wiY291bnQ9XCIrY107LTE9PWY/MDxjPyhmPWVbMF0uaCxoLnB1c2goXCJvZnM9XCIrZikpOmY9MDpoLnB1c2goXCJvZnM9XCIrZik7bGV0IG49ITA7Zm9yKGxldCB1PTA7dTxjO3UrKyl7bGV0IG09ZVt1XS5oO2NvbnN0IHI9ZVt1XS5nO20tPWY7aWYoMD5tKWY9TWF0aC5tYXgoMCxlW3VdLmgtMTAwKSxuPSExO2Vsc2UgdHJ5e21kKHIsaCxcInJlcVwiK20rXCJfXCIpO31jYXRjaChHKXtkJiZkKHIpO319aWYobil7ZD1oLmpvaW4oXCImXCIpO2JyZWFrIGF9fX1hPWEubC5zcGxpY2UoMCxjKTtiLkQ9YTtyZXR1cm4gZH1mdW5jdGlvbiBHYyhhKXthLmd8fGEudXx8KGEuWT0xLHpiKGEuR2EsYSksYS5BPTApO31cbmZ1bmN0aW9uIEJjKGEpe2lmKGEuZ3x8YS51fHwzPD1hLkEpcmV0dXJuICExO2EuWSsrO2EudT1LKHEoYS5HYSxhKSxPZChhLGEuQSkpO2EuQSsrO3JldHVybiAhMH1rLkdhPWZ1bmN0aW9uKCl7dGhpcy51PW51bGw7UmQodGhpcyk7aWYodGhpcy4kJiYhKHRoaXMuTHx8bnVsbD09dGhpcy5nfHwwPj10aGlzLk8pKXt2YXIgYT0yKnRoaXMuTzt0aGlzLmguaW5mbyhcIkJQIGRldGVjdGlvbiB0aW1lciBlbmFibGVkOiBcIithKTt0aGlzLkI9SyhxKHRoaXMuYmIsdGhpcyksYSk7fX07ay5iYj1mdW5jdGlvbigpe3RoaXMuQiYmKHRoaXMuQj1udWxsLHRoaXMuaC5pbmZvKFwiQlAgZGV0ZWN0aW9uIHRpbWVvdXQgcmVhY2hlZC5cIiksdGhpcy5oLmluZm8oXCJCdWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQgYW5kIHN3aXRjaCB0byBsb25nLXBvbGxpbmchXCIpLHRoaXMuTj0hMSx0aGlzLkw9ITAsSigxMCksQWModGhpcyksUmQodGhpcykpO307XG5mdW5jdGlvbiB3YyhhKXtudWxsIT1hLkImJihsLmNsZWFyVGltZW91dChhLkIpLGEuQj1udWxsKTt9ZnVuY3Rpb24gUmQoYSl7YS5nPW5ldyBNKGEsYS5oLFwicnBjXCIsYS5ZKTtudWxsPT09YS5vJiYoYS5nLkg9YS5zKTthLmcuTz0wO3ZhciBiPU4oYS5vYSk7UihiLFwiUklEXCIsXCJycGNcIik7UihiLFwiU0lEXCIsYS5KKTtSKGIsXCJDSVwiLGEuTj9cIjBcIjpcIjFcIik7UihiLFwiQUlEXCIsYS5VKTtLZChhLGIpO1IoYixcIlRZUEVcIixcInhtbGh0dHBcIik7YS5vJiZhLnMmJkdkKGIsYS5vLGEucyk7YS5LJiZhLmcuc2V0VGltZW91dChhLkspO3ZhciBjPWEuZzthPWEubGE7Yy5LPTE7Yy52PWpjKE4oYikpO2Mucz1udWxsO2MuVT0hMDtrYyhjLGEpO31rLmFiPWZ1bmN0aW9uKCl7bnVsbCE9dGhpcy52JiYodGhpcy52PW51bGwsQWModGhpcyksQmModGhpcyksSigxOSkpO307ZnVuY3Rpb24gemMoYSl7bnVsbCE9YS52JiYobC5jbGVhclRpbWVvdXQoYS52KSxhLnY9bnVsbCk7fVxuZnVuY3Rpb24gdWMoYSxiKXt2YXIgYz1udWxsO2lmKGEuZz09Yil7emMoYSk7d2MoYSk7YS5nPW51bGw7dmFyIGQ9Mjt9ZWxzZSBpZih5YyhhLmksYikpYz1iLkQsRmMoYS5pLGIpLGQ9MTtlbHNlIHJldHVybjthLkk9Yi5OO2lmKDAhPWEuRylpZihiLmkpaWYoMT09ZCl7Yz1iLnM/Yi5zLmxlbmd0aDowO2I9RGF0ZS5ub3coKS1iLkY7dmFyIGU9YS5DO2Q9U2IoKTtEKGQsbmV3IFZiKGQsYyxiLGUpKTtIYyhhKTt9ZWxzZSBHYyhhKTtlbHNlIGlmKGU9Yi5vLDM9PWV8fDA9PWUmJjA8YS5JfHwhKDE9PWQmJk5kKGEsYil8fDI9PWQmJkJjKGEpKSlzd2l0Y2goYyYmMDxjLmxlbmd0aCYmKGI9YS5pLGIuaT1iLmkuY29uY2F0KGMpKSxlKXtjYXNlIDE6UShhLDUpO2JyZWFrO2Nhc2UgNDpRKGEsMTApO2JyZWFrO2Nhc2UgMzpRKGEsNik7YnJlYWs7ZGVmYXVsdDpRKGEsMik7fX1cbmZ1bmN0aW9uIE9kKGEsYil7bGV0IGM9YS5QYStNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqYS4kYSk7YS5qfHwoYyo9Mik7cmV0dXJuIGMqYn1mdW5jdGlvbiBRKGEsYil7YS5oLmluZm8oXCJFcnJvciBjb2RlIFwiK2IpO2lmKDI9PWIpe3ZhciBjPW51bGw7YS5qJiYoYz1udWxsKTt2YXIgZD1xKGEuamIsYSk7Y3x8KGM9bmV3IFUoXCIvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9jbGVhcmRvdC5naWZcIiksbC5sb2NhdGlvbiYmXCJodHRwXCI9PWwubG9jYXRpb24ucHJvdG9jb2x8fE9jKGMsXCJodHRwc1wiKSxqYyhjKSk7bmQoYy50b1N0cmluZygpLGQpO31lbHNlIEooMik7YS5HPTA7YS5qJiZhLmoudmEoYik7TGQoYSk7SmQoYSk7fWsuamI9ZnVuY3Rpb24oYSl7YT8odGhpcy5oLmluZm8oXCJTdWNjZXNzZnVsbHkgcGluZ2VkIGdvb2dsZS5jb21cIiksSigyKSk6KHRoaXMuaC5pbmZvKFwiRmFpbGVkIHRvIHBpbmcgZ29vZ2xlLmNvbVwiKSxKKDEpKTt9O1xuZnVuY3Rpb24gTGQoYSl7YS5HPTA7YS5JPS0xO2lmKGEuail7aWYoMCE9amQoYS5pKS5sZW5ndGh8fDAhPWEubC5sZW5ndGgpYS5pLmkubGVuZ3RoPTAscmEoYS5sKSxhLmwubGVuZ3RoPTA7YS5qLnVhKCk7fX1mdW5jdGlvbiBFYyhhLGIsYyl7bGV0IGQ9YWQoYyk7aWYoXCJcIiE9ZC5pKWImJlBjKGQsYitcIi5cIitkLmkpLFFjKGQsZC5tKTtlbHNlIHtjb25zdCBlPWwubG9jYXRpb247ZD1iZChlLnByb3RvY29sLGI/YitcIi5cIitlLmhvc3RuYW1lOmUuaG9zdG5hbWUsK2UucG9ydCxjKTt9YS5hYSYmeGEoYS5hYSxmdW5jdGlvbihlLGYpe1IoZCxmLGUpO30pO2I9YS5EO2M9YS5zYTtiJiZjJiZSKGQsYixjKTtSKGQsXCJWRVJcIixhLm1hKTtLZChhLGQpO3JldHVybiBkfVxuZnVuY3Rpb24gbmMoYSxiLGMpe2lmKGImJiFhLkgpdGhyb3cgRXJyb3IoXCJDYW4ndCBjcmVhdGUgc2Vjb25kYXJ5IGRvbWFpbiBjYXBhYmxlIFhocklvIG9iamVjdC5cIik7Yj1jJiZhLkJhJiYhYS5xYT9uZXcgWChuZXcgcGQoe2liOiEwfSkpOm5ldyBYKGEucWEpO2IuTD1hLkg7cmV0dXJuIGJ9ZnVuY3Rpb24gU2QoKXt9az1TZC5wcm90b3R5cGU7ay54YT1mdW5jdGlvbigpe307ay53YT1mdW5jdGlvbigpe307ay52YT1mdW5jdGlvbigpe307ay51YT1mdW5jdGlvbigpe307ay5PYT1mdW5jdGlvbigpe307ZnVuY3Rpb24gVGQoKXtpZih5JiYhKDEwPD1OdW1iZXIoVWEpKSl0aHJvdyBFcnJvcihcIkVudmlyb25tZW50YWwgZXJyb3I6IG5vIGF2YWlsYWJsZSB0cmFuc3BvcnQuXCIpO31UZC5wcm90b3R5cGUuZz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgWShhLGIpfTtcbmZ1bmN0aW9uIFkoYSxiKXtDLmNhbGwodGhpcyk7dGhpcy5nPW5ldyBJZChiKTt0aGlzLmw9YTt0aGlzLmg9YiYmYi5tZXNzYWdlVXJsUGFyYW1zfHxudWxsO2E9YiYmYi5tZXNzYWdlSGVhZGVyc3x8bnVsbDtiJiZiLmNsaWVudFByb3RvY29sSGVhZGVyUmVxdWlyZWQmJihhP2FbXCJYLUNsaWVudC1Qcm90b2NvbFwiXT1cIndlYmNoYW5uZWxcIjphPXtcIlgtQ2xpZW50LVByb3RvY29sXCI6XCJ3ZWJjaGFubmVsXCJ9KTt0aGlzLmcucz1hO2E9YiYmYi5pbml0TWVzc2FnZUhlYWRlcnN8fG51bGw7YiYmYi5tZXNzYWdlQ29udGVudFR5cGUmJihhP2FbXCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCJdPWIubWVzc2FnZUNvbnRlbnRUeXBlOmE9e1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiOmIubWVzc2FnZUNvbnRlbnRUeXBlfSk7YiYmYi55YSYmKGE/YVtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiXT1iLnlhOmE9e1wiWC1XZWJDaGFubmVsLUNsaWVudC1Qcm9maWxlXCI6Yi55YX0pO3RoaXMuZy5QPVxuYTsoYT1iJiZiLmh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0pJiYhc2EoYSkmJih0aGlzLmcubz1hKTt0aGlzLkE9YiYmYi5zdXBwb3J0c0Nyb3NzRG9tYWluWGhyfHwhMTt0aGlzLnY9YiYmYi5zZW5kUmF3SnNvbnx8ITE7KGI9YiYmYi5odHRwU2Vzc2lvbklkUGFyYW0pJiYhc2EoYikmJih0aGlzLmcuRD1iLGE9dGhpcy5oLG51bGwhPT1hJiZiIGluIGEmJihhPXRoaXMuaCxiIGluIGEmJmRlbGV0ZSBhW2JdKSk7dGhpcy5qPW5ldyBaKHRoaXMpO310KFksQyk7WS5wcm90b3R5cGUubT1mdW5jdGlvbigpe3RoaXMuZy5qPXRoaXMuajt0aGlzLkEmJih0aGlzLmcuSD0hMCk7dmFyIGE9dGhpcy5nLGI9dGhpcy5sLGM9dGhpcy5ofHx2b2lkIDA7YS5XYSYmKGEuaC5pbmZvKFwiT3JpZ2luIFRyaWFscyBlbmFibGVkLlwiKSx6YihxKGEuaGIsYSxiKSkpO0ooMCk7YS5XPWI7YS5hYT1jfHx7fTthLk49YS5YO2EuRj1FYyhhLG51bGwsYS5XKTtIYyhhKTt9O1kucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7SWModGhpcy5nKTt9O1xuWS5wcm90b3R5cGUudT1mdW5jdGlvbihhKXtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpe3ZhciBiPXt9O2IuX19kYXRhX189YTtNZCh0aGlzLmcsYik7fWVsc2UgdGhpcy52PyhiPXt9LGIuX19kYXRhX189cmIoYSksTWQodGhpcy5nLGIpKTpNZCh0aGlzLmcsYSk7fTtZLnByb3RvdHlwZS5NPWZ1bmN0aW9uKCl7dGhpcy5nLmo9bnVsbDtkZWxldGUgdGhpcy5qO0ljKHRoaXMuZyk7ZGVsZXRlIHRoaXMuZztZLlouTS5jYWxsKHRoaXMpO307ZnVuY3Rpb24gVWQoYSl7YWMuY2FsbCh0aGlzKTt2YXIgYj1hLl9fc21fXztpZihiKXthOntmb3IoY29uc3QgYyBpbiBiKXthPWM7YnJlYWsgYX1hPXZvaWQgMDt9aWYodGhpcy5pPWEpYT10aGlzLmksYj1udWxsIT09YiYmYSBpbiBiP2JbYV06dm9pZCAwO3RoaXMuZGF0YT1iO31lbHNlIHRoaXMuZGF0YT1hO310KFVkLGFjKTtmdW5jdGlvbiBWZCgpe2JjLmNhbGwodGhpcyk7dGhpcy5zdGF0dXM9MTt9dChWZCxiYyk7ZnVuY3Rpb24gWihhKXt0aGlzLmc9YTt9XG50KFosU2QpO1oucHJvdG90eXBlLnhhPWZ1bmN0aW9uKCl7RCh0aGlzLmcsXCJhXCIpO307Wi5wcm90b3R5cGUud2E9ZnVuY3Rpb24oYSl7RCh0aGlzLmcsbmV3IFVkKGEpKTt9O1oucHJvdG90eXBlLnZhPWZ1bmN0aW9uKGEpe0QodGhpcy5nLG5ldyBWZChhKSk7fTtaLnByb3RvdHlwZS51YT1mdW5jdGlvbigpe0QodGhpcy5nLFwiYlwiKTt9Oy8qXG5cbiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG5cbiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cbiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiovXG5UZC5wcm90b3R5cGUuY3JlYXRlV2ViQ2hhbm5lbD1UZC5wcm90b3R5cGUuZztZLnByb3RvdHlwZS5zZW5kPVkucHJvdG90eXBlLnU7WS5wcm90b3R5cGUub3Blbj1ZLnByb3RvdHlwZS5tO1kucHJvdG90eXBlLmNsb3NlPVkucHJvdG90eXBlLmNsb3NlO1diLk5PX0VSUk9SPTA7V2IuVElNRU9VVD04O1diLkhUVFBfRVJST1I9NjtYYi5DT01QTEVURT1cImNvbXBsZXRlXCI7JGIuRXZlbnRUeXBlPUw7TC5PUEVOPVwiYVwiO0wuQ0xPU0U9XCJiXCI7TC5FUlJPUj1cImNcIjtMLk1FU1NBR0U9XCJkXCI7Qy5wcm90b3R5cGUubGlzdGVuPUMucHJvdG90eXBlLk47WC5wcm90b3R5cGUubGlzdGVuT25jZT1YLnByb3RvdHlwZS5PO1gucHJvdG90eXBlLmdldExhc3RFcnJvcj1YLnByb3RvdHlwZS5MYTtYLnByb3RvdHlwZS5nZXRMYXN0RXJyb3JDb2RlPVgucHJvdG90eXBlLkRhO1gucHJvdG90eXBlLmdldFN0YXR1cz1YLnByb3RvdHlwZS5iYTtYLnByb3RvdHlwZS5nZXRSZXNwb25zZUpzb249WC5wcm90b3R5cGUuUWE7XG5YLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQ9WC5wcm90b3R5cGUuZ2E7WC5wcm90b3R5cGUuc2VuZD1YLnByb3RvdHlwZS5lYTt2YXIgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCA9IGVzbS5jcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBUZH07dmFyIGdldFN0YXRFdmVudFRhcmdldCA9IGVzbS5nZXRTdGF0RXZlbnRUYXJnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gU2IoKX07dmFyIEVycm9yQ29kZSA9IGVzbS5FcnJvckNvZGU9V2I7dmFyIEV2ZW50VHlwZSA9IGVzbS5FdmVudFR5cGU9WGI7dmFyIEV2ZW50ID0gZXNtLkV2ZW50PUg7dmFyIFN0YXQgPSBlc20uU3RhdD17cmI6MCx1YjoxLHZiOjIsT2I6MyxUYjo0LFFiOjUsUmI6NixQYjo3LE5iOjgsU2I6OSxQUk9YWToxMCxOT1BST1hZOjExLExiOjEyLEhiOjEzLEliOjE0LEdiOjE1LEpiOjE2LEtiOjE3LG5iOjE4LG1iOjE5LG9iOjIwfTt2YXIgRmV0Y2hYbWxIdHRwRmFjdG9yeSA9IGVzbS5GZXRjaFhtbEh0dHBGYWN0b3J5PXBkO3ZhciBXZWJDaGFubmVsID0gZXNtLldlYkNoYW5uZWw9JGI7XG52YXIgWGhySW8gPSBlc20uWGhySW89WDtcblxuZXhwb3J0IHsgRXJyb3JDb2RlLCBFdmVudCwgRXZlbnRUeXBlLCBGZXRjaFhtbEh0dHBGYWN0b3J5LCBTdGF0LCBXZWJDaGFubmVsLCBYaHJJbywgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgZXNtIGFzIGRlZmF1bHQsIGdldFN0YXRFdmVudFRhcmdldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IF9yZWdpc3RlckNvbXBvbmVudCwgcmVnaXN0ZXJWZXJzaW9uLCBfZ2V0UHJvdmlkZXIsIGdldEFwcCwgX3JlbW92ZVNlcnZpY2VJbnN0YW5jZSwgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBMb2dMZXZlbCB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciwgY3JlYXRlTW9ja1VzZXJUb2tlbiwgZ2V0TW9kdWxhckluc3RhbmNlLCBkZWVwRXF1YWwsIGdldFVBLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNTYWZhcmksIGlzTW9iaWxlQ29yZG92YSwgaXNSZWFjdE5hdGl2ZSwgaXNFbGVjdHJvbiwgaXNJRSwgaXNVV1AsIGlzQnJvd3NlckV4dGVuc2lvbiB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFhocklvLCBFdmVudFR5cGUsIEVycm9yQ29kZSwgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgZ2V0U3RhdEV2ZW50VGFyZ2V0LCBGZXRjaFhtbEh0dHBGYWN0b3J5LCBXZWJDaGFubmVsLCBFdmVudCwgU3RhdCB9IGZyb20gJ0BmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXInO1xuXG5jb25zdCBEID0gXCJAZmlyZWJhc2UvZmlyZXN0b3JlXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNpbXBsZSB3cmFwcGVyIGFyb3VuZCBhIG51bGxhYmxlIFVJRC4gTW9zdGx5IGV4aXN0cyB0byBtYWtlIGNvZGUgbW9yZVxuICogcmVhZGFibGUuXG4gKi9cbmNsYXNzIEMge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy51aWQgPSB0O1xuICAgIH1cbiAgICBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMudWlkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEga2V5IHJlcHJlc2VudGluZyB0aGlzIHVzZXIsIHN1aXRhYmxlIGZvciBpbmNsdXNpb24gaW4gYVxuICAgICAqIGRpY3Rpb25hcnkuXG4gICAgICovICAgIHRvS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0F1dGhlbnRpY2F0ZWQoKSA/IFwidWlkOlwiICsgdGhpcy51aWQgOiBcImFub255bW91cy11c2VyXCI7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdC51aWQgPT09IHRoaXMudWlkO1xuICAgIH1cbn1cblxuLyoqIEEgdXNlciB3aXRoIGEgbnVsbCBVSUQuICovIEMuVU5BVVRIRU5USUNBVEVEID0gbmV3IEMobnVsbCksIFxuLy8gVE9ETyhtaWtlbGVoZW4pOiBMb29rIGludG8gZ2V0dGluZyBhIHByb3BlciB1aWQtZXF1aXZhbGVudCBmb3Jcbi8vIG5vbi1GaXJlYmFzZUF1dGggcHJvdmlkZXJzLlxuQy5HT09HTEVfQ1JFREVOVElBTFMgPSBuZXcgQyhcImdvb2dsZS1jcmVkZW50aWFscy11aWRcIiksIEMuRklSU1RfUEFSVFkgPSBuZXcgQyhcImZpcnN0LXBhcnR5LXVpZFwiKSwgXG5DLk1PQ0tfVVNFUiA9IG5ldyBDKFwibW9jay11c2VyXCIpO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xubGV0IHggPSBcIjkuOC4wXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBOID0gbmV3IExvZ2dlcihcIkBmaXJlYmFzZS9maXJlc3RvcmVcIik7XG5cbi8vIEhlbHBlciBtZXRob2RzIGFyZSBuZWVkZWQgYmVjYXVzZSB2YXJpYWJsZXMgY2FuJ3QgYmUgZXhwb3J0ZWQgYXMgcmVhZC93cml0ZVxuZnVuY3Rpb24gaygpIHtcbiAgICByZXR1cm4gTi5sb2dMZXZlbDtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSB2ZXJib3NpdHkgb2YgQ2xvdWQgRmlyZXN0b3JlIGxvZ3MgKGRlYnVnLCBlcnJvciwgb3Igc2lsZW50KS5cbiAqXG4gKiBAcGFyYW0gbG9nTGV2ZWwgLSBUaGUgdmVyYm9zaXR5IHlvdSBzZXQgZm9yIGFjdGl2aXR5IGFuZCBlcnJvciBsb2dnaW5nLiBDYW5cbiAqICAgYmUgYW55IG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOlxuICpcbiAqICAgPHVsPlxuICogICAgIDxsaT5gZGVidWdgIGZvciB0aGUgbW9zdCB2ZXJib3NlIGxvZ2dpbmcgbGV2ZWwsIHByaW1hcmlseSBmb3JcbiAqICAgICBkZWJ1Z2dpbmcuPC9saT5cbiAqICAgICA8bGk+YGVycm9yYCB0byBsb2cgZXJyb3JzIG9ubHkuPC9saT5cbiAqICAgICA8bGk+PGNvZGU+YHNpbGVudGAgdG8gdHVybiBvZmYgbG9nZ2luZy48L2xpPlxuICogICA8L3VsPlxuICovIGZ1bmN0aW9uIE0odCkge1xuICAgIE4uc2V0TG9nTGV2ZWwodCk7XG59XG5cbmZ1bmN0aW9uIE8odCwgLi4uZSkge1xuICAgIGlmIChOLmxvZ0xldmVsIDw9IExvZ0xldmVsLkRFQlVHKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLm1hcChCKTtcbiAgICAgICAgTi5kZWJ1ZyhgRmlyZXN0b3JlICgke3h9KTogJHt0fWAsIC4uLm4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gRih0LCAuLi5lKSB7XG4gICAgaWYgKE4ubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEIpO1xuICAgICAgICBOLmVycm9yKGBGaXJlc3RvcmUgKCR7eH0pOiAke3R9YCwgLi4ubik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uICQodCwgLi4uZSkge1xuICAgIGlmIChOLmxvZ0xldmVsIDw9IExvZ0xldmVsLldBUk4pIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEIpO1xuICAgICAgICBOLndhcm4oYEZpcmVzdG9yZSAoJHt4fSk6ICR7dH1gLCAuLi5uKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYWRkaXRpb25hbCBsb2cgcGFyYW1ldGVyIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIEIodCkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gdDtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZSA9IHQsIEpTT04uc3RyaW5naWZ5KGUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gQ29udmVydGluZyB0byBKU09OIGZhaWxlZCwganVzdCBsb2cgdGhlIG9iamVjdCBkaXJlY3RseVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKiogRm9ybWF0cyBhbiBvYmplY3QgYXMgYSBKU09OIHN0cmluZywgc3VpdGFibGUgZm9yIGxvZ2dpbmcuICovXG4gICAgdmFyIGU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cbiAqIE1lc3NhZ2VzIGFyZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uIGJ1aWxkcy5cbiAqXG4gKiBSZXR1cm5zIGBuZXZlcmAgYW5kIGNhbiBiZSB1c2VkIGluIGV4cHJlc3Npb25zOlxuICogQGV4YW1wbGVcbiAqIGxldCBmdXR1cmVWYXIgPSBmYWlsKCdub3QgaW1wbGVtZW50ZWQgeWV0Jyk7XG4gKi8gZnVuY3Rpb24gTCh0ID0gXCJVbmV4cGVjdGVkIHN0YXRlXCIpIHtcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXG4gICAgLy8gZXhjZXB0aW9uIGlzIHN3YWxsb3dlZC5cbiAgICBjb25zdCBlID0gYEZJUkVTVE9SRSAoJHt4fSkgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogYCArIHQ7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmVzdG9yZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXG4gICAgdGhyb3cgRihlKSwgbmV3IEVycm9yKGUpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogTWVzc2FnZXMgYXJlIHN0cmlwcGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICovIGZ1bmN0aW9uIFUodCwgZSkge1xuICAgIHQgfHwgTCgpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogVGhlIGNvZGUgb2YgY2FsbHNpdGVzIGludm9raW5nIHRoaXMgZnVuY3Rpb24gYXJlIHN0cmlwcGVkIG91dCBpbiBwcm9kdWN0aW9uXG4gKiBidWlsZHMuIEFueSBzaWRlLWVmZmVjdHMgb2YgY29kZSB3aXRoaW4gdGhlIGRlYnVnQXNzZXJ0KCkgaW52b2NhdGlvbiB3aWxsIG5vdFxuICogaGFwcGVuIGluIHRoaXMgY2FzZS5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBxKHQsIGUpIHtcbiAgICB0IHx8IEwoKTtcbn1cblxuLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAuIEluIG5vbi1wcm9kdWN0aW9uIGJ1aWxkcywgdmVyaWZpZXMgdGhhdCBgb2JqYCBpcyBhblxuICogaW5zdGFuY2Ugb2YgYFRgIGJlZm9yZSBjYXN0aW5nLlxuICovIGZ1bmN0aW9uIEsodCwgXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZSkge1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBHID0ge1xuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xuICAgIE9LOiBcIm9rXCIsXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xuICAgIENBTkNFTExFRDogXCJjYW5jZWxsZWRcIixcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cbiAgICBVTktOT1dOOiBcInVua25vd25cIixcbiAgICAvKipcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcbiAgICAgKiBuYW1lKS5cbiAgICAgKi9cbiAgICBJTlZBTElEX0FSR1VNRU5UOiBcImludmFsaWQtYXJndW1lbnRcIixcbiAgICAvKipcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXG4gICAgICogZXhwaXJlLlxuICAgICAqL1xuICAgIERFQURMSU5FX0VYQ0VFREVEOiBcImRlYWRsaW5lLWV4Y2VlZGVkXCIsXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXG4gICAgTk9UX0ZPVU5EOiBcIm5vdC1mb3VuZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcbiAgICAgKiBleGlzdHMuXG4gICAgICovXG4gICAgQUxSRUFEWV9FWElTVFM6IFwiYWxyZWFkeS1leGlzdHNcIixcbiAgICAvKipcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbiBub3QgYmUgaWRlbnRpZmllZFxuICAgICAqICh1c2UgVU5BVVRIRU5USUNBVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICovXG4gICAgUEVSTUlTU0lPTl9ERU5JRUQ6IFwicGVybWlzc2lvbi1kZW5pZWRcIixcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIHZhbGlkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGVcbiAgICAgKiBvcGVyYXRpb24uXG4gICAgICovXG4gICAgVU5BVVRIRU5USUNBVEVEOiBcInVuYXV0aGVudGljYXRlZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgcmVzb3VyY2UgaGFzIGJlZW4gZXhoYXVzdGVkLCBwZXJoYXBzIGEgcGVyLXVzZXIgcXVvdGEsIG9yIHBlcmhhcHMgdGhlXG4gICAgICogZW50aXJlIGZpbGUgc3lzdGVtIGlzIG91dCBvZiBzcGFjZS5cbiAgICAgKi9cbiAgICBSRVNPVVJDRV9FWEhBVVNURUQ6IFwicmVzb3VyY2UtZXhoYXVzdGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyByZWplY3RlZCBiZWNhdXNlIHRoZSBzeXN0ZW0gaXMgbm90IGluIGEgc3RhdGUgcmVxdWlyZWQgZm9yXG4gICAgICogdGhlIG9wZXJhdGlvbidzIGV4ZWN1dGlvbi4gRm9yIGV4YW1wbGUsIGRpcmVjdG9yeSB0byBiZSBkZWxldGVkIG1heSBiZVxuICAgICAqIG5vbi1lbXB0eSwgYW4gcm1kaXIgb3BlcmF0aW9uIGlzIGFwcGxpZWQgdG8gYSBub24tZGlyZWN0b3J5LCBldGMuXG4gICAgICpcbiAgICAgKiBBIGxpdG11cyB0ZXN0IHRoYXQgbWF5IGhlbHAgYSBzZXJ2aWNlIGltcGxlbWVudG9yIGluIGRlY2lkaW5nXG4gICAgICogYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELCBhbmQgVU5BVkFJTEFCTEU6XG4gICAgICogIChhKSBVc2UgVU5BVkFJTEFCTEUgaWYgdGhlIGNsaWVudCBjYW4gcmV0cnkganVzdCB0aGUgZmFpbGluZyBjYWxsLlxuICAgICAqICAoYikgVXNlIEFCT1JURUQgaWYgdGhlIGNsaWVudCBzaG91bGQgcmV0cnkgYXQgYSBoaWdoZXItbGV2ZWxcbiAgICAgKiAgICAgIChlLmcuLCByZXN0YXJ0aW5nIGEgcmVhZC1tb2RpZnktd3JpdGUgc2VxdWVuY2UpLlxuICAgICAqICAoYykgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVudGlsXG4gICAgICogICAgICB0aGUgc3lzdGVtIHN0YXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgZml4ZWQuIEUuZy4sIGlmIGFuIFwicm1kaXJcIlxuICAgICAqICAgICAgZmFpbHMgYmVjYXVzZSB0aGUgZGlyZWN0b3J5IGlzIG5vbi1lbXB0eSwgRkFJTEVEX1BSRUNPTkRJVElPTlxuICAgICAqICAgICAgc2hvdWxkIGJlIHJldHVybmVkIHNpbmNlIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bmxlc3NcbiAgICAgKiAgICAgIHRoZXkgaGF2ZSBmaXJzdCBmaXhlZCB1cCB0aGUgZGlyZWN0b3J5IGJ5IGRlbGV0aW5nIGZpbGVzIGZyb20gaXQuXG4gICAgICogIChkKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHBlcmZvcm1zIGNvbmRpdGlvbmFsXG4gICAgICogICAgICBSRVNUIEdldC9VcGRhdGUvRGVsZXRlIG9uIGEgcmVzb3VyY2UgYW5kIHRoZSByZXNvdXJjZSBvbiB0aGVcbiAgICAgKiAgICAgIHNlcnZlciBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZGl0aW9uLiBFLmcuLCBjb25mbGljdGluZ1xuICAgICAqICAgICAgcmVhZC1tb2RpZnktd3JpdGUgb24gdGhlIHNhbWUgcmVzb3VyY2UuXG4gICAgICovXG4gICAgRkFJTEVEX1BSRUNPTkRJVElPTjogXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIsXG4gICAgLyoqXG4gICAgICogVGhlIG9wZXJhdGlvbiB3YXMgYWJvcnRlZCwgdHlwaWNhbGx5IGR1ZSB0byBhIGNvbmN1cnJlbmN5IGlzc3VlIGxpa2VcbiAgICAgKiBzZXF1ZW5jZXIgY2hlY2sgZmFpbHVyZXMsIHRyYW5zYWN0aW9uIGFib3J0cywgZXRjLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIEFCT1JURUQ6IFwiYWJvcnRlZFwiLFxuICAgIC8qKlxuICAgICAqIE9wZXJhdGlvbiB3YXMgYXR0ZW1wdGVkIHBhc3QgdGhlIHZhbGlkIHJhbmdlLiBFLmcuLCBzZWVraW5nIG9yIHJlYWRpbmdcbiAgICAgKiBwYXN0IGVuZCBvZiBmaWxlLlxuICAgICAqXG4gICAgICogVW5saWtlIElOVkFMSURfQVJHVU1FTlQsIHRoaXMgZXJyb3IgaW5kaWNhdGVzIGEgcHJvYmxlbSB0aGF0IG1heSBiZSBmaXhlZFxuICAgICAqIGlmIHRoZSBzeXN0ZW0gc3RhdGUgY2hhbmdlcy4gRm9yIGV4YW1wbGUsIGEgMzItYml0IGZpbGUgc3lzdGVtIHdpbGxcbiAgICAgKiBnZW5lcmF0ZSBJTlZBTElEX0FSR1VNRU5UIGlmIGFza2VkIHRvIHJlYWQgYXQgYW4gb2Zmc2V0IHRoYXQgaXMgbm90IGluIHRoZVxuICAgICAqIHJhbmdlIFswLDJeMzItMV0sIGJ1dCBpdCB3aWxsIGdlbmVyYXRlIE9VVF9PRl9SQU5HRSBpZiBhc2tlZCB0byByZWFkIGZyb21cbiAgICAgKiBhbiBvZmZzZXQgcGFzdCB0aGUgY3VycmVudCBmaWxlIHNpemUuXG4gICAgICpcbiAgICAgKiBUaGVyZSBpcyBhIGZhaXIgYml0IG9mIG92ZXJsYXAgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxuICAgICAqIE9VVF9PRl9SQU5HRS4gV2UgcmVjb21tZW5kIHVzaW5nIE9VVF9PRl9SQU5HRSAodGhlIG1vcmUgc3BlY2lmaWMgZXJyb3IpXG4gICAgICogd2hlbiBpdCBhcHBsaWVzIHNvIHRoYXQgY2FsbGVycyB3aG8gYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGEgc3BhY2UgY2FuXG4gICAgICogZWFzaWx5IGxvb2sgZm9yIGFuIE9VVF9PRl9SQU5HRSBlcnJvciB0byBkZXRlY3Qgd2hlbiB0aGV5IGFyZSBkb25lLlxuICAgICAqL1xuICAgIE9VVF9PRl9SQU5HRTogXCJvdXQtb2YtcmFuZ2VcIixcbiAgICAvKiogT3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCBvciBub3Qgc3VwcG9ydGVkL2VuYWJsZWQgaW4gdGhpcyBzZXJ2aWNlLiAqL1xuICAgIFVOSU1QTEVNRU5URUQ6IFwidW5pbXBsZW1lbnRlZFwiLFxuICAgIC8qKlxuICAgICAqIEludGVybmFsIGVycm9ycy4gTWVhbnMgc29tZSBpbnZhcmlhbnRzIGV4cGVjdGVkIGJ5IHVuZGVybHlpbmcgU3lzdGVtIGhhc1xuICAgICAqIGJlZW4gYnJva2VuLiBJZiB5b3Ugc2VlIG9uZSBvZiB0aGVzZSBlcnJvcnMsIFNvbWV0aGluZyBpcyB2ZXJ5IGJyb2tlbi5cbiAgICAgKi9cbiAgICBJTlRFUk5BTDogXCJpbnRlcm5hbFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXJ2aWNlIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gVGhpcyBpcyBhIG1vc3QgbGlrZWx5IGEgdHJhbnNpZW50XG4gICAgICogY29uZGl0aW9uIGFuZCBtYXkgYmUgY29ycmVjdGVkIGJ5IHJldHJ5aW5nIHdpdGggYSBiYWNrb2ZmLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIFVOQVZBSUxBQkxFOiBcInVuYXZhaWxhYmxlXCIsXG4gICAgLyoqIFVucmVjb3ZlcmFibGUgZGF0YSBsb3NzIG9yIGNvcnJ1cHRpb24uICovXG4gICAgREFUQV9MT1NTOiBcImRhdGEtbG9zc1wiXG59O1xuXG4vKiogQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgb3BlcmF0aW9uLiAqLyBjbGFzcyBRIGV4dGVuZHMgRmlyZWJhc2VFcnJvciB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgYmFja2VuZCBlcnJvciBjb2RlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGVycm9yLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIEEgY3VzdG9tIGVycm9yIGRlc2NyaXB0aW9uLlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgc3VwZXIodCwgZSksIHRoaXMuY29kZSA9IHQsIHRoaXMubWVzc2FnZSA9IGUsIFxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cbiAgICAgICAgdGhpcy50b1N0cmluZyA9ICgpID0+IGAke3RoaXMubmFtZX06IFtjb2RlPSR7dGhpcy5jb2RlfV06ICR7dGhpcy5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBqIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSB0LCB0aGlzLnJlamVjdCA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFcge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51c2VyID0gZSwgdGhpcy50eXBlID0gXCJPQXV0aFwiLCB0aGlzLmhlYWRlcnMgPSBuZXcgTWFwLCB0aGlzLmhlYWRlcnMuc2V0KFwiQXV0aG9yaXphdGlvblwiLCBgQmVhcmVyICR7dH1gKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHoge1xuICAgIGdldFRva2VuKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKEMuVU5BVVRIRU5USUNBVEVEKSkpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG59XG5cbi8qKlxuICogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHJldHVybnMgYSBjb25zdGFudCB0b2tlbi4gVXNlZCBmb3JcbiAqIGVtdWxhdG9yIHRva2VuIG1vY2tpbmcuXG4gKi8gY2xhc3MgSCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnRva2VuID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdG9yZXMgdGhlIGxpc3RlbmVyIHJlZ2lzdGVyZWQgd2l0aCBzZXRDaGFuZ2VMaXN0ZW5lcigpXG4gICAgICAgICAqIFRoaXMgaXNuJ3QgYWN0dWFsbHkgbmVjZXNzYXJ5IHNpbmNlIHRoZSBVSUQgbmV2ZXIgY2hhbmdlcywgYnV0IHdlIHVzZSB0aGlzXG4gICAgICAgICAqIHRvIHZlcmlmeSB0aGUgbGlzdGVuIGNvbnRyYWN0IGlzIGFkaGVyZWQgdG8gaW4gdGVzdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy50b2tlbik7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gZSwgXG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVzZXIuXG4gICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gZSh0aGlzLnRva2VuLnVzZXIpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcbiAgICB9XG59XG5cbmNsYXNzIEoge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy50ID0gdCwgXG4gICAgICAgIC8qKiBUcmFja3MgdGhlIGN1cnJlbnQgVXNlci4gKi9cbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IEMuVU5BVVRIRU5USUNBVEVELCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvdW50ZXIgdXNlZCB0byBkZXRlY3QgaWYgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgYSBnZXRUb2tlbiByZXF1ZXN0IHdhc1xuICAgICAgICAgKiBvdXRzdGFuZGluZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaSA9IDAsIHRoaXMuZm9yY2VSZWZyZXNoID0gITEsIHRoaXMuYXV0aCA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSB0aGlzLmk7XG4gICAgICAgIC8vIEEgY2hhbmdlIGxpc3RlbmVyIHRoYXQgcHJldmVudHMgZG91YmxlLWZpcmluZyBmb3IgdGhlIHNhbWUgdG9rZW4gY2hhbmdlLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0ID0+IHRoaXMuaSAhPT0gbiA/IChuID0gdGhpcy5pLCBlKHQpKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAvLyBBIHByb21pc2UgdGhhdCBjYW4gYmUgd2FpdGVkIG9uIHRvIGJsb2NrIG9uIHRoZSBuZXh0IHRva2VuIGNoYW5nZS5cbiAgICAgICAgLy8gVGhpcyBwcm9taXNlIGlzIHJlLWNyZWF0ZWQgYWZ0ZXIgZWFjaCBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgbGV0IGkgPSBuZXcgajtcbiAgICAgICAgdGhpcy5vID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pKyssIHRoaXMuY3VycmVudFVzZXIgPSB0aGlzLnUoKSwgaS5yZXNvbHZlKCksIGkgPSBuZXcgaiwgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBzKHRoaXMuY3VycmVudFVzZXIpKSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHIgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gaTtcbiAgICAgICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IGUucHJvbWlzZSwgYXdhaXQgcyh0aGlzLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSwgbyA9IHQgPT4ge1xuICAgICAgICAgICAgTyhcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJBdXRoIGRldGVjdGVkXCIpLCB0aGlzLmF1dGggPSB0LCB0aGlzLmF1dGguYWRkQXV0aFRva2VuTGlzdGVuZXIodGhpcy5vKSwgXG4gICAgICAgICAgICByKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudC5vbkluaXQoKHQgPT4gbyh0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEF1dGggcmlnaHQgYWZ0ZXIgRmlyZXN0b3JlLCBzbyB3ZSBnaXZlIGl0XG4gICAgICAgIC8vIGEgY2hhbmNlIHRvIHJlZ2lzdGVyIGl0c2VsZiB3aXRoIHRoZSBjb21wb25lbnQgZnJhbWV3b3JrIGJlZm9yZSB3ZVxuICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0byBzdGFydCB1cCBpbiB1bmF1dGhlbnRpY2F0ZWQgbW9kZS5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1dGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy50LmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHQgPyBvKHQpIDogKFxuICAgICAgICAgICAgICAgIC8vIElmIGF1dGggaXMgc3RpbGwgbm90IGF2YWlsYWJsZSwgcHJvY2VlZCB3aXRoIGBudWxsYCB1c2VyXG4gICAgICAgICAgICAgICAgTyhcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJBdXRoIG5vdCB5ZXQgZGV0ZWN0ZWRcIiksIGkucmVzb2x2ZSgpLCBpID0gbmV3IGopO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgMCksIHIoKTtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIC8vIFRha2Ugbm90ZSBvZiB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgdG9rZW5Db3VudGVyIHNvIHRoYXQgdGhpcyBtZXRob2RcbiAgICAgICAgLy8gY2FuIGZhaWwgKHdpdGggYW4gQUJPUlRFRCBlcnJvcikgaWYgdGhlcmUgaXMgYSB0b2tlbiBjaGFuZ2Ugd2hpbGUgdGhlXG4gICAgICAgIC8vIHJlcXVlc3QgaXMgb3V0c3RhbmRpbmcuXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmksIGUgPSB0aGlzLmZvcmNlUmVmcmVzaDtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yY2VSZWZyZXNoID0gITEsIHRoaXMuYXV0aCA/IHRoaXMuYXV0aC5nZXRUb2tlbihlKS50aGVuKChlID0+IFxuICAgICAgICAvLyBDYW5jZWwgdGhlIHJlcXVlc3Qgc2luY2UgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgdGhlIHJlcXVlc3Qgd2FzXG4gICAgICAgIC8vIG91dHN0YW5kaW5nIHNvIHRoZSByZXNwb25zZSBpcyBwb3RlbnRpYWxseSBmb3IgYSBwcmV2aW91cyB1c2VyICh3aGljaFxuICAgICAgICAvLyB1c2VyLCB3ZSBjYW4ndCBiZSBzdXJlKS5cbiAgICAgICAgdGhpcy5pICE9PSB0ID8gKE8oXCJGaXJlYmFzZUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyXCIsIFwiZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLlwiKSwgXG4gICAgICAgIHRoaXMuZ2V0VG9rZW4oKSkgOiBlID8gKFUoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS5hY2Nlc3NUb2tlbiksIG5ldyBXKGUuYWNjZXNzVG9rZW4sIHRoaXMuY3VycmVudFVzZXIpKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hdXRoICYmIHRoaXMuYXV0aC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pO1xuICAgIH1cbiAgICAvLyBBdXRoLmdldFVpZCgpIGNhbiByZXR1cm4gbnVsbCBldmVuIHdpdGggYSB1c2VyIGxvZ2dlZCBpbi4gSXQgaXMgYmVjYXVzZVxuICAgIC8vIGdldFVpZCgpIGlzIHN5bmNocm9ub3VzLCBidXQgdGhlIGF1dGggY29kZSBwb3B1bGF0aW5nIFVpZCBpcyBhc3luY2hyb25vdXMuXG4gICAgLy8gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGluIHRoZSBBdXRoVG9rZW5MaXN0ZW5lciBjYWxsYmFja1xuICAgIC8vIHRvIGd1YXJhbnRlZSB0byBnZXQgdGhlIGFjdHVhbCB1c2VyLlxuICAgIHUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmF1dGggJiYgdGhpcy5hdXRoLmdldFVpZCgpO1xuICAgICAgICByZXR1cm4gVShudWxsID09PSB0IHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpLCBuZXcgQyh0KTtcbiAgICB9XG59XG5cbi8qXG4gKiBGaXJzdFBhcnR5VG9rZW4gcHJvdmlkZXMgYSBmcmVzaCB0b2tlbiBlYWNoIHRpbWUgaXRzIHZhbHVlXG4gKiBpcyByZXF1ZXN0ZWQsIGJlY2F1c2UgaWYgdGhlIHRva2VuIGlzIHRvbyBvbGQsIHJlcXVlc3RzIHdpbGwgYmUgcmVqZWN0ZWQuXG4gKiBUZWNobmljYWxseSB0aGlzIG1heSBubyBsb25nZXIgYmUgbmVjZXNzYXJ5IHNpbmNlIHRoZSBTREsgc2hvdWxkIGdyYWNlZnVsbHlcbiAqIHJlY292ZXIgZnJvbSB1bmF1dGhlbnRpY2F0ZWQgZXJyb3JzIChzZWUgYi8zMzE0NzgxOCBmb3IgY29udGV4dCksIGJ1dCBpdCdzXG4gKiBzYWZlciB0byBrZWVwIHRoZSBpbXBsZW1lbnRhdGlvbiBhcy1pcy5cbiAqLyBjbGFzcyBZIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IFwiRmlyc3RQYXJ0eVwiLCB0aGlzLnVzZXIgPSBDLkZJUlNUX1BBUlRZLCB0aGlzLmhlYWRlcnMgPSBuZXcgTWFwLCB0aGlzLmhlYWRlcnMuc2V0KFwiWC1Hb29nLUF1dGhVc2VyXCIsIGUpO1xuICAgICAgICBjb25zdCBzID0gdC5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkoW10pO1xuICAgICAgICBzICYmIHRoaXMuaGVhZGVycy5zZXQoXCJBdXRob3JpemF0aW9uXCIsIHMpLCBuICYmIHRoaXMuaGVhZGVycy5zZXQoXCJYLUdvb2ctSWFtLUF1dGhvcml6YXRpb24tVG9rZW5cIiwgbik7XG4gICAgfVxufVxuXG4vKlxuICogUHJvdmlkZXMgdXNlciBjcmVkZW50aWFscyByZXF1aXJlZCBmb3IgdGhlIEZpcmVzdG9yZSBKYXZhU2NyaXB0IFNES1xuICogdG8gYXV0aGVudGljYXRlIHRoZSB1c2VyLCB1c2luZyB0ZWNobmlxdWUgdGhhdCBpcyBvbmx5IGF2YWlsYWJsZVxuICogdG8gYXBwbGljYXRpb25zIGhvc3RlZCBieSBHb29nbGUuXG4gKi8gY2xhc3MgWCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLmggPSB0LCB0aGlzLmwgPSBlLCB0aGlzLm0gPSBuO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgWSh0aGlzLmgsIHRoaXMubCwgdGhpcy5tKSk7XG4gICAgfVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdWlkLlxuICAgICAgICB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IGUoQy5GSVJTVF9QQVJUWSkpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7fVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG59XG5cbmNsYXNzIFoge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHQsIHRoaXMudHlwZSA9IFwiQXBwQ2hlY2tcIiwgdGhpcy5oZWFkZXJzID0gbmV3IE1hcCwgdCAmJiB0Lmxlbmd0aCA+IDAgJiYgdGhpcy5oZWFkZXJzLnNldChcIngtZmlyZWJhc2UtYXBwY2hlY2tcIiwgdGhpcy52YWx1ZSk7XG4gICAgfVxufVxuXG5jbGFzcyB0dCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmcgPSB0LCB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmFwcENoZWNrID0gbnVsbCwgdGhpcy5wID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdCA9PiB7XG4gICAgICAgICAgICBudWxsICE9IHQuZXJyb3IgJiYgTyhcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIGBFcnJvciBnZXR0aW5nIEFwcCBDaGVjayB0b2tlbjsgdXNpbmcgcGxhY2Vob2xkZXIgdG9rZW4gaW5zdGVhZC4gRXJyb3I6ICR7dC5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudG9rZW4gIT09IHRoaXMucDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnAgPSB0LnRva2VuLCBPKFwiRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXJcIiwgYFJlY2VpdmVkICR7biA/IFwibmV3XCIgOiBcImV4aXN0aW5nXCJ9IHRva2VuLmApLCBcbiAgICAgICAgICAgIG4gPyBlKHQudG9rZW4pIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubyA9IGUgPT4ge1xuICAgICAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBuKGUpKSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHMgPSB0ID0+IHtcbiAgICAgICAgICAgIE8oXCJGaXJlYmFzZUFwcENoZWNrVG9rZW5Qcm92aWRlclwiLCBcIkFwcENoZWNrIGRldGVjdGVkXCIpLCB0aGlzLmFwcENoZWNrID0gdCwgdGhpcy5hcHBDaGVjay5hZGRUb2tlbkxpc3RlbmVyKHRoaXMubyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZy5vbkluaXQoKHQgPT4gcyh0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEFwcENoZWNrIGFmdGVyIEZpcmVzdG9yZSwgc28gd2UgZ2l2ZSBpdFxuICAgICAgICAvLyBhIGNoYW5jZSB0byByZWdpc3RlciBpdHNlbGYgd2l0aCB0aGUgY29tcG9uZW50IGZyYW1ld29yay5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFwcENoZWNrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZy5nZXRJbW1lZGlhdGUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogITBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0ID8gcyh0KSA6IFxuICAgICAgICAgICAgICAgIC8vIElmIEFwcENoZWNrIGlzIHN0aWxsIG5vdCBhdmFpbGFibGUsIHByb2NlZWQgd2l0aG91dCBpdC5cbiAgICAgICAgICAgICAgICBPKFwiRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXJcIiwgXCJBcHBDaGVjayBub3QgeWV0IGRldGVjdGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgMCk7XG4gICAgfVxuICAgIGdldFRva2VuKCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5mb3JjZVJlZnJlc2g7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmFwcENoZWNrID8gdGhpcy5hcHBDaGVjay5nZXRUb2tlbih0KS50aGVuKCh0ID0+IHQgPyAoVShcInN0cmluZ1wiID09IHR5cGVvZiB0LnRva2VuKSwgXG4gICAgICAgIHRoaXMucCA9IHQudG9rZW4sIG5ldyBaKHQudG9rZW4pKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hcHBDaGVjayAmJiB0aGlzLmFwcENoZWNrLnJlbW92ZVRva2VuTGlzdGVuZXIodGhpcy5vKTtcbiAgICB9XG59XG5cbi8qKlxuICogQW4gQXBwQ2hlY2sgdG9rZW4gcHJvdmlkZXIgdGhhdCBhbHdheXMgeWllbGRzIGFuIGVtcHR5IHRva2VuLlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgZXQge1xuICAgIGdldFRva2VuKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBaKFwiXCIpKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydCh0LCBlKSB7fVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBCdWlsZHMgYSBDcmVkZW50aWFsc1Byb3ZpZGVyIGRlcGVuZGluZyBvbiB0aGUgdHlwZSBvZlxuICogdGhlIGNyZWRlbnRpYWxzIHBhc3NlZCBpbi5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogYExpc3RlblNlcXVlbmNlYCBpcyBhIG1vbm90b25pYyBzZXF1ZW5jZS4gSXQgaXMgaW5pdGlhbGl6ZWQgd2l0aCBhIG1pbmltdW0gdmFsdWUgdG9cbiAqIGV4Y2VlZC4gQWxsIHN1YnNlcXVlbnQgY2FsbHMgdG8gbmV4dCB3aWxsIHJldHVybiBpbmNyZWFzaW5nIHZhbHVlcy4gSWYgcHJvdmlkZWQgd2l0aCBhXG4gKiBgU2VxdWVuY2VOdW1iZXJTeW5jZXJgLCBpdCB3aWxsIGFkZGl0aW9uYWxseSBidW1wIGl0cyBuZXh0IHZhbHVlIHdoZW4gdG9sZCBvZiBhIG5ldyB2YWx1ZSwgYXNcbiAqIHdlbGwgYXMgd3JpdGUgb3V0IHNlcXVlbmNlIG51bWJlcnMgdGhhdCBpdCBwcm9kdWNlcyB2aWEgYG5leHQoKWAuXG4gKi9cbmNsYXNzIG50IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucHJldmlvdXNWYWx1ZSA9IHQsIGUgJiYgKGUuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gdCA9PiB0aGlzLkkodCksIHRoaXMuVCA9IHQgPT4gZS53cml0ZVNlcXVlbmNlTnVtYmVyKHQpKTtcbiAgICB9XG4gICAgSSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzVmFsdWUgPSBNYXRoLm1heCh0LCB0aGlzLnByZXZpb3VzVmFsdWUpLCB0aGlzLnByZXZpb3VzVmFsdWU7XG4gICAgfVxuICAgIG5leHQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSArK3RoaXMucHJldmlvdXNWYWx1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuVCAmJiB0aGlzLlQodCksIHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBHZW5lcmF0ZXMgYG5CeXRlc2Agb2YgcmFuZG9tIGJ5dGVzLlxuICpcbiAqIElmIGBuQnl0ZXMgPCAwYCAsIGFuIGVycm9yIHdpbGwgYmUgdGhyb3duLlxuICovXG5mdW5jdGlvbiBzdCh0KSB7XG4gICAgLy8gUG9seWZpbGxzIGZvciBJRSBhbmQgV2ViV29ya2VyIGJ5IHVzaW5nIGBzZWxmYCBhbmQgYG1zQ3J5cHRvYCB3aGVuIGBjcnlwdG9gIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgY29uc3QgZSA9IFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygc2VsZiAmJiAoc2VsZi5jcnlwdG8gfHwgc2VsZi5tc0NyeXB0byksIG4gPSBuZXcgVWludDhBcnJheSh0KTtcbiAgICBpZiAoZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUuZ2V0UmFuZG9tVmFsdWVzKSBlLmdldFJhbmRvbVZhbHVlcyhuKTsgZWxzZSBcbiAgICAvLyBGYWxscyBiYWNrIHRvIE1hdGgucmFuZG9tXG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0OyBlKyspIG5bZV0gPSBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpO1xuICAgIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBudC5BID0gLTE7XG5cbmNsYXNzIGl0IHtcbiAgICBzdGF0aWMgUigpIHtcbiAgICAgICAgLy8gQWxwaGFudW1lcmljIGNoYXJhY3RlcnNcbiAgICAgICAgY29uc3QgdCA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIiwgZSA9IE1hdGguZmxvb3IoMjU2IC8gdC5sZW5ndGgpICogdC5sZW5ndGg7XG4gICAgICAgIC8vIFRoZSBsYXJnZXN0IGJ5dGUgdmFsdWUgdGhhdCBpcyBhIG11bHRpcGxlIG9mIGBjaGFyLmxlbmd0aGAuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBcIlwiO1xuICAgICAgICBmb3IgKDtuLmxlbmd0aCA8IDIwOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBzdCg0MCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHMubGVuZ3RoOyArK2kpIFxuICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgdmFsdWVzIHRoYXQgYXJlIFswLCBtYXhNdWx0aXBsZSksIHRoaXMgZW5zdXJlcyB0aGV5IGNhblxuICAgICAgICAgICAgLy8gYmUgZXZlbmx5IG1hcHBlZCB0byBpbmRpY2VzIG9mIGBjaGFyc2AgdmlhIGEgbW9kdWxvIG9wZXJhdGlvbi5cbiAgICAgICAgICAgIG4ubGVuZ3RoIDwgMjAgJiYgc1tpXSA8IGUgJiYgKG4gKz0gdC5jaGFyQXQoc1tpXSAlIHQubGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgfVxufVxuXG5mdW5jdGlvbiBydCh0LCBlKSB7XG4gICAgcmV0dXJuIHQgPCBlID8gLTEgOiB0ID4gZSA/IDEgOiAwO1xufVxuXG4vKiogSGVscGVyIHRvIGNvbXBhcmUgYXJyYXlzIHVzaW5nIGlzRXF1YWwoKS4gKi8gZnVuY3Rpb24gb3QodCwgZSwgbikge1xuICAgIHJldHVybiB0Lmxlbmd0aCA9PT0gZS5sZW5ndGggJiYgdC5ldmVyeSgoKHQsIHMpID0+IG4odCwgZVtzXSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbW1lZGlhdGUgbGV4aWNvZ3JhcGhpY2FsbHktZm9sbG93aW5nIHN0cmluZy4gVGhpcyBpcyB1c2VmdWwgdG9cbiAqIGNvbnN0cnVjdCBhbiBpbmNsdXNpdmUgcmFuZ2UgZm9yIGluZGV4ZWRkYiBpdGVyYXRvcnMuXG4gKi8gZnVuY3Rpb24gdXQodCkge1xuICAgIC8vIFJldHVybiB0aGUgaW5wdXQgc3RyaW5nLCB3aXRoIGFuIGFkZGl0aW9uYWwgTlVMIGJ5dGUgYXBwZW5kZWQuXG4gICAgcmV0dXJuIHQgKyBcIlxcMFwiO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVGhlIGVhcmxpZXN0IGRhdGUgc3VwcG9ydGVkIGJ5IEZpcmVzdG9yZSB0aW1lc3RhbXBzICgwMDAxLTAxLTAxVDAwOjAwOjAwWikuXG4vKipcbiAqIEEgYFRpbWVzdGFtcGAgcmVwcmVzZW50cyBhIHBvaW50IGluIHRpbWUgaW5kZXBlbmRlbnQgb2YgYW55IHRpbWUgem9uZSBvclxuICogY2FsZW5kYXIsIHJlcHJlc2VudGVkIGFzIHNlY29uZHMgYW5kIGZyYWN0aW9ucyBvZiBzZWNvbmRzIGF0IG5hbm9zZWNvbmRcbiAqIHJlc29sdXRpb24gaW4gVVRDIEVwb2NoIHRpbWUuXG4gKlxuICogSXQgaXMgZW5jb2RlZCB1c2luZyB0aGUgUHJvbGVwdGljIEdyZWdvcmlhbiBDYWxlbmRhciB3aGljaCBleHRlbmRzIHRoZVxuICogR3JlZ29yaWFuIGNhbGVuZGFyIGJhY2t3YXJkcyB0byB5ZWFyIG9uZS4gSXQgaXMgZW5jb2RlZCBhc3N1bWluZyBhbGwgbWludXRlc1xuICogYXJlIDYwIHNlY29uZHMgbG9uZywgaS5lLiBsZWFwIHNlY29uZHMgYXJlIFwic21lYXJlZFwiIHNvIHRoYXQgbm8gbGVhcCBzZWNvbmRcbiAqIHRhYmxlIGlzIG5lZWRlZCBmb3IgaW50ZXJwcmV0YXRpb24uIFJhbmdlIGlzIGZyb20gMDAwMS0wMS0wMVQwMDowMDowMFogdG9cbiAqIDk5OTktMTItMzFUMjM6NTk6NTkuOTk5OTk5OTk5Wi5cbiAqXG4gKiBGb3IgZXhhbXBsZXMgYW5kIGZ1cnRoZXIgc3BlY2lmaWNhdGlvbnMsIHJlZmVyIHRvIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvcHJvdG9idWYvYmxvYi9tYXN0ZXIvc3JjL2dvb2dsZS9wcm90b2J1Zi90aW1lc3RhbXAucHJvdG8gfCBUaW1lc3RhbXAgZGVmaW5pdGlvbn0uXG4gKi9cbmNsYXNzIGF0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWNvbmRzIC0gVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouIE11c3QgYmUgZnJvbSAwMDAxLTAxLTAxVDAwOjAwOjAwWiB0b1xuICAgICAqICAgICA5OTk5LTEyLTMxVDIzOjU5OjU5WiBpbmNsdXNpdmUuXG4gICAgICogQHBhcmFtIG5hbm9zZWNvbmRzIC0gVGhlIG5vbi1uZWdhdGl2ZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZFxuICAgICAqICAgICByZXNvbHV0aW9uLiBOZWdhdGl2ZSBzZWNvbmQgdmFsdWVzIHdpdGggZnJhY3Rpb25zIG11c3Qgc3RpbGwgaGF2ZVxuICAgICAqICAgICBub24tbmVnYXRpdmUgbmFub3NlY29uZHMgdmFsdWVzIHRoYXQgY291bnQgZm9yd2FyZCBpbiB0aW1lLiBNdXN0IGJlXG4gICAgICogICAgIGZyb20gMCB0byA5OTksOTk5LDk5OSBpbmNsdXNpdmUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIGZyYWN0aW9ucyBvZiBhIHNlY29uZCBhdCBuYW5vc2Vjb25kIHJlc29sdXRpb24uKlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyA9IHQsIHRoaXMubmFub3NlY29uZHMgPSBlLCBlIDwgMCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmIChlID49IDFlOSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmICh0IDwgLTYyMTM1NTk2ODAwKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIHQpO1xuICAgICAgICAvLyBUaGlzIHdpbGwgYnJlYWsgaW4gdGhlIHllYXIgMTAsMDAwLlxuICAgICAgICAgICAgICAgIGlmICh0ID49IDI1MzQwMjMwMDgwMCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgd2l0aCB0aGUgY3VycmVudCBkYXRlLCB3aXRoIG1pbGxpc2Vjb25kIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgbmV3IHRpbWVzdGFtcCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgZGF0ZS5cbiAgICAgKi8gICAgc3RhdGljIG5vdygpIHtcbiAgICAgICAgcmV0dXJuIGF0LmZyb21NaWxsaXMoRGF0ZS5ub3coKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIGRhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGluaXRpYWxpemUgdGhlIGBUaW1lc3RhbXBgIGZyb20uXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIGRhdGUuXG4gICAgICovICAgIHN0YXRpYyBmcm9tRGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiBhdC5mcm9tTWlsbGlzKHQuZ2V0VGltZSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgZnJvbSB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtaWxsaXNlY29uZHMgLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIG51bWJlciBvZiBtaWxsaXNlY29uZHMuXG4gICAgICovICAgIHN0YXRpYyBmcm9tTWlsbGlzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IE1hdGguZmxvb3IodCAvIDFlMyksIG4gPSBNYXRoLmZsb29yKDFlNiAqICh0IC0gMWUzICogZSkpO1xuICAgICAgICByZXR1cm4gbmV3IGF0KGUsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGBUaW1lc3RhbXBgIHRvIGEgSmF2YVNjcmlwdCBgRGF0ZWAgb2JqZWN0LiBUaGlzIGNvbnZlcnNpb25cbiAgICAgKiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbiBzaW5jZSBgRGF0ZWAgb2JqZWN0cyBvbmx5IHN1cHBvcnQgbWlsbGlzZWNvbmRcbiAgICAgKiBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBKYXZhU2NyaXB0IGBEYXRlYCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXNcbiAgICAgKiAgICAgdGhpcyBgVGltZXN0YW1wYCwgd2l0aCBtaWxsaXNlY29uZCBwcmVjaXNpb24uXG4gICAgICovICAgIHRvRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMudG9NaWxsaXMoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgYFRpbWVzdGFtcGAgdG8gYSBudW1lcmljIHRpbWVzdGFtcCAoaW4gbWlsbGlzZWNvbmRzIHNpbmNlXG4gICAgICogZXBvY2gpLiBUaGlzIG9wZXJhdGlvbiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBwb2ludCBpbiB0aW1lIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyB0aW1lc3RhbXAsIHJlcHJlc2VudGVkIGFzXG4gICAgICogICAgIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovICAgIHRvTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gMWUzICogdGhpcy5zZWNvbmRzICsgdGhpcy5uYW5vc2Vjb25kcyAvIDFlNjtcbiAgICB9XG4gICAgX2NvbXBhcmVUbyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlY29uZHMgPT09IHQuc2Vjb25kcyA/IHJ0KHRoaXMubmFub3NlY29uZHMsIHQubmFub3NlY29uZHMpIDogcnQodGhpcy5zZWNvbmRzLCB0LnNlY29uZHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBUaW1lc3RhbXBgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYFRpbWVzdGFtcGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnNlY29uZHMgPT09IHRoaXMuc2Vjb25kcyAmJiB0Lm5hbm9zZWNvbmRzID09PSB0aGlzLm5hbm9zZWNvbmRzO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgVGltZXN0YW1wYC4gKi8gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlRpbWVzdGFtcChzZWNvbmRzPVwiICsgdGhpcy5zZWNvbmRzICsgXCIsIG5hbm9zZWNvbmRzPVwiICsgdGhpcy5uYW5vc2Vjb25kcyArIFwiKVwiO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYFRpbWVzdGFtcGAuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IHRoaXMuc2Vjb25kcyxcbiAgICAgICAgICAgIG5hbm9zZWNvbmRzOiB0aGlzLm5hbm9zZWNvbmRzXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgb2JqZWN0IHRvIGEgcHJpbWl0aXZlIHN0cmluZywgd2hpY2ggYWxsb3dzIGBUaW1lc3RhbXBgIG9iamVjdHNcbiAgICAgKiB0byBiZSBjb21wYXJlZCB1c2luZyB0aGUgYD5gLCBgPD1gLCBgPj1gIGFuZCBgPmAgb3BlcmF0b3JzLlxuICAgICAqLyAgICB2YWx1ZU9mKCkge1xuICAgICAgICAvLyBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc3RyaW5nIG9mIHRoZSBmb3JtIDxzZWNvbmRzPi48bmFub3NlY29uZHM+IHdoZXJlXG4gICAgICAgIC8vIDxzZWNvbmRzPiBpcyB0cmFuc2xhdGVkIHRvIGhhdmUgYSBub24tbmVnYXRpdmUgdmFsdWUgYW5kIGJvdGggPHNlY29uZHM+XG4gICAgICAgIC8vIGFuZCA8bmFub3NlY29uZHM+IGFyZSBsZWZ0LXBhZGRlZCB3aXRoIHplcm9lcyB0byBiZSBhIGNvbnNpc3RlbnQgbGVuZ3RoLlxuICAgICAgICAvLyBTdHJpbmdzIHdpdGggdGhpcyBmb3JtYXQgdGhlbiBoYXZlIGEgbGV4aW9ncmFwaGljYWwgb3JkZXJpbmcgdGhhdCBtYXRjaGVzXG4gICAgICAgIC8vIHRoZSBleHBlY3RlZCBvcmRlcmluZy4gVGhlIDxzZWNvbmRzPiB0cmFuc2xhdGlvbiBpcyBkb25lIHRvIGF2b2lkIGhhdmluZ1xuICAgICAgICAvLyBhIGxlYWRpbmcgbmVnYXRpdmUgc2lnbiAoaS5lLiBhIGxlYWRpbmcgJy0nIGNoYXJhY3RlcikgaW4gaXRzIHN0cmluZ1xuICAgICAgICAvLyByZXByZXNlbnRhdGlvbiwgd2hpY2ggd291bGQgYWZmZWN0IGl0cyBsZXhpb2dyYXBoaWNhbCBvcmRlcmluZy5cbiAgICAgICAgY29uc3QgdCA9IHRoaXMuc2Vjb25kcyAtIC02MjEzNTU5NjgwMDtcbiAgICAgICAgLy8gTm90ZTogVXAgdG8gMTIgZGVjaW1hbCBkaWdpdHMgYXJlIHJlcXVpcmVkIHRvIHJlcHJlc2VudCBhbGwgdmFsaWRcbiAgICAgICAgLy8gJ3NlY29uZHMnIHZhbHVlcy5cbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKHQpLnBhZFN0YXJ0KDEyLCBcIjBcIikgKyBcIi5cIiArIFN0cmluZyh0aGlzLm5hbm9zZWNvbmRzKS5wYWRTdGFydCg5LCBcIjBcIik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHZlcnNpb24gb2YgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUuIFRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIHZlcnNpb25cbiAqIHRpbWVzdGFtcCwgc3VjaCBhcyB1cGRhdGVfdGltZSBvciByZWFkX3RpbWUuXG4gKi8gY2xhc3MgY3Qge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVRpbWVzdGFtcCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3QodCk7XG4gICAgfVxuICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgY3QobmV3IGF0KDAsIDApKTtcbiAgICB9XG4gICAgc3RhdGljIG1heCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBjdChuZXcgYXQoMjUzNDAyMzAwNzk5LCA5OTk5OTk5OTkpKTtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLl9jb21wYXJlVG8odC50aW1lc3RhbXApO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLmlzRXF1YWwodC50aW1lc3RhbXApO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIG51bWJlciByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmVyc2lvbiBmb3IgdXNlIGluIHNwZWMgdGVzdHMuICovICAgIHRvTWljcm9zZWNvbmRzKCkge1xuICAgICAgICAvLyBDb252ZXJ0IHRvIG1pY3Jvc2Vjb25kcy5cbiAgICAgICAgcmV0dXJuIDFlNiAqIHRoaXMudGltZXN0YW1wLnNlY29uZHMgKyB0aGlzLnRpbWVzdGFtcC5uYW5vc2Vjb25kcyAvIDFlMztcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlNuYXBzaG90VmVyc2lvbihcIiArIHRoaXMudGltZXN0YW1wLnRvU3RyaW5nKCkgKyBcIilcIjtcbiAgICB9XG4gICAgdG9UaW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIGh0KHQpIHtcbiAgICBsZXQgZSA9IDA7XG4gICAgZm9yIChjb25zdCBuIGluIHQpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBuKSAmJiBlKys7XG4gICAgcmV0dXJuIGU7XG59XG5cbmZ1bmN0aW9uIGx0KHQsIGUpIHtcbiAgICBmb3IgKGNvbnN0IG4gaW4gdCkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pICYmIGUobiwgdFtuXSk7XG59XG5cbmZ1bmN0aW9uIGZ0KHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgaW4gdCkgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBlKSkgcmV0dXJuICExO1xuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxuICovXG5jbGFzcyBkdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB2b2lkIDAgPT09IGUgPyBlID0gMCA6IGUgPiB0Lmxlbmd0aCAmJiBMKCksIHZvaWQgMCA9PT0gbiA/IG4gPSB0Lmxlbmd0aCAtIGUgOiBuID4gdC5sZW5ndGggLSBlICYmIEwoKSwgXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSB0LCB0aGlzLm9mZnNldCA9IGUsIHRoaXMubGVuID0gbjtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IGR0LmNvbXBhcmF0b3IodGhpcywgdCk7XG4gICAgfVxuICAgIGNoaWxkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgZHQgPyB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSkgOiBlLnB1c2godCksIHRoaXMuY29uc3RydWN0KGUpO1xuICAgIH1cbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovICAgIGxpbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgcG9wRmlyc3QodCkge1xuICAgICAgICByZXR1cm4gdCA9IHZvaWQgMCA9PT0gdCA/IDEgOiB0LCB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHQsIHRoaXMubGVuZ3RoIC0gdCk7XG4gICAgfVxuICAgIHBvcExhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZmlyc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XG4gICAgfVxuICAgIGxhc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyB0XTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc1ByZWZpeE9mKHQpIHtcbiAgICAgICAgaWYgKHQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxlbmd0aDsgZSsrKSBpZiAodGhpcy5nZXQoZSkgIT09IHQuZ2V0KGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaXNJbW1lZGlhdGVQYXJlbnRPZih0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHQubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgaWYgKHRoaXMuZ2V0KGUpICE9PSB0LmdldChlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBmb3IgKGxldCBlID0gdGhpcy5vZmZzZXQsIG4gPSB0aGlzLmxpbWl0KCk7IGUgPCBuOyBlKyspIHQodGhpcy5zZWdtZW50c1tlXSk7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0KHMpLCBpID0gZS5nZXQocyk7XG4gICAgICAgICAgICBpZiAobiA8IGkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmIChuID4gaSkgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoIDwgZS5sZW5ndGggPyAtMSA6IHQubGVuZ3RoID4gZS5sZW5ndGggPyAxIDogMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIF90IGV4dGVuZHMgZHQge1xuICAgIGNvbnN0cnVjdCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgX3QodCwgZSwgbik7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oXCIvXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4udCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBzZWdtZW50ICgke259KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLmApO1xuICAgICAgICAgICAgLy8gU3RyaXAgbGVhZGluZyBhbmQgdHJhbGluZyBzbGFzaGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKC4uLm4uc3BsaXQoXCIvXCIpLmZpbHRlcigodCA9PiB0Lmxlbmd0aCA+IDApKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBfdChlKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfdChbXSk7XG4gICAgfVxufVxuXG5jb25zdCB3dCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgbXQgZXh0ZW5kcyBkdCB7XG4gICAgY29uc3RydWN0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBtdCh0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKHQpIHtcbiAgICAgICAgcmV0dXJuIHd0LnRlc3QodCk7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLm1hcCgodCA9PiAodCA9IHQucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL2AvZywgXCJcXFxcYFwiKSwgXG4gICAgICAgIG10LmlzVmFsaWRJZGVudGlmaWVyKHQpIHx8ICh0ID0gXCJgXCIgKyB0ICsgXCJgXCIpLCB0KSkpLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxuICAgICAqLyAgICBpc0tleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gMSA9PT0gdGhpcy5sZW5ndGggJiYgXCJfX25hbWVfX1wiID09PSB0aGlzLmdldCgwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IG10KFsgXCJfX25hbWVfX1wiIF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VydmVyRm9ybWF0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IFwiXCIsIHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCk7XG4gICAgICAgICAgICBlLnB1c2gobiksIG4gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKDtzIDwgdC5sZW5ndGg7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRbc107XG4gICAgICAgICAgICBpZiAoXCJcXFxcXCIgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocyArIDEgPT09IHQubGVuZ3RoKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFtzICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKFwiXFxcXFwiICE9PSBlICYmIFwiLlwiICE9PSBlICYmIFwiYFwiICE9PSBlKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgdCk7XG4gICAgICAgICAgICAgICAgbiArPSBlLCBzICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IGUgPyAociA9ICFyLCBzKyspIDogXCIuXCIgIT09IGUgfHwgciA/IChuICs9IGUsIHMrKykgOiAoaSgpLCBzKyspO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpKCksIHIpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiBcIiArIHQpO1xuICAgICAgICByZXR1cm4gbmV3IG10KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHlQYXRoKCkge1xuICAgICAgICByZXR1cm4gbmV3IG10KFtdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2V0IG9mIGZpZWxkcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHBhcnRpYWxseSBwYXRjaCBhIGRvY3VtZW50LlxuICogRmllbGRNYXNrIGlzIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBPYmplY3RWYWx1ZS5cbiAqIEV4YW1wbGVzOlxuICogICBmb28gLSBPdmVyd3JpdGVzIGZvbyBlbnRpcmVseSB3aXRoIHRoZSBwcm92aWRlZCB2YWx1ZS4gSWYgZm9vIGlzIG5vdFxuICogICAgICAgICBwcmVzZW50IGluIHRoZSBjb21wYW5pb24gT2JqZWN0VmFsdWUsIHRoZSBmaWVsZCBpcyBkZWxldGVkLlxuICogICBmb28uYmFyIC0gT3ZlcndyaXRlcyBvbmx5IHRoZSBmaWVsZCBiYXIgb2YgdGhlIG9iamVjdCBmb28uXG4gKiAgICAgICAgICAgICBJZiBmb28gaXMgbm90IGFuIG9iamVjdCwgZm9vIGlzIHJlcGxhY2VkIHdpdGggYW4gb2JqZWN0XG4gKiAgICAgICAgICAgICBjb250YWluaW5nIGZvb1xuICovIGNsYXNzIGd0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZmllbGRzID0gdCwgXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGlvbiBvZiBGaWVsZE1hc2tcbiAgICAgICAgLy8gU29ydCB0aGUgZmllbGQgbWFzayB0byBzdXBwb3J0IGBGaWVsZE1hc2suaXNFcXVhbCgpYCBhbmQgYXNzZXJ0IGJlbG93LlxuICAgICAgICB0LnNvcnQobXQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgYGZpZWxkUGF0aGAgaXMgaW5jbHVkZWQgYnkgYXQgbGVhc3Qgb25lIGZpZWxkIGluIHRoaXMgZmllbGRcbiAgICAgKiBtYXNrLlxuICAgICAqXG4gICAgICogVGhpcyBpcyBhbiBPKG4pIG9wZXJhdGlvbiwgd2hlcmUgYG5gIGlzIHRoZSBzaXplIG9mIHRoZSBmaWVsZCBtYXNrLlxuICAgICAqLyAgICBjb3ZlcnModCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5maWVsZHMpIGlmIChlLmlzUHJlZml4T2YodCkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIG90KHRoaXMuZmllbGRzLCB0LmZpZWxkcywgKCh0LCBlKSA9PiB0LmlzRXF1YWwoZSkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xuLyoqIFRydWUgaWYgYW5kIG9ubHkgaWYgdGhlIEJhc2U2NCBjb252ZXJzaW9uIGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24geXQoKSB7XG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGF0b2I7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltbXV0YWJsZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBcInByb3RvXCIgYnl0ZSBzdHJpbmcuXG4gKlxuICogUHJvdG8gYnl0ZSBzdHJpbmdzIGNhbiBlaXRoZXIgYmUgQmFzZTY0LWVuY29kZWQgc3RyaW5ncyBvciBVaW50OEFycmF5cyB3aGVuXG4gKiBzZW50IG9uIHRoZSB3aXJlLiBUaGlzIGNsYXNzIGFic3RyYWN0cyBhd2F5IHRoaXMgZGlmZmVyZW50aWF0aW9uIGJ5IGhvbGRpbmdcbiAqIHRoZSBwcm90byBieXRlIHN0cmluZyBpbiBhIGNvbW1vbiBjbGFzcyB0aGF0IG11c3QgYmUgY29udmVydGVkIGludG8gYSBzdHJpbmdcbiAqIGJlZm9yZSBiZWluZyBzZW50IGFzIGEgcHJvdG8uXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyBwdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmJpbmFyeVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tQmFzZTY0U3RyaW5nKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGF0b2IodCk7XG4gICAgICAgIHJldHVybiBuZXcgcHQoZSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOyBSZW1vdmUgdGhlIGNvcHkgb2YgdGhlIGJ5dGUgc3RyaW5nIGhlcmUgYXMgdGhpcyBtZXRob2RcbiAgICAgICAgLy8gaXMgZnJlcXVlbnRseSBjYWxsZWQgZHVyaW5nIGluZGV4aW5nLlxuICAgICAgICBjb25zdCBlID0gXG4gICAgICAgIC8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYW4gVWludDhhcnJheSB0byBhIGJpbmFyeSBzdHJpbmcuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgbGV0IGUgPSBcIlwiO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgKytuKSBlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodFtuXSk7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGEgYmluYXJ5IHN0cmluZyB0byBhbiBVaW50OEFycmF5LlxuICovICh0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBwdChlKTtcbiAgICB9XG4gICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgICAgIGxldCB0ID0gMDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5leHQ6ICgpID0+IHQgPCB0aGlzLmJpbmFyeVN0cmluZy5sZW5ndGggPyB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuYmluYXJ5U3RyaW5nLmNoYXJDb2RlQXQodCsrKSxcbiAgICAgICAgICAgICAgICBkb25lOiAhMVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogdm9pZCAwLFxuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHRvQmFzZTY0KCkge1xuICAgICAgICByZXR1cm4gdCA9IHRoaXMuYmluYXJ5U3RyaW5nLCBidG9hKHQpO1xuICAgICAgICAvKiogQ29udmVydHMgYSBiaW5hcnkgc3RyaW5nIHRvIGEgQmFzZTY0IGVuY29kZWQgc3RyaW5nLiAqL1xuICAgICAgICB2YXIgdDtcbiAgICB9XG4gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZVtuXSA9IHQuY2hhckNvZGVBdChuKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgICAgIC8vIEEgUmVnRXhwIG1hdGNoaW5nIElTTyA4NjAxIFVUQyB0aW1lc3RhbXBzIHdpdGggb3B0aW9uYWwgZnJhY3Rpb24uXG4gICAgICAgICh0aGlzLmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGFwcHJveGltYXRlQnl0ZVNpemUoKSB7XG4gICAgICAgIHJldHVybiAyICogdGhpcy5iaW5hcnlTdHJpbmcubGVuZ3RoO1xuICAgIH1cbiAgICBjb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gcnQodGhpcy5iaW5hcnlTdHJpbmcsIHQuYmluYXJ5U3RyaW5nKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJpbmFyeVN0cmluZyA9PT0gdC5iaW5hcnlTdHJpbmc7XG4gICAgfVxufVxuXG5wdC5FTVBUWV9CWVRFX1NUUklORyA9IG5ldyBwdChcIlwiKTtcblxuY29uc3QgSXQgPSBuZXcgUmVnRXhwKC9eXFxkezR9LVxcZFxcZC1cXGRcXGRUXFxkXFxkOlxcZFxcZDpcXGRcXGQoPzpcXC4oXFxkKykpP1okLyk7XG5cbi8qKlxuICogQ29udmVydHMgdGhlIHBvc3NpYmxlIFByb3RvIHZhbHVlcyBmb3IgYSB0aW1lc3RhbXAgdmFsdWUgaW50byBhIFwic2Vjb25kcyBhbmRcbiAqIG5hbm9zXCIgcmVwcmVzZW50YXRpb24uXG4gKi8gZnVuY3Rpb24gVHQodCkge1xuICAgIC8vIFRoZSBqc29uIGludGVyZmFjZSAoZm9yIHRoZSBicm93c2VyKSB3aWxsIHJldHVybiBhbiBpc28gdGltZXN0YW1wIHN0cmluZyxcbiAgICAvLyB3aGlsZSB0aGUgcHJvdG8ganMgbGlicmFyeSAoZm9yIG5vZGUpIHdpbGwgcmV0dXJuIGFcbiAgICAvLyBnb29nbGUucHJvdG9idWYuVGltZXN0YW1wIGluc3RhbmNlLlxuICAgIGlmIChVKCEhdCksIFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpIHtcbiAgICAgICAgLy8gVGhlIGRhdGUgc3RyaW5nIGNhbiBoYXZlIGhpZ2hlciBwcmVjaXNpb24gKG5hbm9zKSB0aGFuIHRoZSBEYXRlIGNsYXNzXG4gICAgICAgIC8vIChtaWxsaXMpLCBzbyB3ZSBkbyBzb21lIGN1c3RvbSBwYXJzaW5nIGhlcmUuXG4gICAgICAgIC8vIFBhcnNlIHRoZSBuYW5vcyByaWdodCBvdXQgb2YgdGhlIHN0cmluZy5cbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICBjb25zdCBuID0gSXQuZXhlYyh0KTtcbiAgICAgICAgaWYgKFUoISFuKSwgblsxXSkge1xuICAgICAgICAgICAgLy8gUGFkIHRoZSBmcmFjdGlvbiBvdXQgdG8gOSBkaWdpdHMgKG5hbm9zKS5cbiAgICAgICAgICAgIGxldCB0ID0gblsxXTtcbiAgICAgICAgICAgIHQgPSAodCArIFwiMDAwMDAwMDAwXCIpLnN1YnN0cigwLCA5KSwgZSA9IE51bWJlcih0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBQYXJzZSB0aGUgZGF0ZSB0byBnZXQgdGhlIHNlY29uZHMuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBEYXRlKHQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2Vjb25kczogTWF0aC5mbG9vcihzLmdldFRpbWUoKSAvIDFlMyksXG4gICAgICAgICAgICBuYW5vczogZVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiBFdCh0LnNlY29uZHMpLFxuICAgICAgICBuYW5vczogRXQodC5uYW5vcylcbiAgICB9O1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB0eXBlcyBmb3IgbnVtYmVycyBpbnRvIGEgSmF2YVNjcmlwdCBudW1iZXIuXG4gKiBSZXR1cm5zIDAgaWYgdGhlIHZhbHVlIGlzIG5vdCBudW1lcmljLlxuICovIGZ1bmN0aW9uIEV0KHQpIHtcbiAgICAvLyBUT0RPKGJqb3JuaWNrKTogSGFuZGxlIGludDY0IGdyZWF0ZXIgdGhhbiA1MyBiaXRzLlxuICAgIHJldHVybiBcIm51bWJlclwiID09IHR5cGVvZiB0ID8gdCA6IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQgPyBOdW1iZXIodCkgOiAwO1xufVxuXG4vKiogQ29udmVydHMgdGhlIHBvc3NpYmxlIFByb3RvIHR5cGVzIGZvciBCbG9icyBpbnRvIGEgQnl0ZVN0cmluZy4gKi8gZnVuY3Rpb24gQXQodCkge1xuICAgIHJldHVybiBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gcHQuZnJvbUJhc2U2NFN0cmluZyh0KSA6IHB0LmZyb21VaW50OEFycmF5KHQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgbG9jYWxseS1hcHBsaWVkIFNlcnZlclRpbWVzdGFtcC5cbiAqXG4gKiBTZXJ2ZXIgVGltZXN0YW1wcyBhcmUgYmFja2VkIGJ5IE1hcFZhbHVlcyB0aGF0IGNvbnRhaW4gYW4gaW50ZXJuYWwgZmllbGRcbiAqIGBfX3R5cGVfX2Agd2l0aCBhIHZhbHVlIG9mIGBzZXJ2ZXJfdGltZXN0YW1wYC4gVGhlIHByZXZpb3VzIHZhbHVlIGFuZCBsb2NhbFxuICogd3JpdGUgdGltZSBhcmUgc3RvcmVkIGluIGl0cyBgX19wcmV2aW91c192YWx1ZV9fYCBhbmQgYF9fbG9jYWxfd3JpdGVfdGltZV9fYFxuICogZmllbGRzIHJlc3BlY3RpdmVseS5cbiAqXG4gKiBOb3RlczpcbiAqIC0gU2VydmVyVGltZXN0YW1wVmFsdWUgaW5zdGFuY2VzIGFyZSBjcmVhdGVkIGFzIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYVxuICogICB0cmFuc2Zvcm0uIFRoZXkgY2FuIG9ubHkgZXhpc3QgaW4gdGhlIGxvY2FsIHZpZXcgb2YgYSBkb2N1bWVudC4gVGhlcmVmb3JlXG4gKiAgIHRoZXkgZG8gbm90IG5lZWQgdG8gYmUgcGFyc2VkIG9yIHNlcmlhbGl6ZWQuXG4gKiAtIFdoZW4gZXZhbHVhdGVkIGxvY2FsbHkgKGUuZy4gZm9yIHNuYXBzaG90LmRhdGEoKSksIHRoZXkgYnkgZGVmYXVsdFxuICogICBldmFsdWF0ZSB0byBgbnVsbGAuIFRoaXMgYmVoYXZpb3IgY2FuIGJlIGNvbmZpZ3VyZWQgYnkgcGFzc2luZyBjdXN0b21cbiAqICAgRmllbGRWYWx1ZU9wdGlvbnMgdG8gdmFsdWUoKS5cbiAqIC0gV2l0aCByZXNwZWN0IHRvIG90aGVyIFNlcnZlclRpbWVzdGFtcFZhbHVlcywgdGhleSBzb3J0IGJ5IHRoZWlyXG4gKiAgIGxvY2FsV3JpdGVUaW1lLlxuICovIGZ1bmN0aW9uIFJ0KHQpIHtcbiAgICB2YXIgZSwgbjtcbiAgICByZXR1cm4gXCJzZXJ2ZXJfdGltZXN0YW1wXCIgPT09IChudWxsID09PSAobiA9ICgobnVsbCA9PT0gKGUgPSBudWxsID09IHQgPyB2b2lkIDAgOiB0Lm1hcFZhbHVlKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmZpZWxkcykgfHwge30pLl9fdHlwZV9fKSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLnN0cmluZ1ZhbHVlKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFNlcnZlclRpbWVzdGFtcCBwcm90byB2YWx1ZSAodXNpbmcgdGhlIGludGVybmFsIGZvcm1hdCkuXG4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIGZpZWxkIGJlZm9yZSB0aGlzIFNlcnZlclRpbWVzdGFtcCB3YXMgc2V0LlxuICpcbiAqIFByZXNlcnZpbmcgdGhlIHByZXZpb3VzIHZhbHVlcyBhbGxvd3MgdGhlIHVzZXIgdG8gZGlzcGxheSB0aGUgbGFzdCByZXNvbGVkXG4gKiB2YWx1ZSB1bnRpbCB0aGUgYmFja2VuZCByZXNwb25kcyB3aXRoIHRoZSB0aW1lc3RhbXAuXG4gKi9cbmZ1bmN0aW9uIGJ0KHQpIHtcbiAgICBjb25zdCBlID0gdC5tYXBWYWx1ZS5maWVsZHMuX19wcmV2aW91c192YWx1ZV9fO1xuICAgIHJldHVybiBSdChlKSA/IGJ0KGUpIDogZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBsb2NhbCB0aW1lIGF0IHdoaWNoIHRoaXMgdGltZXN0YW1wIHdhcyBmaXJzdCBzZXQuXG4gKi8gZnVuY3Rpb24gUHQodCkge1xuICAgIGNvbnN0IGUgPSBUdCh0Lm1hcFZhbHVlLmZpZWxkcy5fX2xvY2FsX3dyaXRlX3RpbWVfXy50aW1lc3RhbXBWYWx1ZSk7XG4gICAgcmV0dXJuIG5ldyBhdChlLnNlY29uZHMsIGUubmFub3MpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBWdCB7XG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0cyBhIERhdGFiYXNlSW5mbyB1c2luZyB0aGUgcHJvdmlkZWQgaG9zdCwgZGF0YWJhc2VJZCBhbmRcbiAgICAgKiBwZXJzaXN0ZW5jZUtleS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkYXRhYmFzZUlkIC0gVGhlIGRhdGFiYXNlIHRvIHVzZS5cbiAgICAgKiBAcGFyYW0gYXBwSWQgLSBUaGUgRmlyZWJhc2UgQXBwIElkLlxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZUtleSAtIEEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoaXMgRmlyZXN0b3JlJ3MgbG9jYWxcbiAgICAgKiBzdG9yYWdlICh1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIGRhdGFiYXNlSWQpLlxuICAgICAqIEBwYXJhbSBob3N0IC0gVGhlIEZpcmVzdG9yZSBiYWNrZW5kIGhvc3QgdG8gY29ubmVjdCB0by5cbiAgICAgKiBAcGFyYW0gc3NsIC0gV2hldGhlciB0byB1c2UgU1NMIHdoZW4gY29ubmVjdGluZy5cbiAgICAgKiBAcGFyYW0gZm9yY2VMb25nUG9sbGluZyAtIFdoZXRoZXIgdG8gdXNlIHRoZSBmb3JjZUxvbmdQb2xsaW5nIG9wdGlvblxuICAgICAqIHdoZW4gdXNpbmcgV2ViQ2hhbm5lbCBhcyB0aGUgbmV0d29yayB0cmFuc3BvcnQuXG4gICAgICogQHBhcmFtIGF1dG9EZXRlY3RMb25nUG9sbGluZyAtIFdoZXRoZXIgdG8gdXNlIHRoZSBkZXRlY3RCdWZmZXJpbmdQcm94eVxuICAgICAqIG9wdGlvbiB3aGVuIHVzaW5nIFdlYkNoYW5uZWwgYXMgdGhlIG5ldHdvcmsgdHJhbnNwb3J0LlxuICAgICAqIEBwYXJhbSB1c2VGZXRjaFN0cmVhbXMgV2hldGhlciB0byB1c2UgdGhlIEZldGNoIEFQSSBpbnN0ZWFkIG9mXG4gICAgICogWE1MSFRUUFJlcXVlc3RcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByLCBvLCB1KSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuYXBwSWQgPSBlLCB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gbiwgdGhpcy5ob3N0ID0gcywgdGhpcy5zc2wgPSBpLCBcbiAgICAgICAgdGhpcy5mb3JjZUxvbmdQb2xsaW5nID0gciwgdGhpcy5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSBvLCB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHU7XG4gICAgfVxufVxuXG4vKiogVGhlIGRlZmF1bHQgZGF0YWJhc2UgbmFtZSBmb3IgYSBwcm9qZWN0LiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBkYXRhYmFzZSBJRCBhIEZpcmVzdG9yZSBjbGllbnQgaXMgYXNzb2NpYXRlZCB3aXRoLlxuICogQGludGVybmFsXG4gKi9cbmNsYXNzIHZ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucHJvamVjdElkID0gdCwgdGhpcy5kYXRhYmFzZSA9IGUgfHwgXCIoZGVmYXVsdClcIjtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gbmV3IHZ0KFwiXCIsIFwiXCIpO1xuICAgIH1cbiAgICBnZXQgaXNEZWZhdWx0RGF0YWJhc2UoKSB7XG4gICAgICAgIHJldHVybiBcIihkZWZhdWx0KVwiID09PSB0aGlzLmRhdGFiYXNlO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiB2dCAmJiB0LnByb2plY3RJZCA9PT0gdGhpcy5wcm9qZWN0SWQgJiYgdC5kYXRhYmFzZSA9PT0gdGhpcy5kYXRhYmFzZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogU2VudGluZWwgdmFsdWUgdGhhdCBzb3J0cyBiZWZvcmUgYW55IE11dGF0aW9uIEJhdGNoIElELiAqL1xuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgYSB2YXJpYWJsZSBpcyBlaXRoZXIgdW5kZWZpbmVkIG9yIG51bGwuXG4gKi9cbmZ1bmN0aW9uIFN0KHQpIHtcbiAgICByZXR1cm4gbnVsbCA9PSB0O1xufVxuXG4vKiogUmV0dXJucyB3aGV0aGVyIHRoZSB2YWx1ZSByZXByZXNlbnRzIC0wLiAqLyBmdW5jdGlvbiBEdCh0KSB7XG4gICAgLy8gRGV0ZWN0IGlmIHRoZSB2YWx1ZSBpcyAtMC4wLiBCYXNlZCBvbiBwb2x5ZmlsbCBmcm9tXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2lzXG4gICAgcmV0dXJuIDAgPT09IHQgJiYgMSAvIHQgPT0gLTEgLyAwO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBhIHZhbHVlIGlzIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIGludGVnZXIgcmFuZ2VcbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byB0ZXN0IGZvciBiZWluZyBhbiBpbnRlZ2VyIGFuZCBpbiB0aGUgc2FmZSByYW5nZVxuICovIGZ1bmN0aW9uIEN0KHQpIHtcbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCAmJiBOdW1iZXIuaXNJbnRlZ2VyKHQpICYmICFEdCh0KSAmJiB0IDw9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSICYmIHQgPj0gTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUGF0aCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgeHQoX3QuZnJvbVN0cmluZyh0KSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tTmFtZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgeHQoX3QuZnJvbVN0cmluZyh0KS5wb3BGaXJzdCg1KSk7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB4dChfdC5lbXB0eVBhdGgoKSk7XG4gICAgfVxuICAgIGdldCBjb2xsZWN0aW9uR3JvdXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgucG9wTGFzdCgpLmxhc3RTZWdtZW50KCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGlzIGluIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbklkLiAqLyAgICBoYXNDb2xsZWN0aW9uSWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmxlbmd0aCA+PSAyICYmIHRoaXMucGF0aC5nZXQodGhpcy5wYXRoLmxlbmd0aCAtIDIpID09PSB0O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBncm91cCAoaS5lLiB0aGUgbmFtZSBvZiB0aGUgcGFyZW50IGNvbGxlY3Rpb24pIGZvciB0aGlzIGtleS4gKi8gICAgZ2V0Q29sbGVjdGlvbkdyb3VwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmdldCh0aGlzLnBhdGgubGVuZ3RoIC0gMik7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRoZSBmdWxseSBxdWFsaWZpZWQgcGF0aCB0byB0aGUgcGFyZW50IGNvbGxlY3Rpb24uICovICAgIGdldENvbGxlY3Rpb25QYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnBvcExhc3QoKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0ICYmIDAgPT09IF90LmNvbXBhcmF0b3IodGhpcy5wYXRoLCB0LnBhdGgpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC50b1N0cmluZygpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIHJldHVybiBfdC5jb21wYXJhdG9yKHQucGF0aCwgZS5wYXRoKTtcbiAgICB9XG4gICAgc3RhdGljIGlzRG9jdW1lbnRLZXkodCkge1xuICAgICAgICByZXR1cm4gdC5sZW5ndGggJSAyID09IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHdpdGggdGhlIGdpdmVuIHNlZ21lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlZ21lbnRzIC0gVGhlIHNlZ21lbnRzIG9mIHRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudFxuICAgICAqIEByZXR1cm5zIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VnbWVudHModCkge1xuICAgICAgICByZXR1cm4gbmV3IHh0KG5ldyBfdCh0LnNsaWNlKCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IE50ID0ge1xuICAgIG1hcFZhbHVlOiB7XG4gICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgX190eXBlX186IHtcbiAgICAgICAgICAgICAgICBzdHJpbmdWYWx1ZTogXCJfX21heF9fXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0sIGt0ID0ge1xuICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbn07XG5cbi8qKiBFeHRyYWN0cyB0aGUgYmFja2VuZCdzIHR5cGUgb3JkZXIgZm9yIHRoZSBwcm92aWRlZCB2YWx1ZS4gKi9cbmZ1bmN0aW9uIE10KHQpIHtcbiAgICByZXR1cm4gXCJudWxsVmFsdWVcIiBpbiB0ID8gMCAvKiBOdWxsVmFsdWUgKi8gOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCB8fCBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IDIgLyogTnVtYmVyVmFsdWUgKi8gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOiBcInN0cmluZ1ZhbHVlXCIgaW4gdCA/IDUgLyogU3RyaW5nVmFsdWUgKi8gOiBcImJ5dGVzVmFsdWVcIiBpbiB0ID8gNiAvKiBCbG9iVmFsdWUgKi8gOiBcInJlZmVyZW5jZVZhbHVlXCIgaW4gdCA/IDcgLyogUmVmVmFsdWUgKi8gOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8gOCAvKiBHZW9Qb2ludFZhbHVlICovIDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IDkgLyogQXJyYXlWYWx1ZSAqLyA6IFwibWFwVmFsdWVcIiBpbiB0ID8gUnQodCkgPyA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDogSHQodCkgPyA5MDA3MTk5MjU0NzQwOTkxIC8qIE1heFZhbHVlICovIDogMTAgLyogT2JqZWN0VmFsdWUgKi8gOiBMKCk7XG59XG5cbi8qKiBUZXN0cyBgbGVmdGAgYW5kIGByaWdodGAgZm9yIGVxdWFsaXR5IGJhc2VkIG9uIHRoZSBiYWNrZW5kIHNlbWFudGljcy4gKi8gZnVuY3Rpb24gT3QodCwgZSkge1xuICAgIGlmICh0ID09PSBlKSByZXR1cm4gITA7XG4gICAgY29uc3QgbiA9IE10KHQpO1xuICAgIGlmIChuICE9PSBNdChlKSkgcmV0dXJuICExO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAwIC8qIE51bGxWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDkwMDcxOTkyNTQ3NDA5OTEgLyogTWF4VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gITA7XG5cbiAgICAgIGNhc2UgMSAvKiBCb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5ib29sZWFuVmFsdWUgPT09IGUuYm9vbGVhblZhbHVlO1xuXG4gICAgICBjYXNlIDQgLyogU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gUHQodCkuaXNFcXVhbChQdChlKSk7XG5cbiAgICAgIGNhc2UgMyAvKiBUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdC50aW1lc3RhbXBWYWx1ZSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBlLnRpbWVzdGFtcFZhbHVlICYmIHQudGltZXN0YW1wVmFsdWUubGVuZ3RoID09PSBlLnRpbWVzdGFtcFZhbHVlLmxlbmd0aCkgXG4gICAgICAgICAgICAvLyBVc2Ugc3RyaW5nIGVxdWFsaXR5IGZvciBJU08gODYwMSB0aW1lc3RhbXBzXG4gICAgICAgICAgICByZXR1cm4gdC50aW1lc3RhbXBWYWx1ZSA9PT0gZS50aW1lc3RhbXBWYWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBUdCh0LnRpbWVzdGFtcFZhbHVlKSwgcyA9IFR0KGUudGltZXN0YW1wVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG4uc2Vjb25kcyA9PT0gcy5zZWNvbmRzICYmIG4ubmFub3MgPT09IHMubmFub3M7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0LnN0cmluZ1ZhbHVlID09PSBlLnN0cmluZ1ZhbHVlO1xuXG4gICAgICBjYXNlIDYgLyogQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBBdCh0LmJ5dGVzVmFsdWUpLmlzRXF1YWwoQXQoZS5ieXRlc1ZhbHVlKSk7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgNyAvKiBSZWZWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0LnJlZmVyZW5jZVZhbHVlID09PSBlLnJlZmVyZW5jZVZhbHVlO1xuXG4gICAgICBjYXNlIDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gRXQodC5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlKSA9PT0gRXQoZS5nZW9Qb2ludFZhbHVlLmxhdGl0dWRlKSAmJiBFdCh0Lmdlb1BvaW50VmFsdWUubG9uZ2l0dWRlKSA9PT0gRXQoZS5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSk7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgMiAvKiBOdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiB0ICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gZSkgcmV0dXJuIEV0KHQuaW50ZWdlclZhbHVlKSA9PT0gRXQoZS5pbnRlZ2VyVmFsdWUpO1xuICAgICAgICAgICAgaWYgKFwiZG91YmxlVmFsdWVcIiBpbiB0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEV0KHQuZG91YmxlVmFsdWUpLCBzID0gRXQoZS5kb3VibGVWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPT09IHMgPyBEdChuKSA9PT0gRHQocykgOiBpc05hTihuKSAmJiBpc05hTihzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgfSh0LCBlKTtcblxuICAgICAgY2FzZSA5IC8qIEFycmF5VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gb3QodC5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgZS5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSwgT3QpO1xuXG4gICAgICBjYXNlIDEwIC8qIE9iamVjdFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lm1hcFZhbHVlLmZpZWxkcyB8fCB7fSwgcyA9IGUubWFwVmFsdWUuZmllbGRzIHx8IHt9O1xuICAgICAgICAgICAgaWYgKGh0KG4pICE9PSBodChzKSkgcmV0dXJuICExO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IGluIG4pIGlmIChuLmhhc093blByb3BlcnR5KHQpICYmICh2b2lkIDAgPT09IHNbdF0gfHwgIU90KG5bdF0sIHNbdF0pKSkgcmV0dXJuICExO1xuICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICB9XG4gICAgICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIEFycmF5VmFsdWUgY29udGFpbnMgdGhlIHNwZWNpZmllZCBlbGVtZW50LiAqLyAodCwgZSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBMKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBGdCh0LCBlKSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gKHQudmFsdWVzIHx8IFtdKS5maW5kKCh0ID0+IE90KHQsIGUpKSk7XG59XG5cbmZ1bmN0aW9uICR0KHQsIGUpIHtcbiAgICBpZiAodCA9PT0gZSkgcmV0dXJuIDA7XG4gICAgY29uc3QgbiA9IE10KHQpLCBzID0gTXQoZSk7XG4gICAgaWYgKG4gIT09IHMpIHJldHVybiBydChuLCBzKTtcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMCAvKiBOdWxsVmFsdWUgKi8gOlxuICAgICAgY2FzZSA5MDA3MTk5MjU0NzQwOTkxIC8qIE1heFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIDA7XG5cbiAgICAgIGNhc2UgMSAvKiBCb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gcnQodC5ib29sZWFuVmFsdWUsIGUuYm9vbGVhblZhbHVlKTtcblxuICAgICAgY2FzZSAyIC8qIE51bWJlclZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBFdCh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKSwgcyA9IEV0KGUuaW50ZWdlclZhbHVlIHx8IGUuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG4gPCBzID8gLTEgOiBuID4gcyA/IDEgOiBuID09PSBzID8gMCA6IFxuICAgICAgICAgICAgLy8gb25lIG9yIGJvdGggYXJlIE5hTi5cbiAgICAgICAgICAgIGlzTmFOKG4pID8gaXNOYU4ocykgPyAwIDogLTEgOiAxO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gQnQodC50aW1lc3RhbXBWYWx1ZSwgZS50aW1lc3RhbXBWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNCAvKiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBCdChQdCh0KSwgUHQoZSkpO1xuXG4gICAgICBjYXNlIDUgLyogU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gcnQodC5zdHJpbmdWYWx1ZSwgZS5zdHJpbmdWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNiAvKiBCbG9iVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IEF0KHQpLCBzID0gQXQoZSk7XG4gICAgICAgICAgICByZXR1cm4gbi5jb21wYXJlVG8ocyk7XG4gICAgICAgIH0odC5ieXRlc1ZhbHVlLCBlLmJ5dGVzVmFsdWUpO1xuXG4gICAgICBjYXNlIDcgLyogUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuc3BsaXQoXCIvXCIpLCBzID0gZS5zcGxpdChcIi9cIik7XG4gICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IG4ubGVuZ3RoICYmIHQgPCBzLmxlbmd0aDsgdCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHJ0KG5bdF0sIHNbdF0pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSBlKSByZXR1cm4gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydChuLmxlbmd0aCwgcy5sZW5ndGgpO1xuICAgICAgICB9KHQucmVmZXJlbmNlVmFsdWUsIGUucmVmZXJlbmNlVmFsdWUpO1xuXG4gICAgICBjYXNlIDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gcnQoRXQodC5sYXRpdHVkZSksIEV0KGUubGF0aXR1ZGUpKTtcbiAgICAgICAgICAgIGlmICgwICE9PSBuKSByZXR1cm4gbjtcbiAgICAgICAgICAgIHJldHVybiBydChFdCh0LmxvbmdpdHVkZSksIEV0KGUubG9uZ2l0dWRlKSk7XG4gICAgICAgIH0odC5nZW9Qb2ludFZhbHVlLCBlLmdlb1BvaW50VmFsdWUpO1xuXG4gICAgICBjYXNlIDkgLyogQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC52YWx1ZXMgfHwgW10sIHMgPSBlLnZhbHVlcyB8fCBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgbi5sZW5ndGggJiYgdCA8IHMubGVuZ3RoOyArK3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gJHQoblt0XSwgc1t0XSk7XG4gICAgICAgICAgICAgICAgaWYgKGUpIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ0KG4ubGVuZ3RoLCBzLmxlbmd0aCk7XG4gICAgICAgIH0odC5hcnJheVZhbHVlLCBlLmFycmF5VmFsdWUpO1xuXG4gICAgICBjYXNlIDEwIC8qIE9iamVjdFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGlmICh0ID09PSBOdC5tYXBWYWx1ZSAmJiBlID09PSBOdC5tYXBWYWx1ZSkgcmV0dXJuIDA7XG4gICAgICAgICAgICBpZiAodCA9PT0gTnQubWFwVmFsdWUpIHJldHVybiAxO1xuICAgICAgICAgICAgaWYgKGUgPT09IE50Lm1hcFZhbHVlKSByZXR1cm4gLTE7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5maWVsZHMgfHwge30sIHMgPSBPYmplY3Qua2V5cyhuKSwgaSA9IGUuZmllbGRzIHx8IHt9LCByID0gT2JqZWN0LmtleXMoaSk7XG4gICAgICAgICAgICAvLyBFdmVuIHRob3VnaCBNYXBWYWx1ZXMgYXJlIGxpa2VseSBzb3J0ZWQgY29ycmVjdGx5IGJhc2VkIG9uIHRoZWlyIGluc2VydGlvblxuICAgICAgICAgICAgLy8gb3JkZXIgKGUuZy4gd2hlbiByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kKSwgbG9jYWwgbW9kaWZpY2F0aW9ucyBjYW4gYnJpbmdcbiAgICAgICAgICAgIC8vIGVsZW1lbnRzIG91dCBvZiBvcmRlci4gV2UgbmVlZCB0byByZS1zb3J0IHRoZSBlbGVtZW50cyB0byBlbnN1cmUgdGhhdFxuICAgICAgICAgICAgLy8gY2Fub25pY2FsIElEcyBhcmUgaW5kZXBlbmRlbnQgb2YgaW5zZXJ0aW9uIG9yZGVyLlxuICAgICAgICAgICAgcy5zb3J0KCksIHIuc29ydCgpO1xuICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBzLmxlbmd0aCAmJiB0IDwgci5sZW5ndGg7ICsrdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBydChzW3RdLCByW3RdKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICAgICAgY29uc3QgbyA9ICR0KG5bc1t0XV0sIGlbclt0XV0pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSBvKSByZXR1cm4gbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydChzLmxlbmd0aCwgci5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogR2VuZXJhdGVzIHRoZSBjYW5vbmljYWwgSUQgZm9yIHRoZSBwcm92aWRlZCBmaWVsZCB2YWx1ZSAoYXMgdXNlZCBpbiBUYXJnZXRcbiAqIHNlcmlhbGl6YXRpb24pLlxuICovICh0Lm1hcFZhbHVlLCBlLm1hcFZhbHVlKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgTCgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gQnQodCwgZSkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0ICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgJiYgdC5sZW5ndGggPT09IGUubGVuZ3RoKSByZXR1cm4gcnQodCwgZSk7XG4gICAgY29uc3QgbiA9IFR0KHQpLCBzID0gVHQoZSksIGkgPSBydChuLnNlY29uZHMsIHMuc2Vjb25kcyk7XG4gICAgcmV0dXJuIDAgIT09IGkgPyBpIDogcnQobi5uYW5vcywgcy5uYW5vcyk7XG59XG5cbmZ1bmN0aW9uIEx0KHQpIHtcbiAgICByZXR1cm4gVXQodCk7XG59XG5cbmZ1bmN0aW9uIFV0KHQpIHtcbiAgICByZXR1cm4gXCJudWxsVmFsdWVcIiBpbiB0ID8gXCJudWxsXCIgOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyBcIlwiICsgdC5ib29sZWFuVmFsdWUgOiBcImludGVnZXJWYWx1ZVwiIGluIHQgPyBcIlwiICsgdC5pbnRlZ2VyVmFsdWUgOiBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IFwiXCIgKyB0LmRvdWJsZVZhbHVlIDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBUdCh0KTtcbiAgICAgICAgcmV0dXJuIGB0aW1lKCR7ZS5zZWNvbmRzfSwke2UubmFub3N9KWA7XG4gICAgfSh0LnRpbWVzdGFtcFZhbHVlKSA6IFwic3RyaW5nVmFsdWVcIiBpbiB0ID8gdC5zdHJpbmdWYWx1ZSA6IFwiYnl0ZXNWYWx1ZVwiIGluIHQgPyBBdCh0LmJ5dGVzVmFsdWUpLnRvQmFzZTY0KCkgOiBcInJlZmVyZW5jZVZhbHVlXCIgaW4gdCA/IChuID0gdC5yZWZlcmVuY2VWYWx1ZSwgXG4gICAgeHQuZnJvbU5hbWUobikudG9TdHJpbmcoKSkgOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8gYGdlbygkeyhlID0gdC5nZW9Qb2ludFZhbHVlKS5sYXRpdHVkZX0sJHtlLmxvbmdpdHVkZX0pYCA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIGxldCBlID0gXCJbXCIsIG4gPSAhMDtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHQudmFsdWVzIHx8IFtdKSBuID8gbiA9ICExIDogZSArPSBcIixcIiwgZSArPSBVdChzKTtcbiAgICAgICAgcmV0dXJuIGUgKyBcIl1cIjtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSByZWZlcmVuY2UgdmFsdWUgZm9yIHRoZSBwcm92aWRlZCBkYXRhYmFzZSBhbmQga2V5LiAqLyAodC5hcnJheVZhbHVlKSA6IFwibWFwVmFsdWVcIiBpbiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICAvLyBJdGVyYXRpb24gb3JkZXIgaW4gSmF2YVNjcmlwdCBpcyBub3QgZ3VhcmFudGVlZC4gVG8gZW5zdXJlIHRoYXQgd2UgZ2VuZXJhdGVcbiAgICAgICAgLy8gbWF0Y2hpbmcgY2Fub25pY2FsIElEcyBmb3IgaWRlbnRpY2FsIG1hcHMsIHdlIG5lZWQgdG8gc29ydCB0aGUga2V5cy5cbiAgICAgICAgY29uc3QgZSA9IE9iamVjdC5rZXlzKHQuZmllbGRzIHx8IHt9KS5zb3J0KCk7XG4gICAgICAgIGxldCBuID0gXCJ7XCIsIHMgPSAhMDtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHMgPyBzID0gITEgOiBuICs9IFwiLFwiLCBuICs9IGAke2l9OiR7VXQodC5maWVsZHNbaV0pfWA7XG4gICAgICAgIHJldHVybiBuICsgXCJ9XCI7XG4gICAgfSh0Lm1hcFZhbHVlKSA6IEwoKTtcbiAgICB2YXIgZSwgbjtcbn1cblxuZnVuY3Rpb24gcXQodCwgZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlZmVyZW5jZVZhbHVlOiBgcHJvamVjdHMvJHt0LnByb2plY3RJZH0vZGF0YWJhc2VzLyR7dC5kYXRhYmFzZX0vZG9jdW1lbnRzLyR7ZS5wYXRoLmNhbm9uaWNhbFN0cmluZygpfWBcbiAgICB9O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYW4gSW50ZWdlclZhbHVlIC4gKi8gZnVuY3Rpb24gS3QodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJpbnRlZ2VyVmFsdWVcIiBpbiB0O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBEb3VibGVWYWx1ZS4gKi9cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhbiBBcnJheVZhbHVlLiAqL1xuZnVuY3Rpb24gR3QodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJhcnJheVZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgTnVsbFZhbHVlLiAqLyBmdW5jdGlvbiBRdCh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcIm51bGxWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBOYU4uICovIGZ1bmN0aW9uIGp0KHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiB0ICYmIGlzTmFOKE51bWJlcih0LmRvdWJsZVZhbHVlKSk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIE1hcFZhbHVlLiAqLyBmdW5jdGlvbiBXdCh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcIm1hcFZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIENyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgYHNvdXJjZWAuICovIGZ1bmN0aW9uIHp0KHQpIHtcbiAgICBpZiAodC5nZW9Qb2ludFZhbHVlKSByZXR1cm4ge1xuICAgICAgICBnZW9Qb2ludFZhbHVlOiBPYmplY3QuYXNzaWduKHt9LCB0Lmdlb1BvaW50VmFsdWUpXG4gICAgfTtcbiAgICBpZiAodC50aW1lc3RhbXBWYWx1ZSAmJiBcIm9iamVjdFwiID09IHR5cGVvZiB0LnRpbWVzdGFtcFZhbHVlKSByZXR1cm4ge1xuICAgICAgICB0aW1lc3RhbXBWYWx1ZTogT2JqZWN0LmFzc2lnbih7fSwgdC50aW1lc3RhbXBWYWx1ZSlcbiAgICB9O1xuICAgIGlmICh0Lm1hcFZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGx0KHQubWFwVmFsdWUuZmllbGRzLCAoKHQsIG4pID0+IGUubWFwVmFsdWUuZmllbGRzW3RdID0genQobikpKSwgZTtcbiAgICB9XG4gICAgaWYgKHQuYXJyYXlWYWx1ZSkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogW11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCAodC5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSkubGVuZ3RoOyArK24pIGUuYXJyYXlWYWx1ZS52YWx1ZXNbbl0gPSB6dCh0LmFycmF5VmFsdWUudmFsdWVzW25dKTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0KTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgVmFsdWUgcmVwcmVzZW50cyB0aGUgY2Fub25pY2FsIHtAbGluayAjTUFYX1ZBTFVFfSAuICovIGZ1bmN0aW9uIEh0KHQpIHtcbiAgICByZXR1cm4gXCJfX21heF9fXCIgPT09ICgoKHQubWFwVmFsdWUgfHwge30pLmZpZWxkcyB8fCB7fSkuX190eXBlX18gfHwge30pLnN0cmluZ1ZhbHVlO1xufVxuXG4vKiogUmV0dXJucyB0aGUgbG93ZXN0IHZhbHVlIGZvciB0aGUgZ2l2ZW4gdmFsdWUgdHlwZSAoaW5jbHVzaXZlKS4gKi8gZnVuY3Rpb24gSnQodCkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIHQgPyBrdCA6IFwiYm9vbGVhblZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgYm9vbGVhblZhbHVlOiAhMVxuICAgIH0gOiBcImludGVnZXJWYWx1ZVwiIGluIHQgfHwgXCJkb3VibGVWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICB9IDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIHRpbWVzdGFtcFZhbHVlOiB7XG4gICAgICAgICAgICBzZWNvbmRzOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUlxuICAgICAgICB9XG4gICAgfSA6IFwic3RyaW5nVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBzdHJpbmdWYWx1ZTogXCJcIlxuICAgIH0gOiBcImJ5dGVzVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBieXRlc1ZhbHVlOiBcIlwiXG4gICAgfSA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiB0ID8gcXQodnQuZW1wdHkoKSwgeHQuZW1wdHkoKSkgOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogLTkwLFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiAtMTgwXG4gICAgICAgIH1cbiAgICB9IDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgYXJyYXlWYWx1ZToge31cbiAgICB9IDogXCJtYXBWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIG1hcFZhbHVlOiB7fVxuICAgIH0gOiBMKCk7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBsYXJnZXN0IHZhbHVlIGZvciB0aGUgZ2l2ZW4gdmFsdWUgdHlwZSAoZXhjbHVzaXZlKS4gKi8gZnVuY3Rpb24gWXQodCkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGJvb2xlYW5WYWx1ZTogITFcbiAgICB9IDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBkb3VibGVWYWx1ZTogTmFOXG4gICAgfSA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCB8fCBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgIHNlY29uZHM6IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXG4gICAgICAgIH1cbiAgICB9IDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIHN0cmluZ1ZhbHVlOiBcIlwiXG4gICAgfSA6IFwic3RyaW5nVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBieXRlc1ZhbHVlOiBcIlwiXG4gICAgfSA6IFwiYnl0ZXNWYWx1ZVwiIGluIHQgPyBxdCh2dC5lbXB0eSgpLCB4dC5lbXB0eSgpKSA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogLTkwLFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiAtMTgwXG4gICAgICAgIH1cbiAgICB9IDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgYXJyYXlWYWx1ZToge31cbiAgICB9IDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgfSA6IFwibWFwVmFsdWVcIiBpbiB0ID8gTnQgOiBMKCk7XG59XG5cbmZ1bmN0aW9uIFh0KHQsIGUpIHtcbiAgICBjb25zdCBuID0gJHQodC52YWx1ZSwgZS52YWx1ZSk7XG4gICAgcmV0dXJuIDAgIT09IG4gPyBuIDogdC5pbmNsdXNpdmUgJiYgIWUuaW5jbHVzaXZlID8gLTEgOiAhdC5pbmNsdXNpdmUgJiYgZS5pbmNsdXNpdmUgPyAxIDogMDtcbn1cblxuZnVuY3Rpb24gWnQodCwgZSkge1xuICAgIGNvbnN0IG4gPSAkdCh0LnZhbHVlLCBlLnZhbHVlKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiB0LmluY2x1c2l2ZSAmJiAhZS5pbmNsdXNpdmUgPyAxIDogIXQuaW5jbHVzaXZlICYmIGUuaW5jbHVzaXZlID8gLTEgOiAwO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBPYmplY3RWYWx1ZSByZXByZXNlbnRzIGEgTWFwVmFsdWUgaW4gdGhlIEZpcmVzdG9yZSBQcm90byBhbmQgb2ZmZXJzIHRoZVxuICogYWJpbGl0eSB0byBhZGQgYW5kIHJlbW92ZSBmaWVsZHMgKHZpYSB0aGUgT2JqZWN0VmFsdWVCdWlsZGVyKS5cbiAqLyBjbGFzcyB0ZSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdDtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gbmV3IHRlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7fVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmFsdWUgYXQgdGhlIGdpdmVuIHBhdGggb3IgbnVsbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoIC0gdGhlIHBhdGggdG8gc2VhcmNoXG4gICAgICogQHJldHVybnMgVGhlIHZhbHVlIGF0IHRoZSBwYXRoIG9yIG51bGwgaWYgdGhlIHBhdGggaXMgbm90IHNldC5cbiAgICAgKi8gICAgZmllbGQodCkge1xuICAgICAgICBpZiAodC5pc0VtcHR5KCkpIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgICB7XG4gICAgICAgICAgICBsZXQgZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoIC0gMTsgKytuKSBpZiAoZSA9IChlLm1hcFZhbHVlLmZpZWxkcyB8fCB7fSlbdC5nZXQobildLCBcbiAgICAgICAgICAgICFXdChlKSkgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICByZXR1cm4gZSA9IChlLm1hcFZhbHVlLmZpZWxkcyB8fCB7fSlbdC5sYXN0U2VnbWVudCgpXSwgZSB8fCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGZpZWxkIHRvIHRoZSBwcm92aWRlZCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoIC0gVGhlIGZpZWxkIHBhdGggdG8gc2V0LlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICovICAgIHNldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuZ2V0RmllbGRzTWFwKHQucG9wTGFzdCgpKVt0Lmxhc3RTZWdtZW50KCldID0genQoZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIHByb3ZpZGVkIGZpZWxkcyB0byB0aGUgcHJvdmlkZWQgdmFsdWVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGEgLSBBIG1hcCBvZiBmaWVsZHMgdG8gdmFsdWVzIChvciBudWxsIGZvciBkZWxldGVzKS5cbiAgICAgKi8gICAgc2V0QWxsKHQpIHtcbiAgICAgICAgbGV0IGUgPSBtdC5lbXB0eVBhdGgoKSwgbiA9IHt9LCBzID0gW107XG4gICAgICAgIHQuZm9yRWFjaCgoKHQsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICghZS5pc0ltbWVkaWF0ZVBhcmVudE9mKGkpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW5zZXJ0IHRoZSBhY2N1bXVsYXRlZCBjaGFuZ2VzIGF0IHRoaXMgcGFyZW50IGxvY2F0aW9uXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0RmllbGRzTWFwKGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKHQsIG4sIHMpLCBuID0ge30sIHMgPSBbXSwgZSA9IGkucG9wTGFzdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdCA/IG5baS5sYXN0U2VnbWVudCgpXSA9IHp0KHQpIDogcy5wdXNoKGkubGFzdFNlZ21lbnQoKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuZ2V0RmllbGRzTWFwKGUpO1xuICAgICAgICB0aGlzLmFwcGx5Q2hhbmdlcyhpLCBuLCBzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgZmllbGQgYXQgdGhlIHNwZWNpZmllZCBwYXRoLiBJZiB0aGVyZSBpcyBubyBmaWVsZCBhdCB0aGVcbiAgICAgKiBzcGVjaWZpZWQgcGF0aCwgbm90aGluZyBpcyBjaGFuZ2VkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmllbGQgcGF0aCB0byByZW1vdmUuXG4gICAgICovICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmZpZWxkKHQucG9wTGFzdCgpKTtcbiAgICAgICAgV3QoZSkgJiYgZS5tYXBWYWx1ZS5maWVsZHMgJiYgZGVsZXRlIGUubWFwVmFsdWUuZmllbGRzW3QubGFzdFNlZ21lbnQoKV07XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gT3QodGhpcy52YWx1ZSwgdC52YWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG1hcCB0aGF0IGNvbnRhaW5zIHRoZSBsZWFmIGVsZW1lbnQgb2YgYHBhdGhgLiBJZiB0aGUgcGFyZW50XG4gICAgICogZW50cnkgZG9lcyBub3QgeWV0IGV4aXN0LCBvciBpZiBpdCBpcyBub3QgYSBtYXAsIGEgbmV3IG1hcCB3aWxsIGJlIGNyZWF0ZWQuXG4gICAgICovICAgIGdldEZpZWxkc01hcCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgZS5tYXBWYWx1ZS5maWVsZHMgfHwgKGUubWFwVmFsdWUgPSB7XG4gICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyArK24pIHtcbiAgICAgICAgICAgIGxldCBzID0gZS5tYXBWYWx1ZS5maWVsZHNbdC5nZXQobildO1xuICAgICAgICAgICAgV3QocykgJiYgcy5tYXBWYWx1ZS5maWVsZHMgfHwgKHMgPSB7XG4gICAgICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzOiB7fVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIGUubWFwVmFsdWUuZmllbGRzW3QuZ2V0KG4pXSA9IHMpLCBlID0gcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZS5tYXBWYWx1ZS5maWVsZHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1vZGlmaWVzIGBmaWVsZHNNYXBgIGJ5IGFkZGluZywgcmVwbGFjaW5nIG9yIGRlbGV0aW5nIHRoZSBzcGVjaWZpZWRcbiAgICAgKiBlbnRyaWVzLlxuICAgICAqLyAgICBhcHBseUNoYW5nZXModCwgZSwgbikge1xuICAgICAgICBsdChlLCAoKGUsIG4pID0+IHRbZV0gPSBuKSk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBuKSBkZWxldGUgdFtlXTtcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgdGUoenQodGhpcy52YWx1ZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgRmllbGRNYXNrIGJ1aWx0IGZyb20gYWxsIGZpZWxkcyBpbiBhIE1hcFZhbHVlLlxuICovIGZ1bmN0aW9uIGVlKHQpIHtcbiAgICBjb25zdCBlID0gW107XG4gICAgcmV0dXJuIGx0KHQuZmllbGRzLCAoKHQsIG4pID0+IHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBtdChbIHQgXSk7XG4gICAgICAgIGlmIChXdChuKSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGVlKG4ubWFwVmFsdWUpLmZpZWxkcztcbiAgICAgICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgXG4gICAgICAgICAgICAvLyBQcmVzZXJ2ZSB0aGUgZW1wdHkgbWFwIGJ5IGFkZGluZyBpdCB0byB0aGUgRmllbGRNYXNrLlxuICAgICAgICAgICAgZS5wdXNoKHMpOyBlbHNlIFxuICAgICAgICAgICAgLy8gRm9yIG5lc3RlZCBhbmQgbm9uLWVtcHR5IE9iamVjdFZhbHVlcywgYWRkIHRoZSBGaWVsZFBhdGggb2YgdGhlXG4gICAgICAgICAgICAvLyBsZWFmIG5vZGVzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQpIGUucHVzaChzLmNoaWxkKG4pKTtcbiAgICAgICAgfSBlbHNlIFxuICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGUgbGVhZlxuICAgICAgICAvLyBub2Rlcy5cbiAgICAgICAgZS5wdXNoKHMpO1xuICAgIH0pKSwgbmV3IGd0KGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgZG9jdW1lbnQgaW4gRmlyZXN0b3JlIHdpdGggYSBrZXksIHZlcnNpb24sIGRhdGEgYW5kIHdoZXRoZXIgaXRcbiAqIGhhcyBsb2NhbCBtdXRhdGlvbnMgYXBwbGllZCB0byBpdC5cbiAqXG4gKiBEb2N1bWVudHMgY2FuIHRyYW5zaXRpb24gYmV0d2VlbiBzdGF0ZXMgdmlhIGBjb252ZXJ0VG9Gb3VuZERvY3VtZW50KClgLFxuICogYGNvbnZlcnRUb05vRG9jdW1lbnQoKWAgYW5kIGBjb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQoKWAuIElmIGEgZG9jdW1lbnQgZG9lc1xuICogbm90IHRyYW5zaXRpb24gdG8gb25lIG9mIHRoZXNlIHN0YXRlcyBldmVuIGFmdGVyIGFsbCBtdXRhdGlvbnMgaGF2ZSBiZWVuXG4gKiBhcHBsaWVkLCBgaXNWYWxpZERvY3VtZW50KClgIHJldHVybnMgZmFsc2UgYW5kIHRoZSBkb2N1bWVudCBzaG91bGQgYmUgcmVtb3ZlZFxuICogZnJvbSBhbGwgdmlld3MuXG4gKi8gY2xhc3MgbmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IGUsIHRoaXMudmVyc2lvbiA9IG4sIHRoaXMucmVhZFRpbWUgPSBzLCB0aGlzLmRhdGEgPSBpLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudFN0YXRlID0gcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGRvY3VtZW50IHdpdGggbm8ga25vd24gdmVyc2lvbiBvciBkYXRhLCBidXQgd2hpY2ggY2FuIHNlcnZlIGFzXG4gICAgICogYmFzZSBkb2N1bWVudCBmb3IgbXV0YXRpb25zLlxuICAgICAqLyAgICBzdGF0aWMgbmV3SW52YWxpZERvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBuZSh0LCAwIC8qIElOVkFMSUQgKi8gLCBjdC5taW4oKSwgY3QubWluKCksIHRlLmVtcHR5KCksIDAgLyogU1lOQ0VEICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IHdpdGggdGhlIGdpdmVuIGRhdGEgYXQgdGhlXG4gICAgICogZ2l2ZW4gdmVyc2lvbi5cbiAgICAgKi8gICAgc3RhdGljIG5ld0ZvdW5kRG9jdW1lbnQodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbmV3IG5lKHQsIDEgLyogRk9VTkRfRE9DVU1FTlQgKi8gLCBlLCBjdC5taW4oKSwgbiwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIG5vdCBleGlzdCBhdCB0aGUgZ2l2ZW4gdmVyc2lvbi4gKi8gICAgc3RhdGljIG5ld05vRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IG5lKHQsIDIgLyogTk9fRE9DVU1FTlQgKi8gLCBlLCBjdC5taW4oKSwgdGUuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24gYnV0XG4gICAgICogd2hvc2UgZGF0YSBpcyBub3Qga25vd24gKGUuZy4gYSBkb2N1bWVudCB0aGF0IHdhcyB1cGRhdGVkIHdpdGhvdXQgYSBrbm93blxuICAgICAqIGJhc2UgZG9jdW1lbnQpLlxuICAgICAqLyAgICBzdGF0aWMgbmV3VW5rbm93bkRvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBuZSh0LCAzIC8qIFVOS05PV05fRE9DVU1FTlQgKi8gLCBlLCBjdC5taW4oKSwgdGUuZW1wdHkoKSwgMiAvKiBIQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYW5kIHRoYXQgaXRzIHZlcnNpb25cbiAgICAgKiBhbmQgZGF0YSBhcmUga25vd24uXG4gICAgICovICAgIGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uID0gdCwgdGhpcy5kb2N1bWVudFR5cGUgPSAxIC8qIEZPVU5EX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gZSwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDAgLyogU1lOQ0VEICovICwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgZG9jdW1lbnQgdHlwZSB0byBpbmRpY2F0ZSB0aGF0IGl0IGRvZXNuJ3QgZXhpc3QgYXQgdGhlIGdpdmVuXG4gICAgICogdmVyc2lvbi5cbiAgICAgKi8gICAgY29udmVydFRvTm9Eb2N1bWVudCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDIgLyogTk9fRE9DVU1FTlQgKi8gLCB0aGlzLmRhdGEgPSB0ZS5lbXB0eSgpLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBTWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZXhpc3RzIGF0IGEgZ2l2ZW4gdmVyc2lvbiBidXRcbiAgICAgKiB0aGF0IGl0cyBkYXRhIGlzIG5vdCBrbm93biAoZS5nLiBhIGRvY3VtZW50IHRoYXQgd2FzIHVwZGF0ZWQgd2l0aG91dCBhIGtub3duXG4gICAgICogYmFzZSBkb2N1bWVudCkuXG4gICAgICovICAgIGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDMgLyogVU5LTk9XTl9ET0NVTUVOVCAqLyAsIHRoaXMuZGF0YSA9IHRlLmVtcHR5KCksIFxuICAgICAgICB0aGlzLmRvY3VtZW50U3RhdGUgPSAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudFN0YXRlID0gMiAvKiBIQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyAsIHRoaXM7XG4gICAgfVxuICAgIHNldEhhc0xvY2FsTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudFN0YXRlID0gMSAvKiBIQVNfTE9DQUxfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0UmVhZFRpbWUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWFkVGltZSA9IHQsIHRoaXM7XG4gICAgfVxuICAgIGdldCBoYXNMb2NhbE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDEgLyogSEFTX0xPQ0FMX01VVEFUSU9OUyAqLyA9PT0gdGhpcy5kb2N1bWVudFN0YXRlO1xuICAgIH1cbiAgICBnZXQgaGFzQ29tbWl0dGVkTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gMiAvKiBIQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyA9PT0gdGhpcy5kb2N1bWVudFN0YXRlO1xuICAgIH1cbiAgICBnZXQgaGFzUGVuZGluZ1dyaXRlcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzTG9jYWxNdXRhdGlvbnMgfHwgdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XG4gICAgfVxuICAgIGlzVmFsaWREb2N1bWVudCgpIHtcbiAgICAgICAgcmV0dXJuIDAgLyogSU5WQUxJRCAqLyAhPT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzRm91bmREb2N1bWVudCgpIHtcbiAgICAgICAgcmV0dXJuIDEgLyogRk9VTkRfRE9DVU1FTlQgKi8gPT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc05vRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAyIC8qIE5PX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNVbmtub3duRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAzIC8qIFVOS05PV05fRE9DVU1FTlQgKi8gPT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBuZSAmJiB0aGlzLmtleS5pc0VxdWFsKHQua2V5KSAmJiB0aGlzLnZlcnNpb24uaXNFcXVhbCh0LnZlcnNpb24pICYmIHRoaXMuZG9jdW1lbnRUeXBlID09PSB0LmRvY3VtZW50VHlwZSAmJiB0aGlzLmRvY3VtZW50U3RhdGUgPT09IHQuZG9jdW1lbnRTdGF0ZSAmJiB0aGlzLmRhdGEuaXNFcXVhbCh0LmRhdGEpO1xuICAgIH1cbiAgICBtdXRhYmxlQ29weSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBuZSh0aGlzLmtleSwgdGhpcy5kb2N1bWVudFR5cGUsIHRoaXMudmVyc2lvbiwgdGhpcy5yZWFkVGltZSwgdGhpcy5kYXRhLmNsb25lKCksIHRoaXMuZG9jdW1lbnRTdGF0ZSk7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gYERvY3VtZW50KCR7dGhpcy5rZXl9LCAke3RoaXMudmVyc2lvbn0sICR7SlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhLnZhbHVlKX0sIHtkb2N1bWVudFR5cGU6ICR7dGhpcy5kb2N1bWVudFR5cGV9fSksIHtkb2N1bWVudFN0YXRlOiAke3RoaXMuZG9jdW1lbnRTdGF0ZX19KWA7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXBhcmVzIHRoZSB2YWx1ZSBmb3IgZmllbGQgYGZpZWxkYCBpbiB0aGUgcHJvdmlkZWQgZG9jdW1lbnRzLiBUaHJvd3MgaWZcbiAqIHRoZSBmaWVsZCBkb2VzIG5vdCBleGlzdCBpbiBib3RoIGRvY3VtZW50cy5cbiAqL1xuLyoqXG4gKiBBbiBpbmRleCBkZWZpbml0aW9uIGZvciBmaWVsZCBpbmRleGVzIGluIEZpcmVzdG9yZS5cbiAqXG4gKiBFdmVyeSBpbmRleCBpcyBhc3NvY2lhdGVkIHdpdGggYSBjb2xsZWN0aW9uLiBUaGUgZGVmaW5pdGlvbiBjb250YWlucyBhIGxpc3RcbiAqIG9mIGZpZWxkcyBhbmQgdGhlaXIgaW5kZXgga2luZCAod2hpY2ggY2FuIGJlIGBBU0NFTkRJTkdgLCBgREVTQ0VORElOR2Agb3JcbiAqIGBDT05UQUlOU2AgZm9yIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBxdWVyaWVzKS5cbiAqXG4gKiBVbmxpa2UgdGhlIGJhY2tlbmQsIHRoZSBTREsgZG9lcyBub3QgZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGNvbGxlY3Rpb24gb3JcbiAqIGNvbGxlY3Rpb24gZ3JvdXAtc2NvcGVkIGluZGljZXMuIEV2ZXJ5IGluZGV4IGNhbiBiZSB1c2VkIGZvciBib3RoIHNpbmdsZVxuICogY29sbGVjdGlvbiBhbmQgY29sbGVjdGlvbiBncm91cCBxdWVyaWVzLlxuICovXG5jbGFzcyBzZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IElELiBSZXR1cm5zIC0xIGlmIHRoZSBpbmRleCBJRCBpcyBub3QgYXZhaWxhYmxlIChlLmcuIHRoZSBpbmRleFxuICAgICAqIGhhcyBub3QgeWV0IGJlZW4gcGVyc2lzdGVkKS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNvbGxlY3Rpb24gSUQgdGhpcyBpbmRleCBhcHBsaWVzIHRvLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUgZmllbGQgc2VnbWVudHMgZm9yIHRoaXMgaW5kZXguICovXG4gICAgbiwgXG4gICAgLyoqIFNob3dzIGhvdyB1cC10by1kYXRlIHRoZSBpbmRleCBpcyBmb3IgdGhlIGN1cnJlbnQgdXNlci4gKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuaW5kZXhJZCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5maWVsZHMgPSBuLCB0aGlzLmluZGV4U3RhdGUgPSBzO1xuICAgIH1cbn1cblxuLyoqIEFuIElEIGZvciBhbiBpbmRleCB0aGF0IGhhcyBub3QgeWV0IGJlZW4gYWRkZWQgdG8gcGVyc2lzdGVuY2UuICAqL1xuLyoqIFJldHVybnMgdGhlIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBzZWdtZW50IGZvciB0aGlzIGluZGV4LiAqL1xuZnVuY3Rpb24gaWUodCkge1xuICAgIHJldHVybiB0LmZpZWxkcy5maW5kKCh0ID0+IDIgLyogQ09OVEFJTlMgKi8gPT09IHQua2luZCkpO1xufVxuXG4vKiogUmV0dXJucyBhbGwgZGlyZWN0aW9uYWwgKGFzY2VuZGluZy9kZXNjZW5kaW5nKSBzZWdtZW50cyBmb3IgdGhpcyBpbmRleC4gKi8gZnVuY3Rpb24gcmUodCkge1xuICAgIHJldHVybiB0LmZpZWxkcy5maWx0ZXIoKHQgPT4gMiAvKiBDT05UQUlOUyAqLyAhPT0gdC5raW5kKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgb3JkZXIgb2YgdGhlIGRvY3VtZW50IGtleSBjb21wb25lbnQgZm9yIHRoZSBnaXZlbiBpbmRleC5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBXZWIgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uLlxuICovIHNlLlVOS05PV05fSUQgPSAtMTtcblxuLyoqIEFuIGluZGV4IGNvbXBvbmVudCBjb25zaXN0aW5nIG9mIGZpZWxkIHBhdGggYW5kIGluZGV4IHR5cGUuICAqL1xuY2xhc3Mgb2Uge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgZmllbGQgcGF0aCBvZiB0aGUgY29tcG9uZW50LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgZmllbGRzIHNvcnRpbmcgb3JkZXIuICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLmZpZWxkUGF0aCA9IHQsIHRoaXMua2luZCA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFN0b3JlcyB0aGUgXCJoaWdoIHdhdGVyIG1hcmtcIiB0aGF0IGluZGljYXRlcyBob3cgdXBkYXRlZCB0aGUgSW5kZXggaXMgZm9yIHRoZVxuICogY3VycmVudCB1c2VyLlxuICovIGNsYXNzIHVlIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgd2hlbiB0aGUgaW5kZXggd2FzIGxhc3QgdXBkYXRlZCAocmVsYXRpdmUgdG8gb3RoZXIgaW5kZXhlcykuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSB0aGUgbGF0ZXN0IGluZGV4ZWQgcmVhZCB0aW1lLCBkb2N1bWVudCBhbmQgYmF0Y2ggaWQuICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyID0gdCwgdGhpcy5vZmZzZXQgPSBlO1xuICAgIH1cbiAgICAvKiogVGhlIHN0YXRlIG9mIGFuIGluZGV4IHRoYXQgaGFzIG5vdCB5ZXQgYmVlbiBiYWNrZmlsbGVkLiAqLyAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgdWUoMCwgaGUubWluKCkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIG9mZnNldCB0aGF0IG1hdGNoZXMgYWxsIGRvY3VtZW50cyB3aXRoIGEgcmVhZCB0aW1lIGhpZ2hlciB0aGFuXG4gKiBgcmVhZFRpbWVgLlxuICovIGZ1bmN0aW9uIGFlKHQsIGUpIHtcbiAgICAvLyBXZSB3YW50IHRvIGNyZWF0ZSBhbiBvZmZzZXQgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHMgd2l0aCBhIHJlYWQgdGltZVxuICAgIC8vIGdyZWF0ZXIgdGhhbiB0aGUgcHJvdmlkZWQgcmVhZCB0aW1lLiBUbyBkbyBzbywgd2UgdGVjaG5pY2FsbHkgbmVlZCB0b1xuICAgIC8vIGNyZWF0ZSBhbiBvZmZzZXQgZm9yIGAocmVhZFRpbWUsIE1BWF9ET0NVTUVOVF9LRVkpYC4gV2hpbGUgd2UgY291bGQgdXNlXG4gICAgLy8gVW5pY29kZSBjb2RlcG9pbnRzIHRvIGdlbmVyYXRlIE1BWF9ET0NVTUVOVF9LRVksIGl0IGlzIG11Y2ggZWFzaWVyIHRvIHVzZVxuICAgIC8vIGAocmVhZFRpbWUgKyAxLCBEb2N1bWVudEtleS5lbXB0eSgpKWAgc2luY2UgYD4gRG9jdW1lbnRLZXkuZW1wdHkoKWAgbWF0Y2hlc1xuICAgIC8vIGFsbCB2YWxpZCBkb2N1bWVudCBJRHMuXG4gICAgY29uc3QgbiA9IHQudG9UaW1lc3RhbXAoKS5zZWNvbmRzLCBzID0gdC50b1RpbWVzdGFtcCgpLm5hbm9zZWNvbmRzICsgMSwgaSA9IGN0LmZyb21UaW1lc3RhbXAoMWU5ID09PSBzID8gbmV3IGF0KG4gKyAxLCAwKSA6IG5ldyBhdChuLCBzKSk7XG4gICAgcmV0dXJuIG5ldyBoZShpLCB4dC5lbXB0eSgpLCBlKTtcbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgb2Zmc2V0IGJhc2VkIG9uIHRoZSBwcm92aWRlZCBkb2N1bWVudC4gKi8gZnVuY3Rpb24gY2UodCkge1xuICAgIHJldHVybiBuZXcgaGUodC5yZWFkVGltZSwgdC5rZXksIC0xKTtcbn1cblxuLyoqXG4gKiBTdG9yZXMgdGhlIGxhdGVzdCByZWFkIHRpbWUsIGRvY3VtZW50IGFuZCBiYXRjaCBJRCB0aGF0IHdlcmUgcHJvY2Vzc2VkIGZvciBhblxuICogaW5kZXguXG4gKi8gY2xhc3MgaGUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBsYXRlc3QgcmVhZCB0aW1lIHZlcnNpb24gdGhhdCBoYXMgYmVlbiBpbmRleGVkIGJ5IEZpcmVzdG9yZSBmb3IgdGhpc1xuICAgICAqIGZpZWxkIGluZGV4LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBrZXkgb2YgdGhlIGxhc3QgZG9jdW1lbnQgdGhhdCB3YXMgaW5kZXhlZCBmb3IgdGhpcyBxdWVyeS4gVXNlXG4gICAgICogYERvY3VtZW50S2V5LmVtcHR5KClgIGlmIG5vIGRvY3VtZW50IGhhcyBiZWVuIGluZGV4ZWQuXG4gICAgICovXG4gICAgZSwgXG4gICAgLypcbiAgICAgKiBUaGUgbGFyZ2VzdCBtdXRhdGlvbiBiYXRjaCBpZCB0aGF0J3MgYmVlbiBwcm9jZXNzZWQgYnkgRmlyZXN0b3JlLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy5yZWFkVGltZSA9IHQsIHRoaXMuZG9jdW1lbnRLZXkgPSBlLCB0aGlzLmxhcmdlc3RCYXRjaElkID0gbjtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYmVmb3JlIGFsbCByZWd1bGFyIG9mZnNldHMuICovICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgaGUoY3QubWluKCksIHh0LmVtcHR5KCksIC0xKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYW4gb2Zmc2V0IHRoYXQgc29ydHMgYWZ0ZXIgYWxsIHJlZ3VsYXIgb2Zmc2V0cy4gKi8gICAgc3RhdGljIG1heCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBoZShjdC5tYXgoKSwgeHQuZW1wdHkoKSwgLTEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbGUodCwgZSkge1xuICAgIGxldCBuID0gdC5yZWFkVGltZS5jb21wYXJlVG8oZS5yZWFkVGltZSk7XG4gICAgcmV0dXJuIDAgIT09IG4gPyBuIDogKG4gPSB4dC5jb21wYXJhdG9yKHQuZG9jdW1lbnRLZXksIGUuZG9jdW1lbnRLZXkpLCAwICE9PSBuID8gbiA6IHJ0KHQubGFyZ2VzdEJhdGNoSWQsIGUubGFyZ2VzdEJhdGNoSWQpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIEFuIGltbXV0YWJsZSBzb3J0ZWQgbWFwIGltcGxlbWVudGF0aW9uLCBiYXNlZCBvbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2tcbi8vIHRyZWUuXG5jbGFzcyBmZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0LCB0aGlzLnJvb3QgPSBlIHx8IF9lLkVNUFRZO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5L3ZhbHVlIGFkZGVkIG9yIHJlcGxhY2VkLlxuICAgIGluc2VydCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgZmUodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3QuaW5zZXJ0KHQsIGUsIHRoaXMuY29tcGFyYXRvcikuY29weShudWxsLCBudWxsLCBfZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IHJlbW92ZWQuXG4gICAgcmVtb3ZlKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBmZSh0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdC5yZW1vdmUodCwgdGhpcy5jb21wYXJhdG9yKS5jb3B5KG51bGwsIG51bGwsIF9lLkJMQUNLLCBudWxsLCBudWxsKSk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBub2RlIHdpdGggdGhlIGdpdmVuIGtleSwgb3IgbnVsbC5cbiAgICBnZXQodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMucm9vdDtcbiAgICAgICAgZm9yICg7IWUuaXNFbXB0eSgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmNvbXBhcmF0b3IodCwgZS5rZXkpO1xuICAgICAgICAgICAgaWYgKDAgPT09IG4pIHJldHVybiBlLnZhbHVlO1xuICAgICAgICAgICAgbiA8IDAgPyBlID0gZS5sZWZ0IDogbiA+IDAgJiYgKGUgPSBlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGVsZW1lbnQgaW4gdGhpcyBzb3J0ZWQgbWFwLCBvciAtMSBpZiBpdCBkb2Vzbid0XG4gICAgLy8gZXhpc3QuXG4gICAgaW5kZXhPZih0KSB7XG4gICAgICAgIC8vIE51bWJlciBvZiBub2RlcyB0aGF0IHdlcmUgcHJ1bmVkIHdoZW4gZGVzY2VuZGluZyByaWdodFxuICAgICAgICBsZXQgZSA9IDAsIG4gPSB0aGlzLnJvb3Q7XG4gICAgICAgIGZvciAoOyFuLmlzRW1wdHkoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5jb21wYXJhdG9yKHQsIG4ua2V5KTtcbiAgICAgICAgICAgIGlmICgwID09PSBzKSByZXR1cm4gZSArIG4ubGVmdC5zaXplO1xuICAgICAgICAgICAgcyA8IDAgPyBuID0gbi5sZWZ0IDogKFxuICAgICAgICAgICAgLy8gQ291bnQgYWxsIG5vZGVzIGxlZnQgb2YgdGhlIG5vZGUgcGx1cyB0aGUgbm9kZSBpdHNlbGZcbiAgICAgICAgICAgIGUgKz0gbi5sZWZ0LnNpemUgKyAxLCBuID0gbi5yaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTm9kZSBub3QgZm91bmRcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2Ygbm9kZXMgaW4gdGhlIG1hcC5cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5zaXplO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIGtleSBpbiB0aGUgbWFwLlxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5taW5LZXkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIG1hcC5cbiAgICBtYXhLZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QubWF4S2V5KCk7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgbWFwIGluIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZnVuY3Rpb25cbiAgICAvLyBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lmlub3JkZXJUcmF2ZXJzYWwodCk7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICB0aGlzLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlLCBuKSwgITEpKSk7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodC5wdXNoKGAke2V9OiR7bn1gKSwgITEpKSksIGB7JHt0LmpvaW4oXCIsIFwiKX19YDtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpc1xuICAgIC8vIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LnJldmVyc2VUcmF2ZXJzYWwodCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYW4gaXRlcmF0b3Igb3ZlciB0aGUgU29ydGVkTWFwLlxuICAgIGdldEl0ZXJhdG9yKCkge1xuICAgICAgICByZXR1cm4gbmV3IGRlKHRoaXMucm9vdCwgbnVsbCwgdGhpcy5jb21wYXJhdG9yLCAhMSk7XG4gICAgfVxuICAgIGdldEl0ZXJhdG9yRnJvbSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgZGUodGhpcy5yb290LCB0LCB0aGlzLmNvbXBhcmF0b3IsICExKTtcbiAgICB9XG4gICAgZ2V0UmV2ZXJzZUl0ZXJhdG9yKCkge1xuICAgICAgICByZXR1cm4gbmV3IGRlKHRoaXMucm9vdCwgbnVsbCwgdGhpcy5jb21wYXJhdG9yLCAhMCk7XG4gICAgfVxuICAgIGdldFJldmVyc2VJdGVyYXRvckZyb20odCkge1xuICAgICAgICByZXR1cm4gbmV3IGRlKHRoaXMucm9vdCwgdCwgdGhpcy5jb21wYXJhdG9yLCAhMCk7XG4gICAgfVxufVxuXG4gLy8gZW5kIFNvcnRlZE1hcFxuLy8gQW4gaXRlcmF0b3Igb3ZlciBhbiBMTFJCTm9kZS5cbmNsYXNzIGRlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuaXNSZXZlcnNlID0gcywgdGhpcy5ub2RlU3RhY2sgPSBbXTtcbiAgICAgICAgbGV0IGkgPSAxO1xuICAgICAgICBmb3IgKDshdC5pc0VtcHR5KCk7ICkgaWYgKGkgPSBlID8gbih0LmtleSwgZSkgOiAxLCBcbiAgICAgICAgLy8gZmxpcCB0aGUgY29tcGFyaXNvbiBpZiB3ZSdyZSBnb2luZyBpbiByZXZlcnNlXG4gICAgICAgIGUgJiYgcyAmJiAoaSAqPSAtMSksIGkgPCAwKSBcbiAgICAgICAgLy8gVGhpcyBub2RlIGlzIGxlc3MgdGhhbiBvdXIgc3RhcnQga2V5LiBpZ25vcmUgaXRcbiAgICAgICAgdCA9IHRoaXMuaXNSZXZlcnNlID8gdC5sZWZ0IDogdC5yaWdodDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoMCA9PT0gaSkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBleGFjdGx5IGVxdWFsIHRvIG91ciBzdGFydCBrZXkuIFB1c2ggaXQgb24gdGhlIHN0YWNrLFxuICAgICAgICAgICAgICAgIC8vIGJ1dCBzdG9wIGl0ZXJhdGluZztcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc3RhcnQga2V5LCBhZGQgaXQgdG8gdGhlIHN0YWNrIGFuZCBtb3ZlXG4gICAgICAgICAgICAvLyB0byB0aGUgbmV4dCBvbmVcbiAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0aGlzLmlzUmV2ZXJzZSA/IHQucmlnaHQgOiB0LmxlZnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLm5vZGVTdGFjay5wb3AoKTtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGtleTogdC5rZXksXG4gICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIGZvciAodCA9IHQubGVmdDsgIXQuaXNFbXB0eSgpOyApIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0LnJpZ2h0OyBlbHNlIGZvciAodCA9IHQucmlnaHQ7ICF0LmlzRW1wdHkoKTsgKSB0aGlzLm5vZGVTdGFjay5wdXNoKHQpLCBcbiAgICAgICAgdCA9IHQubGVmdDtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIGhhc05leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVTdGFjay5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBwZWVrKCkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5ub2RlU3RhY2subGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubm9kZVN0YWNrW3RoaXMubm9kZVN0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5OiB0LmtleSxcbiAgICAgICAgICAgIHZhbHVlOiB0LnZhbHVlXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4gLy8gZW5kIFNvcnRlZE1hcEl0ZXJhdG9yXG4vLyBSZXByZXNlbnRzIGEgbm9kZSBpbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2sgdHJlZS5cbmNsYXNzIF9lIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgdGhpcy52YWx1ZSA9IGUsIHRoaXMuY29sb3IgPSBudWxsICE9IG4gPyBuIDogX2UuUkVELCB0aGlzLmxlZnQgPSBudWxsICE9IHMgPyBzIDogX2UuRU1QVFksIFxuICAgICAgICB0aGlzLnJpZ2h0ID0gbnVsbCAhPSBpID8gaSA6IF9lLkVNUFRZLCB0aGlzLnNpemUgPSB0aGlzLmxlZnQuc2l6ZSArIDEgKyB0aGlzLnJpZ2h0LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUsIG9wdGlvbmFsbHkgcmVwbGFjaW5nIHBpZWNlcyBvZiBpdC5cbiAgICBjb3B5KHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfZShudWxsICE9IHQgPyB0IDogdGhpcy5rZXksIG51bGwgIT0gZSA/IGUgOiB0aGlzLnZhbHVlLCBudWxsICE9IG4gPyBuIDogdGhpcy5jb2xvciwgbnVsbCAhPSBzID8gcyA6IHRoaXMubGVmdCwgbnVsbCAhPSBpID8gaSA6IHRoaXMucmlnaHQpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgLy8gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0Lmlub3JkZXJUcmF2ZXJzYWwodCkgfHwgdCh0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHwgdGhpcy5yaWdodC5pbm9yZGVyVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5yZXZlcnNlVHJhdmVyc2FsKHQpIHx8IHQodGhpcy5rZXksIHRoaXMudmFsdWUpIHx8IHRoaXMubGVmdC5yZXZlcnNlVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIG5vZGUgaW4gdGhlIHRyZWUuXG4gICAgbWluKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmlzRW1wdHkoKSA/IHRoaXMgOiB0aGlzLmxlZnQubWluKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWluKCkua2V5O1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICBtYXhLZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmlzRW1wdHkoKSA/IHRoaXMua2V5IDogdGhpcy5yaWdodC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUga2V5L3ZhbHVlIGFkZGVkLlxuICAgIGluc2VydCh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICAgICAgY29uc3QgaSA9IG4odCwgcy5rZXkpO1xuICAgICAgICByZXR1cm4gcyA9IGkgPCAwID8gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5pbnNlcnQodCwgZSwgbiksIG51bGwpIDogMCA9PT0gaSA/IHMuY29weShudWxsLCBlLCBudWxsLCBudWxsLCBudWxsKSA6IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0Lmluc2VydCh0LCBlLCBuKSksIFxuICAgICAgICBzLmZpeFVwKCk7XG4gICAgfVxuICAgIHJlbW92ZU1pbigpIHtcbiAgICAgICAgaWYgKHRoaXMubGVmdC5pc0VtcHR5KCkpIHJldHVybiBfZS5FTVBUWTtcbiAgICAgICAgbGV0IHQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmlzUmVkKCkgfHwgdC5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAodCA9IHQubW92ZVJlZExlZnQoKSksIHQgPSB0LmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgdC5sZWZ0LnJlbW92ZU1pbigpLCBudWxsKSwgXG4gICAgICAgIHQuZml4VXAoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGl0ZW0gcmVtb3ZlZC5cbiAgICByZW1vdmUodCwgZSkge1xuICAgICAgICBsZXQgbiwgcyA9IHRoaXM7XG4gICAgICAgIGlmIChlKHQsIHMua2V5KSA8IDApIHMubGVmdC5pc0VtcHR5KCkgfHwgcy5sZWZ0LmlzUmVkKCkgfHwgcy5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZExlZnQoKSksIFxuICAgICAgICBzID0gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5yZW1vdmUodCwgZSksIG51bGwpOyBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzLmxlZnQuaXNSZWQoKSAmJiAocyA9IHMucm90YXRlUmlnaHQoKSksIHMucmlnaHQuaXNFbXB0eSgpIHx8IHMucmlnaHQuaXNSZWQoKSB8fCBzLnJpZ2h0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZFJpZ2h0KCkpLCBcbiAgICAgICAgICAgIDAgPT09IGUodCwgcy5rZXkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMucmlnaHQuaXNFbXB0eSgpKSByZXR1cm4gX2UuRU1QVFk7XG4gICAgICAgICAgICAgICAgbiA9IHMucmlnaHQubWluKCksIHMgPSBzLmNvcHkobi5rZXksIG4udmFsdWUsIG51bGwsIG51bGwsIHMucmlnaHQucmVtb3ZlTWluKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcyA9IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0LnJlbW92ZSh0LCBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHMuZml4VXAoKTtcbiAgICB9XG4gICAgaXNSZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlIGFmdGVyIHBlcmZvcm1pbmcgYW55IG5lZWRlZCByb3RhdGlvbnMuXG4gICAgZml4VXAoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHQucmlnaHQuaXNSZWQoKSAmJiAhdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZUxlZnQoKSksIHQubGVmdC5pc1JlZCgpICYmIHQubGVmdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdC5sZWZ0LmlzUmVkKCkgJiYgdC5yaWdodC5pc1JlZCgpICYmICh0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRMZWZ0KCkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuY29sb3JGbGlwKCk7XG4gICAgICAgIHJldHVybiB0LnJpZ2h0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCB0LnJpZ2h0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdCA9IHQucm90YXRlTGVmdCgpLCB0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRSaWdodCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLmNvbG9yRmxpcCgpO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQucm90YXRlUmlnaHQoKSwgdCA9IHQuY29sb3JGbGlwKCkpLCB0O1xuICAgIH1cbiAgICByb3RhdGVMZWZ0KCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIF9lLlJFRCwgbnVsbCwgdGhpcy5yaWdodC5sZWZ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCB0LCBudWxsKTtcbiAgICB9XG4gICAgcm90YXRlUmlnaHQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgX2UuUkVELCB0aGlzLmxlZnQucmlnaHQsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbnVsbCwgdCk7XG4gICAgfVxuICAgIGNvbG9yRmxpcCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsICF0aGlzLmxlZnQuY29sb3IsIG51bGwsIG51bGwpLCBlID0gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsICF0aGlzLnJpZ2h0LmNvbG9yLCBudWxsLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weShudWxsLCBudWxsLCAhdGhpcy5jb2xvciwgdCwgZSk7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNoZWNrKCk7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdygyLCB0KSA8PSB0aGlzLnNpemUgKyAxO1xuICAgIH1cbiAgICAvLyBJbiBhIGJhbGFuY2VkIFJCIHRyZWUsIHRoZSBibGFjay1kZXB0aCAobnVtYmVyIG9mIGJsYWNrIG5vZGVzKSBmcm9tIHJvb3QgdG9cbiAgICAvLyBsZWF2ZXMgaXMgZXF1YWwgb24gYm90aCBzaWRlcy4gIFRoaXMgZnVuY3Rpb24gdmVyaWZpZXMgdGhhdCBvciBhc3NlcnRzLlxuICAgIGNoZWNrKCkge1xuICAgICAgICBpZiAodGhpcy5pc1JlZCgpICYmIHRoaXMubGVmdC5pc1JlZCgpKSB0aHJvdyBMKCk7XG4gICAgICAgIGlmICh0aGlzLnJpZ2h0LmlzUmVkKCkpIHRocm93IEwoKTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jaGVjaygpO1xuICAgICAgICBpZiAodCAhPT0gdGhpcy5yaWdodC5jaGVjaygpKSB0aHJvdyBMKCk7XG4gICAgICAgIHJldHVybiB0ICsgKHRoaXMuaXNSZWQoKSA/IDAgOiAxKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgTExSQk5vZGVcbi8vIEVtcHR5IG5vZGUgaXMgc2hhcmVkIGJldHdlZW4gYWxsIExMUkIgdHJlZXMuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuX2UuRU1QVFkgPSBudWxsLCBfZS5SRUQgPSAhMCwgX2UuQkxBQ0sgPSAhMTtcblxuLy8gZW5kIExMUkJFbXB0eU5vZGVcbl9lLkVNUFRZID0gbmV3IFxuLy8gUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxuY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBnZXQga2V5KCkge1xuICAgICAgICB0aHJvdyBMKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgdGhyb3cgTCgpO1xuICAgIH1cbiAgICBnZXQgY29sb3IoKSB7XG4gICAgICAgIHRocm93IEwoKTtcbiAgICB9XG4gICAgZ2V0IGxlZnQoKSB7XG4gICAgICAgIHRocm93IEwoKTtcbiAgICB9XG4gICAgZ2V0IHJpZ2h0KCkge1xuICAgICAgICB0aHJvdyBMKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgY29weSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbmV3IF9lKHQsIGUpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgIHJlbW92ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgY2hlY2soKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNvcnRlZFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBlbGVtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLlxuICpcbiAqIE5PVEU6IGlmIHByb3ZpZGVkIGNvbXBhcmF0b3IgcmV0dXJucyAwIGZvciB0d28gZWxlbWVudHMsIHdlIGNvbnNpZGVyIHRoZW0gdG9cbiAqIGJlIGVxdWFsIVxuICovXG5jbGFzcyB3ZSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0LCB0aGlzLmRhdGEgPSBuZXcgZmUodGhpcy5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuZGF0YS5nZXQodCk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1pbktleSgpO1xuICAgIH1cbiAgICBsYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1heEtleSgpO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5zaXplO1xuICAgIH1cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pbmRleE9mKHQpO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZWxlbWVudHMgaW4gb3JkZXIgZGVmaW5lZCBieSBcImNvbXBhcmF0b3JcIiAqLyAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgdGhpcy5kYXRhLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiByYW5nZVswXSAmbHQ7PSBlbGVtICZsdDsgcmFuZ2VbMV0uICovICAgIGZvckVhY2hJblJhbmdlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odFswXSk7XG4gICAgICAgIGZvciAoO24uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmF0b3Iocy5rZXksIHRbMV0pID49IDApIHJldHVybjtcbiAgICAgICAgICAgIGUocy5rZXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHN0YXJ0ICZsdDs9IGVsZW0gdW50aWwgZmFsc2UgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIGZvckVhY2hXaGlsZSh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICBmb3IgKG4gPSB2b2lkIDAgIT09IGUgPyB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKGUpIDogdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCk7IG4uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGlmICghdChuLmdldE5leHQoKS5rZXkpKSByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEZpbmRzIHRoZSBsZWFzdCBlbGVtZW50IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBgZWxlbWAuICovICAgIGZpcnN0QWZ0ZXJPckVxdWFsKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odCk7XG4gICAgICAgIHJldHVybiBlLmhhc05leHQoKSA/IGUuZ2V0TmV4dCgpLmtleSA6IG51bGw7XG4gICAgfVxuICAgIGdldEl0ZXJhdG9yKCkge1xuICAgICAgICByZXR1cm4gbmV3IG1lKHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBtZSh0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHQpKTtcbiAgICB9XG4gICAgLyoqIEluc2VydHMgb3IgdXBkYXRlcyBhbiBlbGVtZW50ICovICAgIGFkZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KS5pbnNlcnQodCwgITApKTtcbiAgICB9XG4gICAgLyoqIERlbGV0ZXMgYW4gZWxlbWVudCAqLyAgICBkZWxldGUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXModCkgPyB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KSkgOiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmlzRW1wdHkoKTtcbiAgICB9XG4gICAgdW5pb25XaXRoKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzO1xuICAgICAgICAvLyBNYWtlIHN1cmUgYHJlc3VsdGAgYWx3YXlzIHJlZmVycyB0byB0aGUgbGFyZ2VyIG9uZSBvZiB0aGUgdHdvIHNldHMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuc2l6ZSA8IHQuc2l6ZSAmJiAoZSA9IHQsIHQgPSB0aGlzKSwgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGUgPSBlLmFkZCh0KTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIHdlKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodGhpcy5zaXplICE9PSB0LnNpemUpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpLCBuID0gdC5kYXRhLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO2UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldE5leHQoKS5rZXksIHMgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdGhpcy5jb21wYXJhdG9yKHQsIHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdC5wdXNoKGUpO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4gdC5wdXNoKGUpKSksIFwiU29ydGVkU2V0KFwiICsgdC50b1N0cmluZygpICsgXCIpXCI7XG4gICAgfVxuICAgIGNvcHkodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IHdlKHRoaXMuY29tcGFyYXRvcik7XG4gICAgICAgIHJldHVybiBlLmRhdGEgPSB0LCBlO1xuICAgIH1cbn1cblxuY2xhc3MgbWUge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5pdGVyID0gdDtcbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlci5nZXROZXh0KCkua2V5O1xuICAgIH1cbiAgICBoYXNOZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVyLmhhc05leHQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tcGFyZXMgdHdvIHNvcnRlZCBzZXRzIGZvciBlcXVhbGl0eSB1c2luZyB0aGVpciBuYXR1cmFsIG9yZGVyaW5nLiBUaGVcbiAqIG1ldGhvZCBjb21wdXRlcyB0aGUgaW50ZXJzZWN0aW9uIGFuZCBpbnZva2VzIGBvbkFkZGAgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdFxuICogaXMgaW4gYGFmdGVyYCBidXQgbm90IGBiZWZvcmVgLiBgb25SZW1vdmVgIGlzIGludm9rZWQgZm9yIGV2ZXJ5IGVsZW1lbnQgaW5cbiAqIGBiZWZvcmVgIGJ1dCBtaXNzaW5nIGZyb20gYGFmdGVyYC5cbiAqXG4gKiBUaGUgbWV0aG9kIGNyZWF0ZXMgYSBjb3B5IG9mIGJvdGggYGJlZm9yZWAgYW5kIGBhZnRlcmAgYW5kIHJ1bnMgaW4gTyhuIGxvZ1xuICogbiksIHdoZXJlIG4gaXMgdGhlIHNpemUgb2YgdGhlIHR3byBsaXN0cy5cbiAqXG4gKiBAcGFyYW0gYmVmb3JlIC0gVGhlIGVsZW1lbnRzIHRoYXQgZXhpc3QgaW4gdGhlIG9yaWdpbmFsIHNldC5cbiAqIEBwYXJhbSBhZnRlciAtIFRoZSBlbGVtZW50cyB0byBkaWZmIGFnYWluc3QgdGhlIG9yaWdpbmFsIHNldC5cbiAqIEBwYXJhbSBjb21wYXJhdG9yIC0gVGhlIGNvbXBhcmF0b3IgZm9yIHRoZSBlbGVtZW50cyBpbiBiZWZvcmUgYW5kIGFmdGVyLlxuICogQHBhcmFtIG9uQWRkIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mIGBcbiAqIGFmdGVyYCBidXQgbm90IGBiZWZvcmVgLlxuICogQHBhcmFtIG9uUmVtb3ZlIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mXG4gKiBgYmVmb3JlYCBidXQgbm90IGBhZnRlcmAuXG4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgbmV4dCBlbGVtZW50IGZyb20gdGhlIGl0ZXJhdG9yIG9yIGB1bmRlZmluZWRgIGlmIG5vbmUgYXZhaWxhYmxlLlxuICovXG5mdW5jdGlvbiBnZSh0KSB7XG4gICAgcmV0dXJuIHQuaGFzTmV4dCgpID8gdC5nZXROZXh0KCkgOiB2b2lkIDA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyB5ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5vcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgdGhpcy5saW1pdCA9IGksIFxuICAgICAgICB0aGlzLnN0YXJ0QXQgPSByLCB0aGlzLmVuZEF0ID0gbywgdGhpcy5QID0gbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBUYXJnZXQgd2l0aCBhIHBhdGggYW5kIG9wdGlvbmFsIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gKiBQYXRoIG11c3QgY3VycmVudGx5IGJlIGVtcHR5IGlmIHRoaXMgaXMgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5LlxuICpcbiAqIE5PVEU6IHlvdSBzaG91bGQgYWx3YXlzIGNvbnN0cnVjdCBgVGFyZ2V0YCBmcm9tIGBRdWVyeS50b1RhcmdldGAgaW5zdGVhZCBvZlxuICogdXNpbmcgdGhpcyBmYWN0b3J5IG1ldGhvZCwgYmVjYXVzZSBgUXVlcnlgIHByb3ZpZGVzIGFuIGltcGxpY2l0IGBvcmRlckJ5YFxuICogcHJvcGVydHkuXG4gKi8gZnVuY3Rpb24gcGUodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgcmV0dXJuIG5ldyB5ZSh0LCBlLCBuLCBzLCBpLCByLCBvKTtcbn1cblxuZnVuY3Rpb24gSWUodCkge1xuICAgIGNvbnN0IGUgPSBLKHQpO1xuICAgIGlmIChudWxsID09PSBlLlApIHtcbiAgICAgICAgbGV0IHQgPSBlLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIG51bGwgIT09IGUuY29sbGVjdGlvbkdyb3VwICYmICh0ICs9IFwifGNnOlwiICsgZS5jb2xsZWN0aW9uR3JvdXApLCB0ICs9IFwifGY6XCIsIHQgKz0gZS5maWx0ZXJzLm1hcCgodCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKGUgPSB0KS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIGUub3AudG9TdHJpbmcoKSArIEx0KGUudmFsdWUpO1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgIH0pKS5qb2luKFwiLFwiKSwgdCArPSBcInxvYjpcIiwgdCArPSBlLm9yZGVyQnkubWFwKCh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxuICAgICAgICAgICAgcmV0dXJuIHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0LmRpcjtcbiAgICAgICAgfSh0KSkpLmpvaW4oXCIsXCIpLCBTdChlLmxpbWl0KSB8fCAodCArPSBcInxsOlwiLCB0ICs9IGUubGltaXQpLCBlLnN0YXJ0QXQgJiYgKHQgKz0gXCJ8bGI6XCIsIFxuICAgICAgICB0ICs9IGUuc3RhcnRBdC5pbmNsdXNpdmUgPyBcImI6XCIgOiBcImE6XCIsIHQgKz0gZS5zdGFydEF0LnBvc2l0aW9uLm1hcCgodCA9PiBMdCh0KSkpLmpvaW4oXCIsXCIpKSwgXG4gICAgICAgIGUuZW5kQXQgJiYgKHQgKz0gXCJ8dWI6XCIsIHQgKz0gZS5lbmRBdC5pbmNsdXNpdmUgPyBcImE6XCIgOiBcImI6XCIsIHQgKz0gZS5lbmRBdC5wb3NpdGlvbi5tYXAoKHQgPT4gTHQodCkpKS5qb2luKFwiLFwiKSksIFxuICAgICAgICBlLlAgPSB0O1xuICAgIH1cbiAgICByZXR1cm4gZS5QO1xufVxuXG5mdW5jdGlvbiBUZSh0KSB7XG4gICAgbGV0IGUgPSB0LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwICYmIChlICs9IFwiIGNvbGxlY3Rpb25Hcm91cD1cIiArIHQuY29sbGVjdGlvbkdyb3VwKSwgXG4gICAgdC5maWx0ZXJzLmxlbmd0aCA+IDAgJiYgKGUgKz0gYCwgZmlsdGVyczogWyR7dC5maWx0ZXJzLm1hcCgodCA9PiB7XG4gICAgICAgIHJldHVybiBgJHsoZSA9IHQpLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpfSAke2Uub3B9ICR7THQoZS52YWx1ZSl9YDtcbiAgICAgICAgLyoqIFJldHVybnMgYSBkZWJ1ZyBkZXNjcmlwdGlvbiBmb3IgYGZpbHRlcmAuICovXG4gICAgICAgIHZhciBlO1xuICAgICAgICAvKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIChpLmUuICdfX25hbWVfXycpLiAqLyAgICB9KSkuam9pbihcIiwgXCIpfV1gKSwgXG4gICAgU3QodC5saW1pdCkgfHwgKGUgKz0gXCIsIGxpbWl0OiBcIiArIHQubGltaXQpLCB0Lm9yZGVyQnkubGVuZ3RoID4gMCAmJiAoZSArPSBgLCBvcmRlckJ5OiBbJHt0Lm9yZGVyQnkubWFwKCh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIGAke3QuZmllbGQuY2Fub25pY2FsU3RyaW5nKCl9ICgke3QuZGlyfSlgO1xuICAgIH0odCkpKS5qb2luKFwiLCBcIil9XWApLCB0LnN0YXJ0QXQgJiYgKGUgKz0gXCIsIHN0YXJ0QXQ6IFwiLCBlICs9IHQuc3RhcnRBdC5pbmNsdXNpdmUgPyBcImI6XCIgOiBcImE6XCIsIFxuICAgIGUgKz0gdC5zdGFydEF0LnBvc2l0aW9uLm1hcCgodCA9PiBMdCh0KSkpLmpvaW4oXCIsXCIpKSwgdC5lbmRBdCAmJiAoZSArPSBcIiwgZW5kQXQ6IFwiLCBcbiAgICBlICs9IHQuZW5kQXQuaW5jbHVzaXZlID8gXCJhOlwiIDogXCJiOlwiLCBlICs9IHQuZW5kQXQucG9zaXRpb24ubWFwKCh0ID0+IEx0KHQpKSkuam9pbihcIixcIikpLCBcbiAgICBgVGFyZ2V0KCR7ZX0pYDtcbn1cblxuZnVuY3Rpb24gRWUodCwgZSkge1xuICAgIGlmICh0LmxpbWl0ICE9PSBlLmxpbWl0KSByZXR1cm4gITE7XG4gICAgaWYgKHQub3JkZXJCeS5sZW5ndGggIT09IGUub3JkZXJCeS5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQub3JkZXJCeS5sZW5ndGg7IG4rKykgaWYgKCEkZSh0Lm9yZGVyQnlbbl0sIGUub3JkZXJCeVtuXSkpIHJldHVybiAhMTtcbiAgICBpZiAodC5maWx0ZXJzLmxlbmd0aCAhPT0gZS5maWx0ZXJzLmxlbmd0aCkgcmV0dXJuICExO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5maWx0ZXJzLmxlbmd0aDsgaSsrKSBpZiAobiA9IHQuZmlsdGVyc1tpXSwgcyA9IGUuZmlsdGVyc1tpXSwgXG4gICAgbi5vcCAhPT0gcy5vcCB8fCAhbi5maWVsZC5pc0VxdWFsKHMuZmllbGQpIHx8ICFPdChuLnZhbHVlLCBzLnZhbHVlKSkgcmV0dXJuICExO1xuICAgIHZhciBuLCBzO1xuICAgIHJldHVybiB0LmNvbGxlY3Rpb25Hcm91cCA9PT0gZS5jb2xsZWN0aW9uR3JvdXAgJiYgKCEhdC5wYXRoLmlzRXF1YWwoZS5wYXRoKSAmJiAoISFMZSh0LnN0YXJ0QXQsIGUuc3RhcnRBdCkgJiYgTGUodC5lbmRBdCwgZS5lbmRBdCkpKTtcbn1cblxuZnVuY3Rpb24gQWUodCkge1xuICAgIHJldHVybiB4dC5pc0RvY3VtZW50S2V5KHQucGF0aCkgJiYgbnVsbCA9PT0gdC5jb2xsZWN0aW9uR3JvdXAgJiYgMCA9PT0gdC5maWx0ZXJzLmxlbmd0aDtcbn1cblxuLyoqIFJldHVybnMgdGhlIGZpZWxkIGZpbHRlcnMgdGhhdCB0YXJnZXQgdGhlIGdpdmVuIGZpZWxkIHBhdGguICovIGZ1bmN0aW9uIFJlKHQsIGUpIHtcbiAgICByZXR1cm4gdC5maWx0ZXJzLmZpbHRlcigodCA9PiB0IGluc3RhbmNlb2YgVmUgJiYgdC5maWVsZC5pc0VxdWFsKGUpKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgdmFsdWVzIHRoYXQgYXJlIHVzZWQgaW4gQVJSQVlfQ09OVEFJTlMgb3IgQVJSQVlfQ09OVEFJTlNfQU5ZXG4gKiBmaWx0ZXJzLiBSZXR1cm5zIGBudWxsYCBpZiB0aGVyZSBhcmUgbm8gc3VjaCBmaWx0ZXJzLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIHRvIHVzZSBhcyB0aGUgbG93ZXIgYm91bmQgZm9yIGFzY2VuZGluZyBpbmRleCBzZWdtZW50IGF0XG4gKiB0aGUgcHJvdmlkZWQgYGZpZWxkUGF0aGAgKG9yIHRoZSB1cHBlciBib3VuZCBmb3IgYW4gZGVzY2VuZGluZyBzZWdtZW50KS5cbiAqL1xuZnVuY3Rpb24gYmUodCwgZSwgbikge1xuICAgIGxldCBzID0ga3QsIGkgPSAhMDtcbiAgICAvLyBQcm9jZXNzIGFsbCBmaWx0ZXJzIHRvIGZpbmQgYSB2YWx1ZSBmb3IgdGhlIGN1cnJlbnQgZmllbGQgc2VnbWVudFxuICAgIGZvciAoY29uc3QgbiBvZiBSZSh0LCBlKSkge1xuICAgICAgICBsZXQgdCA9IGt0LCBlID0gITA7XG4gICAgICAgIHN3aXRjaCAobi5vcCkge1xuICAgICAgICAgIGNhc2UgXCI8XCIgLyogTEVTU19USEFOICovIDpcbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBMRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgdCA9IEp0KG4udmFsdWUpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBFUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcImluXCIgLyogSU4gKi8gOlxuICAgICAgICAgIGNhc2UgXCI+PVwiIC8qIEdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICB0ID0gbi52YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj5cIiAvKiBHUkVBVEVSX1RIQU4gKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWUsIGUgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogTk9UX0lOICovIDpcbiAgICAgICAgICAgIHQgPSBrdDtcbiAvLyBSZW1haW5pbmcgZmlsdGVycyBjYW5ub3QgYmUgdXNlZCBhcyBsb3dlciBib3VuZHMuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICBYdCh7XG4gICAgICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB2YWx1ZTogdCxcbiAgICAgICAgICAgIGluY2x1c2l2ZTogZVxuICAgICAgICB9KSA8IDAgJiYgKHMgPSB0LCBpID0gZSk7XG4gICAgfVxuICAgIC8vIElmIHRoZXJlIGlzIGFuIGFkZGl0aW9uYWwgYm91bmQsIGNvbXBhcmUgdGhlIHZhbHVlcyBhZ2FpbnN0IHRoZSBleGlzdGluZ1xuICAgIC8vIHJhbmdlIHRvIHNlZSBpZiB3ZSBjYW4gbmFycm93IHRoZSBzY29wZS5cbiAgICAgICAgaWYgKG51bGwgIT09IG4pIGZvciAobGV0IHIgPSAwOyByIDwgdC5vcmRlckJ5Lmxlbmd0aDsgKytyKSB7XG4gICAgICAgIGlmICh0Lm9yZGVyQnlbcl0uZmllbGQuaXNFcXVhbChlKSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG4ucG9zaXRpb25bcl07XG4gICAgICAgICAgICBYdCh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBuLmluY2x1c2l2ZVxuICAgICAgICAgICAgfSkgPCAwICYmIChzID0gdCwgaSA9IG4uaW5jbHVzaXZlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBzLFxuICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIHRvIHVzZSBhcyB0aGUgdXBwZXIgYm91bmQgZm9yIGFzY2VuZGluZyBpbmRleCBzZWdtZW50IGF0XG4gKiB0aGUgcHJvdmlkZWQgYGZpZWxkUGF0aGAgKG9yIHRoZSBsb3dlciBib3VuZCBmb3IgYSBkZXNjZW5kaW5nIHNlZ21lbnQpLlxuICovIGZ1bmN0aW9uIFBlKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IE50LCBpID0gITA7XG4gICAgLy8gUHJvY2VzcyBhbGwgZmlsdGVycyB0byBmaW5kIGEgdmFsdWUgZm9yIHRoZSBjdXJyZW50IGZpZWxkIHNlZ21lbnRcbiAgICBmb3IgKGNvbnN0IG4gb2YgUmUodCwgZSkpIHtcbiAgICAgICAgbGV0IHQgPSBOdCwgZSA9ICEwO1xuICAgICAgICBzd2l0Y2ggKG4ub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPj1cIiAvKiBHUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHQgPSBZdChuLnZhbHVlKSwgZSA9ICExO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBFUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcImluXCIgLyogSU4gKi8gOlxuICAgICAgICAgIGNhc2UgXCI8PVwiIC8qIExFU1NfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICB0ID0gbi52YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIjxcIiAvKiBMRVNTX1RIQU4gKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWUsIGUgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogTk9UX0lOICovIDpcbiAgICAgICAgICAgIHQgPSBOdDtcbiAvLyBSZW1haW5pbmcgZmlsdGVycyBjYW5ub3QgYmUgdXNlZCBhcyB1cHBlciBib3VuZHMuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICBadCh7XG4gICAgICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICB2YWx1ZTogdCxcbiAgICAgICAgICAgIGluY2x1c2l2ZTogZVxuICAgICAgICB9KSA+IDAgJiYgKHMgPSB0LCBpID0gZSk7XG4gICAgfVxuICAgIC8vIElmIHRoZXJlIGlzIGFuIGFkZGl0aW9uYWwgYm91bmQsIGNvbXBhcmUgdGhlIHZhbHVlcyBhZ2FpbnN0IHRoZSBleGlzdGluZ1xuICAgIC8vIHJhbmdlIHRvIHNlZSBpZiB3ZSBjYW4gbmFycm93IHRoZSBzY29wZS5cbiAgICAgICAgaWYgKG51bGwgIT09IG4pIGZvciAobGV0IHIgPSAwOyByIDwgdC5vcmRlckJ5Lmxlbmd0aDsgKytyKSB7XG4gICAgICAgIGlmICh0Lm9yZGVyQnlbcl0uZmllbGQuaXNFcXVhbChlKSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IG4ucG9zaXRpb25bcl07XG4gICAgICAgICAgICBadCh7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICAgICAgaW5jbHVzaXZlOiBuLmluY2x1c2l2ZVxuICAgICAgICAgICAgfSkgPiAwICYmIChzID0gdCwgaSA9IG4uaW5jbHVzaXZlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiBzLFxuICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICB9O1xufVxuXG4vKiogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHNlZ21lbnRzIG9mIGEgcGVyZmVjdCBpbmRleCBmb3IgdGhpcyB0YXJnZXQuICovIGNsYXNzIFZlIGV4dGVuZHMgY2xhc3Mge30ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5maWVsZCA9IHQsIHRoaXMub3AgPSBlLCB0aGlzLnZhbHVlID0gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHQuaXNLZXlGaWVsZCgpID8gXCJpblwiIC8qIElOICovID09PSBlIHx8IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSBlID8gdGhpcy5WKHQsIGUsIG4pIDogbmV3IHZlKHQsIGUsIG4pIDogXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovID09PSBlID8gbmV3IHhlKHQsIG4pIDogXCJpblwiIC8qIElOICovID09PSBlID8gbmV3IE5lKHQsIG4pIDogXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gPT09IGUgPyBuZXcga2UodCwgbikgOiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gZSA/IG5ldyBNZSh0LCBuKSA6IG5ldyBWZSh0LCBlLCBuKTtcbiAgICB9XG4gICAgc3RhdGljIFYodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovID09PSBlID8gbmV3IFNlKHQsIG4pIDogbmV3IERlKHQsIG4pO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgLy8gVHlwZXMgZG8gbm90IGhhdmUgdG8gbWF0Y2ggaW4gTk9UX0VRVUFMIGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gPT09IHRoaXMub3AgPyBudWxsICE9PSBlICYmIHRoaXMudigkdChlLCB0aGlzLnZhbHVlKSkgOiBudWxsICE9PSBlICYmIE10KHRoaXMudmFsdWUpID09PSBNdChlKSAmJiB0aGlzLnYoJHQoZSwgdGhpcy52YWx1ZSkpO1xuICAgICAgICAvLyBPbmx5IGNvbXBhcmUgdHlwZXMgd2l0aCBtYXRjaGluZyBiYWNrZW5kIG9yZGVyIChzdWNoIGFzIGRvdWJsZSBhbmQgaW50KS5cbiAgICAgICAgfVxuICAgIHYodCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPFwiIC8qIExFU1NfVEhBTiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdCA8IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBMRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPD0gMDtcblxuICAgICAgICAgIGNhc2UgXCI9PVwiIC8qIEVRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwID09PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwICE9PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIj5cIiAvKiBHUkVBVEVSX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPiAwO1xuXG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiB0ID49IDA7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIEwoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBTKCkge1xuICAgICAgICByZXR1cm4gWyBcIjxcIiAvKiBMRVNTX1RIQU4gKi8gLCBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovICwgXCI+XCIgLyogR1JFQVRFUl9USEFOICovICwgXCI+PVwiIC8qIEdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyAsIFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdLmluZGV4T2YodGhpcy5vcCkgPj0gMDtcbiAgICB9XG59XG5cbmNsYXNzIHZlIGV4dGVuZHMgVmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIodCwgZSwgbiksIHRoaXMua2V5ID0geHQuZnJvbU5hbWUobi5yZWZlcmVuY2VWYWx1ZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0geHQuY29tcGFyYXRvcih0LmtleSwgdGhpcy5rZXkpO1xuICAgICAgICByZXR1cm4gdGhpcy52KGUpO1xuICAgIH1cbn1cblxuLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyB3aXRoaW4gYW4gYXJyYXkuICovIGNsYXNzIFNlIGV4dGVuZHMgVmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJpblwiIC8qIElOICovICwgZSksIHRoaXMua2V5cyA9IENlKFwiaW5cIiAvKiBJTiAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5cy5zb21lKChlID0+IGUuaXNFcXVhbCh0LmtleSkpKTtcbiAgICB9XG59XG5cbi8qKiBGaWx0ZXIgdGhhdCBtYXRjaGVzIG9uIGtleSBmaWVsZHMgbm90IHByZXNlbnQgd2l0aGluIGFuIGFycmF5LiAqLyBjbGFzcyBEZSBleHRlbmRzIFZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwibm90LWluXCIgLyogTk9UX0lOICovICwgZSksIHRoaXMua2V5cyA9IENlKFwibm90LWluXCIgLyogTk9UX0lOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICByZXR1cm4gIXRoaXMua2V5cy5zb21lKChlID0+IGUuaXNFcXVhbCh0LmtleSkpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIENlKHQsIGUpIHtcbiAgICB2YXIgbjtcbiAgICByZXR1cm4gKChudWxsID09PSAobiA9IGUuYXJyYXlWYWx1ZSkgfHwgdm9pZCAwID09PSBuID8gdm9pZCAwIDogbi52YWx1ZXMpIHx8IFtdKS5tYXAoKHQgPT4geHQuZnJvbU5hbWUodC5yZWZlcmVuY2VWYWx1ZSkpKTtcbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgYXJyYXktY29udGFpbnMgb3BlcmF0b3IuICovIGNsYXNzIHhlIGV4dGVuZHMgVmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gR3QoZSkgJiYgRnQoZS5hcnJheVZhbHVlLCB0aGlzLnZhbHVlKTtcbiAgICB9XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIElOIG9wZXJhdG9yLiAqLyBjbGFzcyBOZSBleHRlbmRzIFZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiaW5cIiAvKiBJTiAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IGUgJiYgRnQodGhpcy52YWx1ZS5hcnJheVZhbHVlLCBlKTtcbiAgICB9XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIG5vdC1pbiBvcGVyYXRvci4gKi8gY2xhc3Mga2UgZXh0ZW5kcyBWZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgaWYgKEZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiAhRnQodGhpcy52YWx1ZS5hcnJheVZhbHVlLCBlKTtcbiAgICB9XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIGFycmF5LWNvbnRhaW5zLWFueSBvcGVyYXRvci4gKi8gY2xhc3MgTWUgZXh0ZW5kcyBWZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuICEoIUd0KGUpIHx8ICFlLmFycmF5VmFsdWUudmFsdWVzKSAmJiBlLmFycmF5VmFsdWUudmFsdWVzLnNvbWUoKHQgPT4gRnQodGhpcy52YWx1ZS5hcnJheVZhbHVlLCB0KSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgYm91bmQgb2YgYSBxdWVyeS5cbiAqXG4gKiBUaGUgYm91bmQgaXMgc3BlY2lmaWVkIHdpdGggdGhlIGdpdmVuIGNvbXBvbmVudHMgcmVwcmVzZW50aW5nIGEgcG9zaXRpb24gYW5kXG4gKiB3aGV0aGVyIGl0J3MganVzdCBiZWZvcmUgb3IganVzdCBhZnRlciB0aGUgcG9zaXRpb24gKHJlbGF0aXZlIHRvIHdoYXRldmVyIHRoZVxuICogcXVlcnkgb3JkZXIgaXMpLlxuICpcbiAqIFRoZSBwb3NpdGlvbiByZXByZXNlbnRzIGEgbG9naWNhbCBpbmRleCBwb3NpdGlvbiBmb3IgYSBxdWVyeS4gSXQncyBhIHByZWZpeFxuICogb2YgdmFsdWVzIGZvciB0aGUgKHBvdGVudGlhbGx5IGltcGxpY2l0KSBvcmRlciBieSBjbGF1c2VzIG9mIGEgcXVlcnkuXG4gKlxuICogQm91bmQgcHJvdmlkZXMgYSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgd2hldGhlciBhIGRvY3VtZW50IGNvbWVzIGJlZm9yZSBvclxuICogYWZ0ZXIgYSBib3VuZC4gVGhpcyBpcyBpbmZsdWVuY2VkIGJ5IHdoZXRoZXIgdGhlIHBvc2l0aW9uIGlzIGp1c3QgYmVmb3JlIG9yXG4gKiBqdXN0IGFmdGVyIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gKi8gY2xhc3MgT2Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHQsIHRoaXMuaW5jbHVzaXZlID0gZTtcbiAgICB9XG59XG5cbi8qKlxuICogQW4gb3JkZXJpbmcgb24gYSBmaWVsZCwgaW4gc29tZSBEaXJlY3Rpb24uIERpcmVjdGlvbiBkZWZhdWx0cyB0byBBU0NFTkRJTkcuXG4gKi8gY2xhc3MgRmUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBcImFzY1wiIC8qIEFTQ0VORElORyAqLykge1xuICAgICAgICB0aGlzLmZpZWxkID0gdCwgdGhpcy5kaXIgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gJGUodCwgZSkge1xuICAgIHJldHVybiB0LmRpciA9PT0gZS5kaXIgJiYgdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpO1xufVxuXG5mdW5jdGlvbiBCZSh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5wb3NpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByID0gZVtpXSwgbyA9IHQucG9zaXRpb25baV07XG4gICAgICAgIGlmIChyLmZpZWxkLmlzS2V5RmllbGQoKSkgcyA9IHh0LmNvbXBhcmF0b3IoeHQuZnJvbU5hbWUoby5yZWZlcmVuY2VWYWx1ZSksIG4ua2V5KTsgZWxzZSB7XG4gICAgICAgICAgICBzID0gJHQobywgbi5kYXRhLmZpZWxkKHIuZmllbGQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gci5kaXIgJiYgKHMgKj0gLTEpLCAwICE9PSBzKSBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIGEgZG9jdW1lbnQgc29ydHMgYWZ0ZXIgYSBib3VuZCB1c2luZyB0aGUgcHJvdmlkZWQgc29ydFxuICogb3JkZXIuXG4gKi8gZnVuY3Rpb24gTGUodCwgZSkge1xuICAgIGlmIChudWxsID09PSB0KSByZXR1cm4gbnVsbCA9PT0gZTtcbiAgICBpZiAobnVsbCA9PT0gZSkgcmV0dXJuICExO1xuICAgIGlmICh0LmluY2x1c2l2ZSAhPT0gZS5pbmNsdXNpdmUgfHwgdC5wb3NpdGlvbi5sZW5ndGggIT09IGUucG9zaXRpb24ubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0LnBvc2l0aW9uLmxlbmd0aDsgbisrKSB7XG4gICAgICAgIGlmICghT3QodC5wb3NpdGlvbltuXSwgZS5wb3NpdGlvbltuXSkpIHJldHVybiAhMTtcbiAgICB9XG4gICAgcmV0dXJuICEwO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBRdWVyeSBlbmNhcHN1bGF0ZXMgYWxsIHRoZSBxdWVyeSBhdHRyaWJ1dGVzIHdlIHN1cHBvcnQgaW4gdGhlIFNESy4gSXQgY2FuXG4gKiBiZSBydW4gYWdhaW5zdCB0aGUgTG9jYWxTdG9yZSwgYXMgd2VsbCBhcyBiZSBjb252ZXJ0ZWQgdG8gYSBgVGFyZ2V0YCB0b1xuICogcXVlcnkgdGhlIFJlbW90ZVN0b3JlIHJlc3VsdHMuXG4gKlxuICogVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqLyBjbGFzcyBVZSB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBRdWVyeSB3aXRoIGEgcGF0aCBhbmQgb3B0aW9uYWwgYWRkaXRpb25hbCBxdWVyeSBjb25zdHJhaW50cy5cbiAgICAgKiBQYXRoIG11c3QgY3VycmVudGx5IGJlIGVtcHR5IGlmIHRoaXMgaXMgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBudWxsLCBuID0gW10sIHMgPSBbXSwgaSA9IG51bGwsIHIgPSBcIkZcIiAvKiBGaXJzdCAqLyAsIG8gPSBudWxsLCB1ID0gbnVsbCkge1xuICAgICAgICB0aGlzLnBhdGggPSB0LCB0aGlzLmNvbGxlY3Rpb25Hcm91cCA9IGUsIHRoaXMuZXhwbGljaXRPcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgXG4gICAgICAgIHRoaXMubGltaXQgPSBpLCB0aGlzLmxpbWl0VHlwZSA9IHIsIHRoaXMuc3RhcnRBdCA9IG8sIHRoaXMuZW5kQXQgPSB1LCB0aGlzLkQgPSBudWxsLCBcbiAgICAgICAgLy8gVGhlIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgb2YgdGhpcyBgUXVlcnlgIGluc3RhbmNlLlxuICAgICAgICB0aGlzLkMgPSBudWxsLCB0aGlzLnN0YXJ0QXQsIHRoaXMuZW5kQXQ7XG4gICAgfVxufVxuXG4vKiogQ3JlYXRlcyBhIG5ldyBRdWVyeSBpbnN0YW5jZSB3aXRoIHRoZSBvcHRpb25zIHByb3ZpZGVkLiAqLyBmdW5jdGlvbiBxZSh0LCBlLCBuLCBzLCBpLCByLCBvLCB1KSB7XG4gICAgcmV0dXJuIG5ldyBVZSh0LCBlLCBuLCBzLCBpLCByLCBvLCB1KTtcbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgUXVlcnkgZm9yIGEgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHMgYXQgYHBhdGhgICovIGZ1bmN0aW9uIEtlKHQpIHtcbiAgICByZXR1cm4gbmV3IFVlKHQpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBjb252ZXJ0IGEgY29sbGVjdGlvbiBncm91cCBxdWVyeSBpbnRvIGEgY29sbGVjdGlvbiBxdWVyeSBhdCBhXG4gKiBzcGVjaWZpYyBwYXRoLiBUaGlzIGlzIHVzZWQgd2hlbiBleGVjdXRpbmcgY29sbGVjdGlvbiBncm91cCBxdWVyaWVzLCBzaW5jZVxuICogd2UgaGF2ZSB0byBzcGxpdCB0aGUgcXVlcnkgaW50byBhIHNldCBvZiBjb2xsZWN0aW9uIHF1ZXJpZXMgYXQgbXVsdGlwbGVcbiAqIHBhdGhzLlxuICovXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIHF1ZXJ5IGRvZXMgbm90IHNwZWNpZnkgYW55IHF1ZXJ5IGNvbnN0cmFpbnRzIHRoYXRcbiAqIGNvdWxkIHJlbW92ZSByZXN1bHRzLlxuICovXG5mdW5jdGlvbiBHZSh0KSB7XG4gICAgcmV0dXJuIDAgPT09IHQuZmlsdGVycy5sZW5ndGggJiYgbnVsbCA9PT0gdC5saW1pdCAmJiBudWxsID09IHQuc3RhcnRBdCAmJiBudWxsID09IHQuZW5kQXQgJiYgKDAgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCB8fCAxID09PSB0LmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggJiYgdC5leHBsaWNpdE9yZGVyQnlbMF0uZmllbGQuaXNLZXlGaWVsZCgpKTtcbn1cblxuZnVuY3Rpb24gUWUodCkge1xuICAgIHJldHVybiB0LmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggPiAwID8gdC5leHBsaWNpdE9yZGVyQnlbMF0uZmllbGQgOiBudWxsO1xufVxuXG5mdW5jdGlvbiBqZSh0KSB7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZmlsdGVycykgaWYgKGUuUygpKSByZXR1cm4gZS5maWVsZDtcbiAgICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgYW55IG9mIHRoZSBwcm92aWRlZCBPcGVyYXRvcnMgYXJlIGluY2x1ZGVkIGluIHRoZSBxdWVyeSBhbmRcbiAqIHJldHVybnMgdGhlIGZpcnN0IG9uZSB0aGF0IGlzLCBvciBudWxsIGlmIG5vbmUgYXJlLlxuICovXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgcXVlcnkgbWF0Y2hlcyBhIGNvbGxlY3Rpb24gZ3JvdXAgcmF0aGVyIHRoYW4gYSBzcGVjaWZpY1xuICogY29sbGVjdGlvbi5cbiAqL1xuZnVuY3Rpb24gV2UodCkge1xuICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbXBsaWNpdCBvcmRlciBieSBjb25zdHJhaW50IHRoYXQgaXMgdXNlZCB0byBleGVjdXRlIHRoZSBRdWVyeSxcbiAqIHdoaWNoIGNhbiBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JkZXIgYnkgY29uc3RyYWludHMgdGhlIHVzZXIgcHJvdmlkZWQgKGUuZy5cbiAqIHRoZSBTREsgYW5kIGJhY2tlbmQgYWx3YXlzIG9yZGVycyBieSBgX19uYW1lX19gKS5cbiAqLyBmdW5jdGlvbiB6ZSh0KSB7XG4gICAgY29uc3QgZSA9IEsodCk7XG4gICAgaWYgKG51bGwgPT09IGUuRCkge1xuICAgICAgICBlLkQgPSBbXTtcbiAgICAgICAgY29uc3QgdCA9IGplKGUpLCBuID0gUWUoZSk7XG4gICAgICAgIGlmIChudWxsICE9PSB0ICYmIG51bGwgPT09IG4pIFxuICAgICAgICAvLyBJbiBvcmRlciB0byBpbXBsaWNpdGx5IGFkZCBrZXkgb3JkZXJpbmcsIHdlIG11c3QgYWxzbyBhZGQgdGhlXG4gICAgICAgIC8vIGluZXF1YWxpdHkgZmlsdGVyIGZpZWxkIGZvciBpdCB0byBiZSBhIHZhbGlkIHF1ZXJ5LlxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhlIGRlZmF1bHQgaW5lcXVhbGl0eSBmaWVsZCBhbmQga2V5IG9yZGVyaW5nIGlzIGFzY2VuZGluZy5cbiAgICAgICAgdC5pc0tleUZpZWxkKCkgfHwgZS5ELnB1c2gobmV3IEZlKHQpKSwgZS5ELnB1c2gobmV3IEZlKG10LmtleUZpZWxkKCksIFwiYXNjXCIgLyogQVNDRU5ESU5HICovKSk7IGVsc2Uge1xuICAgICAgICAgICAgbGV0IHQgPSAhMTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBlLmV4cGxpY2l0T3JkZXJCeSkgZS5ELnB1c2gobiksIG4uZmllbGQuaXNLZXlGaWVsZCgpICYmICh0ID0gITApO1xuICAgICAgICAgICAgaWYgKCF0KSB7XG4gICAgICAgICAgICAgICAgLy8gVGhlIG9yZGVyIG9mIHRoZSBpbXBsaWNpdCBrZXkgb3JkZXJpbmcgYWx3YXlzIG1hdGNoZXMgdGhlIGxhc3RcbiAgICAgICAgICAgICAgICAvLyBleHBsaWNpdCBvcmRlciBieVxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggPiAwID8gZS5leHBsaWNpdE9yZGVyQnlbZS5leHBsaWNpdE9yZGVyQnkubGVuZ3RoIC0gMV0uZGlyIDogXCJhc2NcIiAvKiBBU0NFTkRJTkcgKi87XG4gICAgICAgICAgICAgICAgZS5ELnB1c2gobmV3IEZlKG10LmtleUZpZWxkKCksIHQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZS5EO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZSB0byBpdCdzIGNvcnJlc3BvbmRpbmcgYFRhcmdldGAgcmVwcmVzZW50YXRpb24uXG4gKi8gZnVuY3Rpb24gSGUodCkge1xuICAgIGNvbnN0IGUgPSBLKHQpO1xuICAgIGlmICghZS5DKSBpZiAoXCJGXCIgLyogRmlyc3QgKi8gPT09IGUubGltaXRUeXBlKSBlLkMgPSBwZShlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCB6ZShlKSwgZS5maWx0ZXJzLCBlLmxpbWl0LCBlLnN0YXJ0QXQsIGUuZW5kQXQpOyBlbHNlIHtcbiAgICAgICAgLy8gRmxpcCB0aGUgb3JkZXJCeSBkaXJlY3Rpb25zIHNpbmNlIHdlIHdhbnQgdGhlIGxhc3QgcmVzdWx0c1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB6ZShlKSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi8gPT09IG4uZGlyID8gXCJhc2NcIiAvKiBBU0NFTkRJTkcgKi8gOiBcImRlc2NcIiAvKiBERVNDRU5ESU5HICovO1xuICAgICAgICAgICAgdC5wdXNoKG5ldyBGZShuLmZpZWxkLCBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gV2UgbmVlZCB0byBzd2FwIHRoZSBjdXJzb3JzIHRvIG1hdGNoIHRoZSBub3ctZmxpcHBlZCBxdWVyeSBvcmRlcmluZy5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5lbmRBdCA/IG5ldyBPZShlLmVuZEF0LnBvc2l0aW9uLCBlLmVuZEF0LmluY2x1c2l2ZSkgOiBudWxsLCBzID0gZS5zdGFydEF0ID8gbmV3IE9lKGUuc3RhcnRBdC5wb3NpdGlvbiwgZS5zdGFydEF0LmluY2x1c2l2ZSkgOiBudWxsO1xuICAgICAgICAvLyBOb3cgcmV0dXJuIGFzIGEgTGltaXRUeXBlLkZpcnN0IHF1ZXJ5LlxuICAgICAgICBlLkMgPSBwZShlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCB0LCBlLmZpbHRlcnMsIGUubGltaXQsIG4sIHMpO1xuICAgIH1cbiAgICByZXR1cm4gZS5DO1xufVxuXG5mdW5jdGlvbiBKZSh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIG5ldyBVZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgZSwgbiwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbn1cblxuZnVuY3Rpb24gWWUodCwgZSkge1xuICAgIHJldHVybiBFZShIZSh0KSwgSGUoZSkpICYmIHQubGltaXRUeXBlID09PSBlLmxpbWl0VHlwZTtcbn1cblxuLy8gVE9ETyhiLzI5MTgzMTY1KTogVGhpcyBpcyB1c2VkIHRvIGdldCBhIHVuaXF1ZSBzdHJpbmcgZnJvbSBhIHF1ZXJ5IHRvLCBmb3Jcbi8vIGV4YW1wbGUsIHVzZSBhcyBhIGRpY3Rpb25hcnkga2V5LCBidXQgdGhlIGltcGxlbWVudGF0aW9uIGlzIHN1YmplY3QgdG9cbi8vIGNvbGxpc2lvbnMuIE1ha2UgaXQgY29sbGlzaW9uLWZyZWUuXG5mdW5jdGlvbiBYZSh0KSB7XG4gICAgcmV0dXJuIGAke0llKEhlKHQpKX18bHQ6JHt0LmxpbWl0VHlwZX1gO1xufVxuXG5mdW5jdGlvbiBaZSh0KSB7XG4gICAgcmV0dXJuIGBRdWVyeSh0YXJnZXQ9JHtUZShIZSh0KSl9OyBsaW1pdFR5cGU9JHt0LmxpbWl0VHlwZX0pYDtcbn1cblxuLyoqIFJldHVybnMgd2hldGhlciBgZG9jYCBtYXRjaGVzIHRoZSBjb25zdHJhaW50cyBvZiBgcXVlcnlgLiAqLyBmdW5jdGlvbiB0bih0LCBlKSB7XG4gICAgcmV0dXJuIGUuaXNGb3VuZERvY3VtZW50KCkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS5rZXkucGF0aDtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwID8gZS5rZXkuaGFzQ29sbGVjdGlvbklkKHQuY29sbGVjdGlvbkdyb3VwKSAmJiB0LnBhdGguaXNQcmVmaXhPZihuKSA6IHh0LmlzRG9jdW1lbnRLZXkodC5wYXRoKSA/IHQucGF0aC5pc0VxdWFsKG4pIDogdC5wYXRoLmlzSW1tZWRpYXRlUGFyZW50T2Yobik7XG4gICAgfVxuICAgIC8qKlxuICogQSBkb2N1bWVudCBtdXN0IGhhdmUgYSB2YWx1ZSBmb3IgZXZlcnkgb3JkZXJpbmcgY2xhdXNlIGluIG9yZGVyIHRvIHNob3cgdXBcbiAqIGluIHRoZSByZXN1bHRzLlxuICovICh0LCBlKSAmJiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmV4cGxpY2l0T3JkZXJCeSkgXG4gICAgICAgIC8vIG9yZGVyIGJ5IGtleSBhbHdheXMgbWF0Y2hlc1xuICAgICAgICBpZiAoIW4uZmllbGQuaXNLZXlGaWVsZCgpICYmIG51bGwgPT09IGUuZGF0YS5maWVsZChuLmZpZWxkKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfSh0LCBlKSAmJiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmZpbHRlcnMpIGlmICghbi5tYXRjaGVzKGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqIE1ha2VzIHN1cmUgYSBkb2N1bWVudCBpcyB3aXRoaW4gdGhlIGJvdW5kcywgaWYgcHJvdmlkZWQuICovICh0LCBlKSAmJiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGlmICh0LnN0YXJ0QXQgJiYgIVxuICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhIGRvY3VtZW50IHNvcnRzIGJlZm9yZSBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gQmUodCwgZSwgbik7XG4gICAgICAgICAgICByZXR1cm4gdC5pbmNsdXNpdmUgPyBzIDw9IDAgOiBzIDwgMDtcbiAgICAgICAgfSh0LnN0YXJ0QXQsIHplKHQpLCBlKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodC5lbmRBdCAmJiAhZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgY29uc3QgcyA9IEJlKHQsIGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIHQuaW5jbHVzaXZlID8gcyA+PSAwIDogcyA+IDA7XG4gICAgICAgIH0odC5lbmRBdCwgemUodCksIGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBjb2xsZWN0aW9uIGdyb3VwIHRoYXQgdGhpcyBxdWVyeSB0YXJnZXRzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgaW4gdGhlIFdlYiBTREsgdG8gZmFjaWxpdGF0ZSBtdWx0aS10YWJcbiAqIHN5bmNocm9uaXphdGlvbiBmb3IgcXVlcnkgcmVzdWx0cy5cbiAqLyAodCwgZSk7XG59XG5cbmZ1bmN0aW9uIGVuKHQpIHtcbiAgICByZXR1cm4gdC5jb2xsZWN0aW9uR3JvdXAgfHwgKHQucGF0aC5sZW5ndGggJSAyID09IDEgPyB0LnBhdGgubGFzdFNlZ21lbnQoKSA6IHQucGF0aC5nZXQodC5wYXRoLmxlbmd0aCAtIDIpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgbmV3IGNvbXBhcmF0b3IgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBjb21wYXJlIHR3byBkb2N1bWVudHNcbiAqIGJhc2VkIG9uIHRoZSBRdWVyeSdzIG9yZGVyaW5nIGNvbnN0cmFpbnQuXG4gKi8gZnVuY3Rpb24gbm4odCkge1xuICAgIHJldHVybiAoZSwgbikgPT4ge1xuICAgICAgICBsZXQgcyA9ICExO1xuICAgICAgICBmb3IgKGNvbnN0IGkgb2YgemUodCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzbihpLCBlLCBuKTtcbiAgICAgICAgICAgIGlmICgwICE9PSB0KSByZXR1cm4gdDtcbiAgICAgICAgICAgIHMgPSBzIHx8IGkuZmllbGQuaXNLZXlGaWVsZCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIHNuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gdC5maWVsZC5pc0tleUZpZWxkKCkgPyB4dC5jb21wYXJhdG9yKGUua2V5LCBuLmtleSkgOiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBlLmRhdGEuZmllbGQodCksIGkgPSBuLmRhdGEuZmllbGQodCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBzICYmIG51bGwgIT09IGkgPyAkdChzLCBpKSA6IEwoKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFRoZSBpbml0aWFsIG11dGF0aW9uIGJhdGNoIGlkIGZvciBlYWNoIGluZGV4LiBHZXRzIHVwZGF0ZWQgZHVyaW5nIGluZGV4XG4gKiBiYWNrZmlsbC5cbiAqLyAodC5maWVsZCwgZSwgbik7XG4gICAgc3dpdGNoICh0LmRpcikge1xuICAgICAgY2FzZSBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiBzO1xuXG4gICAgICBjYXNlIFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi8gOlxuICAgICAgICByZXR1cm4gLTEgKiBzO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTCgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmV0dXJucyBhbiBEb3VibGVWYWx1ZSBmb3IgYHZhbHVlYCB0aGF0IGlzIGVuY29kZWQgYmFzZWQgdGhlIHNlcmlhbGl6ZXInc1xuICogYHVzZVByb3RvM0pzb25gIHNldHRpbmcuXG4gKi8gZnVuY3Rpb24gcm4odCwgZSkge1xuICAgIGlmICh0Lk4pIHtcbiAgICAgICAgaWYgKGlzTmFOKGUpKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiTmFOXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGUgPT09IDEgLyAwKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiSW5maW5pdHlcIlxuICAgICAgICB9O1xuICAgICAgICBpZiAoZSA9PT0gLTEgLyAwKSByZXR1cm4ge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IFwiLUluZmluaXR5XCJcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZG91YmxlVmFsdWU6IER0KGUpID8gXCItMFwiIDogZVxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBJbnRlZ2VyVmFsdWUgZm9yIGB2YWx1ZWAuXG4gKi8gZnVuY3Rpb24gb24odCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGludGVnZXJWYWx1ZTogXCJcIiArIHRcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBudW1iZXIgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvIGEgcHJvdG8uXG4gKiBUaGUgcmV0dXJuIHZhbHVlIGlzIGFuIEludGVnZXJWYWx1ZSBpZiBpdCBjYW4gc2FmZWx5IHJlcHJlc2VudCB0aGUgdmFsdWUsXG4gKiBvdGhlcndpc2UgYSBEb3VibGVWYWx1ZSBpcyByZXR1cm5lZC5cbiAqLyBmdW5jdGlvbiB1bih0LCBlKSB7XG4gICAgcmV0dXJuIEN0KGUpID8gb24oZSkgOiBybih0LCBlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBVc2VkIHRvIHJlcHJlc2VudCBhIGZpZWxkIHRyYW5zZm9ybSBvbiBhIG11dGF0aW9uLiAqLyBjbGFzcyBhbiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBzdHJ1Y3R1cmFsIHR5cGUgb2YgYFRyYW5zZm9ybU9wZXJhdGlvbmAgaXMgdW5pcXVlLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy81NDUxXG4gICAgICAgIHRoaXMuXyA9IHZvaWQgMDtcbiAgICB9XG59XG5cbi8qKlxuICogQ29tcHV0ZXMgdGhlIGxvY2FsIHRyYW5zZm9ybSByZXN1bHQgYWdhaW5zdCB0aGUgcHJvdmlkZWQgYHByZXZpb3VzVmFsdWVgLFxuICogb3B0aW9uYWxseSB1c2luZyB0aGUgcHJvdmlkZWQgbG9jYWxXcml0ZVRpbWUuXG4gKi8gZnVuY3Rpb24gY24odCwgZSwgbikge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgZm4gPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICBmaWVsZHM6IHtcbiAgICAgICAgICAgICAgICBfX3R5cGVfXzoge1xuICAgICAgICAgICAgICAgICAgICBzdHJpbmdWYWx1ZTogXCJzZXJ2ZXJfdGltZXN0YW1wXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF9fbG9jYWxfd3JpdGVfdGltZV9fOiB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRzOiB0LnNlY29uZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW5vczogdC5uYW5vc2Vjb25kc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZSAmJiAobi5maWVsZHMuX19wcmV2aW91c192YWx1ZV9fID0gZSksIHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiBuXG4gICAgICAgIH07XG4gICAgfShuLCBlKSA6IHQgaW5zdGFuY2VvZiBkbiA/IF9uKHQsIGUpIDogdCBpbnN0YW5jZW9mIHduID8gbW4odCwgZSkgOiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogU2luY2UgSmF2YVNjcmlwdCdzIGludGVnZXIgYXJpdGhtZXRpYyBpcyBsaW1pdGVkIHRvIDUzIGJpdFxuICAgICAgICAvLyBwcmVjaXNpb24gYW5kIHJlc29sdmVzIG92ZXJmbG93cyBieSByZWR1Y2luZyBwcmVjaXNpb24sIHdlIGRvIG5vdFxuICAgICAgICAvLyBtYW51YWxseSBjYXAgb3ZlcmZsb3dzIGF0IDJeNjMuXG4gICAgICAgIGNvbnN0IG4gPSBsbih0LCBlKSwgcyA9IHluKG4pICsgeW4odC5rKTtcbiAgICAgICAgcmV0dXJuIEt0KG4pICYmIEt0KHQuaykgPyBvbihzKSA6IHJuKHQuTSwgcyk7XG4gICAgfSh0LCBlKTtcbn1cblxuLyoqXG4gKiBDb21wdXRlcyBhIGZpbmFsIHRyYW5zZm9ybSByZXN1bHQgYWZ0ZXIgdGhlIHRyYW5zZm9ybSBoYXMgYmVlbiBhY2tub3dsZWRnZWRcbiAqIGJ5IHRoZSBzZXJ2ZXIsIHBvdGVudGlhbGx5IHVzaW5nIHRoZSBzZXJ2ZXItcHJvdmlkZWQgdHJhbnNmb3JtUmVzdWx0LlxuICovIGZ1bmN0aW9uIGhuKHQsIGUsIG4pIHtcbiAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcbiAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcbiAgICAvLyBhcHBsaWNhdGlvbnMuXG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBkbiA/IF9uKHQsIGUpIDogdCBpbnN0YW5jZW9mIHduID8gbW4odCwgZSkgOiBuO1xufVxuXG4vKipcbiAqIElmIHRoaXMgdHJhbnNmb3JtIG9wZXJhdGlvbiBpcyBub3QgaWRlbXBvdGVudCwgcmV0dXJucyB0aGUgYmFzZSB2YWx1ZSB0b1xuICogcGVyc2lzdCBmb3IgdGhpcyB0cmFuc2Zvcm0uIElmIGEgYmFzZSB2YWx1ZSBpcyByZXR1cm5lZCwgdGhlIHRyYW5zZm9ybVxuICogb3BlcmF0aW9uIGlzIGFsd2F5cyBhcHBsaWVkIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXNcbiAqIGFscmVhZHkgYmVlbiB1cGRhdGVkLlxuICpcbiAqIEJhc2UgdmFsdWVzIHByb3ZpZGUgY29uc2lzdGVudCBiZWhhdmlvciBmb3Igbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtcyBhbmRcbiAqIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZSBsYXRlbmN5LWNvbXBlbnNhdGVkIHZhbHVlIGV2ZW4gaWYgdGhlIGJhY2tlbmRcbiAqIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlIHRyYW5zZm9ybSBvcGVyYXRpb24uIFRoZSBiYXNlIHZhbHVlIGlzIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMsIGFzIHRoZXkgY2FuIGJlIHJlLXBsYXllZCBldmVuIGlmIHRoZSBiYWNrZW5kIGhhc1xuICogYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCB0cmFuc2Zvcm1zLlxuICovIGZ1bmN0aW9uIGxuKHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIGduID8gS3QobiA9IGUpIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuICEhdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdDtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGVpdGhlciBhbiBJbnRlZ2VyVmFsdWUgb3IgYSBEb3VibGVWYWx1ZS4gKi8gKG4pID8gZSA6IHtcbiAgICAgICAgaW50ZWdlclZhbHVlOiAwXG4gICAgfSA6IG51bGw7XG4gICAgdmFyIG47XG59XG5cbi8qKiBUcmFuc2Zvcm1zIGEgdmFsdWUgaW50byBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wLiAqL1xuY2xhc3MgZm4gZXh0ZW5kcyBhbiB7fVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSB1bmlvbiBvcGVyYXRpb24uICovIGNsYXNzIGRuIGV4dGVuZHMgYW4ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfbih0LCBlKSB7XG4gICAgY29uc3QgbiA9IHBuKGUpO1xuICAgIGZvciAoY29uc3QgZSBvZiB0LmVsZW1lbnRzKSBuLnNvbWUoKHQgPT4gT3QodCwgZSkpKSB8fCBuLnB1c2goZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgdmFsdWVzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSByZW1vdmUgb3BlcmF0aW9uLiAqLyBjbGFzcyB3biBleHRlbmRzIGFuIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZWxlbWVudHMgPSB0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbW4odCwgZSkge1xuICAgIGxldCBuID0gcG4oZSk7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZWxlbWVudHMpIG4gPSBuLmZpbHRlcigodCA9PiAhT3QodCwgZSkpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKlxuICogSW1wbGVtZW50cyB0aGUgYmFja2VuZCBzZW1hbnRpY3MgZm9yIGxvY2FsbHkgY29tcHV0ZWQgTlVNRVJJQ19BREQgKGluY3JlbWVudClcbiAqIHRyYW5zZm9ybXMuIENvbnZlcnRzIGFsbCBmaWVsZCB2YWx1ZXMgdG8gaW50ZWdlcnMgb3IgZG91YmxlcywgYnV0IHVubGlrZSB0aGVcbiAqIGJhY2tlbmQgZG9lcyBub3QgY2FwIGludGVnZXIgdmFsdWVzIGF0IDJeNjMuIEluc3RlYWQsIEphdmFTY3JpcHQgbnVtYmVyXG4gKiBhcml0aG1ldGljIGlzIHVzZWQgYW5kIHByZWNpc2lvbiBsb3NzIGNhbiBvY2N1ciBmb3IgdmFsdWVzIGdyZWF0ZXIgdGhhbiAyXjUzLlxuICovIGNsYXNzIGduIGV4dGVuZHMgYW4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5NID0gdCwgdGhpcy5rID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHluKHQpIHtcbiAgICByZXR1cm4gRXQodC5pbnRlZ2VyVmFsdWUgfHwgdC5kb3VibGVWYWx1ZSk7XG59XG5cbmZ1bmN0aW9uIHBuKHQpIHtcbiAgICByZXR1cm4gR3QodCkgJiYgdC5hcnJheVZhbHVlLnZhbHVlcyA/IHQuYXJyYXlWYWx1ZS52YWx1ZXMuc2xpY2UoKSA6IFtdO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgZmllbGQgcGF0aCBhbmQgdGhlIFRyYW5zZm9ybU9wZXJhdGlvbiB0byBwZXJmb3JtIHVwb24gaXQuICovIGNsYXNzIEluIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZmllbGQgPSB0LCB0aGlzLnRyYW5zZm9ybSA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBUbih0LCBlKSB7XG4gICAgcmV0dXJuIHQuZmllbGQuaXNFcXVhbChlLmZpZWxkKSAmJiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgZG4gJiYgZSBpbnN0YW5jZW9mIGRuIHx8IHQgaW5zdGFuY2VvZiB3biAmJiBlIGluc3RhbmNlb2Ygd24gPyBvdCh0LmVsZW1lbnRzLCBlLmVsZW1lbnRzLCBPdCkgOiB0IGluc3RhbmNlb2YgZ24gJiYgZSBpbnN0YW5jZW9mIGduID8gT3QodC5rLCBlLmspIDogdCBpbnN0YW5jZW9mIGZuICYmIGUgaW5zdGFuY2VvZiBmbjtcbiAgICB9KHQudHJhbnNmb3JtLCBlLnRyYW5zZm9ybSk7XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHN1Y2Nlc3NmdWxseSBhcHBseWluZyBhIG11dGF0aW9uIHRvIHRoZSBiYWNrZW5kLiAqL1xuY2xhc3MgRW4ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBtdXRhdGlvbiB3YXMgY29tbWl0dGVkOlxuICAgICAqXG4gICAgICogLSBGb3IgbW9zdCBvcGVyYXRpb25zLCB0aGlzIGlzIHRoZSB1cGRhdGVUaW1lIGluIHRoZSBXcml0ZVJlc3VsdC5cbiAgICAgKiAtIEZvciBkZWxldGVzLCB0aGUgY29tbWl0VGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSAoYmVjYXVzZSBkZWxldGVzIGFyZVxuICAgICAqICAgbm90IHN0b3JlZCBhbmQgaGF2ZSBubyB1cGRhdGVUaW1lKS5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGVzZSB2ZXJzaW9ucyBjYW4gYmUgZGlmZmVyZW50OiBOby1vcCB3cml0ZXMgd2lsbCBub3QgY2hhbmdlXG4gICAgICogdGhlIHVwZGF0ZVRpbWUgZXZlbiB0aG91Z2ggdGhlIGNvbW1pdFRpbWUgYWR2YW5jZXMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIHJlc3VsdGluZyBmaWVsZHMgcmV0dXJuZWQgZnJvbSB0aGUgYmFja2VuZCBhZnRlciBhIG11dGF0aW9uXG4gICAgICogY29udGFpbmluZyBmaWVsZCB0cmFuc2Zvcm1zIGhhcyBiZWVuIGNvbW1pdHRlZC4gQ29udGFpbnMgb25lIEZpZWxkVmFsdWVcbiAgICAgKiBmb3IgZWFjaCBGaWVsZFRyYW5zZm9ybSB0aGF0IHdhcyBpbiB0aGUgbXV0YXRpb24uXG4gICAgICpcbiAgICAgKiBXaWxsIGJlIGVtcHR5IGlmIHRoZSBtdXRhdGlvbiBkaWQgbm90IGNvbnRhaW4gYW55IGZpZWxkIHRyYW5zZm9ybXMuXG4gICAgICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLnRyYW5zZm9ybVJlc3VsdHMgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBFbmNvZGVzIGEgcHJlY29uZGl0aW9uIGZvciBhIG11dGF0aW9uLiBUaGlzIGZvbGxvd3MgdGhlIG1vZGVsIHRoYXQgdGhlXG4gKiBiYWNrZW5kIGFjY2VwdHMgd2l0aCB0aGUgc3BlY2lhbCBjYXNlIG9mIGFuIGV4cGxpY2l0IFwiZW1wdHlcIiBwcmVjb25kaXRpb25cbiAqIChtZWFuaW5nIG5vIHByZWNvbmRpdGlvbikuXG4gKi8gY2xhc3MgQW4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lID0gdCwgdGhpcy5leGlzdHMgPSBlO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBlbXB0eSBQcmVjb25kaXRpb24uICovICAgIHN0YXRpYyBub25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IEFuO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gd2l0aCBhbiBleGlzdHMgZmxhZy4gKi8gICAgc3RhdGljIGV4aXN0cyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQW4odm9pZCAwLCB0KTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIGJhc2VkIG9uIGEgdmVyc2lvbiBhIGRvY3VtZW50IGV4aXN0cyBhdC4gKi8gICAgc3RhdGljIHVwZGF0ZVRpbWUodCkge1xuICAgICAgICByZXR1cm4gbmV3IEFuKHQpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIHRoaXMgUHJlY29uZGl0aW9uIGlzIGVtcHR5LiAqLyAgICBnZXQgaXNOb25lKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0aGlzLnVwZGF0ZVRpbWUgJiYgdm9pZCAwID09PSB0aGlzLmV4aXN0cztcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV4aXN0cyA9PT0gdC5leGlzdHMgJiYgKHRoaXMudXBkYXRlVGltZSA/ICEhdC51cGRhdGVUaW1lICYmIHRoaXMudXBkYXRlVGltZS5pc0VxdWFsKHQudXBkYXRlVGltZSkgOiAhdC51cGRhdGVUaW1lKTtcbiAgICB9XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByZWNvbmRpdGlvbnMgaXMgdmFsaWQgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC4gKi8gZnVuY3Rpb24gUm4odCwgZSkge1xuICAgIHJldHVybiB2b2lkIDAgIT09IHQudXBkYXRlVGltZSA/IGUuaXNGb3VuZERvY3VtZW50KCkgJiYgZS52ZXJzaW9uLmlzRXF1YWwodC51cGRhdGVUaW1lKSA6IHZvaWQgMCA9PT0gdC5leGlzdHMgfHwgdC5leGlzdHMgPT09IGUuaXNGb3VuZERvY3VtZW50KCk7XG59XG5cbi8qKlxuICogQSBtdXRhdGlvbiBkZXNjcmliZXMgYSBzZWxmLWNvbnRhaW5lZCBjaGFuZ2UgdG8gYSBkb2N1bWVudC4gTXV0YXRpb25zIGNhblxuICogY3JlYXRlLCByZXBsYWNlLCBkZWxldGUsIGFuZCB1cGRhdGUgc3Vic2V0cyBvZiBkb2N1bWVudHMuXG4gKlxuICogTXV0YXRpb25zIG5vdCBvbmx5IGFjdCBvbiB0aGUgdmFsdWUgb2YgdGhlIGRvY3VtZW50IGJ1dCBhbHNvIGl0cyB2ZXJzaW9uLlxuICpcbiAqIEZvciBsb2NhbCBtdXRhdGlvbnMgKG11dGF0aW9ucyB0aGF0IGhhdmVuJ3QgYmVlbiBjb21taXR0ZWQgeWV0KSwgd2UgcHJlc2VydmVcbiAqIHRoZSBleGlzdGluZyB2ZXJzaW9uIGZvciBTZXQgYW5kIFBhdGNoIG11dGF0aW9ucy4gRm9yIERlbGV0ZSBtdXRhdGlvbnMsIHdlXG4gKiByZXNldCB0aGUgdmVyc2lvbiB0byAwLlxuICpcbiAqIEhlcmUncyB0aGUgZXhwZWN0ZWQgdHJhbnNpdGlvbiB0YWJsZS5cbiAqXG4gKiBNVVRBVElPTiAgICAgICAgICAgQVBQTElFRCBUTyAgICAgICAgICAgIFJFU1VMVFMgSU5cbiAqXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxuICogU2V0TXV0YXRpb24gICAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBEb2N1bWVudCh2MClcbiAqIFNldE11dGF0aW9uICAgICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgRG9jdW1lbnQodjApXG4gKiBQYXRjaE11dGF0aW9uICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxuICogUGF0Y2hNdXRhdGlvbiAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYzKVxuICogUGF0Y2hNdXRhdGlvbiAgICAgIEludmFsaWREb2N1bWVudCh2MCkgICBVbmtub3duRG9jdW1lbnQodjMpXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIE5vRG9jdW1lbnQodjApXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjApXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIE5vRG9jdW1lbnQodjApXG4gKlxuICogRm9yIGFja25vd2xlZGdlZCBtdXRhdGlvbnMsIHdlIHVzZSB0aGUgdXBkYXRlVGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSBhc1xuICogdGhlIHJlc3VsdGluZyB2ZXJzaW9uIGZvciBTZXQgYW5kIFBhdGNoIG11dGF0aW9ucy4gQXMgZGVsZXRlcyBoYXZlIG5vXG4gKiBleHBsaWNpdCB1cGRhdGUgdGltZSwgd2UgdXNlIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGZvclxuICogRGVsZXRlIG11dGF0aW9ucy5cbiAqXG4gKiBJZiBhIG11dGF0aW9uIGlzIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZCBidXQgZmFpbHMgdGhlIHByZWNvbmRpdGlvbiBjaGVja1xuICogbG9jYWxseSwgd2UgdHJhbnNpdGlvbiB0byBhbiBgVW5rbm93bkRvY3VtZW50YCBhbmQgcmVseSBvbiBXYXRjaCB0byBzZW5kIHVzXG4gKiB0aGUgdXBkYXRlZCB2ZXJzaW9uLlxuICpcbiAqIEZpZWxkIHRyYW5zZm9ybXMgYXJlIHVzZWQgb25seSB3aXRoIFBhdGNoIGFuZCBTZXQgTXV0YXRpb25zLiBXZSB1c2UgdGhlXG4gKiBgdXBkYXRlVHJhbnNmb3Jtc2AgbWVzc2FnZSB0byBzdG9yZSB0cmFuc2Zvcm1zLCByYXRoZXIgdGhhbiB0aGUgYHRyYW5zZm9ybXNgc1xuICogbWVzc2FnZXMuXG4gKlxuICogIyMgU3ViY2xhc3NpbmcgTm90ZXNcbiAqXG4gKiBFdmVyeSB0eXBlIG9mIG11dGF0aW9uIG5lZWRzIHRvIGltcGxlbWVudCBpdHMgb3duIGFwcGx5VG9SZW1vdGVEb2N1bWVudCgpIGFuZFxuICogYXBwbHlUb0xvY2FsVmlldygpIHRvIGltcGxlbWVudCB0aGUgYWN0dWFsIGJlaGF2aW9yIG9mIGFwcGx5aW5nIHRoZSBtdXRhdGlvblxuICogdG8gc29tZSBzb3VyY2UgZG9jdW1lbnQgKHNlZSBgc2V0TXV0YXRpb25BcHBseVRvUmVtb3RlRG9jdW1lbnQoKWAgZm9yIGFuXG4gKiBleGFtcGxlKS5cbiAqLyBjbGFzcyBibiB7fVxuXG4vKipcbiAqIEFwcGxpZXMgdGhpcyBtdXRhdGlvbiB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHRoZSBwdXJwb3NlcyBvZiBjb21wdXRpbmcgYVxuICogbmV3IHJlbW90ZSBkb2N1bWVudC4gSWYgdGhlIGlucHV0IGRvY3VtZW50IGRvZXNuJ3QgbWF0Y2ggdGhlIGV4cGVjdGVkIHN0YXRlXG4gKiAoZS5nLiBpdCBpcyBpbnZhbGlkIG9yIG91dGRhdGVkKSwgdGhlIGRvY3VtZW50IHR5cGUgbWF5IHRyYW5zaXRpb24gdG9cbiAqIHVua25vd24uXG4gKlxuICogQHBhcmFtIG11dGF0aW9uIC0gVGhlIG11dGF0aW9uIHRvIGFwcGx5LlxuICogQHBhcmFtIGRvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIG11dGF0ZS4gVGhlIGlucHV0IGRvY3VtZW50IGNhbiBiZSBhblxuICogICAgIGludmFsaWQgZG9jdW1lbnQgaWYgdGhlIGNsaWVudCBoYXMgbm8ga25vd2xlZGdlIG9mIHRoZSBwcmUtbXV0YXRpb24gc3RhdGVcbiAqICAgICBvZiB0aGUgZG9jdW1lbnQuXG4gKiBAcGFyYW0gbXV0YXRpb25SZXN1bHQgLSBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIHRoZSBtdXRhdGlvbiBmcm9tIHRoZSBiYWNrZW5kLlxuICovIGZ1bmN0aW9uIFBuKHQsIGUsIG4pIHtcbiAgICB0IGluc3RhbmNlb2YgQ24gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFVubGlrZSBzZXRNdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYVxuICAgICAgICAvLyByZW1vdGUgZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb25cbiAgICAgICAgLy8gbXVzdCBoYXZlIGhlbGQuXG4gICAgICAgIGNvbnN0IHMgPSB0LnZhbHVlLmNsb25lKCksIGkgPSBrbih0LmZpZWxkVHJhbnNmb3JtcywgZSwgbi50cmFuc2Zvcm1SZXN1bHRzKTtcbiAgICAgICAgcy5zZXRBbGwoaSksIGUuY29udmVydFRvRm91bmREb2N1bWVudChuLnZlcnNpb24sIHMpLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0odCwgZSwgbikgOiB0IGluc3RhbmNlb2YgeG4gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghUm4odC5wcmVjb25kaXRpb24sIGUpKSBcbiAgICAgICAgLy8gU2luY2UgdGhlIG11dGF0aW9uIHdhcyBub3QgcmVqZWN0ZWQsIHdlIGtub3cgdGhhdCB0aGUgcHJlY29uZGl0aW9uXG4gICAgICAgIC8vIG1hdGNoZWQgb24gdGhlIGJhY2tlbmQuIFdlIHRoZXJlZm9yZSBtdXN0IG5vdCBoYXZlIHRoZSBleHBlY3RlZCB2ZXJzaW9uXG4gICAgICAgIC8vIG9mIHRoZSBkb2N1bWVudCBpbiBvdXIgY2FjaGUgYW5kIGNvbnZlcnQgdG8gYW4gVW5rbm93bkRvY3VtZW50IHdpdGggYVxuICAgICAgICAvLyBrbm93biB1cGRhdGVUaW1lLlxuICAgICAgICByZXR1cm4gdm9pZCBlLmNvbnZlcnRUb1Vua25vd25Eb2N1bWVudChuLnZlcnNpb24pO1xuICAgICAgICBjb25zdCBzID0ga24odC5maWVsZFRyYW5zZm9ybXMsIGUsIG4udHJhbnNmb3JtUmVzdWx0cyksIGkgPSBlLmRhdGE7XG4gICAgICAgIGkuc2V0QWxsKE5uKHQpKSwgaS5zZXRBbGwocyksIGUuY29udmVydFRvRm91bmREb2N1bWVudChuLnZlcnNpb24sIGkpLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0odCwgZSwgbikgOiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFVubGlrZSBhcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGEgcmVtb3RlXG4gICAgICAgIC8vIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uIG11c3RcbiAgICAgICAgLy8gaGF2ZSBoZWxkLlxuICAgICAgICBlLmNvbnZlcnRUb05vRG9jdW1lbnQobi52ZXJzaW9uKS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9KDAsIGUsIG4pO1xufVxuXG4vKipcbiAqIEFwcGxpZXMgdGhpcyBtdXRhdGlvbiB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHRoZSBwdXJwb3NlcyBvZiBjb21wdXRpbmdcbiAqIHRoZSBuZXcgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGVcbiAqIGV4cGVjdGVkIHN0YXRlLCB0aGUgZG9jdW1lbnQgaXMgbm90IG1vZGlmaWVkLlxuICpcbiAqIEBwYXJhbSBtdXRhdGlvbiAtIFRoZSBtdXRhdGlvbiB0byBhcHBseS5cbiAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBtdXRhdGUuIFRoZSBpbnB1dCBkb2N1bWVudCBjYW4gYmUgYW5cbiAqICAgICBpbnZhbGlkIGRvY3VtZW50IGlmIHRoZSBjbGllbnQgaGFzIG5vIGtub3dsZWRnZSBvZiB0aGUgcHJlLW11dGF0aW9uIHN0YXRlXG4gKiAgICAgb2YgdGhlIGRvY3VtZW50LlxuICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gQSB0aW1lc3RhbXAgaW5kaWNhdGluZyB0aGUgbG9jYWwgd3JpdGUgdGltZSBvZiB0aGVcbiAqICAgICBiYXRjaCB0aGlzIG11dGF0aW9uIGlzIGEgcGFydCBvZi5cbiAqLyBmdW5jdGlvbiBWbih0LCBlLCBuKSB7XG4gICAgdCBpbnN0YW5jZW9mIENuID8gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBpZiAoIVJuKHQucHJlY29uZGl0aW9uLCBlKSkgXG4gICAgICAgIC8vIFRoZSBtdXRhdGlvbiBmYWlsZWQgdG8gYXBwbHkgKGUuZy4gYSBkb2N1bWVudCBJRCBjcmVhdGVkIHdpdGggYWRkKClcbiAgICAgICAgLy8gY2F1c2VkIGEgbmFtZSBjb2xsaXNpb24pLlxuICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHMgPSB0LnZhbHVlLmNsb25lKCksIGkgPSBNbih0LmZpZWxkVHJhbnNmb3JtcywgbiwgZSk7XG4gICAgICAgIHMuc2V0QWxsKGkpLCBlLmNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoRG4oZSksIHMpLnNldEhhc0xvY2FsTXV0YXRpb25zKCk7XG4gICAgfVxuICAgIC8qKlxuICogQSBtdXRhdGlvbiB0aGF0IG1vZGlmaWVzIGZpZWxkcyBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoIHRoZVxuICogZ2l2ZW4gdmFsdWVzLiBUaGUgdmFsdWVzIGFyZSBhcHBsaWVkIHRocm91Z2ggYSBmaWVsZCBtYXNrOlxuICpcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBib3RoIHRoZSBtYXNrIGFuZCB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZyBmaWVsZFxuICogICAgaXMgdXBkYXRlZC5cbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBuZWl0aGVyIHRoZSBtYXNrIG5vciB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZ1xuICogICAgZmllbGQgaXMgdW5tb2RpZmllZC5cbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiB0aGUgbWFzayBidXQgbm90IGluIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyBkZWxldGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIG5vdCBpbiB0aGUgbWFzayBidXQgaXMgaW4gdGhlIHZhbHVlcywgdGhlIHZhbHVlcyBtYXAgaXNcbiAqICAgIGlnbm9yZWQuXG4gKi8gKHQsIGUsIG4pIDogdCBpbnN0YW5jZW9mIHhuID8gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBpZiAoIVJuKHQucHJlY29uZGl0aW9uLCBlKSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzID0gTW4odC5maWVsZFRyYW5zZm9ybXMsIG4sIGUpLCBpID0gZS5kYXRhO1xuICAgICAgICBpLnNldEFsbChObih0KSksIGkuc2V0QWxsKHMpLCBlLmNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoRG4oZSksIGkpLnNldEhhc0xvY2FsTXV0YXRpb25zKCk7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyBhIEZpZWxkUGF0aC9WYWx1ZSBtYXAgd2l0aCB0aGUgY29udGVudCBvZiB0aGUgUGF0Y2hNdXRhdGlvbi5cbiAqLyAodCwgZSwgbikgOiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIFJuKHQucHJlY29uZGl0aW9uLCBlKSAmJiBcbiAgICAgICAgLy8gV2UgZG9uJ3QgY2FsbCBgc2V0SGFzTG9jYWxNdXRhdGlvbnMoKWAgc2luY2Ugd2Ugd2FudCB0byBiZSBiYWNrd2FyZHNcbiAgICAgICAgLy8gY29tcGF0aWJsZSB3aXRoIHRoZSBleGlzdGluZyBTREsgYmVoYXZpb3IuXG4gICAgICAgIGUuY29udmVydFRvTm9Eb2N1bWVudChjdC5taW4oKSk7XG4gICAgfVxuICAgIC8qKlxuICogQSBtdXRhdGlvbiB0aGF0IHZlcmlmaWVzIHRoZSBleGlzdGVuY2Ugb2YgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aFxuICogdGhlIHByb3ZpZGVkIHByZWNvbmRpdGlvbi5cbiAqXG4gKiBUaGUgYHZlcmlmeWAgb3BlcmF0aW9uIGlzIG9ubHkgdXNlZCBpbiBUcmFuc2FjdGlvbnMsIGFuZCB0aGlzIGNsYXNzIHNlcnZlc1xuICogcHJpbWFyaWx5IHRvIGZhY2lsaXRhdGUgc2VyaWFsaXphdGlvbiBpbnRvIHByb3Rvcy5cbiAqLyAodCwgZSk7XG59XG5cbi8qKlxuICogSWYgdGhpcyBtdXRhdGlvbiBpcyBub3QgaWRlbXBvdGVudCwgcmV0dXJucyB0aGUgYmFzZSB2YWx1ZSB0byBwZXJzaXN0IHdpdGhcbiAqIHRoaXMgbXV0YXRpb24uIElmIGEgYmFzZSB2YWx1ZSBpcyByZXR1cm5lZCwgdGhlIG11dGF0aW9uIGlzIGFsd2F5cyBhcHBsaWVkXG4gKiB0byB0aGlzIGJhc2UgdmFsdWUsIGV2ZW4gaWYgZG9jdW1lbnQgaGFzIGFscmVhZHkgYmVlbiB1cGRhdGVkLlxuICpcbiAqIFRoZSBiYXNlIHZhbHVlIGlzIGEgc3BhcnNlIG9iamVjdCB0aGF0IGNvbnNpc3RzIG9mIG9ubHkgdGhlIGRvY3VtZW50XG4gKiBmaWVsZHMgZm9yIHdoaWNoIHRoaXMgbXV0YXRpb24gY29udGFpbnMgYSBub24taWRlbXBvdGVudCB0cmFuc2Zvcm1hdGlvblxuICogKGUuZy4gYSBudW1lcmljIGluY3JlbWVudCkuIFRoZSBwcm92aWRlZCB2YWx1ZSBndWFyYW50ZWVzIGNvbnNpc3RlbnRcbiAqIGJlaGF2aW9yIGZvciBub24taWRlbXBvdGVudCB0cmFuc2Zvcm1zIGFuZCBhbGxvdyB1cyB0byByZXR1cm4gdGhlIHNhbWVcbiAqIGxhdGVuY3ktY29tcGVuc2F0ZWQgdmFsdWUgZXZlbiBpZiB0aGUgYmFja2VuZCBoYXMgYWxyZWFkeSBhcHBsaWVkIHRoZVxuICogbXV0YXRpb24uIFRoZSBiYXNlIHZhbHVlIGlzIG51bGwgZm9yIGlkZW1wb3RlbnQgbXV0YXRpb25zLCBhcyB0aGV5IGNhbiBiZVxuICogcmUtcGxheWVkIGV2ZW4gaWYgdGhlIGJhY2tlbmQgaGFzIGFscmVhZHkgYXBwbGllZCB0aGVtLlxuICpcbiAqIEByZXR1cm5zIGEgYmFzZSB2YWx1ZSB0byBzdG9yZSBhbG9uZyB3aXRoIHRoZSBtdXRhdGlvbiwgb3IgbnVsbCBmb3JcbiAqIGlkZW1wb3RlbnQgbXV0YXRpb25zLlxuICovIGZ1bmN0aW9uIHZuKHQsIGUpIHtcbiAgICBsZXQgbiA9IG51bGw7XG4gICAgZm9yIChjb25zdCBzIG9mIHQuZmllbGRUcmFuc2Zvcm1zKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmRhdGEuZmllbGQocy5maWVsZCksIGkgPSBsbihzLnRyYW5zZm9ybSwgdCB8fCBudWxsKTtcbiAgICAgICAgbnVsbCAhPSBpICYmIChudWxsID09IG4gJiYgKG4gPSB0ZS5lbXB0eSgpKSwgbi5zZXQocy5maWVsZCwgaSkpO1xuICAgIH1cbiAgICByZXR1cm4gbiB8fCBudWxsO1xufVxuXG5mdW5jdGlvbiBTbih0LCBlKSB7XG4gICAgcmV0dXJuIHQudHlwZSA9PT0gZS50eXBlICYmICghIXQua2V5LmlzRXF1YWwoZS5rZXkpICYmICghIXQucHJlY29uZGl0aW9uLmlzRXF1YWwoZS5wcmVjb25kaXRpb24pICYmICghIWZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gdCAmJiB2b2lkIDAgPT09IGUgfHwgISghdCB8fCAhZSkgJiYgb3QodCwgZSwgKCh0LCBlKSA9PiBUbih0LCBlKSkpO1xuICAgIH0odC5maWVsZFRyYW5zZm9ybXMsIGUuZmllbGRUcmFuc2Zvcm1zKSAmJiAoMCAvKiBTZXQgKi8gPT09IHQudHlwZSA/IHQudmFsdWUuaXNFcXVhbChlLnZhbHVlKSA6IDEgLyogUGF0Y2ggKi8gIT09IHQudHlwZSB8fCB0LmRhdGEuaXNFcXVhbChlLmRhdGEpICYmIHQuZmllbGRNYXNrLmlzRXF1YWwoZS5maWVsZE1hc2spKSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIGZyb20gdGhlIGdpdmVuIGRvY3VtZW50IGZvciB1c2UgYXMgdGhlIHJlc3VsdCBvZiBhXG4gKiBtdXRhdGlvbi4gTXV0YXRpb25zIGFyZSBkZWZpbmVkIHRvIHJldHVybiB0aGUgdmVyc2lvbiBvZiB0aGUgYmFzZSBkb2N1bWVudFxuICogb25seSBpZiBpdCBpcyBhbiBleGlzdGluZyBkb2N1bWVudC4gRGVsZXRlZCBhbmQgdW5rbm93biBkb2N1bWVudHMgaGF2ZSBhXG4gKiBwb3N0LW11dGF0aW9uIHZlcnNpb24gb2YgU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICovIGZ1bmN0aW9uIERuKHQpIHtcbiAgICByZXR1cm4gdC5pc0ZvdW5kRG9jdW1lbnQoKSA/IHQudmVyc2lvbiA6IGN0Lm1pbigpO1xufVxuXG4vKipcbiAqIEEgbXV0YXRpb24gdGhhdCBjcmVhdGVzIG9yIHJlcGxhY2VzIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBvYmplY3QgdmFsdWUgY29udGVudHMuXG4gKi8gY2xhc3MgQ24gZXh0ZW5kcyBibiB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcyA9IFtdKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMua2V5ID0gdCwgdGhpcy52YWx1ZSA9IGUsIHRoaXMucHJlY29uZGl0aW9uID0gbiwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBzLCBcbiAgICAgICAgdGhpcy50eXBlID0gMCAvKiBTZXQgKi87XG4gICAgfVxufVxuXG5jbGFzcyB4biBleHRlbmRzIGJuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpID0gW10pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLmRhdGEgPSBlLCB0aGlzLmZpZWxkTWFzayA9IG4sIHRoaXMucHJlY29uZGl0aW9uID0gcywgXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gaSwgdGhpcy50eXBlID0gMSAvKiBQYXRjaCAqLztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIE5uKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IE1hcDtcbiAgICByZXR1cm4gdC5maWVsZE1hc2suZmllbGRzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICBpZiAoIW4uaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdC5kYXRhLmZpZWxkKG4pO1xuICAgICAgICAgICAgZS5zZXQobiwgcyk7XG4gICAgICAgIH1cbiAgICB9KSksIGU7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2UgYWZ0ZXIgYSBtdXRhdGlvblxuICogY29udGFpbmluZyB0cmFuc2Zvcm1zIGhhcyBiZWVuIGFja25vd2xlZGdlZCBieSB0aGUgc2VydmVyLlxuICpcbiAqIEBwYXJhbSBmaWVsZFRyYW5zZm9ybXMgLSBUaGUgZmllbGQgdHJhbnNmb3JtcyB0byBhcHBseSB0aGUgcmVzdWx0IHRvLlxuICogQHBhcmFtIG11dGFibGVEb2N1bWVudCAtIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBkb2N1bWVudCBhZnRlciBhcHBseWluZyBhbGxcbiAqIHByZXZpb3VzIG11dGF0aW9ucy5cbiAqIEBwYXJhbSBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzIC0gVGhlIHRyYW5zZm9ybSByZXN1bHRzIHJlY2VpdmVkIGJ5IHRoZSBzZXJ2ZXIuXG4gKiBAcmV0dXJucyBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cbiAqLyBmdW5jdGlvbiBrbih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IG5ldyBNYXA7XG4gICAgVSh0Lmxlbmd0aCA9PT0gbi5sZW5ndGgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByID0gdFtpXSwgbyA9IHIudHJhbnNmb3JtLCB1ID0gZS5kYXRhLmZpZWxkKHIuZmllbGQpO1xuICAgICAgICBzLnNldChyLmZpZWxkLCBobihvLCB1LCBuW2ldKSk7XG4gICAgfVxuICAgIHJldHVybiBzO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBsaXN0IG9mIFwidHJhbnNmb3JtIHJlc3VsdHNcIiAoYSB0cmFuc2Zvcm0gcmVzdWx0IGlzIGEgZmllbGQgdmFsdWVcbiAqIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgdHJhbnNmb3JtKSBmb3IgdXNlIHdoZW4gYXBwbHlpbmcgYVxuICogdHJhbnNmb3JtIGxvY2FsbHkuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBUaGUgbG9jYWwgdGltZSBvZiB0aGUgbXV0YXRpb24gKHVzZWQgdG9cbiAqICAgICBnZW5lcmF0ZSBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMpLlxuICogQHBhcmFtIG11dGFibGVEb2N1bWVudCAtIFRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBkb2N1bWVudCBhZnRlciBhcHBseWluZyBhbGxcbiAqICAgICBwcmV2aW91cyBtdXRhdGlvbnMuXG4gKiBAcmV0dXJucyBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cbiAqLyBmdW5jdGlvbiBNbih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IG5ldyBNYXA7XG4gICAgZm9yIChjb25zdCBpIG9mIHQpIHtcbiAgICAgICAgY29uc3QgdCA9IGkudHJhbnNmb3JtLCByID0gbi5kYXRhLmZpZWxkKGkuZmllbGQpO1xuICAgICAgICBzLnNldChpLmZpZWxkLCBjbih0LCByLCBlKSk7XG4gICAgfVxuICAgIHJldHVybiBzO1xufVxuXG4vKiogQSBtdXRhdGlvbiB0aGF0IGRlbGV0ZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkuICovIGNsYXNzIE9uIGV4dGVuZHMgYm4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IGUsIHRoaXMudHlwZSA9IDIgLyogRGVsZXRlICovICwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBbXTtcbiAgICB9XG59XG5cbmNsYXNzIEZuIGV4dGVuZHMgYm4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IGUsIHRoaXMudHlwZSA9IDMgLyogVmVyaWZ5ICovICwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBbXTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzICRuIHtcbiAgICAvLyBUT0RPKGIvMzMwNzgxNjMpOiBqdXN0IHVzZSBzaW1wbGVzdCBmb3JtIG9mIGV4aXN0ZW5jZSBmaWx0ZXIgZm9yIG5vd1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5jb3VudCA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFcnJvciBDb2RlcyBkZXNjcmliaW5nIHRoZSBkaWZmZXJlbnQgd2F5cyBHUlBDIGNhbiBmYWlsLiBUaGVzZSBhcmUgY29waWVkXG4gKiBkaXJlY3RseSBmcm9tIEdSUEMncyBzb3VyY2VzIGhlcmU6XG4gKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAqXG4gKiBJbXBvcnRhbnQhIFRoZSBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBtYXR0ZXIgYmVjYXVzZSB0aGUgc3RyaW5nIGZvcm1zXG4gKiBhcmUgdXNlZCBmb3IgcmV2ZXJzZSBsb29rdXBzIGZyb20gdGhlIHdlYmNoYW5uZWwgc3RyZWFtLiBEbyBOT1QgY2hhbmdlIHRoZVxuICogbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMgb3IgY2hhbmdlIHRoaXMgaW50byBhIGNvbnN0IGVudW0uXG4gKi8gdmFyIEJuLCBMbjtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgbm9uLXdyaXRlIG9wZXJhdGlvbi5cbiAqXG4gKiBTZWUgaXNQZXJtYW5lbnRXcml0ZUVycm9yIGZvciBjbGFzc2lmeWluZyB3cml0ZSBlcnJvcnMuXG4gKi9cbmZ1bmN0aW9uIFVuKHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBMKCk7XG5cbiAgICAgIGNhc2UgRy5DQU5DRUxMRUQ6XG4gICAgICBjYXNlIEcuVU5LTk9XTjpcbiAgICAgIGNhc2UgRy5ERUFETElORV9FWENFRURFRDpcbiAgICAgIGNhc2UgRy5SRVNPVVJDRV9FWEhBVVNURUQ6XG4gICAgICBjYXNlIEcuSU5URVJOQUw6XG4gICAgICBjYXNlIEcuVU5BVkFJTEFCTEU6XG4gLy8gVW5hdXRoZW50aWNhdGVkIG1lYW5zIHNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggb3VyIHRva2VuIGFuZCB3ZSBuZWVkXG4gICAgICAgIC8vIHRvIHJldHJ5IHdpdGggbmV3IGNyZWRlbnRpYWxzIHdoaWNoIHdpbGwgaGFwcGVuIGF1dG9tYXRpY2FsbHkuXG4gICAgICAgICAgICAgIGNhc2UgRy5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiAhMTtcblxuICAgICAgY2FzZSBHLklOVkFMSURfQVJHVU1FTlQ6XG4gICAgICBjYXNlIEcuTk9UX0ZPVU5EOlxuICAgICAgY2FzZSBHLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgY2FzZSBHLlBFUk1JU1NJT05fREVOSUVEOlxuICAgICAgY2FzZSBHLkZBSUxFRF9QUkVDT05ESVRJT046XG4gLy8gQWJvcnRlZCBtaWdodCBiZSByZXRyaWVkIGluIHNvbWUgc2NlbmFyaW9zLCBidXQgdGhhdCBpcyBkZXBlbmRhbnQgb25cbiAgICAgICAgLy8gdGhlIGNvbnRleHQgYW5kIHNob3VsZCBoYW5kbGVkIGluZGl2aWR1YWxseSBieSB0aGUgY2FsbGluZyBjb2RlLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2FwaXMvZGVzaWduL2Vycm9ycy5cbiAgICAgICAgICAgICAgY2FzZSBHLkFCT1JURUQ6XG4gICAgICBjYXNlIEcuT1VUX09GX1JBTkdFOlxuICAgICAgY2FzZSBHLlVOSU1QTEVNRU5URUQ6XG4gICAgICBjYXNlIEcuREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBlcnJvciBjb2RlIHJlcHJlc2VudHMgYSBwZXJtYW5lbnQgZXJyb3Igd2hlbiByZWNlaXZlZFxuICogaW4gcmVzcG9uc2UgdG8gYSB3cml0ZSBvcGVyYXRpb24uXG4gKlxuICogV3JpdGUgb3BlcmF0aW9ucyBtdXN0IGJlIGhhbmRsZWQgc3BlY2lhbGx5IGJlY2F1c2UgYXMgb2YgYi8xMTk0Mzc3NjQsIEFCT1JURURcbiAqIGVycm9ycyBvbiB0aGUgd3JpdGUgc3RyZWFtIHNob3VsZCBiZSByZXRyaWVkIHRvbyAoZXZlbiB0aG91Z2ggQUJPUlRFRCBlcnJvcnNcbiAqIGFyZSBub3QgZ2VuZXJhbGx5IHJldHJ5YWJsZSkuXG4gKlxuICogTm90ZSB0aGF0IGR1cmluZyB0aGUgaW5pdGlhbCBoYW5kc2hha2Ugb24gdGhlIHdyaXRlIHN0cmVhbSBhbiBBQk9SVEVEIGVycm9yXG4gKiBzaWduYWxzIHRoYXQgd2Ugc2hvdWxkIGRpc2NhcmQgb3VyIHN0cmVhbSB0b2tlbiAoaS5lLiBpdCBpcyBwZXJtYW5lbnQpLiBUaGlzXG4gKiBtZWFucyBhIGhhbmRzaGFrZSBlcnJvciBzaG91bGQgYmUgY2xhc3NpZmllZCB3aXRoIGlzUGVybWFuZW50RXJyb3IsIGFib3ZlLlxuICovXG4vKipcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIEdSUEMgc3RhdHVzIGNvZGUgbnVtYmVyLCBsaWtlIDAsIDEsIG9yIDE0LiBUaGVzZVxuICogYXJlIG5vdCB0aGUgc2FtZSBhcyBIVFRQIHN0YXR1cyBjb2Rlcy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBHUlBDIHN0YXR1cyBjb2RlLiBGYWlscyBpZiB0aGVyZVxuICogICAgIGlzIG5vIG1hdGNoLlxuICovXG5mdW5jdGlvbiBxbih0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgXG4gICAgLy8gVGhpcyBzaG91bGRuJ3Qgbm9ybWFsbHkgaGFwcGVuLCBidXQgaW4gY2VydGFpbiBlcnJvciBjYXNlcyAobGlrZSB0cnlpbmdcbiAgICAvLyB0byBzZW5kIGludmFsaWQgcHJvdG8gbWVzc2FnZXMpIHdlIG1heSBnZXQgYW4gZXJyb3Igd2l0aCBubyBHUlBDIGNvZGUuXG4gICAgcmV0dXJuIEYoXCJHUlBDIGVycm9yIGhhcyBubyAuY29kZVwiKSwgRy5VTktOT1dOO1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSBCbi5PSzpcbiAgICAgICAgcmV0dXJuIEcuT0s7XG5cbiAgICAgIGNhc2UgQm4uQ0FOQ0VMTEVEOlxuICAgICAgICByZXR1cm4gRy5DQU5DRUxMRUQ7XG5cbiAgICAgIGNhc2UgQm4uVU5LTk9XTjpcbiAgICAgICAgcmV0dXJuIEcuVU5LTk9XTjtcblxuICAgICAgY2FzZSBCbi5ERUFETElORV9FWENFRURFRDpcbiAgICAgICAgcmV0dXJuIEcuREVBRExJTkVfRVhDRUVERUQ7XG5cbiAgICAgIGNhc2UgQm4uUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgICByZXR1cm4gRy5SRVNPVVJDRV9FWEhBVVNURUQ7XG5cbiAgICAgIGNhc2UgQm4uSU5URVJOQUw6XG4gICAgICAgIHJldHVybiBHLklOVEVSTkFMO1xuXG4gICAgICBjYXNlIEJuLlVOQVZBSUxBQkxFOlxuICAgICAgICByZXR1cm4gRy5VTkFWQUlMQUJMRTtcblxuICAgICAgY2FzZSBCbi5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiBHLlVOQVVUSEVOVElDQVRFRDtcblxuICAgICAgY2FzZSBCbi5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgICByZXR1cm4gRy5JTlZBTElEX0FSR1VNRU5UO1xuXG4gICAgICBjYXNlIEJuLk5PVF9GT1VORDpcbiAgICAgICAgcmV0dXJuIEcuTk9UX0ZPVU5EO1xuXG4gICAgICBjYXNlIEJuLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgICByZXR1cm4gRy5BTFJFQURZX0VYSVNUUztcblxuICAgICAgY2FzZSBCbi5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgICAgcmV0dXJuIEcuUEVSTUlTU0lPTl9ERU5JRUQ7XG5cbiAgICAgIGNhc2UgQm4uRkFJTEVEX1BSRUNPTkRJVElPTjpcbiAgICAgICAgcmV0dXJuIEcuRkFJTEVEX1BSRUNPTkRJVElPTjtcblxuICAgICAgY2FzZSBCbi5BQk9SVEVEOlxuICAgICAgICByZXR1cm4gRy5BQk9SVEVEO1xuXG4gICAgICBjYXNlIEJuLk9VVF9PRl9SQU5HRTpcbiAgICAgICAgcmV0dXJuIEcuT1VUX09GX1JBTkdFO1xuXG4gICAgICBjYXNlIEJuLlVOSU1QTEVNRU5URUQ6XG4gICAgICAgIHJldHVybiBHLlVOSU1QTEVNRU5URUQ7XG5cbiAgICAgIGNhc2UgQm4uREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gRy5EQVRBX0xPU1M7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBMKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIEhUVFAgcmVzcG9uc2UncyBlcnJvciBzdGF0dXMgdG8gdGhlIGVxdWl2YWxlbnQgZXJyb3IgY29kZS5cbiAqXG4gKiBAcGFyYW0gc3RhdHVzIC0gQW4gSFRUUCBlcnJvciByZXNwb25zZSBzdGF0dXMgKFwiRkFJTEVEX1BSRUNPTkRJVElPTlwiLFxuICogXCJVTktOT1dOXCIsIGV0Yy4pXG4gKiBAcmV0dXJucyBUaGUgZXF1aXZhbGVudCBDb2RlLiBOb24tbWF0Y2hpbmcgcmVzcG9uc2VzIGFyZSBtYXBwZWQgdG9cbiAqICAgICBDb2RlLlVOS05PV04uXG4gKi8gKExuID0gQm4gfHwgKEJuID0ge30pKVtMbi5PSyA9IDBdID0gXCJPS1wiLCBMbltMbi5DQU5DRUxMRUQgPSAxXSA9IFwiQ0FOQ0VMTEVEXCIsIFxuTG5bTG4uVU5LTk9XTiA9IDJdID0gXCJVTktOT1dOXCIsIExuW0xuLklOVkFMSURfQVJHVU1FTlQgPSAzXSA9IFwiSU5WQUxJRF9BUkdVTUVOVFwiLCBcbkxuW0xuLkRFQURMSU5FX0VYQ0VFREVEID0gNF0gPSBcIkRFQURMSU5FX0VYQ0VFREVEXCIsIExuW0xuLk5PVF9GT1VORCA9IDVdID0gXCJOT1RfRk9VTkRcIiwgXG5MbltMbi5BTFJFQURZX0VYSVNUUyA9IDZdID0gXCJBTFJFQURZX0VYSVNUU1wiLCBMbltMbi5QRVJNSVNTSU9OX0RFTklFRCA9IDddID0gXCJQRVJNSVNTSU9OX0RFTklFRFwiLCBcbkxuW0xuLlVOQVVUSEVOVElDQVRFRCA9IDE2XSA9IFwiVU5BVVRIRU5USUNBVEVEXCIsIExuW0xuLlJFU09VUkNFX0VYSEFVU1RFRCA9IDhdID0gXCJSRVNPVVJDRV9FWEhBVVNURURcIiwgXG5MbltMbi5GQUlMRURfUFJFQ09ORElUSU9OID0gOV0gPSBcIkZBSUxFRF9QUkVDT05ESVRJT05cIiwgTG5bTG4uQUJPUlRFRCA9IDEwXSA9IFwiQUJPUlRFRFwiLCBcbkxuW0xuLk9VVF9PRl9SQU5HRSA9IDExXSA9IFwiT1VUX09GX1JBTkdFXCIsIExuW0xuLlVOSU1QTEVNRU5URUQgPSAxMl0gPSBcIlVOSU1QTEVNRU5URURcIiwgXG5MbltMbi5JTlRFUk5BTCA9IDEzXSA9IFwiSU5URVJOQUxcIiwgTG5bTG4uVU5BVkFJTEFCTEUgPSAxNF0gPSBcIlVOQVZBSUxBQkxFXCIsIExuW0xuLkRBVEFfTE9TUyA9IDE1XSA9IFwiREFUQV9MT1NTXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgbWFwIGltcGxlbWVudGF0aW9uIHRoYXQgdXNlcyBvYmplY3RzIGFzIGtleXMuIE9iamVjdHMgbXVzdCBoYXZlIGFuXG4gKiBhc3NvY2lhdGVkIGVxdWFscyBmdW5jdGlvbiBhbmQgbXVzdCBiZSBpbW11dGFibGUuIEVudHJpZXMgaW4gdGhlIG1hcCBhcmVcbiAqIHN0b3JlZCB0b2dldGhlciB3aXRoIHRoZSBrZXkgYmVpbmcgcHJvZHVjZWQgZnJvbSB0aGUgbWFwS2V5Rm4uIFRoaXMgbWFwXG4gKiBhdXRvbWF0aWNhbGx5IGhhbmRsZXMgY29sbGlzaW9ucyBvZiBrZXlzLlxuICovXG5jbGFzcyBLbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLm1hcEtleUZuID0gdCwgdGhpcy5lcXVhbHNGbiA9IGUsIFxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGlubmVyIG1hcCBmb3IgYSBrZXkvdmFsdWUgcGFpci4gRHVlIHRvIHRoZSBwb3NzaWJpbGl0eSBvZiBjb2xsaXNpb25zIHdlXG4gICAgICAgICAqIGtlZXAgYSBsaXN0IG9mIGVudHJpZXMgdGhhdCB3ZSBkbyBhIGxpbmVhciBzZWFyY2ggdGhyb3VnaCB0byBmaW5kIGFuIGFjdHVhbFxuICAgICAgICAgKiBtYXRjaC4gTm90ZSB0aGF0IGNvbGxpc2lvbnMgc2hvdWxkIGJlIHJhcmUsIHNvIHdlIHN0aWxsIGV4cGVjdCBuZWFyXG4gICAgICAgICAqIGNvbnN0YW50IHRpbWUgbG9va3VwcyBpbiBwcmFjdGljZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaW5uZXIgPSB7fSwgXG4gICAgICAgIC8qKiBUaGUgbnVtYmVyIG9mIGVudHJpZXMgc3RvcmVkIGluIHRoZSBtYXAgKi9cbiAgICAgICAgdGhpcy5pbm5lclNpemUgPSAwO1xuICAgIH1cbiAgICAvKiogR2V0IGEgdmFsdWUgZm9yIHRoaXMga2V5LCBvciB1bmRlZmluZWQgaWYgaXQgZG9lcyBub3QgZXhpc3QuICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLm1hcEtleUZuKHQpLCBuID0gdGhpcy5pbm5lcltlXTtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gbikgZm9yIChjb25zdCBbZSwgc10gb2YgbikgaWYgKHRoaXMuZXF1YWxzRm4oZSwgdCkpIHJldHVybiBzO1xuICAgIH1cbiAgICBoYXModCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLmdldCh0KTtcbiAgICB9XG4gICAgLyoqIFB1dCB0aGlzIGtleSBhbmQgdmFsdWUgaW4gdGhlIG1hcC4gKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMubWFwS2V5Rm4odCksIHMgPSB0aGlzLmlubmVyW25dO1xuICAgICAgICBpZiAodm9pZCAwID09PSBzKSByZXR1cm4gdGhpcy5pbm5lcltuXSA9IFsgWyB0LCBlIF0gXSwgdm9pZCB0aGlzLmlubmVyU2l6ZSsrO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHMubGVuZ3RoOyBuKyspIGlmICh0aGlzLmVxdWFsc0ZuKHNbbl1bMF0sIHQpKSBcbiAgICAgICAgLy8gVGhpcyBpcyB1cGRhdGluZyBhbiBleGlzdGluZyBlbnRyeSBhbmQgZG9lcyBub3QgaW5jcmVhc2UgYGlubmVyU2l6ZWAuXG4gICAgICAgIHJldHVybiB2b2lkIChzW25dID0gWyB0LCBlIF0pO1xuICAgICAgICBzLnB1c2goWyB0LCBlIF0pLCB0aGlzLmlubmVyU2l6ZSsrO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhpcyBrZXkgZnJvbSB0aGUgbWFwLiBSZXR1cm5zIGEgYm9vbGVhbiBpZiBhbnl0aGluZyB3YXMgZGVsZXRlZC5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwS2V5Rm4odCksIG4gPSB0aGlzLmlubmVyW2VdO1xuICAgICAgICBpZiAodm9pZCAwID09PSBuKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IHMgPSAwOyBzIDwgbi5sZW5ndGg7IHMrKykgaWYgKHRoaXMuZXF1YWxzRm4obltzXVswXSwgdCkpIHJldHVybiAxID09PSBuLmxlbmd0aCA/IGRlbGV0ZSB0aGlzLmlubmVyW2VdIDogbi5zcGxpY2UocywgMSksIFxuICAgICAgICB0aGlzLmlubmVyU2l6ZS0tLCAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgbHQodGhpcy5pbm5lciwgKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtlLCBzXSBvZiBuKSB0KGUsIHMpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlzRW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBmdCh0aGlzLmlubmVyKTtcbiAgICB9XG4gICAgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5uZXJTaXplO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgR24gPSBuZXcgZmUoeHQuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIFFuKCkge1xuICAgIHJldHVybiBHbjtcbn1cblxuY29uc3Qgam4gPSBuZXcgZmUoeHQuY29tcGFyYXRvcik7XG5cbmZ1bmN0aW9uIFduKC4uLnQpIHtcbiAgICBsZXQgZSA9IGpuO1xuICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5pbnNlcnQobi5rZXksIG4pO1xuICAgIHJldHVybiBlO1xufVxuXG5mdW5jdGlvbiB6bigpIHtcbiAgICByZXR1cm4gbmV3IEtuKCh0ID0+IHQudG9TdHJpbmcoKSksICgodCwgZSkgPT4gdC5pc0VxdWFsKGUpKSk7XG59XG5cbmNvbnN0IEhuID0gbmV3IGZlKHh0LmNvbXBhcmF0b3IpO1xuXG5jb25zdCBKbiA9IG5ldyB3ZSh4dC5jb21wYXJhdG9yKTtcblxuZnVuY3Rpb24gWW4oLi4udCkge1xuICAgIGxldCBlID0gSm47XG4gICAgZm9yIChjb25zdCBuIG9mIHQpIGUgPSBlLmFkZChuKTtcbiAgICByZXR1cm4gZTtcbn1cblxuY29uc3QgWG4gPSBuZXcgd2UocnQpO1xuXG5mdW5jdGlvbiBabigpIHtcbiAgICByZXR1cm4gWG47XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGV2ZW50IGZyb20gdGhlIFJlbW90ZVN0b3JlLiBJdCBpcyBzcGxpdCBpbnRvIHRhcmdldENoYW5nZXMgKGNoYW5nZXMgdG8gdGhlXG4gKiBzdGF0ZSBvciB0aGUgc2V0IG9mIGRvY3VtZW50cyBpbiBvdXIgd2F0Y2hlZCB0YXJnZXRzKSBhbmQgZG9jdW1lbnRVcGRhdGVzXG4gKiAoY2hhbmdlcyB0byB0aGUgYWN0dWFsIGRvY3VtZW50cykuXG4gKi8gY2xhc3MgdHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoaXMgZXZlbnQgYnJpbmdzIHVzIHVwIHRvLCBvciBNSU4gaWYgbm90IHNldC5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIG1hcCBmcm9tIHRhcmdldCB0byBjaGFuZ2VzIHRvIHRoZSB0YXJnZXQuIFNlZSBUYXJnZXRDaGFuZ2UuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2YgdGFyZ2V0cyB0aGF0IGlzIGtub3duIHRvIGJlIGluY29uc2lzdGVudC4gTGlzdGVucyBmb3IgdGhlc2VcbiAgICAgKiB0YXJnZXRzIHNob3VsZCBiZSByZS1lc3RhYmxpc2hlZCB3aXRob3V0IHJlc3VtZSB0b2tlbnMuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnRzIGhhdmUgY2hhbmdlZCBvciBiZWVuIGRlbGV0ZWQsIGFsb25nIHdpdGggdGhlXG4gICAgICogZG9jJ3MgbmV3IHZhbHVlcyAoaWYgbm90IGRlbGV0ZWQpLlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIEEgc2V0IG9mIHdoaWNoIGRvY3VtZW50IHVwZGF0ZXMgYXJlIGR1ZSBvbmx5IHRvIGxpbWJvIHJlc29sdXRpb24gdGFyZ2V0cy5cbiAgICAgKi9cbiAgICBpKSB7XG4gICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uID0gdCwgdGhpcy50YXJnZXRDaGFuZ2VzID0gZSwgdGhpcy50YXJnZXRNaXNtYXRjaGVzID0gbiwgdGhpcy5kb2N1bWVudFVwZGF0ZXMgPSBzLCBcbiAgICAgICAgdGhpcy5yZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSEFDSzogVmlld3MgcmVxdWlyZSBSZW1vdGVFdmVudHMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHZpZXcgaXNcbiAgICAgKiBDVVJSRU5ULCBidXQgc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgcmVjZWl2ZSByZW1vdGUgZXZlbnRzLiBTbyB0aGlzIG1ldGhvZCBpc1xuICAgICAqIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBhXG4gICAgICogQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldywgZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnQgdGFiLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBzdGF0aWMgY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIG4uc2V0KHQsIGVzLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlKSksIG5ldyB0cyhjdC5taW4oKSwgbiwgWm4oKSwgUW4oKSwgWW4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgVGFyZ2V0Q2hhbmdlIHNwZWNpZmllcyB0aGUgc2V0IG9mIGNoYW5nZXMgZm9yIGEgc3BlY2lmaWMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAqIGEgUmVtb3RlRXZlbnQuIFRoZXNlIGNoYW5nZXMgdHJhY2sgd2hpY2ggZG9jdW1lbnRzIGFyZSBhZGRlZCwgbW9kaWZpZWQgb3JcbiAqIHJlbW92ZWQsIGFzIHdlbGwgYXMgdGhlIHRhcmdldCdzIHJlc3VtZSB0b2tlbiBhbmQgd2hldGhlciB0aGUgdGFyZ2V0IGlzXG4gKiBtYXJrZWQgQ1VSUkVOVC5cbiAqIFRoZSBhY3R1YWwgY2hhbmdlcyAqdG8qIGRvY3VtZW50cyBhcmUgbm90IHBhcnQgb2YgdGhlIFRhcmdldENoYW5nZSBzaW5jZVxuICogZG9jdW1lbnRzIG1heSBiZSBwYXJ0IG9mIG11bHRpcGxlIHRhcmdldHMuXG4gKi8gY2xhc3MgZXMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmUgcmVzdW1lZFxuICAgICAqIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdCBtYXRjaGVzIHRoZVxuICAgICAqIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2hcbiAgICAgKiB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBcImN1cnJlbnRcIiAoc3luY2VkKSBzdGF0dXMgb2YgdGhpcyB0YXJnZXQuIE5vdGUgdGhhdCBcImN1cnJlbnRcIlxuICAgICAqIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbCB0aGF0IGltcGxpZXMgdGhhdCBhIHRhcmdldCBpc1xuICAgICAqIGJvdGggdXAtdG8tZGF0ZSBhbmQgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaCBzdHJlYW0uXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIG5ld2x5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAgICAgKiB0aGlzIHJlbW90ZSBldmVudC5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgYWxyZWFkeSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBidXQgcmVjZWl2ZWRcbiAgICAgKiBhbiB1cGRhdGUgZHVyaW5nIHRoaXMgcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSByZW1vdmVkIGZyb20gdGhpcyB0YXJnZXQgYXMgcGFydCBvZiB0aGlzXG4gICAgICogcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHQsIHRoaXMuY3VycmVudCA9IGUsIHRoaXMuYWRkZWREb2N1bWVudHMgPSBuLCB0aGlzLm1vZGlmaWVkRG9jdW1lbnRzID0gcywgXG4gICAgICAgIHRoaXMucmVtb3ZlZERvY3VtZW50cyA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgVGFyZ2V0Q2hhbmdlcyB0aGF0IGNhbiBiZSB1c2VkIHRvXG4gICAgICogYXBwbHkgYSBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3IChmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudFxuICAgICAqIHRhYikgb3IgZm9yIG5ldyBxdWVyaWVzICh0byByYWlzZSBzbmFwc2hvdHMgd2l0aCBjb3JyZWN0IENVUlJFTlQgc3RhdHVzKS5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgZXMocHQuRU1QVFlfQllURV9TVFJJTkcsIGUsIFluKCksIFluKCksIFluKCkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGNoYW5nZWQgZG9jdW1lbnQgYW5kIGEgbGlzdCBvZiB0YXJnZXQgaWRzIHRvIHdoaWNoIHRoaXMgY2hhbmdlXG4gKiBhcHBsaWVzLlxuICpcbiAqIElmIGRvY3VtZW50IGhhcyBiZWVuIGRlbGV0ZWQgTm9Eb2N1bWVudCB3aWxsIGJlIHByb3ZpZGVkLlxuICovIGNsYXNzIG5zIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIG5ldyBkb2N1bWVudCBhcHBsaWVzIHRvIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGlzIHJlbW92ZWQgZnJvbSBhbGwgb2YgdGhlc2UgdGFyZ2V0cy4gKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIGtleSBvZiB0aGUgZG9jdW1lbnQgZm9yIHRoaXMgY2hhbmdlLiAqL1xuICAgIG4sIFxuICAgIC8qKlxuICAgICAqIFRoZSBuZXcgZG9jdW1lbnQgb3IgTm9Eb2N1bWVudCBpZiBpdCB3YXMgZGVsZXRlZC4gSXMgbnVsbCBpZiB0aGVcbiAgICAgKiBkb2N1bWVudCB3ZW50IG91dCBvZiB2aWV3IHdpdGhvdXQgdGhlIHNlcnZlciBzZW5kaW5nIGEgbmV3IGRvY3VtZW50LlxuICAgICAqL1xuICAgIHMpIHtcbiAgICAgICAgdGhpcy5PID0gdCwgdGhpcy5yZW1vdmVkVGFyZ2V0SWRzID0gZSwgdGhpcy5rZXkgPSBuLCB0aGlzLkYgPSBzO1xuICAgIH1cbn1cblxuY2xhc3Mgc3Mge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMuJCA9IGU7XG4gICAgfVxufVxuXG5jbGFzcyBpcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFdoYXQga2luZCBvZiBjaGFuZ2Ugb2NjdXJyZWQgdG8gdGhlIHdhdGNoIHRhcmdldC4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIHRhcmdldCBJRHMgdGhhdCB3ZXJlIGFkZGVkL3JlbW92ZWQvc2V0LiAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgdGFyZ2V0IHRvIGJlXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhIHRoYXRcbiAgICAgKiBtYXRjaGVzIHRoZSB0YXJnZXQuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluXG4gICAgICogdGltZSBmcm9tIHdoaWNoIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXG4gICAgICovXG4gICAgbiA9IHB0LkVNUFRZX0JZVEVfU1RSSU5HXG4gICAgLyoqIEFuIFJQQyBlcnJvciBpbmRpY2F0aW5nIHdoeSB0aGUgd2F0Y2ggZmFpbGVkLiAqLyAsIHMgPSBudWxsKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB0LCB0aGlzLnRhcmdldElkcyA9IGUsIHRoaXMucmVzdW1lVG9rZW4gPSBuLCB0aGlzLmNhdXNlID0gcztcbiAgICB9XG59XG5cbi8qKiBUcmFja3MgdGhlIGludGVybmFsIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0LiAqLyBjbGFzcyBycyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIChhZGRzIG9yIHJlbW92ZXMpIHRoYXQgd2UgYXJlIHdhaXRpbmcgb24uXG4gICAgICAgICAqIFdlIG9ubHkgY29uc2lkZXIgdGFyZ2V0cyBhY3RpdmUgdGhhdCBoYXZlIG5vIHBlbmRpbmcgcmVzcG9uc2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5CID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnQgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZXNlIGNoYW5nZXMgYXJlIGNvbnRpbnVvdXNseSB1cGRhdGVkIGFzIHdlIHJlY2VpdmUgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgICAgICogYWx3YXlzIHJlZmxlY3QgdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMgYWdhaW5zdCB0aGUgbGFzdCBpc3N1ZWQgc25hcHNob3QuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkwgPSBhcygpLCBcbiAgICAgICAgLyoqIFNlZSBwdWJsaWMgZ2V0dGVycyBmb3IgZXhwbGFuYXRpb25zIG9mIHRoZXNlIGZpZWxkcy4gKi9cbiAgICAgICAgdGhpcy5VID0gcHQuRU1QVFlfQllURV9TVFJJTkcsIHRoaXMucSA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgc3RhdGUgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBuZXh0IHNuYXBzaG90LiBXZVxuICAgICAgICAgKiBpbml0aWFsaXplIHRvIHRydWUgc28gdGhhdCBuZXdseS1hZGRlZCB0YXJnZXRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgbmV4dFxuICAgICAgICAgKiBSZW1vdGVFdmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuSyA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBiZWVuIG1hcmtlZCAnY3VycmVudCcuXG4gICAgICpcbiAgICAgKiAnQ3VycmVudCcgaGFzIHNwZWNpYWwgbWVhbmluZyBpbiB0aGUgUlBDIHByb3RvY29sOiBJdCBpbXBsaWVzIHRoYXQgdGhlXG4gICAgICogV2F0Y2ggYmFja2VuZCBoYXMgc2VudCB1cyBhbGwgY2hhbmdlcyB1cCB0byB0aGUgcG9pbnQgYXQgd2hpY2ggdGhlIHRhcmdldFxuICAgICAqIHdhcyBhZGRlZCBhbmQgdGhhdCB0aGUgdGFyZ2V0IGlzIGNvbnNpc3RlbnQgd2l0aCB0aGUgcmVzdCBvZiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0uXG4gICAgICovICAgIGdldCBjdXJyZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xO1xuICAgIH1cbiAgICAvKiogVGhlIGxhc3QgcmVzdW1lIHRva2VuIHNlbnQgdG8gdXMgZm9yIHRoaXMgdGFyZ2V0LiAqLyAgICBnZXQgcmVzdW1lVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlU7XG4gICAgfVxuICAgIC8qKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBwZW5kaW5nIHRhcmdldCBhZGRzIG9yIHRhcmdldCByZW1vdmVzLiAqLyAgICBnZXQgRygpIHtcbiAgICAgICAgcmV0dXJuIDAgIT09IHRoaXMuQjtcbiAgICB9XG4gICAgLyoqIFdoZXRoZXIgd2UgaGF2ZSBtb2RpZmllZCBhbnkgc3RhdGUgdGhhdCBzaG91bGQgdHJpZ2dlciBhIHNuYXBzaG90LiAqLyAgICBnZXQgaigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgcmVzdW1lIHRva2VuIHRvIHRoZSBUYXJnZXRDaGFuZ2UsIGJ1dCBvbmx5IHdoZW4gaXQgaGFzIGEgbmV3XG4gICAgICogdmFsdWUuIEVtcHR5IHJlc3VtZVRva2VucyBhcmUgZGlzY2FyZGVkLlxuICAgICAqLyAgICBXKHQpIHtcbiAgICAgICAgdC5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwICYmICh0aGlzLksgPSAhMCwgdGhpcy5VID0gdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSB0YXJnZXQgY2hhbmdlIGZyb20gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuXG4gICAgICpcbiAgICAgKiBUbyByZXNldCB0aGUgZG9jdW1lbnQgY2hhbmdlcyBhZnRlciByYWlzaW5nIHRoaXMgc25hcHNob3QsIGNhbGxcbiAgICAgKiBgY2xlYXJQZW5kaW5nQ2hhbmdlcygpYC5cbiAgICAgKi8gICAgSCgpIHtcbiAgICAgICAgbGV0IHQgPSBZbigpLCBlID0gWW4oKSwgbiA9IFluKCk7XG4gICAgICAgIHJldHVybiB0aGlzLkwuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgIHQgPSB0LmFkZChzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIgLyogTW9kaWZpZWQgKi8gOlxuICAgICAgICAgICAgICAgIGUgPSBlLmFkZChzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgTCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIG5ldyBlcyh0aGlzLlUsIHRoaXMucSwgdCwgZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgZG9jdW1lbnQgY2hhbmdlcyBhbmQgc2V0cyBgaGFzUGVuZGluZ0NoYW5nZXNgIHRvIGZhbHNlLlxuICAgICAqLyAgICBKKCkge1xuICAgICAgICB0aGlzLksgPSAhMSwgdGhpcy5MID0gYXMoKTtcbiAgICB9XG4gICAgWSh0LCBlKSB7XG4gICAgICAgIHRoaXMuSyA9ICEwLCB0aGlzLkwgPSB0aGlzLkwuaW5zZXJ0KHQsIGUpO1xuICAgIH1cbiAgICBYKHQpIHtcbiAgICAgICAgdGhpcy5LID0gITAsIHRoaXMuTCA9IHRoaXMuTC5yZW1vdmUodCk7XG4gICAgfVxuICAgIFooKSB7XG4gICAgICAgIHRoaXMuQiArPSAxO1xuICAgIH1cbiAgICB0dCgpIHtcbiAgICAgICAgdGhpcy5CIC09IDE7XG4gICAgfVxuICAgIGV0KCkge1xuICAgICAgICB0aGlzLksgPSAhMCwgdGhpcy5xID0gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXG4gKi9cbmNsYXNzIG9zIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMubnQgPSB0LCBcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xuICAgICAgICB0aGlzLnN0ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXG4gICAgICAgIHRoaXMuaXQgPSBRbigpLCBcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xuICAgICAgICB0aGlzLnJ0ID0gdXMoKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy4gVGhlc2UgdGFyZ2V0cyBhcmVcbiAgICAgICAgICoga25vd24gdG8gYmUgaW5jb25zaXN0ZW50IGFuZCB0aGVpciBsaXN0ZW5zIG5lZWRzIHRvIGJlIHJlLWVzdGFibGlzaGVkIGJ5XG4gICAgICAgICAqIFJlbW90ZVN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vdCA9IG5ldyB3ZShydCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgRG9jdW1lbnRXYXRjaENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKi8gICAgdXQodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5PKSB0LkYgJiYgdC5GLmlzRm91bmREb2N1bWVudCgpID8gdGhpcy5hdChlLCB0LkYpIDogdGhpcy5jdChlLCB0LmtleSwgdC5GKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQucmVtb3ZlZFRhcmdldElkcykgdGhpcy5jdChlLCB0LmtleSwgdC5GKTtcbiAgICB9XG4gICAgLyoqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgV2F0Y2hUYXJnZXRDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuICovICAgIGh0KHQpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoVGFyZ2V0KHQsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmx0KGUpO1xuICAgICAgICAgICAgc3dpdGNoICh0LnN0YXRlKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBOb0NoYW5nZSAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5mdChlKSAmJiBuLlcodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4udHQoKSwgbi5HIHx8IFxuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgYSBmcmVzaGx5IGFkZGVkIHRhcmdldCwgc28gd2UgbmVlZCB0byByZXNldCBhbnkgc3RhdGVcbiAgICAgICAgICAgICAgICAvLyB0aGF0IHdlIGhhZCBwcmV2aW91c2x5LiBUaGlzIGNhbiBoYXBwZW4gZS5nLiB3aGVuIHJlbW92ZSBhbmQgYWRkXG4gICAgICAgICAgICAgICAgLy8gYmFjayBhIHRhcmdldCBmb3IgZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAgICAgICAgICAgIG4uSigpLCBuLlcodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAyIC8qIFJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiByZW1vdmVkIHRhcmdldHMgdG8gd2UgY2FuIHBvc3QtZmlsdGVyIGFuZFxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgdGFyZ2V0IGNoYW5nZXMuXG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcbiAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cbiAgICAgICAgICAgICAgICBuLnR0KCksIG4uRyB8fCB0aGlzLnJlbW92ZVRhcmdldChlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDMgLyogQ3VycmVudCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5mdChlKSAmJiAobi5ldCgpLCBuLlcodC5yZXN1bWVUb2tlbikpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgNCAvKiBSZXNldCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5mdChlKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRhcmdldCBhbmQgc3ludGhlc2l6ZXMgcmVtb3ZlcyBmb3IgYWxsIGV4aXN0aW5nXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzLiBUaGUgYmFja2VuZCB3aWxsIHJlLWFkZCBhbnkgZG9jdW1lbnRzIHRoYXQgc3RpbGxcbiAgICAgICAgICAgICAgICAvLyBtYXRjaCB0aGUgdGFyZ2V0IGJlZm9yZSBpdCBzZW5kcyB0aGUgbmV4dCBnbG9iYWwgc25hcHNob3QuXG4gICAgICAgICAgICAgICAgdGhpcy5kdChlKSwgbi5XKHQucmVzdW1lVG9rZW4pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIEwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGFsbCB0YXJnZXRJZHMgdGhhdCB0aGUgd2F0Y2ggY2hhbmdlIGFwcGxpZXMgdG86IGVpdGhlciB0aGVcbiAgICAgKiB0YXJnZXRJZHMgZXhwbGljaXRseSBsaXN0ZWQgaW4gdGhlIGNoYW5nZSBvciB0aGUgdGFyZ2V0SWRzIG9mIGFsbCBjdXJyZW50bHlcbiAgICAgKiBhY3RpdmUgdGFyZ2V0cy5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHQudGFyZ2V0SWRzLmxlbmd0aCA+IDAgPyB0LnRhcmdldElkcy5mb3JFYWNoKGUpIDogdGhpcy5zdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5mdChuKSAmJiBlKG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZXhpc3RlbmNlIGZpbHRlcnMgYW5kIHN5bnRoZXNpemVzIGRlbGV0ZXMgZm9yIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAqIFRhcmdldHMgdGhhdCBhcmUgaW52YWxpZGF0ZWQgYnkgZmlsdGVyIG1pc21hdGNoZXMgYXJlIGFkZGVkIHRvXG4gICAgICogYHBlbmRpbmdUYXJnZXRSZXNldHNgLlxuICAgICAqLyAgICBfdCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkLCBuID0gdC4kLmNvdW50LCBzID0gdGhpcy53dChlKTtcbiAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLnRhcmdldDtcbiAgICAgICAgICAgIGlmIChBZSh0KSkgaWYgKDAgPT09IG4pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcbiAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgeHQodC5wYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmN0KGUsIG4sIG5lLm5ld05vRG9jdW1lbnQobiwgY3QubWluKCkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBVKDEgPT09IG4pOyBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmd0KGUpICE9PSBuICYmIChcbiAgICAgICAgICAgICAgICAvLyBFeGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoOiBXZSByZXNldCB0aGUgbWFwcGluZyBhbmQgcmFpc2UgYSBuZXdcbiAgICAgICAgICAgICAgICAvLyBzbmFwc2hvdCB3aXRoIGBpc0Zyb21DYWNoZTp0cnVlYC5cbiAgICAgICAgICAgICAgICB0aGlzLmR0KGUpLCB0aGlzLm90ID0gdGhpcy5vdC5hZGQoZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoZSBjdXJyZW50bHkgYWNjdW11bGF0ZWQgc3RhdGUgaW50byBhIHJlbW90ZSBldmVudCBhdCB0aGVcbiAgICAgKiBwcm92aWRlZCBzbmFwc2hvdCB2ZXJzaW9uLiBSZXNldHMgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYmVmb3JlIHJldHVybmluZy5cbiAgICAgKi8gICAgeXQodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IE1hcDtcbiAgICAgICAgdGhpcy5zdC5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMud3Qocyk7XG4gICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgIGlmIChuLmN1cnJlbnQgJiYgQWUoaS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50IHF1ZXJpZXMgZm9yIGRvY3VtZW50IHRoYXQgZG9uJ3QgZXhpc3QgY2FuIHByb2R1Y2UgYW4gZW1wdHlcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0IHNldC4gVG8gdXBkYXRlIG91ciBsb2NhbCBjYWNoZSwgd2Ugc3ludGhlc2l6ZSBhIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBpZiB3ZSBoYXZlIG5vdCBwcmV2aW91c2x5IHJlY2VpdmVkIHRoZSBkb2N1bWVudC4gVGhpc1xuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHZlcyB0aGUgbGltYm8gc3RhdGUgb2YgdGhlIGRvY3VtZW50LCByZW1vdmluZyBpdCBmcm9tXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpbWJvRG9jdW1lbnRSZWZzLlxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElkZWFsbHkgd2Ugd291bGQgaGF2ZSBhbiBleHBsaWNpdCBsb29rdXAgdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQgcmVzdWx0aW5nIGluIGFuIGV4cGxpY2l0IGRlbGV0ZSBtZXNzYWdlIGFuZCB3ZSBjb3VsZFxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBzcGVjaWFsIGxvZ2ljLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IHh0KGkudGFyZ2V0LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBudWxsICE9PSB0aGlzLml0LmdldChlKSB8fCB0aGlzLkl0KHMsIGUpIHx8IHRoaXMuY3QocywgZSwgbmUubmV3Tm9Eb2N1bWVudChlLCB0KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG4uaiAmJiAoZS5zZXQocywgbi5IKCkpLCBuLkooKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IG4gPSBZbigpO1xuICAgICAgICAvLyBXZSBleHRyYWN0IHRoZSBzZXQgb2YgbGltYm8tb25seSBkb2N1bWVudCB1cGRhdGVzIGFzIHRoZSBHQyBsb2dpY1xuICAgICAgICAvLyBzcGVjaWFsLWNhc2VzIGRvY3VtZW50cyB0aGF0IGRvIG5vdCBhcHBlYXIgaW4gdGhlIHRhcmdldCBjYWNoZS5cbiAgICAgICAgXG4gICAgICAgIC8vIFRPRE8oZ3NvbHRpcyk6IEV4cGFuZCBvbiB0aGlzIGNvbW1lbnQgb25jZSBHQyBpcyBhdmFpbGFibGUgaW4gdGhlIEpTXG4gICAgICAgIC8vIGNsaWVudC5cbiAgICAgICAgICAgICAgICB0aGlzLnJ0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICAgICAgZS5mb3JFYWNoV2hpbGUoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnd0KHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhZSB8fCAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyA9PT0gZS5wdXJwb3NlIHx8IChzID0gITEsICExKTtcbiAgICAgICAgICAgIH0pKSwgcyAmJiAobiA9IG4uYWRkKHQpKTtcbiAgICAgICAgfSkpLCB0aGlzLml0LmZvckVhY2goKChlLCBuKSA9PiBuLnNldFJlYWRUaW1lKHQpKSk7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgdHModCwgZSwgdGhpcy5vdCwgdGhpcy5pdCwgbik7XG4gICAgICAgIHJldHVybiB0aGlzLml0ID0gUW4oKSwgdGhpcy5ydCA9IHVzKCksIHRoaXMub3QgPSBuZXcgd2UocnQpLCBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBwcm92aWRlZCBkb2N1bWVudCB0byB0aGUgaW50ZXJuYWwgbGlzdCBvZiBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAqIGl0cyBkb2N1bWVudCBrZXkgdG8gdGhlIGdpdmVuIHRhcmdldCdzIG1hcHBpbmcuXG4gICAgICovXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAgICBhdCh0LCBlKSB7XG4gICAgICAgIGlmICghdGhpcy5mdCh0KSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5JdCh0LCBlLmtleSkgPyAyIC8qIE1vZGlmaWVkICovIDogMCAvKiBBZGRlZCAqLztcbiAgICAgICAgdGhpcy5sdCh0KS5ZKGUua2V5LCBuKSwgdGhpcy5pdCA9IHRoaXMuaXQuaW5zZXJ0KGUua2V5LCBlKSwgdGhpcy5ydCA9IHRoaXMucnQuaW5zZXJ0KGUua2V5LCB0aGlzLlR0KGUua2V5KS5hZGQodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBwcm92aWRlZCBkb2N1bWVudCBmcm9tIHRoZSB0YXJnZXQgbWFwcGluZy4gSWYgdGhlXG4gICAgICogZG9jdW1lbnQgbm8gbG9uZ2VyIG1hdGNoZXMgdGhlIHRhcmdldCwgYnV0IHRoZSBkb2N1bWVudCdzIHN0YXRlIGlzIHN0aWxsXG4gICAgICoga25vd24gKGUuZy4gd2Uga25vdyB0aGF0IHRoZSBkb2N1bWVudCB3YXMgZGVsZXRlZCBvciB3ZSByZWNlaXZlZCB0aGUgY2hhbmdlXG4gICAgICogdGhhdCBjYXVzZWQgdGhlIGZpbHRlciBtaXNtYXRjaCksIHRoZSBuZXcgZG9jdW1lbnQgY2FuIGJlIHByb3ZpZGVkXG4gICAgICogdG8gdXBkYXRlIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuXG4gICAgICovXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAgICBjdCh0LCBlLCBuKSB7XG4gICAgICAgIGlmICghdGhpcy5mdCh0KSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5sdCh0KTtcbiAgICAgICAgdGhpcy5JdCh0LCBlKSA/IHMuWShlLCAxIC8qIFJlbW92ZWQgKi8pIDogXG4gICAgICAgIC8vIFRoZSBkb2N1bWVudCBtYXkgaGF2ZSBlbnRlcmVkIGFuZCBsZWZ0IHRoZSB0YXJnZXQgYmVmb3JlIHdlIHJhaXNlZCBhXG4gICAgICAgIC8vIHNuYXBzaG90LCBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGNoYW5nZS5cbiAgICAgICAgcy5YKGUpLCB0aGlzLnJ0ID0gdGhpcy5ydC5pbnNlcnQoZSwgdGhpcy5UdChlKS5kZWxldGUodCkpLCBuICYmICh0aGlzLml0ID0gdGhpcy5pdC5pbnNlcnQoZSwgbikpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXQodCkge1xuICAgICAgICB0aGlzLnN0LmRlbGV0ZSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCBjb3VudCBvZiBkb2N1bWVudHMgaW4gdGhlIHRhcmdldC4gVGhpcyBpbmNsdWRlcyBib3RoXG4gICAgICogdGhlIG51bWJlciBvZiBkb2N1bWVudHMgdGhhdCB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdG8gYmUgcGFydCBvZiB0aGVcbiAgICAgKiB0YXJnZXQgYXMgd2VsbCBhcyBhbnkgYWNjdW11bGF0ZWQgY2hhbmdlcy5cbiAgICAgKi8gICAgZ3QodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5sdCh0KS5IKCk7XG4gICAgICAgIHJldHVybiB0aGlzLm50LmdldFJlbW90ZUtleXNGb3JUYXJnZXQodCkuc2l6ZSArIGUuYWRkZWREb2N1bWVudHMuc2l6ZSAtIGUucmVtb3ZlZERvY3VtZW50cy5zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbmNyZW1lbnQgdGhlIG51bWJlciBvZiBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoIGJlZm9yZSB3ZSBjYW4gY29uc2lkZXIgdGhlXG4gICAgICogc2VydmVyIHRvIGJlICdpbi1zeW5jJyB3aXRoIHRoZSBjbGllbnQncyBhY3RpdmUgdGFyZ2V0cy5cbiAgICAgKi8gICAgWih0KSB7XG4gICAgICAgIHRoaXMubHQodCkuWigpO1xuICAgIH1cbiAgICBsdCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5zdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChlID0gbmV3IHJzLCB0aGlzLnN0LnNldCh0LCBlKSksIGU7XG4gICAgfVxuICAgIFR0KHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnJ0LmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgKGUgPSBuZXcgd2UocnQpLCB0aGlzLnJ0ID0gdGhpcy5ydC5pbnNlcnQodCwgZSkpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSB1c2VyIGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQgKGJ5IGNhbGxpbmdcbiAgICAgKiBgZ2V0VGFyZ2V0RGF0YUZvclRhcmdldCgpYCkgYW5kIHRoYXQgd2UgYXJlIG5vdCB3YWl0aW5nIGZvciBwZW5kaW5nIEFERHNcbiAgICAgKiBmcm9tIHdhdGNoLlxuICAgICAqLyAgICBmdCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBudWxsICE9PSB0aGlzLnd0KHQpO1xuICAgICAgICByZXR1cm4gZSB8fCBPKFwiV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yXCIsIFwiRGV0ZWN0ZWQgaW5hY3RpdmUgdGFyZ2V0XCIsIHQpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBUYXJnZXREYXRhIGZvciBhbiBhY3RpdmUgdGFyZ2V0IChpLmUuIGEgdGFyZ2V0IHRoYXQgdGhlIHVzZXJcbiAgICAgKiBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoYXQgaGFzIG5vIG91dHN0YW5kaW5nIHRhcmdldCBjaGFuZ2UgcmVxdWVzdHMpLlxuICAgICAqLyAgICB3dCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnN0LmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgJiYgZS5HID8gbnVsbCA6IHRoaXMubnQuRXQodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQgdG8gaXRzIGluaXRpYWwgc3RhdGUgKGUuZy4gc2V0c1xuICAgICAqICdjdXJyZW50JyB0byBmYWxzZSwgY2xlYXJzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHJlbW92ZXMgaXRzIHRhcmdldCBtYXBwaW5nXG4gICAgICogZnJvbSBhbGwgZG9jdW1lbnRzKS5cbiAgICAgKi8gICAgZHQodCkge1xuICAgICAgICB0aGlzLnN0LnNldCh0LCBuZXcgcnMpO1xuICAgICAgICB0aGlzLm50LmdldFJlbW90ZUtleXNGb3JUYXJnZXQodCkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmN0KHQsIGUsIC8qdXBkYXRlZERvY3VtZW50PSovIG51bGwpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgTG9jYWxTdG9yZSBjb25zaWRlcnMgdGhlIGRvY3VtZW50IHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogc3BlY2lmaWVkIHRhcmdldC5cbiAgICAgKi8gICAgSXQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5udC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLmhhcyhlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVzKCkge1xuICAgIHJldHVybiBuZXcgZmUoeHQuY29tcGFyYXRvcik7XG59XG5cbmZ1bmN0aW9uIGFzKCkge1xuICAgIHJldHVybiBuZXcgZmUoeHQuY29tcGFyYXRvcik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IGNzID0gKCgpID0+IHtcbiAgICBjb25zdCB0ID0ge1xuICAgICAgICBhc2M6IFwiQVNDRU5ESU5HXCIsXG4gICAgICAgIGRlc2M6IFwiREVTQ0VORElOR1wiXG4gICAgfTtcbiAgICByZXR1cm4gdDtcbn0pKCksIGhzID0gKCgpID0+IHtcbiAgICBjb25zdCB0ID0ge1xuICAgICAgICBcIjxcIjogXCJMRVNTX1RIQU5cIixcbiAgICAgICAgXCI8PVwiOiBcIkxFU1NfVEhBTl9PUl9FUVVBTFwiLFxuICAgICAgICBcIj5cIjogXCJHUkVBVEVSX1RIQU5cIixcbiAgICAgICAgXCI+PVwiOiBcIkdSRUFURVJfVEhBTl9PUl9FUVVBTFwiLFxuICAgICAgICBcIj09XCI6IFwiRVFVQUxcIixcbiAgICAgICAgXCIhPVwiOiBcIk5PVF9FUVVBTFwiLFxuICAgICAgICBcImFycmF5LWNvbnRhaW5zXCI6IFwiQVJSQVlfQ09OVEFJTlNcIixcbiAgICAgICAgaW46IFwiSU5cIixcbiAgICAgICAgXCJub3QtaW5cIjogXCJOT1RfSU5cIixcbiAgICAgICAgXCJhcnJheS1jb250YWlucy1hbnlcIjogXCJBUlJBWV9DT05UQUlOU19BTllcIlxuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpO1xuXG4vKipcbiAqIFRoaXMgY2xhc3MgZ2VuZXJhdGVzIEpzb25PYmplY3QgdmFsdWVzIGZvciB0aGUgRGF0YXN0b3JlIEFQSSBzdWl0YWJsZSBmb3JcbiAqIHNlbmRpbmcgdG8gZWl0aGVyIEdSUEMgc3R1YiBtZXRob2RzIG9yIHZpYSB0aGUgSlNPTi9IVFRQIFJFU1QgQVBJLlxuICpcbiAqIFRoZSBzZXJpYWxpemVyIHN1cHBvcnRzIGJvdGggUHJvdG9idWYuanMgYW5kIFByb3RvMyBKU09OIGZvcm1hdHMuIEJ5XG4gKiBzZXR0aW5nIGB1c2VQcm90bzNKc29uYCB0byB0cnVlLCB0aGUgc2VyaWFsaXplciB3aWxsIHVzZSB0aGUgUHJvdG8zIEpTT05cbiAqIGZvcm1hdC5cbiAqXG4gKiBGb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgUHJvdG8zIEpTT04gZm9ybWF0IGNoZWNrXG4gKiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9wcm90b2NvbC1idWZmZXJzL2RvY3MvcHJvdG8zI2pzb25cbiAqXG4gKiBUT0RPKGtsaW10KTogV2UgY2FuIHJlbW92ZSB0aGUgZGF0YWJhc2VJZCBhcmd1bWVudCBpZiB3ZSBrZWVwIHRoZSBmdWxsXG4gKiByZXNvdXJjZSBuYW1lIGluIGRvY3VtZW50cy5cbiAqL1xuY2xhc3MgbHMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gdCwgdGhpcy5OID0gZTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBhIERhdGUgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvIGEgcHJvdG8uXG4gKi9cbmZ1bmN0aW9uIGZzKHQsIGUpIHtcbiAgICBpZiAodC5OKSB7XG4gICAgICAgIHJldHVybiBgJHtuZXcgRGF0ZSgxZTMgKiBlLnNlY29uZHMpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvXFwuXFxkKi8sIFwiXCIpLnJlcGxhY2UoXCJaXCIsIFwiXCIpfS4keyhcIjAwMDAwMDAwMFwiICsgZS5uYW5vc2Vjb25kcykuc2xpY2UoLTkpfVpgO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiBcIlwiICsgZS5zZWNvbmRzLFxuICAgICAgICBuYW5vczogZS5uYW5vc2Vjb25kc1xuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBieXRlcyB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGluIGEgcHJvdG8uXG4gKlxuICogVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAqL1xuZnVuY3Rpb24gZHModCwgZSkge1xuICAgIHJldHVybiB0Lk4gPyBlLnRvQmFzZTY0KCkgOiBlLnRvVWludDhBcnJheSgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBCeXRlU3RyaW5nIGJhc2VkIG9uIHRoZSBwcm90byBzdHJpbmcgdmFsdWUuXG4gKi8gZnVuY3Rpb24gX3ModCwgZSkge1xuICAgIHJldHVybiBmcyh0LCBlLnRvVGltZXN0YW1wKCkpO1xufVxuXG5mdW5jdGlvbiB3cyh0KSB7XG4gICAgcmV0dXJuIFUoISF0KSwgY3QuZnJvbVRpbWVzdGFtcChmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBUdCh0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBhdChlLnNlY29uZHMsIGUubmFub3MpO1xuICAgIH0odCkpO1xufVxuXG5mdW5jdGlvbiBtcyh0LCBlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfdChbIFwicHJvamVjdHNcIiwgdC5wcm9qZWN0SWQsIFwiZGF0YWJhc2VzXCIsIHQuZGF0YWJhc2UgXSk7XG4gICAgfSh0KS5jaGlsZChcImRvY3VtZW50c1wiKS5jaGlsZChlKS5jYW5vbmljYWxTdHJpbmcoKTtcbn1cblxuZnVuY3Rpb24gZ3ModCkge1xuICAgIGNvbnN0IGUgPSBfdC5mcm9tU3RyaW5nKHQpO1xuICAgIHJldHVybiBVKEtzKGUpKSwgZTtcbn1cblxuZnVuY3Rpb24geXModCwgZSkge1xuICAgIHJldHVybiBtcyh0LmRhdGFiYXNlSWQsIGUucGF0aCk7XG59XG5cbmZ1bmN0aW9uIHBzKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZ3MoZSk7XG4gICAgaWYgKG4uZ2V0KDEpICE9PSB0LmRhdGFiYXNlSWQucHJvamVjdElkKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IHByb2plY3Q6IFwiICsgbi5nZXQoMSkgKyBcIiB2cyBcIiArIHQuZGF0YWJhc2VJZC5wcm9qZWN0SWQpO1xuICAgIGlmIChuLmdldCgzKSAhPT0gdC5kYXRhYmFzZUlkLmRhdGFiYXNlKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IGRhdGFiYXNlOiBcIiArIG4uZ2V0KDMpICsgXCIgdnMgXCIgKyB0LmRhdGFiYXNlSWQuZGF0YWJhc2UpO1xuICAgIHJldHVybiBuZXcgeHQoQXMobikpO1xufVxuXG5mdW5jdGlvbiBJcyh0LCBlKSB7XG4gICAgcmV0dXJuIG1zKHQuZGF0YWJhc2VJZCwgZSk7XG59XG5cbmZ1bmN0aW9uIFRzKHQpIHtcbiAgICBjb25zdCBlID0gZ3ModCk7XG4gICAgLy8gSW4gdjFiZXRhMSBxdWVyaWVzIGZvciBjb2xsZWN0aW9ucyBhdCB0aGUgcm9vdCBkaWQgbm90IGhhdmUgYSB0cmFpbGluZ1xuICAgIC8vIFwiL2RvY3VtZW50c1wiLiBJbiB2MSBhbGwgcmVzb3VyY2UgcGF0aHMgY29udGFpbiBcIi9kb2N1bWVudHNcIi4gUHJlc2VydmUgdGhlXG4gICAgLy8gYWJpbGl0eSB0byByZWFkIHRoZSB2MWJldGExIGZvcm0gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBxdWVyaWVzIHBlcnNpc3RlZFxuICAgIC8vIGluIHRoZSBsb2NhbCB0YXJnZXQgY2FjaGUuXG4gICAgICAgIHJldHVybiA0ID09PSBlLmxlbmd0aCA/IF90LmVtcHR5UGF0aCgpIDogQXMoZSk7XG59XG5cbmZ1bmN0aW9uIEVzKHQpIHtcbiAgICByZXR1cm4gbmV3IF90KFsgXCJwcm9qZWN0c1wiLCB0LmRhdGFiYXNlSWQucHJvamVjdElkLCBcImRhdGFiYXNlc1wiLCB0LmRhdGFiYXNlSWQuZGF0YWJhc2UgXSkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIEFzKHQpIHtcbiAgICByZXR1cm4gVSh0Lmxlbmd0aCA+IDQgJiYgXCJkb2N1bWVudHNcIiA9PT0gdC5nZXQoNCkpLCB0LnBvcEZpcnN0KDUpO1xufVxuXG4vKiogQ3JlYXRlcyBhIERvY3VtZW50IHByb3RvIGZyb20ga2V5IGFuZCBmaWVsZHMgKGJ1dCBubyBjcmVhdGUvdXBkYXRlIHRpbWUpICovIGZ1bmN0aW9uIFJzKHQsIGUsIG4pIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiB5cyh0LCBlKSxcbiAgICAgICAgZmllbGRzOiBuLnZhbHVlLm1hcFZhbHVlLmZpZWxkc1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGJzKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gcHModCwgZS5uYW1lKSwgaSA9IHdzKGUudXBkYXRlVGltZSksIHIgPSBuZXcgdGUoe1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiBlLmZpZWxkc1xuICAgICAgICB9XG4gICAgfSksIG8gPSBuZS5uZXdGb3VuZERvY3VtZW50KHMsIGksIHIpO1xuICAgIHJldHVybiBuICYmIG8uc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCksIG4gPyBvLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpIDogbztcbn1cblxuZnVuY3Rpb24gUHModCwgZSkge1xuICAgIHJldHVybiBcImZvdW5kXCIgaW4gZSA/IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgVSghIWUuZm91bmQpLCBlLmZvdW5kLm5hbWUsIGUuZm91bmQudXBkYXRlVGltZTtcbiAgICAgICAgY29uc3QgbiA9IHBzKHQsIGUuZm91bmQubmFtZSksIHMgPSB3cyhlLmZvdW5kLnVwZGF0ZVRpbWUpLCBpID0gbmV3IHRlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBlLmZvdW5kLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG5lLm5ld0ZvdW5kRG9jdW1lbnQobiwgcywgaSk7XG4gICAgfSh0LCBlKSA6IFwibWlzc2luZ1wiIGluIGUgPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIFUoISFlLm1pc3NpbmcpLCBVKCEhZS5yZWFkVGltZSk7XG4gICAgICAgIGNvbnN0IG4gPSBwcyh0LCBlLm1pc3NpbmcpLCBzID0gd3MoZS5yZWFkVGltZSk7XG4gICAgICAgIHJldHVybiBuZS5uZXdOb0RvY3VtZW50KG4sIHMpO1xuICAgIH0odCwgZSkgOiBMKCk7XG59XG5cbmZ1bmN0aW9uIFZzKHQsIGUpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAoXCJ0YXJnZXRDaGFuZ2VcIiBpbiBlKSB7XG4gICAgICAgIGUudGFyZ2V0Q2hhbmdlO1xuICAgICAgICAvLyBwcm90bzMgZGVmYXVsdCB2YWx1ZSBpcyB1bnNldCBpbiBKU09OICh1bmRlZmluZWQpLCBzbyB1c2UgJ05PX0NIQU5HRSdcbiAgICAgICAgLy8gaWYgdW5zZXRcbiAgICAgICAgY29uc3QgcyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5PX0NIQU5HRVwiID09PSB0ID8gMCAvKiBOb0NoYW5nZSAqLyA6IFwiQUREXCIgPT09IHQgPyAxIC8qIEFkZGVkICovIDogXCJSRU1PVkVcIiA9PT0gdCA/IDIgLyogUmVtb3ZlZCAqLyA6IFwiQ1VSUkVOVFwiID09PSB0ID8gMyAvKiBDdXJyZW50ICovIDogXCJSRVNFVFwiID09PSB0ID8gNCAvKiBSZXNldCAqLyA6IEwoKTtcbiAgICAgICAgfShlLnRhcmdldENoYW5nZS50YXJnZXRDaGFuZ2VUeXBlIHx8IFwiTk9fQ0hBTkdFXCIpLCBpID0gZS50YXJnZXRDaGFuZ2UudGFyZ2V0SWRzIHx8IFtdLCByID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIHQuTiA/IChVKHZvaWQgMCA9PT0gZSB8fCBcInN0cmluZ1wiID09IHR5cGVvZiBlKSwgcHQuZnJvbUJhc2U2NFN0cmluZyhlIHx8IFwiXCIpKSA6IChVKHZvaWQgMCA9PT0gZSB8fCBlIGluc3RhbmNlb2YgVWludDhBcnJheSksIFxuICAgICAgICAgICAgcHQuZnJvbVVpbnQ4QXJyYXkoZSB8fCBuZXcgVWludDhBcnJheSkpO1xuICAgICAgICB9KHQsIGUudGFyZ2V0Q2hhbmdlLnJlc3VtZVRva2VuKSwgbyA9IGUudGFyZ2V0Q2hhbmdlLmNhdXNlLCB1ID0gbyAmJiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdm9pZCAwID09PSB0LmNvZGUgPyBHLlVOS05PV04gOiBxbih0LmNvZGUpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBRKGUsIHQubWVzc2FnZSB8fCBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBudW1iZXIgKG9yIG51bGwpIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50b1xuICogYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cbiAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cbiAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyByZXR1cm5pbmcgXCJudW1iZXJcIiBiZWNhdXNlIHRoYXQncyB3aGF0XG4gKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IEludDMyVmFsdWUgbXVzdCBiZS4gQnV0IEdSUEMgYWN0dWFsbHlcbiAqIGV4cGVjdHMgYSB7IHZhbHVlOiA8bnVtYmVyPiB9IHN0cnVjdC5cbiAqLyAobyk7XG4gICAgICAgIG4gPSBuZXcgaXMocywgaSwgciwgdSB8fCBudWxsKTtcbiAgICB9IGVsc2UgaWYgKFwiZG9jdW1lbnRDaGFuZ2VcIiBpbiBlKSB7XG4gICAgICAgIGUuZG9jdW1lbnRDaGFuZ2U7XG4gICAgICAgIGNvbnN0IHMgPSBlLmRvY3VtZW50Q2hhbmdlO1xuICAgICAgICBzLmRvY3VtZW50LCBzLmRvY3VtZW50Lm5hbWUsIHMuZG9jdW1lbnQudXBkYXRlVGltZTtcbiAgICAgICAgY29uc3QgaSA9IHBzKHQsIHMuZG9jdW1lbnQubmFtZSksIHIgPSB3cyhzLmRvY3VtZW50LnVwZGF0ZVRpbWUpLCBvID0gbmV3IHRlKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBzLmRvY3VtZW50LmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgdSA9IG5lLm5ld0ZvdW5kRG9jdW1lbnQoaSwgciwgbyksIGEgPSBzLnRhcmdldElkcyB8fCBbXSwgYyA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBucyhhLCBjLCB1LmtleSwgdSk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50RGVsZXRlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50RGVsZXRlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgcy5kb2N1bWVudDtcbiAgICAgICAgY29uc3QgaSA9IHBzKHQsIHMuZG9jdW1lbnQpLCByID0gcy5yZWFkVGltZSA/IHdzKHMucmVhZFRpbWUpIDogY3QubWluKCksIG8gPSBuZS5uZXdOb0RvY3VtZW50KGksIHIpLCB1ID0gcy5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xuICAgICAgICBuID0gbmV3IG5zKFtdLCB1LCBvLmtleSwgbyk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50UmVtb3ZlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50UmVtb3ZlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgcy5kb2N1bWVudDtcbiAgICAgICAgY29uc3QgaSA9IHBzKHQsIHMuZG9jdW1lbnQpLCByID0gcy5yZW1vdmVkVGFyZ2V0SWRzIHx8IFtdO1xuICAgICAgICBuID0gbmV3IG5zKFtdLCByLCBpLCBudWxsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIShcImZpbHRlclwiIGluIGUpKSByZXR1cm4gTCgpO1xuICAgICAgICB7XG4gICAgICAgICAgICBlLmZpbHRlcjtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmZpbHRlcjtcbiAgICAgICAgICAgIHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBjb25zdCBzID0gdC5jb3VudCB8fCAwLCBpID0gbmV3ICRuKHMpLCByID0gdC50YXJnZXRJZDtcbiAgICAgICAgICAgIG4gPSBuZXcgc3MociwgaSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG47XG59XG5cbmZ1bmN0aW9uIHZzKHQsIGUpIHtcbiAgICBsZXQgbjtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIENuKSBuID0ge1xuICAgICAgICB1cGRhdGU6IFJzKHQsIGUua2V5LCBlLnZhbHVlKVxuICAgIH07IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBPbikgbiA9IHtcbiAgICAgICAgZGVsZXRlOiB5cyh0LCBlLmtleSlcbiAgICB9OyBlbHNlIGlmIChlIGluc3RhbmNlb2YgeG4pIG4gPSB7XG4gICAgICAgIHVwZGF0ZTogUnModCwgZS5rZXksIGUuZGF0YSksXG4gICAgICAgIHVwZGF0ZU1hc2s6IHFzKGUuZmllbGRNYXNrKVxuICAgIH07IGVsc2Uge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgRm4pKSByZXR1cm4gTCgpO1xuICAgICAgICBuID0ge1xuICAgICAgICAgICAgdmVyaWZ5OiB5cyh0LCBlLmtleSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGUuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCA+IDAgJiYgKG4udXBkYXRlVHJhbnNmb3JtcyA9IGUuZmllbGRUcmFuc2Zvcm1zLm1hcCgodCA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnRyYW5zZm9ybTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBmbikgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIHNldFRvU2VydmVyVmFsdWU6IFwiUkVRVUVTVF9USU1FXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBkbikgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIGFwcGVuZE1pc3NpbmdFbGVtZW50czoge1xuICAgICAgICAgICAgICAgIHZhbHVlczogbi5lbGVtZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIHduKSByZXR1cm4ge1xuICAgICAgICAgICAgZmllbGRQYXRoOiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxuICAgICAgICAgICAgcmVtb3ZlQWxsRnJvbUFycmF5OiB7XG4gICAgICAgICAgICAgICAgdmFsdWVzOiBuLmVsZW1lbnRzXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgZ24pIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBpbmNyZW1lbnQ6IG4ua1xuICAgICAgICB9O1xuICAgICAgICB0aHJvdyBMKCk7XG4gICAgfSgwLCB0KSkpKSwgZS5wcmVjb25kaXRpb24uaXNOb25lIHx8IChuLmN1cnJlbnREb2N1bWVudCA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZS51cGRhdGVUaW1lID8ge1xuICAgICAgICAgICAgdXBkYXRlVGltZTogX3ModCwgZS51cGRhdGVUaW1lKVxuICAgICAgICB9IDogdm9pZCAwICE9PSBlLmV4aXN0cyA/IHtcbiAgICAgICAgICAgIGV4aXN0czogZS5leGlzdHNcbiAgICAgICAgfSA6IEwoKTtcbiAgICB9KHQsIGUucHJlY29uZGl0aW9uKSksIG47XG59XG5cbmZ1bmN0aW9uIFNzKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZS5jdXJyZW50RG9jdW1lbnQgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHQudXBkYXRlVGltZSA/IEFuLnVwZGF0ZVRpbWUod3ModC51cGRhdGVUaW1lKSkgOiB2b2lkIDAgIT09IHQuZXhpc3RzID8gQW4uZXhpc3RzKHQuZXhpc3RzKSA6IEFuLm5vbmUoKTtcbiAgICB9KGUuY3VycmVudERvY3VtZW50KSA6IEFuLm5vbmUoKSwgcyA9IGUudXBkYXRlVHJhbnNmb3JtcyA/IGUudXBkYXRlVHJhbnNmb3Jtcy5tYXAoKGUgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBsZXQgbiA9IG51bGw7XG4gICAgICAgIGlmIChcInNldFRvU2VydmVyVmFsdWVcIiBpbiBlKSBVKFwiUkVRVUVTVF9USU1FXCIgPT09IGUuc2V0VG9TZXJ2ZXJWYWx1ZSksIG4gPSBuZXcgZm47IGVsc2UgaWYgKFwiYXBwZW5kTWlzc2luZ0VsZW1lbnRzXCIgaW4gZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuYXBwZW5kTWlzc2luZ0VsZW1lbnRzLnZhbHVlcyB8fCBbXTtcbiAgICAgICAgICAgIG4gPSBuZXcgZG4odCk7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJyZW1vdmVBbGxGcm9tQXJyYXlcIiBpbiBlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5yZW1vdmVBbGxGcm9tQXJyYXkudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgbiA9IG5ldyB3bih0KTtcbiAgICAgICAgfSBlbHNlIFwiaW5jcmVtZW50XCIgaW4gZSA/IG4gPSBuZXcgZ24odCwgZS5pbmNyZW1lbnQpIDogTCgpO1xuICAgICAgICBjb25zdCBzID0gbXQuZnJvbVNlcnZlckZvcm1hdChlLmZpZWxkUGF0aCk7XG4gICAgICAgIHJldHVybiBuZXcgSW4ocywgbik7XG4gICAgfSh0LCBlKSkpIDogW107XG4gICAgaWYgKGUudXBkYXRlKSB7XG4gICAgICAgIGUudXBkYXRlLm5hbWU7XG4gICAgICAgIGNvbnN0IGkgPSBwcyh0LCBlLnVwZGF0ZS5uYW1lKSwgciA9IG5ldyB0ZSh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogZS51cGRhdGUuZmllbGRzXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoZS51cGRhdGVNYXNrKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmZpZWxkUGF0aHMgfHwgW107XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBndChlLm1hcCgodCA9PiBtdC5mcm9tU2VydmVyRm9ybWF0KHQpKSkpO1xuICAgICAgICAgICAgfShlLnVwZGF0ZU1hc2spO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB4bihpLCByLCB0LCBuLCBzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IENuKGksIHIsIG4sIHMpO1xuICAgIH1cbiAgICBpZiAoZS5kZWxldGUpIHtcbiAgICAgICAgY29uc3QgcyA9IHBzKHQsIGUuZGVsZXRlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBPbihzLCBuKTtcbiAgICB9XG4gICAgaWYgKGUudmVyaWZ5KSB7XG4gICAgICAgIGNvbnN0IHMgPSBwcyh0LCBlLnZlcmlmeSk7XG4gICAgICAgIHJldHVybiBuZXcgRm4ocywgbik7XG4gICAgfVxuICAgIHJldHVybiBMKCk7XG59XG5cbmZ1bmN0aW9uIERzKHQsIGUpIHtcbiAgICByZXR1cm4gdCAmJiB0Lmxlbmd0aCA+IDAgPyAoVSh2b2lkIDAgIT09IGUpLCB0Lm1hcCgodCA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIE5PVEU6IERlbGV0ZXMgZG9uJ3QgaGF2ZSBhbiB1cGRhdGVUaW1lLlxuICAgICAgICBsZXQgbiA9IHQudXBkYXRlVGltZSA/IHdzKHQudXBkYXRlVGltZSkgOiB3cyhlKTtcbiAgICAgICAgcmV0dXJuIG4uaXNFcXVhbChjdC5taW4oKSkgJiYgKFxuICAgICAgICAvLyBUaGUgRmlyZXN0b3JlIEVtdWxhdG9yIGN1cnJlbnRseSByZXR1cm5zIGFuIHVwZGF0ZSB0aW1lIG9mIDAgZm9yXG4gICAgICAgIC8vIGRlbGV0ZXMgb2Ygbm9uLWV4aXN0aW5nIGRvY3VtZW50cyAocmF0aGVyIHRoYW4gbnVsbCkuIFRoaXMgYnJlYWtzIHRoZVxuICAgICAgICAvLyB0ZXN0IFwiZ2V0IGRlbGV0ZWQgZG9jIHdoaWxlIG9mZmxpbmUgd2l0aCBzb3VyY2U9Y2FjaGVcIiBhcyBOb0RvY3VtZW50c1xuICAgICAgICAvLyB3aXRoIHZlcnNpb24gMCBhcmUgZmlsdGVyZWQgYnkgSW5kZXhlZERiJ3MgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAgICAgICAgLy8gVE9ETygjMjE0OSk6IFJlbW92ZSB0aGlzIHdoZW4gRW11bGF0b3IgaXMgZml4ZWRcbiAgICAgICAgbiA9IHdzKGUpKSwgbmV3IEVuKG4sIHQudHJhbnNmb3JtUmVzdWx0cyB8fCBbXSk7XG4gICAgfSh0LCBlKSkpKSA6IFtdO1xufVxuXG5mdW5jdGlvbiBDcyh0LCBlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZG9jdW1lbnRzOiBbIElzKHQsIGUucGF0aCkgXVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHhzKHQsIGUpIHtcbiAgICAvLyBEaXNzZWN0IHRoZSBwYXRoIGludG8gcGFyZW50LCBjb2xsZWN0aW9uSWQsIGFuZCBvcHRpb25hbCBrZXkgZmlsdGVyLlxuICAgIGNvbnN0IG4gPSB7XG4gICAgICAgIHN0cnVjdHVyZWRRdWVyeToge31cbiAgICB9LCBzID0gZS5wYXRoO1xuICAgIG51bGwgIT09IGUuY29sbGVjdGlvbkdyb3VwID8gKG4ucGFyZW50ID0gSXModCwgcyksIG4uc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbIHtcbiAgICAgICAgY29sbGVjdGlvbklkOiBlLmNvbGxlY3Rpb25Hcm91cCxcbiAgICAgICAgYWxsRGVzY2VuZGFudHM6ICEwXG4gICAgfSBdKSA6IChuLnBhcmVudCA9IElzKHQsIHMucG9wTGFzdCgpKSwgbi5zdHJ1Y3R1cmVkUXVlcnkuZnJvbSA9IFsge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6IHMubGFzdFNlZ21lbnQoKVxuICAgIH0gXSk7XG4gICAgY29uc3QgaSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGUgPSB0Lm1hcCgodCA9PiBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBpZiAoXCI9PVwiIC8qIEVRVUFMICovID09PSB0Lm9wKSB7XG4gICAgICAgICAgICAgICAgaWYgKGp0KHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICRzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTkFOXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKFF0KHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICRzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTlVMTFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChcIiE9XCIgLyogTk9UX0VRVUFMICovID09PSB0Lm9wKSB7XG4gICAgICAgICAgICAgICAgaWYgKGp0KHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ6ICRzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTk9UX05BTlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChRdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiAkcyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05PVF9OVUxMXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpZWxkRmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiAkcyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IEZzKHQub3ApLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCkpKTtcbiAgICAgICAgaWYgKDEgPT09IGUubGVuZ3RoKSByZXR1cm4gZVswXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUZpbHRlcjoge1xuICAgICAgICAgICAgICAgIG9wOiBcIkFORFwiLFxuICAgICAgICAgICAgICAgIGZpbHRlcnM6IGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KGUuZmlsdGVycyk7XG4gICAgaSAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkud2hlcmUgPSBpKTtcbiAgICBjb25zdCByID0gZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAoMCA9PT0gdC5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgcmV0dXJuIHQubWFwKCh0ID0+IFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZmllbGQ6ICRzKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogT3ModC5kaXIpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KHQpKSk7XG4gICAgfShlLm9yZGVyQnkpO1xuICAgIHIgJiYgKG4uc3RydWN0dXJlZFF1ZXJ5Lm9yZGVyQnkgPSByKTtcbiAgICBjb25zdCBvID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdC5OIHx8IFN0KGUpID8gZSA6IHtcbiAgICAgICAgICAgIHZhbHVlOiBlXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyBhIG51bWJlciAob3IgbnVsbCkgZnJvbSBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxuICovICh0LCBlLmxpbWl0KTtcbiAgICB2YXIgdTtcbiAgICByZXR1cm4gbnVsbCAhPT0gbyAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkubGltaXQgPSBvKSwgZS5zdGFydEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5zdGFydEF0ID0ge1xuICAgICAgICBiZWZvcmU6ICh1ID0gZS5zdGFydEF0KS5pbmNsdXNpdmUsXG4gICAgICAgIHZhbHVlczogdS5wb3NpdGlvblxuICAgIH0pLCBlLmVuZEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJlZm9yZTogIXQuaW5jbHVzaXZlLFxuICAgICAgICAgICAgdmFsdWVzOiB0LnBvc2l0aW9uXG4gICAgICAgIH07XG4gICAgfShlLmVuZEF0KSksIG47XG59XG5cbmZ1bmN0aW9uIE5zKHQpIHtcbiAgICBsZXQgZSA9IFRzKHQucGFyZW50KTtcbiAgICBjb25zdCBuID0gdC5zdHJ1Y3R1cmVkUXVlcnksIHMgPSBuLmZyb20gPyBuLmZyb20ubGVuZ3RoIDogMDtcbiAgICBsZXQgaSA9IG51bGw7XG4gICAgaWYgKHMgPiAwKSB7XG4gICAgICAgIFUoMSA9PT0gcyk7XG4gICAgICAgIGNvbnN0IHQgPSBuLmZyb21bMF07XG4gICAgICAgIHQuYWxsRGVzY2VuZGFudHMgPyBpID0gdC5jb2xsZWN0aW9uSWQgOiBlID0gZS5jaGlsZCh0LmNvbGxlY3Rpb25JZCk7XG4gICAgfVxuICAgIGxldCByID0gW107XG4gICAgbi53aGVyZSAmJiAociA9IE1zKG4ud2hlcmUpKTtcbiAgICBsZXQgbyA9IFtdO1xuICAgIG4ub3JkZXJCeSAmJiAobyA9IG4ub3JkZXJCeS5tYXAoKHQgPT4gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IEZlKEJzKHQuZmllbGQpLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgY2FzZSBcIkFTQ0VORElOR1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFzY1wiIC8qIEFTQ0VORElORyAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiREVTQ0VORElOR1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImRlc2NcIiAvKiBERVNDRU5ESU5HICovO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgKHQuZGlyZWN0aW9uKSk7XG4gICAgfSh0KSkpKTtcbiAgICBsZXQgdSA9IG51bGw7XG4gICAgbi5saW1pdCAmJiAodSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIHJldHVybiBlID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgdCA/IHQudmFsdWUgOiB0LCBTdChlKSA/IG51bGwgOiBlO1xuICAgIH0obi5saW1pdCkpO1xuICAgIGxldCBhID0gbnVsbDtcbiAgICBuLnN0YXJ0QXQgJiYgKGEgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuYmVmb3JlLCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgICAgIHJldHVybiBuZXcgT2UobiwgZSk7XG4gICAgfShuLnN0YXJ0QXQpKTtcbiAgICBsZXQgYyA9IG51bGw7XG4gICAgcmV0dXJuIG4uZW5kQXQgJiYgKGMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhdC5iZWZvcmUsIG4gPSB0LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBPZShuLCBlKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIChuLmVuZEF0KSksIHFlKGUsIGksIG8sIHIsIHUsIFwiRlwiIC8qIEZpcnN0ICovICwgYSwgYyk7XG59XG5cbmZ1bmN0aW9uIGtzKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICBjYXNlIDAgLyogTGlzdGVuICovIDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIEV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovIDpcbiAgICAgICAgICAgIHJldHVybiBcImV4aXN0ZW5jZS1maWx0ZXItbWlzbWF0Y2hcIjtcblxuICAgICAgICAgIGNhc2UgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFwibGltYm8tZG9jdW1lbnRcIjtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gTCgpO1xuICAgICAgICB9XG4gICAgfSgwLCBlLnB1cnBvc2UpO1xuICAgIHJldHVybiBudWxsID09IG4gPyBudWxsIDoge1xuICAgICAgICBcImdvb2ctbGlzdGVuLXRhZ3NcIjogblxuICAgIH07XG59XG5cbmZ1bmN0aW9uIE1zKHQpIHtcbiAgICByZXR1cm4gdCA/IHZvaWQgMCAhPT0gdC51bmFyeUZpbHRlciA/IFsgVXModCkgXSA6IHZvaWQgMCAhPT0gdC5maWVsZEZpbHRlciA/IFsgTHModCkgXSA6IHZvaWQgMCAhPT0gdC5jb21wb3NpdGVGaWx0ZXIgPyB0LmNvbXBvc2l0ZUZpbHRlci5maWx0ZXJzLm1hcCgodCA9PiBNcyh0KSkpLnJlZHVjZSgoKHQsIGUpID0+IHQuY29uY2F0KGUpKSkgOiBMKCkgOiBbXTtcbn1cblxuZnVuY3Rpb24gT3ModCkge1xuICAgIHJldHVybiBjc1t0XTtcbn1cblxuZnVuY3Rpb24gRnModCkge1xuICAgIHJldHVybiBoc1t0XTtcbn1cblxuZnVuY3Rpb24gJHModCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkUGF0aDogdC5jYW5vbmljYWxTdHJpbmcoKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIEJzKHQpIHtcbiAgICByZXR1cm4gbXQuZnJvbVNlcnZlckZvcm1hdCh0LmZpZWxkUGF0aCk7XG59XG5cbmZ1bmN0aW9uIExzKHQpIHtcbiAgICByZXR1cm4gVmUuY3JlYXRlKEJzKHQuZmllbGRGaWx0ZXIuZmllbGQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2UgXCJFUVVBTFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPT1cIiAvKiBFUVVBTCAqLztcblxuICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkdSRUFURVJfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPFwiIC8qIExFU1NfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJMRVNTX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovO1xuXG4gICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovO1xuXG4gICAgICAgICAgY2FzZSBcIk5PVF9JTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogTk9UX0lOICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBMKCk7XG4gICAgICAgIH1cbiAgICB9KHQuZmllbGRGaWx0ZXIub3ApLCB0LmZpZWxkRmlsdGVyLnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gVXModCkge1xuICAgIHN3aXRjaCAodC51bmFyeUZpbHRlci5vcCkge1xuICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICBjb25zdCBlID0gQnModC51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgIHJldHVybiBWZS5jcmVhdGUoZSwgXCI9PVwiIC8qIEVRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05VTExcIjpcbiAgICAgICAgY29uc3QgbiA9IEJzKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICByZXR1cm4gVmUuY3JlYXRlKG4sIFwiPT1cIiAvKiBFUVVBTCAqLyAsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSk7XG5cbiAgICAgIGNhc2UgXCJJU19OT1RfTkFOXCI6XG4gICAgICAgIGNvbnN0IHMgPSBCcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIFZlLmNyZWF0ZShzLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgIGNvbnN0IGkgPSBCcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIFZlLmNyZWF0ZShpLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIEwoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHFzKHQpIHtcbiAgICBjb25zdCBlID0gW107XG4gICAgcmV0dXJuIHQuZmllbGRzLmZvckVhY2goKHQgPT4gZS5wdXNoKHQuY2Fub25pY2FsU3RyaW5nKCkpKSksIHtcbiAgICAgICAgZmllbGRQYXRoczogZVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIEtzKHQpIHtcbiAgICAvLyBSZXNvdXJjZSBuYW1lcyBoYXZlIGF0IGxlYXN0IDQgY29tcG9uZW50cyAocHJvamVjdCBJRCwgZGF0YWJhc2UgSUQpXG4gICAgcmV0dXJuIHQubGVuZ3RoID49IDQgJiYgXCJwcm9qZWN0c1wiID09PSB0LmdldCgwKSAmJiBcImRhdGFiYXNlc1wiID09PSB0LmdldCgyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRW5jb2RlcyBhIHJlc291cmNlIHBhdGggaW50byBhIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtLlxuICovXG5mdW5jdGlvbiBHcyh0KSB7XG4gICAgbGV0IGUgPSBcIlwiO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykgZS5sZW5ndGggPiAwICYmIChlID0ganMoZSkpLCBlID0gUXModC5nZXQobiksIGUpO1xuICAgIHJldHVybiBqcyhlKTtcbn1cblxuLyoqIEVuY29kZXMgYSBzaW5nbGUgc2VnbWVudCBvZiBhIHJlc291cmNlIHBhdGggaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIFFzKHQsIGUpIHtcbiAgICBsZXQgbiA9IGU7XG4gICAgY29uc3QgcyA9IHQubGVuZ3RoO1xuICAgIGZvciAobGV0IGUgPSAwOyBlIDwgczsgZSsrKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0LmNoYXJBdChlKTtcbiAgICAgICAgc3dpdGNoIChzKSB7XG4gICAgICAgICAgY2FzZSBcIlxcMFwiOlxuICAgICAgICAgICAgbiArPSBcIlx1MDAwMVx1MDAxMFwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiXHUwMDAxXCI6XG4gICAgICAgICAgICBuICs9IFwiXHUwMDAxXHUwMDExXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBuICs9IHM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG47XG59XG5cbi8qKiBFbmNvZGVzIGEgcGF0aCBzZXBhcmF0b3IgaW50byB0aGUgZ2l2ZW4gcmVzdWx0ICovIGZ1bmN0aW9uIGpzKHQpIHtcbiAgICByZXR1cm4gdCArIFwiXHUwMDAxXHUwMDAxXCI7XG59XG5cbi8qKlxuICogRGVjb2RlcyB0aGUgZ2l2ZW4gSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0gb2YgYSByZXNvdXJjZSBwYXRoIGludG9cbiAqIGEgUmVzb3VyY2VQYXRoIGluc3RhbmNlLiBOb3RlIHRoYXQgdGhpcyBtZXRob2QgaXMgbm90IHN1aXRhYmxlIGZvciB1c2Ugd2l0aFxuICogZGVjb2RpbmcgcmVzb3VyY2UgbmFtZXMgZnJvbSB0aGUgc2VydmVyOyB0aG9zZSBhcmUgT25lIFBsYXRmb3JtIGZvcm1hdFxuICogc3RyaW5ncy5cbiAqLyBmdW5jdGlvbiBXcyh0KSB7XG4gICAgLy8gRXZlbnQgdGhlIGVtcHR5IHBhdGggbXVzdCBlbmNvZGUgYXMgYSBwYXRoIG9mIGF0IGxlYXN0IGxlbmd0aCAyLiBBIHBhdGhcbiAgICAvLyB3aXRoIGV4YWN0bHkgMiBtdXN0IGJlIHRoZSBlbXB0eSBwYXRoLlxuICAgIGNvbnN0IGUgPSB0Lmxlbmd0aDtcbiAgICBpZiAoVShlID49IDIpLCAyID09PSBlKSByZXR1cm4gVShcIlx1MDAwMVwiID09PSB0LmNoYXJBdCgwKSAmJiBcIlx1MDAwMVwiID09PSB0LmNoYXJBdCgxKSksIF90LmVtcHR5UGF0aCgpO1xuICAgIC8vIEVzY2FwZSBjaGFyYWN0ZXJzIGNhbm5vdCBleGlzdCBwYXN0IHRoZSBzZWNvbmQtdG8tbGFzdCBwb3NpdGlvbiBpbiB0aGVcbiAgICAvLyBzb3VyY2UgdmFsdWUuXG4gICAgICAgIGNvbnN0IG4gPSBlIC0gMiwgcyA9IFtdO1xuICAgIGxldCBpID0gXCJcIjtcbiAgICBmb3IgKGxldCByID0gMDsgciA8IGU7ICkge1xuICAgICAgICAvLyBUaGUgbGFzdCB0d28gY2hhcmFjdGVycyBvZiBhIHZhbGlkIGVuY29kZWQgcGF0aCBtdXN0IGJlIGEgc2VwYXJhdG9yLCBzb1xuICAgICAgICAvLyB0aGVyZSBtdXN0IGJlIGFuIGVuZCB0byB0aGlzIHNlZ21lbnQuXG4gICAgICAgIGNvbnN0IGUgPSB0LmluZGV4T2YoXCJcdTAwMDFcIiwgcik7XG4gICAgICAgIChlIDwgMCB8fCBlID4gbikgJiYgTCgpO1xuICAgICAgICBzd2l0Y2ggKHQuY2hhckF0KGUgKyAxKSkge1xuICAgICAgICAgIGNhc2UgXCJcdTAwMDFcIjpcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnN1YnN0cmluZyhyLCBlKTtcbiAgICAgICAgICAgIGxldCBvO1xuICAgICAgICAgICAgMCA9PT0gaS5sZW5ndGggPyBcbiAgICAgICAgICAgIC8vIEF2b2lkIGNvcHlpbmcgZm9yIHRoZSBjb21tb24gY2FzZSBvZiBhIHNlZ21lbnQgdGhhdCBleGNsdWRlcyBcXDBcbiAgICAgICAgICAgIC8vIGFuZCBcXDAwMVxuICAgICAgICAgICAgbyA9IG4gOiAoaSArPSBuLCBvID0gaSwgaSA9IFwiXCIpLCBzLnB1c2gobyk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMTBcIjpcbiAgICAgICAgICAgIGkgKz0gdC5zdWJzdHJpbmcociwgZSksIGkgKz0gXCJcXDBcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAxMVwiOlxuICAgICAgICAgICAgLy8gVGhlIGVzY2FwZSBjaGFyYWN0ZXIgY2FuIGJlIHVzZWQgaW4gdGhlIG91dHB1dCB0byBlbmNvZGUgaXRzZWxmLlxuICAgICAgICAgICAgaSArPSB0LnN1YnN0cmluZyhyLCBlICsgMSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBMKCk7XG4gICAgICAgIH1cbiAgICAgICAgciA9IGUgKyAyO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IF90KHMpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCB6cyA9IFsgXCJ1c2VySWRcIiwgXCJiYXRjaElkXCIgXTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIG5hbWUgJ293bmVyJyBpcyBjaG9zZW4gdG8gZW5zdXJlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGhcbiAqIG9sZGVyIGNsaWVudHMgdGhhdCBvbmx5IHN1cHBvcnRlZCBzaW5nbGUgbG9ja2VkIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2VcbiAqIGxheWVyLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSBbdXNlcklkLCBlbmNvZGVkUGF0aF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnNcbiAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gKi9cbmZ1bmN0aW9uIEhzKHQsIGUpIHtcbiAgICByZXR1cm4gWyB0LCBHcyhlKSBdO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxsIGluZGV4IGtleSBvZiBbdXNlcklkLCBlbmNvZGVkUGF0aCwgYmF0Y2hJZF0gZm9yIGluc2VydGluZ1xuICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXG4gKi8gZnVuY3Rpb24gSnModCwgZSwgbikge1xuICAgIHJldHVybiBbIHQsIEdzKGUpLCBuIF07XG59XG5cbi8qKlxuICogQmVjYXVzZSB3ZSBzdG9yZSBhbGwgdGhlIHVzZWZ1bCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBzdG9yZSBpbiB0aGUga2V5LFxuICogdGhlcmUgaXMgbm8gdXNlZnVsIGluZm9ybWF0aW9uIHRvIHN0b3JlIGFzIHRoZSB2YWx1ZS4gVGhlIHJhdyAodW5lbmNvZGVkKVxuICogcGF0aCBjYW5ub3QgYmUgc3RvcmVkIGJlY2F1c2UgSW5kZXhlZERiIGRvZXNuJ3Qgc3RvcmUgcHJvdG90eXBlXG4gKiBpbmZvcm1hdGlvbi5cbiAqLyBjb25zdCBZcyA9IHt9LCBYcyA9IFsgXCJwcmVmaXhQYXRoXCIsIFwiY29sbGVjdGlvbkdyb3VwXCIsIFwicmVhZFRpbWVcIiwgXCJkb2N1bWVudElkXCIgXSwgWnMgPSBbIFwicHJlZml4UGF0aFwiLCBcImNvbGxlY3Rpb25Hcm91cFwiLCBcImRvY3VtZW50SWRcIiBdLCB0aSA9IFsgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJyZWFkVGltZVwiLCBcInByZWZpeFBhdGhcIiwgXCJkb2N1bWVudElkXCIgXSwgZWkgPSBbIFwiY2Fub25pY2FsSWRcIiwgXCJ0YXJnZXRJZFwiIF0sIG5pID0gWyBcInRhcmdldElkXCIsIFwicGF0aFwiIF0sIHNpID0gWyBcInBhdGhcIiwgXCJ0YXJnZXRJZFwiIF0sIGlpID0gWyBcImNvbGxlY3Rpb25JZFwiLCBcInBhcmVudFwiIF0sIHJpID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiBdLCBvaSA9IFsgXCJ1aWRcIiwgXCJzZXF1ZW5jZU51bWJlclwiIF0sIHVpID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiwgXCJhcnJheVZhbHVlXCIsIFwiZGlyZWN0aW9uYWxWYWx1ZVwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiLCBcImRvY3VtZW50S2V5XCIgXSwgYWkgPSBbIFwiaW5kZXhJZFwiLCBcInVpZFwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiIF0sIGNpID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwiZG9jdW1lbnRJZFwiIF0sIGhpID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwibGFyZ2VzdEJhdGNoSWRcIiBdLCBsaSA9IFsgXCJ1c2VySWRcIiwgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJsYXJnZXN0QmF0Y2hJZFwiIF0sIGZpID0gWyAuLi5bIC4uLlsgLi4uWyAuLi5bIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1wiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiIF0sIFwiY2xpZW50TWV0YWRhdGFcIiBdLCBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIgXSwgXCJjb2xsZWN0aW9uUGFyZW50c1wiIF0sIFwiYnVuZGxlc1wiLCBcIm5hbWVkUXVlcmllc1wiIF0sIGRpID0gWyAuLi5maSwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgX2kgPSBbIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1YxNFwiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiLCBcImNsaWVudE1ldGFkYXRhXCIsIFwicmVtb3RlRG9jdW1lbnRHbG9iYWxcIiwgXCJjb2xsZWN0aW9uUGFyZW50c1wiLCBcImJ1bmRsZXNcIiwgXCJuYW1lZFF1ZXJpZXNcIiwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgd2kgPSBbIC4uLl9pLCBcImluZGV4Q29uZmlndXJhdGlvblwiLCBcImluZGV4U3RhdGVcIiwgXCJpbmRleEVudHJpZXNcIiBdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgbWkgPSBcIlRoZSBjdXJyZW50IHRhYiBpcyBub3QgaW4gdGhlIHJlcXVpcmVkIHN0YXRlIHRvIHBlcmZvcm0gdGhpcyBvcGVyYXRpb24uIEl0IG1pZ2h0IGJlIG5lY2Vzc2FyeSB0byByZWZyZXNoIHRoZSBicm93c2VyIHRhYi5cIjtcblxuLyoqXG4gKiBBIGJhc2UgY2xhc3MgcmVwcmVzZW50aW5nIGEgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24sIGVuY2Fwc3VsYXRpbmcgYm90aCB0aGVcbiAqIHRyYW5zYWN0aW9uJ3Mgc2VxdWVuY2UgbnVtYmVycyBhcyB3ZWxsIGFzIGEgbGlzdCBvZiBvbkNvbW1pdHRlZCBsaXN0ZW5lcnMuXG4gKlxuICogV2hlbiB5b3UgY2FsbCBQZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbigpLCBpdCB3aWxsIGNyZWF0ZSBhIHRyYW5zYWN0aW9uIGFuZFxuICogcGFzcyBpdCB0byB5b3VyIGNhbGxiYWNrLiBZb3UgdGhlbiBwYXNzIGl0IHRvIGFueSBtZXRob2QgdGhhdCBvcGVyYXRlc1xuICogb24gcGVyc2lzdGVuY2UuXG4gKi8gY2xhc3MgZ2kge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzID0gW107XG4gICAgfVxuICAgIGFkZE9uQ29tbWl0dGVkTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzLnB1c2godCk7XG4gICAgfVxuICAgIHJhaXNlT25Db21taXR0ZWRFdmVudCgpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycy5mb3JFYWNoKCh0ID0+IHQoKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGVyc2lzdGVuY2VQcm9taXNlIGlzIGVzc2VudGlhbGx5IGEgcmUtaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZSBleGNlcHRcbiAqIGl0IGhhcyBhIC5uZXh0KCkgbWV0aG9kIGluc3RlYWQgb2YgLnRoZW4oKSBhbmQgLm5leHQoKSBhbmQgLmNhdGNoKCkgY2FsbGJhY2tzXG4gKiBhcmUgZXhlY3V0ZWQgc3luY2hyb25vdXNseSB3aGVuIGEgUGVyc2lzdGVuY2VQcm9taXNlIHJlc29sdmVzIHJhdGhlciB0aGFuXG4gKiBhc3luY2hyb25vdXNseSAoUHJvbWlzZSBpbXBsZW1lbnRhdGlvbnMgdXNlIHNldEltbWVkaWF0ZSgpIG9yIHNpbWlsYXIpLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIGludGVyb3BlcmF0ZSB3aXRoIEluZGV4ZWREQiB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHlcbiAqIGNvbW1pdCB0cmFuc2FjdGlvbnMgaWYgY29udHJvbCBpcyByZXR1cm5lZCB0byB0aGUgZXZlbnQgbG9vcCB3aXRob3V0XG4gKiBzeW5jaHJvbm91c2x5IGluaXRpYXRpbmcgYW5vdGhlciBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uLlxuICpcbiAqIE5PVEU6IC50aGVuKCkgYW5kIC5jYXRjaCgpIG9ubHkgYWxsb3cgYSBzaW5nbGUgY29uc3VtZXIsIHVubGlrZSBub3JtYWxcbiAqIFByb21pc2VzLlxuICovIGNsYXNzIHlpIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIC8vIE5PVEU6IG5leHQvY2F0Y2hDYWxsYmFjayB3aWxsIGFsd2F5cyBwb2ludCB0byBvdXIgb3duIHdyYXBwZXIgZnVuY3Rpb25zLFxuICAgICAgICAvLyBub3QgdGhlIHVzZXIncyByYXcgbmV4dCgpIG9yIGNhdGNoKCkgY2FsbGJhY2tzLlxuICAgICAgICB0aGlzLm5leHRDYWxsYmFjayA9IG51bGwsIHRoaXMuY2F0Y2hDYWxsYmFjayA9IG51bGwsIFxuICAgICAgICAvLyBXaGVuIHRoZSBvcGVyYXRpb24gcmVzb2x2ZXMsIHdlJ2xsIHNldCByZXN1bHQgb3IgZXJyb3IgYW5kIG1hcmsgaXNEb25lLlxuICAgICAgICB0aGlzLnJlc3VsdCA9IHZvaWQgMCwgdGhpcy5lcnJvciA9IHZvaWQgMCwgdGhpcy5pc0RvbmUgPSAhMSwgXG4gICAgICAgIC8vIFNldCB0byB0cnVlIHdoZW4gLnRoZW4oKSBvciAuY2F0Y2goKSBhcmUgY2FsbGVkIGFuZCBwcmV2ZW50cyBhZGRpdGlvbmFsXG4gICAgICAgIC8vIGNoYWluaW5nLlxuICAgICAgICB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMSwgdCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLnJlc3VsdCA9IHQsIHRoaXMubmV4dENhbGxiYWNrICYmIFxuICAgICAgICAgICAgLy8gdmFsdWUgc2hvdWxkIGJlIGRlZmluZWQgdW5sZXNzIFQgaXMgVm9pZCwgYnV0IHdlIGNhbid0IGV4cHJlc3NcbiAgICAgICAgICAgIC8vIHRoYXQgaW4gdGhlIHR5cGUgc3lzdGVtLlxuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sodCk7XG4gICAgICAgIH0pLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLmVycm9yID0gdCwgdGhpcy5jYXRjaENhbGxiYWNrICYmIHRoaXMuY2F0Y2hDYWxsYmFjayh0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjYXRjaCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5leHQodm9pZCAwLCB0KTtcbiAgICB9XG4gICAgbmV4dCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgJiYgTCgpLCB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMCwgdGhpcy5pc0RvbmUgPyB0aGlzLmVycm9yID8gdGhpcy53cmFwRmFpbHVyZShlLCB0aGlzLmVycm9yKSA6IHRoaXMud3JhcFN1Y2Nlc3ModCwgdGhpcy5yZXN1bHQpIDogbmV3IHlpKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBTdWNjZXNzKHQsIGUpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9LCB0aGlzLmNhdGNoQ2FsbGJhY2sgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBGYWlsdXJlKGUsIHQpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvUHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0KHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHdyYXBVc2VyRnVuY3Rpb24odCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQoKTtcbiAgICAgICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgeWkgPyBlIDogeWkucmVzb2x2ZShlKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgcmV0dXJuIHlpLnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3cmFwU3VjY2Vzcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiB5aS5yZXNvbHZlKGUpO1xuICAgIH1cbiAgICB3cmFwRmFpbHVyZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiB5aS5yZWplY3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyByZXNvbHZlKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB5aSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGUodCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc3RhdGljIHJlamVjdCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgeWkoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBuKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyB3YWl0Rm9yKFxuICAgIC8vIEFjY2VwdCBhbGwgUHJvbWlzZSB0eXBlcyBpbiB3YWl0Rm9yKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB0KSB7XG4gICAgICAgIHJldHVybiBuZXcgeWkoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9IDAsIGkgPSAwLCByID0gITE7XG4gICAgICAgICAgICB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICsrcywgdC5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICsraSwgciAmJiBpID09PSBzICYmIGUoKTtcbiAgICAgICAgICAgICAgICB9KSwgKHQgPT4gbih0KSkpO1xuICAgICAgICAgICAgfSkpLCByID0gITAsIGkgPT09IHMgJiYgZSgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVuIGFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnMgdGhhdCBhc3luY2hyb25vdXNseSBldmFsdWF0ZSB0byBhXG4gICAgICogYm9vbGVhbiwgaW1wbGVtZW50cyBhIHNob3J0LWNpcmN1aXRpbmcgYG9yYCBiZXR3ZWVuIHRoZSByZXN1bHRzLiBQcmVkaWNhdGVzXG4gICAgICogd2lsbCBiZSBldmFsdWF0ZWQgdW50aWwgb25lIG9mIHRoZW0gcmV0dXJucyBgdHJ1ZWAsIHRoZW4gc3RvcC4gVGhlIGZpbmFsXG4gICAgICogcmVzdWx0IHdpbGwgYmUgd2hldGhlciBhbnkgb2YgdGhlbSByZXR1cm5lZCBgdHJ1ZWAuXG4gICAgICovICAgIHN0YXRpYyBvcih0KSB7XG4gICAgICAgIGxldCBlID0geWkucmVzb2x2ZSghMSk7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5uZXh0KCh0ID0+IHQgPyB5aS5yZXNvbHZlKHQpIDogbigpKSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBzdGF0aWMgZm9yRWFjaCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4ucHVzaChlLmNhbGwodGhpcywgdCwgcykpO1xuICAgICAgICB9KSksIHRoaXMud2FpdEZvcihuKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBSZWZlcmVuY2VzIHRvIGB3aW5kb3dgIGFyZSBndWFyZGVkIGJ5IFNpbXBsZURiLmlzQXZhaWxhYmxlKClcbi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyoqXG4gKiBXcmFwcyBhbiBJREJUcmFuc2FjdGlvbiBhbmQgZXhwb3NlcyBhIHN0b3JlKCkgbWV0aG9kIHRvIGdldCBhIGhhbmRsZSB0byBhXG4gKiBzcGVjaWZpYyBvYmplY3Qgc3RvcmUuXG4gKi9cbmNsYXNzIHBpIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gdCwgdGhpcy50cmFuc2FjdGlvbiA9IGUsIHRoaXMuYWJvcnRlZCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBJbmRleGVkRGIgdHJhbnNhY3Rpb24uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkF0ID0gbmV3IGosIHRoaXMudHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuQXQucmVzb2x2ZSgpO1xuICAgICAgICB9LCB0aGlzLnRyYW5zYWN0aW9uLm9uYWJvcnQgPSAoKSA9PiB7XG4gICAgICAgICAgICBlLmVycm9yID8gdGhpcy5BdC5yZWplY3QobmV3IEVpKHQsIGUuZXJyb3IpKSA6IHRoaXMuQXQucmVzb2x2ZSgpO1xuICAgICAgICB9LCB0aGlzLnRyYW5zYWN0aW9uLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBWaShlLnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICB0aGlzLkF0LnJlamVjdChuZXcgRWkodCwgbikpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgb3Blbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHBpKGUsIHQudHJhbnNhY3Rpb24ocywgbikpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRWkoZSwgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IFJ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5BdC5wcm9taXNlO1xuICAgIH1cbiAgICBhYm9ydCh0KSB7XG4gICAgICAgIHQgJiYgdGhpcy5BdC5yZWplY3QodCksIHRoaXMuYWJvcnRlZCB8fCAoTyhcIlNpbXBsZURiXCIsIFwiQWJvcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQgPyB0Lm1lc3NhZ2UgOiBcIkNsaWVudC1pbml0aWF0ZWQgYWJvcnRcIiksIFxuICAgICAgICB0aGlzLmFib3J0ZWQgPSAhMCwgdGhpcy50cmFuc2FjdGlvbi5hYm9ydCgpKTtcbiAgICB9XG4gICAgYnQoKSB7XG4gICAgICAgIC8vIElmIHRoZSBicm93c2VyIHN1cHBvcnRzIFYzIEluZGV4ZWREQiwgd2UgaW52b2tlIGNvbW1pdCgpIGV4cGxpY2l0bHkgdG9cbiAgICAgICAgLy8gc3BlZWQgdXAgaW5kZXggREIgcHJvY2Vzc2luZyBpZiB0aGUgZXZlbnQgbG9vcCByZW1haW5zIGJsb2Nrcy5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgY29uc3QgdCA9IHRoaXMudHJhbnNhY3Rpb247XG4gICAgICAgIHRoaXMuYWJvcnRlZCB8fCBcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIHQuY29tbWl0IHx8IHQuY29tbWl0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBTaW1wbGVEYlN0b3JlPEtleVR5cGUsIFZhbHVlVHlwZT4gZm9yIHRoZSBzcGVjaWZpZWQgc3RvcmUuIEFsbFxuICAgICAqIG9wZXJhdGlvbnMgcGVyZm9ybWVkIG9uIHRoZSBTaW1wbGVEYlN0b3JlIGhhcHBlbiB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhpc1xuICAgICAqIHRyYW5zYWN0aW9uIGFuZCBpdCBjYW5ub3QgYmUgdXNlZCBhbnltb3JlIG9uY2UgdGhlIHRyYW5zYWN0aW9uIGlzXG4gICAgICogY29tcGxldGVkLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHdlIGNhbid0IGFjdHVhbGx5IGVuZm9yY2UgdGhhdCB0aGUgS2V5VHlwZSBhbmQgVmFsdWVUeXBlIGFyZVxuICAgICAqIGNvcnJlY3QsIGJ1dCB0aGV5IGFsbG93IHR5cGUgc2FmZXR5IHRocm91Z2ggdGhlIHJlc3Qgb2YgdGhlIGNvbnN1bWluZyBjb2RlLlxuICAgICAqLyAgICBzdG9yZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHQpO1xuICAgICAgICByZXR1cm4gbmV3IFJpKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIHdyYXBwZXIgYXJvdW5kIEluZGV4ZWREYiB3aXRoIGEgc2ltcGxpZmllZCBpbnRlcmZhY2UgdGhhdCB1c2VzXG4gKiBQcm9taXNlLWxpa2UgcmV0dXJuIHZhbHVlcyB0byBjaGFpbiBvcGVyYXRpb25zLiBSZWFsIHByb21pc2VzIGNhbm5vdCBiZSB1c2VkXG4gKiBzaW5jZSAudGhlbigpIGNvbnRpbnVhdGlvbnMgYXJlIGV4ZWN1dGVkIGFzeW5jaHJvbm91c2x5IChlLmcuIHZpYVxuICogLnNldEltbWVkaWF0ZSksIHdoaWNoIHdvdWxkIGNhdXNlIEluZGV4ZWREQiB0byBlbmQgdGhlIHRyYW5zYWN0aW9uLlxuICogU2VlIFBlcnNpc3RlbmNlUHJvbWlzZSBmb3IgbW9yZSBkZXRhaWxzLlxuICovIGNsYXNzIElpIHtcbiAgICAvKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgU2ltcGxlRGIgd3JhcHBlciBmb3IgSW5kZXhlZERiIGRhdGFiYXNlIGBuYW1lYC5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBgdmVyc2lvbmAgbXVzdCBub3QgYmUgYSBkb3duZ3JhZGUuIEluZGV4ZWREQiBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICogZG93bmdyYWRpbmcgdGhlIHNjaGVtYSB2ZXJzaW9uLiBXZSBjdXJyZW50bHkgZG8gbm90IHN1cHBvcnQgYW55IHdheSB0byBkb1xuICAgICAqIHZlcnNpb25pbmcgb3V0c2lkZSBvZiBJbmRleGVkREIncyB2ZXJzaW9uaW5nIG1lY2hhbmlzbSwgYXMgb25seVxuICAgICAqIHZlcnNpb24tdXBncmFkZSB0cmFuc2FjdGlvbnMgYXJlIGFsbG93ZWQgdG8gZG8gdGhpbmdzIGxpa2UgY3JlYXRlXG4gICAgICogb2JqZWN0c3RvcmVzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5uYW1lID0gdCwgdGhpcy52ZXJzaW9uID0gZSwgdGhpcy5QdCA9IG47XG4gICAgICAgIC8vIE5PVEU6IEFjY29yZGluZyB0byBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTk3MDUwLCB0aGVcbiAgICAgICAgLy8gYnVnIHdlJ3JlIGNoZWNraW5nIGZvciBzaG91bGQgZXhpc3QgaW4gaU9TID49IDEyLjIgYW5kIDwgMTMsIGJ1dCBmb3JcbiAgICAgICAgLy8gd2hhdGV2ZXIgcmVhc29uIGl0J3MgbXVjaCBoYXJkZXIgdG8gaGl0IGFmdGVyIDEyLjIgc28gd2Ugb25seSBwcm9hY3RpdmVseVxuICAgICAgICAvLyBsb2cgb24gMTIuMi5cbiAgICAgICAgMTIuMiA9PT0gSWkuVnQoZ2V0VUEoKSkgJiYgRihcIkZpcmVzdG9yZSBwZXJzaXN0ZW5jZSBzdWZmZXJzIGZyb20gYSBidWcgaW4gaU9TIDEyLjIgU2FmYXJpIHRoYXQgbWF5IGNhdXNlIHlvdXIgYXBwIHRvIHN0b3Agd29ya2luZy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuXCIpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLiAqLyAgICBzdGF0aWMgZGVsZXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIE8oXCJTaW1wbGVEYlwiLCBcIlJlbW92aW5nIGRhdGFiYXNlOlwiLCB0KSwgYmkod2luZG93LmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZSh0KSkudG9Qcm9taXNlKCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgSW5kZXhlZERCIGlzIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gKi8gICAgc3RhdGljIHZ0KCkge1xuICAgICAgICBpZiAoIWlzSW5kZXhlZERCQXZhaWxhYmxlKCkpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKElpLlN0KCkpIHJldHVybiAhMDtcbiAgICAgICAgLy8gV2UgZXh0ZW5zaXZlbHkgdXNlIGluZGV4ZWQgYXJyYXkgdmFsdWVzIGFuZCBjb21wb3VuZCBrZXlzLFxuICAgICAgICAvLyB3aGljaCBJRSBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydC4gSG93ZXZlciwgdGhleSBzdGlsbCBoYXZlIGluZGV4ZWREQlxuICAgICAgICAvLyBkZWZpbmVkIG9uIHRoZSB3aW5kb3csIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoZW0gaGVyZSBhbmQgbWFrZSBzdXJlXG4gICAgICAgIC8vIHRvIHJldHVybiB0aGF0IHBlcnNpc3RlbmNlIGlzIG5vdCBlbmFibGVkIGZvciB0aG9zZSBicm93c2Vycy5cbiAgICAgICAgLy8gRm9yIHRyYWNraW5nIHN1cHBvcnQgb2YgdGhpcyBmZWF0dXJlLCBzZWUgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9zdGF0dXMvaW5kZXhlZGRiYXJyYXlzYW5kbXVsdGllbnRyeXN1cHBvcnQvXG4gICAgICAgIC8vIENoZWNrIHRoZSBVQSBzdHJpbmcgdG8gZmluZCBvdXQgdGhlIGJyb3dzZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGdldFVBKCksIGUgPSBJaS5WdCh0KSwgbiA9IDAgPCBlICYmIGUgPCAxMCwgcyA9IElpLkR0KHQpLCBpID0gMCA8IHMgJiYgcyA8IDQuNTtcbiAgICAgICAgLy8gSUUgMTBcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IE1TSUUgMTAuMDsgV2luZG93cyBOVCA2LjI7IFRyaWRlbnQvNi4wKSc7XG4gICAgICAgIC8vIElFIDExXG4gICAgICAgIC8vIHVhID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMzsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28nO1xuICAgICAgICAvLyBFZGdlXG4gICAgICAgIC8vIHVhID0gJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLFxuICAgICAgICAvLyBsaWtlIEdlY2tvKSBDaHJvbWUvMzkuMC4yMTcxLjcxIFNhZmFyaS81MzcuMzYgRWRnZS8xMi4wJztcbiAgICAgICAgLy8gaU9TIFNhZmFyaTogRGlzYWJsZSBmb3IgdXNlcnMgcnVubmluZyBpT1MgdmVyc2lvbiA8IDEwLlxuICAgICAgICAgICAgICAgIHJldHVybiAhKHQuaW5kZXhPZihcIk1TSUUgXCIpID4gMCB8fCB0LmluZGV4T2YoXCJUcmlkZW50L1wiKSA+IDAgfHwgdC5pbmRleE9mKFwiRWRnZS9cIikgPiAwIHx8IG4gfHwgaSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgYmFja2luZyBJbmRleGVkREIgc3RvcmUgaXMgdGhlIE5vZGUgSW5kZXhlZERCU2hpbVxuICAgICAqIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL2F4ZW1jbGlvbi9JbmRleGVkREJTaGltKS5cbiAgICAgKi8gICAgc3RhdGljIFN0KCkge1xuICAgICAgICB2YXIgdDtcbiAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHByb2Nlc3MgJiYgXCJZRVNcIiA9PT0gKG51bGwgPT09ICh0ID0gcHJvY2Vzcy5lbnYpIHx8IHZvaWQgMCA9PT0gdCA/IHZvaWQgMCA6IHQuQ3QpO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZnJvbSBhIHRyYW5zYWN0aW9uLiAqLyAgICBzdGF0aWMgeHQodCwgZSkge1xuICAgICAgICByZXR1cm4gdC5zdG9yZShlKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIC8qKiBQYXJzZSBVc2VyIEFnZW50IHRvIGRldGVybWluZSBpT1MgdmVyc2lvbi4gUmV0dXJucyAtMSBpZiBub3QgZm91bmQuICovXG4gICAgc3RhdGljIFZ0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQubWF0Y2goL2koPzpwaG9uZXxwYWR8cG9kKSBvcyAoW1xcZF9dKykvaSksIG4gPSBlID8gZVsxXS5zcGxpdChcIl9cIikuc2xpY2UoMCwgMikuam9pbihcIi5cIikgOiBcIi0xXCI7XG4gICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgfVxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAvKiogUGFyc2UgVXNlciBBZ2VudCB0byBkZXRlcm1pbmUgQW5kcm9pZCB2ZXJzaW9uLiBSZXR1cm5zIC0xIGlmIG5vdCBmb3VuZC4gKi9cbiAgICBzdGF0aWMgRHQodCkge1xuICAgICAgICBjb25zdCBlID0gdC5tYXRjaCgvQW5kcm9pZCAoW1xcZC5dKykvaSksIG4gPSBlID8gZVsxXS5zcGxpdChcIi5cIikuc2xpY2UoMCwgMikuam9pbihcIi5cIikgOiBcIi0xXCI7XG4gICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UsIGNyZWF0aW5nIG9yIHVwZ3JhZGluZyBpdCBpZiBuZWNlc3NhcnkuXG4gICAgICovICAgIGFzeW5jIE50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIgfHwgKE8oXCJTaW1wbGVEYlwiLCBcIk9wZW5pbmcgZGF0YWJhc2U6XCIsIHRoaXMubmFtZSksIHRoaXMuZGIgPSBhd2FpdCBuZXcgUHJvbWlzZSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogSW52ZXN0aWdhdGUgYnJvd3NlciBjb21wYXRpYmlsaXR5LlxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0luZGV4ZWREQl9BUEkvVXNpbmdfSW5kZXhlZERCXG4gICAgICAgICAgICAvLyBzdWdnZXN0cyBJRTkgYW5kIG9sZGVyIFdlYktpdCBicm93c2VycyBoYW5kbGUgdXBncmFkZVxuICAgICAgICAgICAgLy8gZGlmZmVyZW50bHkuIFRoZXkgZXhwZWN0IHNldFZlcnNpb24sIGFzIGRlc2NyaWJlZCBoZXJlOlxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0lEQlZlcnNpb25DaGFuZ2VSZXF1ZXN0L3NldFZlcnNpb25cbiAgICAgICAgICAgIGNvbnN0IHMgPSBpbmRleGVkREIub3Blbih0aGlzLm5hbWUsIHRoaXMudmVyc2lvbik7XG4gICAgICAgICAgICBzLm9uc3VjY2VzcyA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgZShuKTtcbiAgICAgICAgICAgIH0sIHMub25ibG9ja2VkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIG4obmV3IEVpKHQsIFwiQ2Fubm90IHVwZ3JhZGUgSW5kZXhlZERCIHNjaGVtYSB3aGlsZSBhbm90aGVyIHRhYiBpcyBvcGVuLiBDbG9zZSBhbGwgdGFicyB0aGF0IGFjY2VzcyBGaXJlc3RvcmUgYW5kIHJlbG9hZCB0aGlzIHBhZ2UgdG8gcHJvY2VlZC5cIikpO1xuICAgICAgICAgICAgfSwgcy5vbmVycm9yID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGUudGFyZ2V0LmVycm9yO1xuICAgICAgICAgICAgICAgIFwiVmVyc2lvbkVycm9yXCIgPT09IHMubmFtZSA/IG4obmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkEgbmV3ZXIgdmVyc2lvbiBvZiB0aGUgRmlyZXN0b3JlIFNESyB3YXMgcHJldmlvdXNseSB1c2VkIGFuZCBzbyB0aGUgcGVyc2lzdGVkIGRhdGEgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB0aGUgdmVyc2lvbiBvZiB0aGUgU0RLIHlvdSBhcmUgbm93IHVzaW5nLiBUaGUgU0RLIHdpbGwgb3BlcmF0ZSB3aXRoIHBlcnNpc3RlbmNlIGRpc2FibGVkLiBJZiB5b3UgbmVlZCBwZXJzaXN0ZW5jZSwgcGxlYXNlIHJlLXVwZ3JhZGUgdG8gYSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBTREsgb3IgZWxzZSBjbGVhciB0aGUgcGVyc2lzdGVkIEluZGV4ZWREQiBkYXRhIGZvciB5b3VyIGFwcCB0byBzdGFydCBmcmVzaC5cIikpIDogXCJJbnZhbGlkU3RhdGVFcnJvclwiID09PSBzLm5hbWUgPyBuKG5ldyBRKEcuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJVbmFibGUgdG8gb3BlbiBhbiBJbmRleGVkREIgY29ubmVjdGlvbi4gVGhpcyBjb3VsZCBiZSBkdWUgdG8gcnVubmluZyBpbiBhIHByaXZhdGUgYnJvd3Npbmcgc2Vzc2lvbiBvbiBhIGJyb3dzZXIgd2hvc2UgcHJpdmF0ZSBicm93c2luZyBzZXNzaW9ucyBkbyBub3Qgc3VwcG9ydCBJbmRleGVkREI6IFwiICsgcykpIDogbihuZXcgRWkodCwgcykpO1xuICAgICAgICAgICAgfSwgcy5vbnVwZ3JhZGVuZWVkZWQgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBPKFwiU2ltcGxlRGJcIiwgJ0RhdGFiYXNlIFwiJyArIHRoaXMubmFtZSArICdcIiByZXF1aXJlcyB1cGdyYWRlIGZyb20gdmVyc2lvbjonLCB0Lm9sZFZlcnNpb24pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5QdC5rdChlLCBzLnRyYW5zYWN0aW9uLCB0Lm9sZFZlcnNpb24sIHRoaXMudmVyc2lvbikubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBPKFwiU2ltcGxlRGJcIiwgXCJEYXRhYmFzZSB1cGdyYWRlIHRvIHZlcnNpb24gXCIgKyB0aGlzLnZlcnNpb24gKyBcIiBjb21wbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSkpLCB0aGlzLk10ICYmICh0aGlzLmRiLm9udmVyc2lvbmNoYW5nZSA9IHQgPT4gdGhpcy5NdCh0KSksIHRoaXMuZGI7XG4gICAgfVxuICAgIE90KHQpIHtcbiAgICAgICAgdGhpcy5NdCA9IHQsIHRoaXMuZGIgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gZSA9PiB0KGUpKTtcbiAgICB9XG4gICAgYXN5bmMgcnVuVHJhbnNhY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gXCJyZWFkb25seVwiID09PSBlO1xuICAgICAgICBsZXQgciA9IDA7XG4gICAgICAgIGZvciAoOzspIHtcbiAgICAgICAgICAgICsrcjtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYiA9IGF3YWl0IHRoaXMuTnQodCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHBpLm9wZW4odGhpcy5kYiwgdCwgaSA/IFwicmVhZG9ubHlcIiA6IFwicmVhZHdyaXRlXCIsIG4pLCByID0gcyhlKS5uZXh0KCh0ID0+IChlLmJ0KCksIFxuICAgICAgICAgICAgICAgIHQpKSkuY2F0Y2goKHQgPT4gKFxuICAgICAgICAgICAgICAgIC8vIEFib3J0IHRoZSB0cmFuc2FjdGlvbiBpZiB0aGVyZSB3YXMgYW4gZXJyb3IuXG4gICAgICAgICAgICAgICAgZS5hYm9ydCh0KSwgeWkucmVqZWN0KHQpKSkpLnRvUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIC8vIEFzIG5vdGVkIGFib3ZlLCBlcnJvcnMgYXJlIHByb3BhZ2F0ZWQgYnkgYWJvcnRpbmcgdGhlIHRyYW5zYWN0aW9uLiBTb1xuICAgICAgICAgICAgICAgIC8vIHdlIHN3YWxsb3cgYW55IGVycm9yIGhlcmUgdG8gYXZvaWQgdGhlIGJyb3dzZXIgbG9nZ2luZyBpdCBhcyB1bmhhbmRsZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuY2F0Y2goKCgpID0+IHt9KSksIFxuICAgICAgICAgICAgICAgIC8vIFdhaXQgZm9yIHRoZSB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSAoaS5lLiBJbmRleGVkRGIncyBvbnN1Y2Nlc3MgZXZlbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBmaXJlKSwgYnV0IHN0aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgdHJhbnNhY3Rpb25GblJlc3VsdCBiYWNrIHRvIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhbGxlci5cbiAgICAgICAgICAgICAgICBhd2FpdCBlLlJ0LCByO1xuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgIC8vIFRPRE8oc2NobWlkdC1zZWJhc3RpYW4pOiBXZSBjb3VsZCBwcm9iYWJseSBiZSBzbWFydGVyIGFib3V0IHRoaXMgYW5kXG4gICAgICAgICAgICAgICAgLy8gbm90IHJldHJ5IGV4Y2VwdGlvbnMgdGhhdCBhcmUgbGlrZWx5IHVucmVjb3ZlcmFibGUgKHN1Y2ggYXMgcXVvdGFcbiAgICAgICAgICAgICAgICAvLyBleGNlZWRlZCBlcnJvcnMpLlxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IFdlIGNhbm5vdCB1c2UgYW4gaW5zdGFuY2VvZiBjaGVjayBmb3IgRmlyZXN0b3JlRXhjZXB0aW9uLCBzaW5jZSB0aGVcbiAgICAgICAgICAgICAgICAvLyBleGNlcHRpb24gaXMgd3JhcHBlZCBpbiBhIGdlbmVyaWMgZXJyb3IgYnkgb3VyIGFzeW5jL2F3YWl0IGhhbmRsaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBcIkZpcmViYXNlRXJyb3JcIiAhPT0gdC5uYW1lICYmIHIgPCAzO1xuICAgICAgICAgICAgICAgIGlmIChPKFwiU2ltcGxlRGJcIiwgXCJUcmFuc2FjdGlvbiBmYWlsZWQgd2l0aCBlcnJvcjpcIiwgdC5tZXNzYWdlLCBcIlJldHJ5aW5nOlwiLCBlKSwgXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpLCAhZSkgcmV0dXJuIFByb21pc2UucmVqZWN0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLmRiICYmIHRoaXMuZGIuY2xvc2UoKSwgdGhpcy5kYiA9IHZvaWQgMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBjb250cm9sbGVyIGZvciBpdGVyYXRpbmcgb3ZlciBhIGtleSByYW5nZSBvciBpbmRleC4gSXQgYWxsb3dzIGFuIGl0ZXJhdGVcbiAqIGNhbGxiYWNrIHRvIGRlbGV0ZSB0aGUgY3VycmVudGx5LXJlZmVyZW5jZWQgb2JqZWN0LCBvciBqdW1wIHRvIGEgbmV3IGtleVxuICogd2l0aGluIHRoZSBrZXkgcmFuZ2Ugb3IgaW5kZXguXG4gKi8gY2xhc3MgVGkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5GdCA9IHQsIHRoaXMuJHQgPSAhMSwgdGhpcy5CdCA9IG51bGw7XG4gICAgfVxuICAgIGdldCBpc0RvbmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiR0O1xuICAgIH1cbiAgICBnZXQgTHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkJ0O1xuICAgIH1cbiAgICBzZXQgY3Vyc29yKHQpIHtcbiAgICAgICAgdGhpcy5GdCA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBzdG9wIGl0ZXJhdGlvbiBhdCBhbnkgcG9pbnQuXG4gICAgICovICAgIGRvbmUoKSB7XG4gICAgICAgIHRoaXMuJHQgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBjYW4gYmUgY2FsbGVkIHRvIHNraXAgdG8gdGhhdCBuZXh0IGtleSwgd2hpY2ggY291bGQgYmVcbiAgICAgKiBhbiBpbmRleCBvciBhIHByaW1hcnkga2V5LlxuICAgICAqLyAgICBVdCh0KSB7XG4gICAgICAgIHRoaXMuQnQgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIGZyb20gdGhlIG9iamVjdCBzdG9yZS5cbiAgICAgKlxuICAgICAqIE5PVEU6IFlvdSBDQU5OT1QgZG8gdGhpcyB3aXRoIGEga2V5c09ubHkgcXVlcnkuXG4gICAgICovICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIGJpKHRoaXMuRnQuZGVsZXRlKCkpO1xuICAgIH1cbn1cblxuLyoqIEFuIGVycm9yIHRoYXQgd3JhcHMgZXhjZXB0aW9ucyB0aGF0IHRocm93biBkdXJpbmcgSW5kZXhlZERCIGV4ZWN1dGlvbi4gKi8gY2xhc3MgRWkgZXh0ZW5kcyBRIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKEcuVU5BVkFJTEFCTEUsIGBJbmRleGVkREIgdHJhbnNhY3Rpb24gJyR7dH0nIGZhaWxlZDogJHtlfWApLCB0aGlzLm5hbWUgPSBcIkluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3JcIjtcbiAgICB9XG59XG5cbi8qKiBWZXJpZmllcyB3aGV0aGVyIGBlYCBpcyBhbiBJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yLiAqLyBmdW5jdGlvbiBBaSh0KSB7XG4gICAgLy8gVXNlIG5hbWUgZXF1YWxpdHksIGFzIGluc3RhbmNlb2YgY2hlY2tzIG9uIGVycm9ycyBkb24ndCB3b3JrIHdpdGggZXJyb3JzXG4gICAgLy8gdGhhdCB3cmFwIG90aGVyIGVycm9ycy5cbiAgICByZXR1cm4gXCJJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yXCIgPT09IHQubmFtZTtcbn1cblxuLyoqXG4gKiBBIHdyYXBwZXIgYXJvdW5kIGFuIElEQk9iamVjdFN0b3JlIHByb3ZpZGluZyBhbiBBUEkgdGhhdDpcbiAqXG4gKiAxKSBIYXMgZ2VuZXJpYyBLZXlUeXBlIC8gVmFsdWVUeXBlIHBhcmFtZXRlcnMgdG8gcHJvdmlkZSBzdHJvbmdseS10eXBlZFxuICogbWV0aG9kcyBmb3IgYWN0aW5nIGFnYWluc3QgdGhlIG9iamVjdCBzdG9yZS5cbiAqIDIpIERlYWxzIHdpdGggSW5kZXhlZERCJ3Mgb25zdWNjZXNzIC8gb25lcnJvciBldmVudCBjYWxsYmFja3MsIG1ha2luZyBldmVyeVxuICogbWV0aG9kIHJldHVybiBhIFBlcnNpc3RlbmNlUHJvbWlzZSBpbnN0ZWFkLlxuICogMykgUHJvdmlkZXMgYSBoaWdoZXItbGV2ZWwgQVBJIHRvIGF2b2lkIG5lZWRpbmcgdG8gZG8gZXhjZXNzaXZlIHdyYXBwaW5nIG9mXG4gKiBpbnRlcm1lZGlhdGUgSW5kZXhlZERCIHR5cGVzIChJREJDdXJzb3JXaXRoVmFsdWUsIGV0Yy4pXG4gKi8gY2xhc3MgUmkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5zdG9yZSA9IHQ7XG4gICAgfVxuICAgIHB1dCh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlID8gKE8oXCJTaW1wbGVEYlwiLCBcIlBVVFwiLCB0aGlzLnN0b3JlLm5hbWUsIHQsIGUpLCBuID0gdGhpcy5zdG9yZS5wdXQoZSwgdCkpIDogKE8oXCJTaW1wbGVEYlwiLCBcIlBVVFwiLCB0aGlzLnN0b3JlLm5hbWUsIFwiPGF1dG8ta2V5PlwiLCB0KSwgXG4gICAgICAgIG4gPSB0aGlzLnN0b3JlLnB1dCh0KSksIGJpKG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IHZhbHVlIGludG8gYW4gT2JqZWN0IFN0b3JlIGFuZCByZXR1cm5zIHRoZSBuZXcga2V5LiBTaW1pbGFyIHRvXG4gICAgICogSW5kZXhlZERiJ3MgYGFkZCgpYCwgdGhpcyBtZXRob2Qgd2lsbCBmYWlsIG9uIHByaW1hcnkga2V5IGNvbGxpc2lvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdmFsdWUgLSBUaGUgb2JqZWN0IHRvIHdyaXRlLlxuICAgICAqIEByZXR1cm5zIFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGFkZC5cbiAgICAgKi8gICAgYWRkKHQpIHtcbiAgICAgICAgTyhcIlNpbXBsZURiXCIsIFwiQUREXCIsIHRoaXMuc3RvcmUubmFtZSwgdCwgdCk7XG4gICAgICAgIHJldHVybiBiaSh0aGlzLnN0b3JlLmFkZCh0KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGZyb20gdGhlIHNwZWNpZmllZCBzdG9yZSwgb3IgbnVsbFxuICAgICAqIGlmIG5vIG9iamVjdCBleGlzdHMgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS5cbiAgICAgKlxuICAgICAqIEBrZXkgVGhlIGtleSBvZiB0aGUgb2JqZWN0IHRvIGdldC5cbiAgICAgKiBAcmV0dXJucyBUaGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgb3IgbnVsbCBpZiBubyBvYmplY3QgZXhpc3RzLlxuICAgICAqLyAgICBnZXQodCkge1xuICAgICAgICAvLyBXZSdyZSBkb2luZyBhbiB1bnNhZmUgY2FzdCB0byBWYWx1ZVR5cGUuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiBiaSh0aGlzLnN0b3JlLmdldCh0KSkubmV4dCgoZSA9PiAoXG4gICAgICAgIC8vIE5vcm1hbGl6ZSBub25leGlzdGVuY2UgdG8gbnVsbC5cbiAgICAgICAgdm9pZCAwID09PSBlICYmIChlID0gbnVsbCksIE8oXCJTaW1wbGVEYlwiLCBcIkdFVFwiLCB0aGlzLnN0b3JlLm5hbWUsIHQsIGUpLCBlKSkpO1xuICAgIH1cbiAgICBkZWxldGUodCkge1xuICAgICAgICBPKFwiU2ltcGxlRGJcIiwgXCJERUxFVEVcIiwgdGhpcy5zdG9yZS5uYW1lLCB0KTtcbiAgICAgICAgcmV0dXJuIGJpKHRoaXMuc3RvcmUuZGVsZXRlKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgd2UgZXZlciBuZWVkIG1vcmUgb2YgdGhlIGNvdW50IHZhcmlhbnRzLCB3ZSBjYW4gYWRkIG92ZXJsb2Fkcy4gRm9yIG5vdyxcbiAgICAgKiBhbGwgd2UgbmVlZCBpcyB0byBjb3VudCBldmVyeXRoaW5nIGluIGEgc3RvcmUuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2Ygcm93cyBpbiB0aGUgc3RvcmUuXG4gICAgICovICAgIGNvdW50KCkge1xuICAgICAgICBPKFwiU2ltcGxlRGJcIiwgXCJDT1VOVFwiLCB0aGlzLnN0b3JlLm5hbWUpO1xuICAgICAgICByZXR1cm4gYmkodGhpcy5zdG9yZS5jb3VudCgpKTtcbiAgICB9XG4gICAgcXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5vcHRpb25zKHQsIGUpO1xuICAgICAgICAvLyBVc2UgYGdldEFsbCgpYCBpZiB0aGUgYnJvd3NlciBzdXBwb3J0cyBJbmRleGVkREIgdjMsIGFzIGl0IGlzIHJvdWdobHlcbiAgICAgICAgLy8gMjAlIGZhc3Rlci4gVW5mb3J0dW5hdGVseSwgZ2V0QWxsKCkgZG9lcyBub3Qgc3VwcG9ydCBjdXN0b20gaW5kaWNlcy5cbiAgICAgICAgICAgICAgICBpZiAobi5pbmRleCB8fCBcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIHRoaXMuc3RvcmUuZ2V0QWxsKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5jdXJzb3IobiksIGUgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkt0KHQsICgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGUucHVzaChuKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3RvcmUuZ2V0QWxsKG4ucmFuZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB5aSgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICB0Lm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbih0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZSh0LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMgZnJvbSB0aGUgcHJvdmlkZWQgaW5kZXggcmFuZ2UuIExvYWRzIGFsbFxuICAgICAqIGVsZW1lbnRzIGlmIG5vIGxpbWl0IGlzIHByb3ZpZGVkLlxuICAgICAqLyAgICBHdCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnN0b3JlLmdldEFsbCh0LCBudWxsID09PSBlID8gdm9pZCAwIDogZSk7XG4gICAgICAgIHJldHVybiBuZXcgeWkoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBuLm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBlKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIH0sIG4ub25zdWNjZXNzID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgdChlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBRdCh0LCBlKSB7XG4gICAgICAgIE8oXCJTaW1wbGVEYlwiLCBcIkRFTEVURSBBTExcIiwgdGhpcy5zdG9yZS5uYW1lKTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMub3B0aW9ucyh0LCBlKTtcbiAgICAgICAgbi5qdCA9ICExO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5jdXJzb3Iobik7XG4gICAgICAgIHJldHVybiB0aGlzLkt0KHMsICgodCwgZSwgbikgPT4gbi5kZWxldGUoKSkpO1xuICAgIH1cbiAgICBXdCh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICBlID8gbiA9IHQgOiAobiA9IHt9LCBlID0gdCk7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmN1cnNvcihuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuS3QocywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzdG9yZSwgYnV0IHdhaXRzIGZvciB0aGUgZ2l2ZW4gY2FsbGJhY2sgdG8gY29tcGxldGUgZm9yXG4gICAgICogZWFjaCBlbnRyeSBiZWZvcmUgaXRlcmF0aW5nIHRoZSBuZXh0IGVudHJ5LiBUaGlzIGFsbG93cyB0aGUgY2FsbGJhY2sgdG8gZG9cbiAgICAgKiBhc3luY2hyb25vdXMgd29yayB0byBkZXRlcm1pbmUgaWYgdGhpcyBpdGVyYXRpb24gc2hvdWxkIGNvbnRpbnVlLlxuICAgICAqXG4gICAgICogVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHNob3VsZCByZXR1cm4gYHRydWVgIHRvIGNvbnRpbnVlIGl0ZXJhdGlvbiwgYW5kXG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICovICAgIHp0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuY3Vyc29yKHt9KTtcbiAgICAgICAgcmV0dXJuIG5ldyB5aSgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIGUub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBWaSh0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgcyhlKTtcbiAgICAgICAgICAgIH0sIGUub25zdWNjZXNzID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBzID8gdChzLnByaW1hcnlLZXksIHMudmFsdWUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0ID8gcy5jb250aW51ZSgpIDogbigpO1xuICAgICAgICAgICAgICAgIH0pKSA6IG4oKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgS3QodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgIHJldHVybiBuZXcgeWkoKChzLCBpKSA9PiB7XG4gICAgICAgICAgICB0Lm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBpKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIH0sIHQub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHJldHVybiB2b2lkIHMoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFRpKGkpLCBvID0gZShpLnByaW1hcnlLZXksIGkudmFsdWUsIHIpO1xuICAgICAgICAgICAgICAgIGlmIChvIGluc3RhbmNlb2YgeWkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG8uY2F0Y2goKHQgPT4gKHIuZG9uZSgpLCB5aS5yZWplY3QodCkpKSk7XG4gICAgICAgICAgICAgICAgICAgIG4ucHVzaCh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgci5pc0RvbmUgPyBzKCkgOiBudWxsID09PSByLkx0ID8gaS5jb250aW51ZSgpIDogaS5jb250aW51ZShyLkx0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB5aS53YWl0Rm9yKG4pKSk7XG4gICAgfVxuICAgIG9wdGlvbnModCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdCAmJiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IG4gPSB0IDogZSA9IHQpLCB7XG4gICAgICAgICAgICBpbmRleDogbixcbiAgICAgICAgICAgIHJhbmdlOiBlXG4gICAgICAgIH07XG4gICAgfVxuICAgIGN1cnNvcih0KSB7XG4gICAgICAgIGxldCBlID0gXCJuZXh0XCI7XG4gICAgICAgIGlmICh0LnJldmVyc2UgJiYgKGUgPSBcInByZXZcIiksIHQuaW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnN0b3JlLmluZGV4KHQuaW5kZXgpO1xuICAgICAgICAgICAgcmV0dXJuIHQuanQgPyBuLm9wZW5LZXlDdXJzb3IodC5yYW5nZSwgZSkgOiBuLm9wZW5DdXJzb3IodC5yYW5nZSwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmUub3BlbkN1cnNvcih0LnJhbmdlLCBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogV3JhcHMgYW4gSURCUmVxdWVzdCBpbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSwgdXNpbmcgdGhlIG9uc3VjY2VzcyAvIG9uZXJyb3JcbiAqIGhhbmRsZXJzIHRvIHJlc29sdmUgLyByZWplY3QgdGhlIFBlcnNpc3RlbmNlUHJvbWlzZSBhcyBhcHByb3ByaWF0ZS5cbiAqLyBmdW5jdGlvbiBiaSh0KSB7XG4gICAgcmV0dXJuIG5ldyB5aSgoKGUsIG4pID0+IHtcbiAgICAgICAgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICBlKG4pO1xuICAgICAgICB9LCB0Lm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBWaSh0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICBuKGUpO1xuICAgICAgICB9O1xuICAgIH0pKTtcbn1cblxuLy8gR3VhcmQgc28gd2Ugb25seSByZXBvcnQgdGhlIGVycm9yIG9uY2UuXG5sZXQgUGkgPSAhMTtcblxuZnVuY3Rpb24gVmkodCkge1xuICAgIGNvbnN0IGUgPSBJaS5WdChnZXRVQSgpKTtcbiAgICBpZiAoZSA+PSAxMi4yICYmIGUgPCAxMykge1xuICAgICAgICBjb25zdCBlID0gXCJBbiBpbnRlcm5hbCBlcnJvciB3YXMgZW5jb3VudGVyZWQgaW4gdGhlIEluZGV4ZWQgRGF0YWJhc2Ugc2VydmVyXCI7XG4gICAgICAgIGlmICh0Lm1lc3NhZ2UuaW5kZXhPZihlKSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBXcmFwIGVycm9yIGluIGEgbW9yZSBkZXNjcmlwdGl2ZSBvbmUuXG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IFEoXCJpbnRlcm5hbFwiLCBgSU9TX0lOREVYRUREQl9CVUcxOiBJbmRleGVkRGIgaGFzIHRocm93biAnJHtlfScuIFRoaXMgaXMgbGlrZWx5IGR1ZSB0byBhbiB1bmF2b2lkYWJsZSBidWcgaW4gaU9TLiBTZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xLzU2NDk2Mjk2LzExMDkxNSBmb3IgZGV0YWlscyBhbmQgYSBwb3RlbnRpYWwgd29ya2Fyb3VuZC5gKTtcbiAgICAgICAgICAgIHJldHVybiBQaSB8fCAoUGkgPSAhMCwgXG4gICAgICAgICAgICAvLyBUaHJvdyBhIGdsb2JhbCBleGNlcHRpb24gb3V0c2lkZSBvZiB0aGlzIHByb21pc2UgY2hhaW4sIGZvciB0aGUgdXNlciB0b1xuICAgICAgICAgICAgLy8gcG90ZW50aWFsbHkgY2F0Y2guXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhyb3cgdDtcbiAgICAgICAgICAgIH0pLCAwKSksIHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIHZpIGV4dGVuZHMgZ2kge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5IdCA9IHQsIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFNpKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICByZXR1cm4gSWkueHQobi5IdCwgZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYmF0Y2ggb2YgbXV0YXRpb25zIHRoYXQgd2lsbCBiZSBzZW50IGFzIG9uZSB1bml0IHRvIHRoZSBiYWNrZW5kLlxuICovIGNsYXNzIERpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYmF0Y2hJZCAtIFRoZSB1bmlxdWUgSUQgb2YgdGhpcyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBUaGUgb3JpZ2luYWwgd3JpdGUgdGltZSBvZiB0aGlzIG11dGF0aW9uLlxuICAgICAqIEBwYXJhbSBiYXNlTXV0YXRpb25zIC0gTXV0YXRpb25zIHRoYXQgYXJlIHVzZWQgdG8gcG9wdWxhdGUgdGhlIGJhc2VcbiAgICAgKiB2YWx1ZXMgd2hlbiB0aGlzIG11dGF0aW9uIGlzIGFwcGxpZWQgbG9jYWxseS4gVGhpcyBjYW4gYmUgdXNlZCB0byBsb2NhbGx5XG4gICAgICogb3ZlcndyaXRlIHZhbHVlcyB0aGF0IGFyZSBwZXJzaXN0ZWQgaW4gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS4gQmFzZVxuICAgICAqIG11dGF0aW9ucyBhcmUgbmV2ZXIgc2VudCB0byB0aGUgYmFja2VuZC5cbiAgICAgKiBAcGFyYW0gbXV0YXRpb25zIC0gVGhlIHVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGluIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogVXNlci1wcm92aWRlZCBtdXRhdGlvbnMgYXJlIGFwcGxpZWQgYm90aCBsb2NhbGx5IGFuZCByZW1vdGVseSBvbiB0aGVcbiAgICAgKiBiYWNrZW5kLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5iYXRjaElkID0gdCwgdGhpcy5sb2NhbFdyaXRlVGltZSA9IGUsIHRoaXMuYmFzZU11dGF0aW9ucyA9IG4sIHRoaXMubXV0YXRpb25zID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhbGwgdGhlIG11dGF0aW9ucyBpbiB0aGlzIE11dGF0aW9uQmF0Y2ggdG8gdGhlIHNwZWNpZmllZCBkb2N1bWVudFxuICAgICAqIHRvIGNvbXB1dGUgdGhlIHN0YXRlIG9mIHRoZSByZW1vdGUgZG9jdW1lbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICogQHBhcmFtIGJhdGNoUmVzdWx0IC0gVGhlIHJlc3VsdCBvZiBhcHBseWluZyB0aGUgTXV0YXRpb25CYXRjaCB0byB0aGVcbiAgICAgKiBiYWNrZW5kLlxuICAgICAqLyAgICBhcHBseVRvUmVtb3RlRG9jdW1lbnQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS5tdXRhdGlvblJlc3VsdHM7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5tdXRhdGlvbnMubGVuZ3RoOyBlKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLm11dGF0aW9uc1tlXTtcbiAgICAgICAgICAgIGlmIChzLmtleS5pc0VxdWFsKHQua2V5KSkge1xuICAgICAgICAgICAgICAgIFBuKHMsIHQsIG5bZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbXB1dGVzIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQgZ2l2ZW4gYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpc1xuICAgICAqIGJhdGNoLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIGFwcGx5IG11dGF0aW9ucyB0by5cbiAgICAgKi8gICAgYXBwbHlUb0xvY2FsVmlldyh0KSB7XG4gICAgICAgIC8vIEZpcnN0LCBhcHBseSB0aGUgYmFzZSBzdGF0ZS4gVGhpcyBhbGxvd3MgdXMgdG8gYXBwbHkgbm9uLWlkZW1wb3RlbnRcbiAgICAgICAgLy8gdHJhbnNmb3JtIGFnYWluc3QgYSBjb25zaXN0ZW50IHNldCBvZiB2YWx1ZXMuXG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLmJhc2VNdXRhdGlvbnMpIGUua2V5LmlzRXF1YWwodC5rZXkpICYmIFZuKGUsIHQsIHRoaXMubG9jYWxXcml0ZVRpbWUpO1xuICAgICAgICAvLyBTZWNvbmQsIGFwcGx5IGFsbCB1c2VyLXByb3ZpZGVkIG11dGF0aW9ucy5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5tdXRhdGlvbnMpIGUua2V5LmlzRXF1YWwodC5rZXkpICYmIFZuKGUsIHQsIHRoaXMubG9jYWxXcml0ZVRpbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBmb3IgYWxsIHByb3ZpZGVkIGRvY3VtZW50cyBnaXZlbiB0aGUgbXV0YXRpb25zIGluXG4gICAgICogdGhpcyBiYXRjaC5cbiAgICAgKi8gICAgYXBwbHlUb0xvY2FsRG9jdW1lbnRTZXQodCkge1xuICAgICAgICAvLyBUT0RPKG1yc2NobWlkdCk6IFRoaXMgaW1wbGVtZW50YXRpb24gaXMgTyhuXjIpLiBJZiB3ZSBhcHBseSB0aGUgbXV0YXRpb25zXG4gICAgICAgIC8vIGRpcmVjdGx5IChhcyBkb25lIGluIGBhcHBseVRvTG9jYWxWaWV3KClgKSwgd2UgY2FuIHJlZHVjZSB0aGUgY29tcGxleGl0eVxuICAgICAgICAvLyB0byBPKG4pLlxuICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldChlLmtleSksIHMgPSBuO1xuICAgICAgICAgICAgLy8gVE9ETyhtdXRhYmxlZG9jdW1lbnRzKTogVGhpcyBtZXRob2Qgc2hvdWxkIHRha2UgYSBNdXRhYmxlRG9jdW1lbnRNYXBcbiAgICAgICAgICAgIC8vIGFuZCB3ZSBzaG91bGQgcmVtb3ZlIHRoaXMgY2FzdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwbHlUb0xvY2FsVmlldyhzKSwgbi5pc1ZhbGlkRG9jdW1lbnQoKSB8fCBzLmNvbnZlcnRUb05vRG9jdW1lbnQoY3QubWluKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGtleXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9ucy5yZWR1Y2UoKCh0LCBlKSA9PiB0LmFkZChlLmtleSkpLCBZbigpKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhdGNoSWQgPT09IHQuYmF0Y2hJZCAmJiBvdCh0aGlzLm11dGF0aW9ucywgdC5tdXRhdGlvbnMsICgodCwgZSkgPT4gU24odCwgZSkpKSAmJiBvdCh0aGlzLmJhc2VNdXRhdGlvbnMsIHQuYmFzZU11dGF0aW9ucywgKCh0LCBlKSA9PiBTbih0LCBlKSkpO1xuICAgIH1cbn1cblxuLyoqIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSBtdXRhdGlvbiBiYXRjaCB0byB0aGUgYmFja2VuZC4gKi8gY2xhc3MgQ2kge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIFxuICAgIC8qKlxuICAgICAqIEEgcHJlLWNvbXB1dGVkIG1hcHBpbmcgZnJvbSBlYWNoIG11dGF0ZWQgZG9jdW1lbnQgdG8gdGhlIHJlc3VsdGluZ1xuICAgICAqIHZlcnNpb24uXG4gICAgICovXG4gICAgcykge1xuICAgICAgICB0aGlzLmJhdGNoID0gdCwgdGhpcy5jb21taXRWZXJzaW9uID0gZSwgdGhpcy5tdXRhdGlvblJlc3VsdHMgPSBuLCB0aGlzLmRvY1ZlcnNpb25zID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBNdXRhdGlvbkJhdGNoUmVzdWx0IGZvciB0aGUgZ2l2ZW4gYmF0Y2ggYW5kIHJlc3VsdHMuIFRoZXJlXG4gICAgICogbXVzdCBiZSBvbmUgcmVzdWx0IGZvciBlYWNoIG11dGF0aW9uIGluIHRoZSBiYXRjaC4gVGhpcyBzdGF0aWMgZmFjdG9yeVxuICAgICAqIGNhY2hlcyBhIGRvY3VtZW50PSZndDt2ZXJzaW9uIG1hcHBpbmcgKGRvY1ZlcnNpb25zKS5cbiAgICAgKi8gICAgc3RhdGljIGZyb20odCwgZSwgbikge1xuICAgICAgICBVKHQubXV0YXRpb25zLmxlbmd0aCA9PT0gbi5sZW5ndGgpO1xuICAgICAgICBsZXQgcyA9IEhuO1xuICAgICAgICBjb25zdCBpID0gdC5tdXRhdGlvbnM7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgaS5sZW5ndGg7IHQrKykgcyA9IHMuaW5zZXJ0KGlbdF0ua2V5LCBuW3RdLnZlcnNpb24pO1xuICAgICAgICByZXR1cm4gbmV3IENpKHQsIGUsIG4sIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50YXRpb24gb2YgYW4gb3ZlcmxheSBjb21wdXRlZCBieSBGaXJlc3RvcmUuXG4gKlxuICogSG9sZHMgaW5mb3JtYXRpb24gYWJvdXQgYSBtdXRhdGlvbiBhbmQgdGhlIGxhcmdlc3QgYmF0Y2ggaWQgaW4gRmlyZXN0b3JlIHdoZW5cbiAqIHRoZSBtdXRhdGlvbiB3YXMgY3JlYXRlZC5cbiAqLyBjbGFzcyB4aSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmxhcmdlc3RCYXRjaElkID0gdCwgdGhpcy5tdXRhdGlvbiA9IGU7XG4gICAgfVxuICAgIGdldEtleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb24ua2V5O1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHQgJiYgdGhpcy5tdXRhdGlvbiA9PT0gdC5tdXRhdGlvbjtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBgT3ZlcmxheXtcXG4gICAgICBsYXJnZXN0QmF0Y2hJZDogJHt0aGlzLmxhcmdlc3RCYXRjaElkfSxcXG4gICAgICBtdXRhdGlvbjogJHt0aGlzLm11dGF0aW9uLnRvU3RyaW5nKCl9XFxuICAgIH1gO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIHNldCBvZiBtZXRhZGF0YSB0aGF0IHRoZSBsb2NhbCBzdG9yZSB0cmFja3MgZm9yIGVhY2ggdGFyZ2V0LlxuICovIGNsYXNzIE5pIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHRhcmdldCBiZWluZyBsaXN0ZW5lZCB0by4gKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IElEIHRvIHdoaWNoIHRoZSB0YXJnZXQgY29ycmVzcG9uZHM7IEFzc2lnbmVkIGJ5IHRoZVxuICAgICAqIExvY2FsU3RvcmUgZm9yIHVzZXIgbGlzdGVucyBhbmQgYnkgdGhlIFN5bmNFbmdpbmUgZm9yIGxpbWJvIHdhdGNoZXMuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBwdXJwb3NlIG9mIHRoZSB0YXJnZXQuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbiBkdXJpbmcgd2hpY2ggdGhpcyB0YXJnZXQgZGF0YVxuICAgICAqIHdhcyBtb2RpZmllZC5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKiogVGhlIGxhdGVzdCBzbmFwc2hvdCB2ZXJzaW9uIHNlZW4gZm9yIHRoaXMgdGFyZ2V0LiAqL1xuICAgIGkgPSBjdC5taW4oKVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIHNuYXBzaG90IHZlcnNpb24gYXQgd2hpY2ggdGhlIGFzc29jaWF0ZWQgdmlld1xuICAgICAqIGNvbnRhaW5lZCBubyBsaW1ibyBkb2N1bWVudHMuXG4gICAgICovICwgciA9IGN0Lm1pbigpXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi8gLCBvID0gcHQuRU1QVFlfQllURV9TVFJJTkcpIHtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0LCB0aGlzLnRhcmdldElkID0gZSwgdGhpcy5wdXJwb3NlID0gbiwgdGhpcy5zZXF1ZW5jZU51bWJlciA9IHMsIHRoaXMuc25hcHNob3RWZXJzaW9uID0gaSwgXG4gICAgICAgIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA9IHIsIHRoaXMucmVzdW1lVG9rZW4gPSBvO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgc2VxdWVuY2UgbnVtYmVyLiAqLyAgICB3aXRoU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IE5pKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHQsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHRoaXMucmVzdW1lVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCByZXN1bWUgdG9rZW4gYW5kXG4gICAgICogc25hcHNob3QgdmVyc2lvbi5cbiAgICAgKi8gICAgd2l0aFJlc3VtZVRva2VuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBOaSh0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRJZCwgdGhpcy5wdXJwb3NlLCB0aGlzLnNlcXVlbmNlTnVtYmVyLCBlLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBsYXN0IGxpbWJvIGZyZWVcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi8gICAgd2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IE5pKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHRoaXMuc2VxdWVuY2VOdW1iZXIsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0LCB0aGlzLnJlc3VtZVRva2VuKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogU2VyaWFsaXplciBmb3IgdmFsdWVzIHN0b3JlZCBpbiB0aGUgTG9jYWxTdG9yZS4gKi8gY2xhc3Mga2kge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5KdCA9IHQ7XG4gICAgfVxufVxuXG4vKiogRGVjb2RlcyBhIHJlbW90ZSBkb2N1bWVudCBmcm9tIHN0b3JhZ2UgbG9jYWxseSB0byBhIERvY3VtZW50LiAqLyBmdW5jdGlvbiBNaSh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKGUuZG9jdW1lbnQpIG4gPSBicyh0Lkp0LCBlLmRvY3VtZW50LCAhIWUuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTsgZWxzZSBpZiAoZS5ub0RvY3VtZW50KSB7XG4gICAgICAgIGNvbnN0IHQgPSB4dC5mcm9tU2VnbWVudHMoZS5ub0RvY3VtZW50LnBhdGgpLCBzID0gQmkoZS5ub0RvY3VtZW50LnJlYWRUaW1lKTtcbiAgICAgICAgbiA9IG5lLm5ld05vRG9jdW1lbnQodCwgcyksIGUuaGFzQ29tbWl0dGVkTXV0YXRpb25zICYmIG4uc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFlLnVua25vd25Eb2N1bWVudCkgcmV0dXJuIEwoKTtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IHh0LmZyb21TZWdtZW50cyhlLnVua25vd25Eb2N1bWVudC5wYXRoKSwgcyA9IEJpKGUudW5rbm93bkRvY3VtZW50LnZlcnNpb24pO1xuICAgICAgICAgICAgbiA9IG5lLm5ld1Vua25vd25Eb2N1bWVudCh0LCBzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZS5yZWFkVGltZSAmJiBuLnNldFJlYWRUaW1lKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBhdCh0WzBdLCB0WzFdKTtcbiAgICAgICAgcmV0dXJuIGN0LmZyb21UaW1lc3RhbXAoZSk7XG4gICAgfShlLnJlYWRUaW1lKSksIG47XG59XG5cbi8qKiBFbmNvZGVzIGEgZG9jdW1lbnQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi8gZnVuY3Rpb24gT2kodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IHtcbiAgICAgICAgcHJlZml4UGF0aDogbi5nZXRDb2xsZWN0aW9uUGF0aCgpLnBvcExhc3QoKS50b0FycmF5KCksXG4gICAgICAgIGNvbGxlY3Rpb25Hcm91cDogbi5jb2xsZWN0aW9uR3JvdXAsXG4gICAgICAgIGRvY3VtZW50SWQ6IG4ucGF0aC5sYXN0U2VnbWVudCgpLFxuICAgICAgICByZWFkVGltZTogRmkoZS5yZWFkVGltZSksXG4gICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogZS5oYXNDb21taXR0ZWRNdXRhdGlvbnNcbiAgICB9O1xuICAgIGlmIChlLmlzRm91bmREb2N1bWVudCgpKSBzLmRvY3VtZW50ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogeXModCwgZS5rZXkpLFxuICAgICAgICAgICAgZmllbGRzOiBlLmRhdGEudmFsdWUubWFwVmFsdWUuZmllbGRzLFxuICAgICAgICAgICAgdXBkYXRlVGltZTogZnModCwgZS52ZXJzaW9uLnRvVGltZXN0YW1wKCkpXG4gICAgICAgIH07XG4gICAgfSh0Lkp0LCBlKTsgZWxzZSBpZiAoZS5pc05vRG9jdW1lbnQoKSkgcy5ub0RvY3VtZW50ID0ge1xuICAgICAgICBwYXRoOiBuLnBhdGgudG9BcnJheSgpLFxuICAgICAgICByZWFkVGltZTogJGkoZS52ZXJzaW9uKVxuICAgIH07IGVsc2Uge1xuICAgICAgICBpZiAoIWUuaXNVbmtub3duRG9jdW1lbnQoKSkgcmV0dXJuIEwoKTtcbiAgICAgICAgcy51bmtub3duRG9jdW1lbnQgPSB7XG4gICAgICAgICAgICBwYXRoOiBuLnBhdGgudG9BcnJheSgpLFxuICAgICAgICAgICAgdmVyc2lvbjogJGkoZS52ZXJzaW9uKVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gcztcbn1cblxuZnVuY3Rpb24gRmkodCkge1xuICAgIGNvbnN0IGUgPSB0LnRvVGltZXN0YW1wKCk7XG4gICAgcmV0dXJuIFsgZS5zZWNvbmRzLCBlLm5hbm9zZWNvbmRzIF07XG59XG5cbmZ1bmN0aW9uICRpKHQpIHtcbiAgICBjb25zdCBlID0gdC50b1RpbWVzdGFtcCgpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHNlY29uZHM6IGUuc2Vjb25kcyxcbiAgICAgICAgbmFub3NlY29uZHM6IGUubmFub3NlY29uZHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBCaSh0KSB7XG4gICAgY29uc3QgZSA9IG5ldyBhdCh0LnNlY29uZHMsIHQubmFub3NlY29uZHMpO1xuICAgIHJldHVybiBjdC5mcm9tVGltZXN0YW1wKGUpO1xufVxuXG4vKiogRW5jb2RlcyBhIGJhdGNoIG9mIG11dGF0aW9ucyBpbnRvIGEgRGJNdXRhdGlvbkJhdGNoIGZvciBsb2NhbCBzdG9yYWdlLiAqL1xuLyoqIERlY29kZXMgYSBEYk11dGF0aW9uQmF0Y2ggaW50byBhIE11dGF0aW9uQmF0Y2ggKi9cbmZ1bmN0aW9uIExpKHQsIGUpIHtcbiAgICBjb25zdCBuID0gKGUuYmFzZU11dGF0aW9ucyB8fCBbXSkubWFwKChlID0+IFNzKHQuSnQsIGUpKSk7XG4gICAgLy8gU3F1YXNoIG9sZCB0cmFuc2Zvcm0gbXV0YXRpb25zIGludG8gZXhpc3RpbmcgcGF0Y2ggb3Igc2V0IG11dGF0aW9ucy5cbiAgICAvLyBUaGUgcmVwbGFjZW1lbnQgb2YgcmVwcmVzZW50aW5nIGB0cmFuc2Zvcm1zYCB3aXRoIGB1cGRhdGVfdHJhbnNmb3Jtc2BcbiAgICAvLyBvbiB0aGUgU0RLIG1lYW5zIHRoYXQgb2xkIGB0cmFuc2Zvcm1gIG11dGF0aW9ucyBzdG9yZWQgaW4gSW5kZXhlZERCIG5lZWRcbiAgICAvLyB0byBiZSB1cGRhdGVkIHRvIGB1cGRhdGVfdHJhbnNmb3Jtc2AuXG4gICAgLy8gVE9ETyhiLzE3NDYwODM3NCk6IFJlbW92ZSB0aGlzIGNvZGUgb25jZSB3ZSBwZXJmb3JtIGEgc2NoZW1hIG1pZ3JhdGlvbi5cbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBlLm11dGF0aW9ucy5sZW5ndGggLSAxOyArK3QpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubXV0YXRpb25zW3RdO1xuICAgICAgICBpZiAodCArIDEgPCBlLm11dGF0aW9ucy5sZW5ndGggJiYgdm9pZCAwICE9PSBlLm11dGF0aW9uc1t0ICsgMV0udHJhbnNmb3JtKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gZS5tdXRhdGlvbnNbdCArIDFdO1xuICAgICAgICAgICAgbi51cGRhdGVUcmFuc2Zvcm1zID0gcy50cmFuc2Zvcm0uZmllbGRUcmFuc2Zvcm1zLCBlLm11dGF0aW9ucy5zcGxpY2UodCArIDEsIDEpLCBcbiAgICAgICAgICAgICsrdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBzID0gZS5tdXRhdGlvbnMubWFwKChlID0+IFNzKHQuSnQsIGUpKSksIGkgPSBhdC5mcm9tTWlsbGlzKGUubG9jYWxXcml0ZVRpbWVNcyk7XG4gICAgcmV0dXJuIG5ldyBEaShlLmJhdGNoSWQsIGksIG4sIHMpO1xufVxuXG4vKiogRGVjb2RlcyBhIERiVGFyZ2V0IGludG8gVGFyZ2V0RGF0YSAqLyBmdW5jdGlvbiBVaSh0KSB7XG4gICAgY29uc3QgZSA9IEJpKHQucmVhZFRpbWUpLCBuID0gdm9pZCAwICE9PSB0Lmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gPyBCaSh0Lmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24pIDogY3QubWluKCk7XG4gICAgbGV0IHM7XG4gICAgdmFyIGk7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gdC5xdWVyeS5kb2N1bWVudHMgPyAoVSgxID09PSAoaSA9IHQucXVlcnkpLmRvY3VtZW50cy5sZW5ndGgpLCBcbiAgICBzID0gSGUoS2UoVHMoaS5kb2N1bWVudHNbMF0pKSkpIDogcyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIEhlKE5zKHQpKTtcbiAgICB9KHQucXVlcnkpLCBuZXcgTmkocywgdC50YXJnZXRJZCwgMCAvKiBMaXN0ZW4gKi8gLCB0Lmxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgZSwgbiwgcHQuZnJvbUJhc2U2NFN0cmluZyh0LnJlc3VtZVRva2VuKSk7XG59XG5cbi8qKiBFbmNvZGVzIFRhcmdldERhdGEgaW50byBhIERiVGFyZ2V0IGZvciBzdG9yYWdlIGxvY2FsbHkuICovIGZ1bmN0aW9uIHFpKHQsIGUpIHtcbiAgICBjb25zdCBuID0gJGkoZS5zbmFwc2hvdFZlcnNpb24pLCBzID0gJGkoZS5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKTtcbiAgICBsZXQgaTtcbiAgICBpID0gQWUoZS50YXJnZXQpID8gQ3ModC5KdCwgZS50YXJnZXQpIDogeHModC5KdCwgZS50YXJnZXQpO1xuICAgIC8vIFdlIGNhbid0IHN0b3JlIHRoZSByZXN1bWVUb2tlbiBhcyBhIEJ5dGVTdHJpbmcgaW4gSW5kZXhlZERiLCBzbyB3ZVxuICAgIC8vIGNvbnZlcnQgaXQgdG8gYSBiYXNlNjQgc3RyaW5nIGZvciBzdG9yYWdlLlxuICAgICAgICBjb25zdCByID0gZS5yZXN1bWVUb2tlbi50b0Jhc2U2NCgpO1xuICAgIC8vIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBpcyBhbHdheXMgMCB1bnRpbCB3ZSBkbyByZWFsIEdDLlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICB0YXJnZXRJZDogZS50YXJnZXRJZCxcbiAgICAgICAgY2Fub25pY2FsSWQ6IEllKGUudGFyZ2V0KSxcbiAgICAgICAgcmVhZFRpbWU6IG4sXG4gICAgICAgIHJlc3VtZVRva2VuOiByLFxuICAgICAgICBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI6IGUuc2VxdWVuY2VOdW1iZXIsXG4gICAgICAgIGxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb246IHMsXG4gICAgICAgIHF1ZXJ5OiBpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgZmlndXJpbmcgb3V0IHdoYXQga2luZCBvZiBxdWVyeSBoYXMgYmVlbiBzdG9yZWQuXG4gKi9cbi8qKlxuICogRW5jb2RlcyBhIGBCdW5kbGVkUXVlcnlgIGZyb20gYnVuZGxlIHByb3RvIHRvIGEgUXVlcnkgb2JqZWN0LlxuICpcbiAqIFRoaXMgcmVjb25zdHJ1Y3RzIHRoZSBvcmlnaW5hbCBxdWVyeSB1c2VkIHRvIGJ1aWxkIHRoZSBidW5kbGUgYmVpbmcgbG9hZGVkLFxuICogaW5jbHVkaW5nIGZlYXR1cmVzIGV4aXN0cyBvbmx5IGluIFNES3MgKGZvciBleGFtcGxlOiBsaW1pdC10by1sYXN0KS5cbiAqL1xuZnVuY3Rpb24gS2kodCkge1xuICAgIGNvbnN0IGUgPSBOcyh7XG4gICAgICAgIHBhcmVudDogdC5wYXJlbnQsXG4gICAgICAgIHN0cnVjdHVyZWRRdWVyeTogdC5zdHJ1Y3R1cmVkUXVlcnlcbiAgICB9KTtcbiAgICByZXR1cm4gXCJMQVNUXCIgPT09IHQubGltaXRUeXBlID8gSmUoZSwgZS5saW1pdCwgXCJMXCIgLyogTGFzdCAqLykgOiBlO1xufVxuXG4vKiogRW5jb2RlcyBhIE5hbWVkUXVlcnkgcHJvdG8gb2JqZWN0IHRvIGEgTmFtZWRRdWVyeSBtb2RlbCBvYmplY3QuICovXG4vKiogRW5jb2RlcyBhIERiRG9jdW1lbnRPdmVybGF5IG9iamVjdCB0byBhbiBPdmVybGF5IG1vZGVsIG9iamVjdC4gKi9cbmZ1bmN0aW9uIEdpKHQsIGUpIHtcbiAgICByZXR1cm4gbmV3IHhpKGUubGFyZ2VzdEJhdGNoSWQsIFNzKHQuSnQsIGUub3ZlcmxheU11dGF0aW9uKSk7XG59XG5cbi8qKiBEZWNvZGVzIGFuIE92ZXJsYXkgbW9kZWwgb2JqZWN0IGludG8gYSBEYkRvY3VtZW50T3ZlcmxheSBvYmplY3QuICovXG4vKipcbiAqIFJldHVybnMgdGhlIERiRG9jdW1lbnRPdmVybGF5S2V5IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIHVzZXIgYW5kXG4gKiBkb2N1bWVudCBrZXkuXG4gKi9cbmZ1bmN0aW9uIFFpKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZS5wYXRoLmxhc3RTZWdtZW50KCk7XG4gICAgcmV0dXJuIFsgdCwgR3MoZS5wYXRoLnBvcExhc3QoKSksIG4gXTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIGppIHtcbiAgICBnZXRCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBXaSh0KS5nZXQoZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAodCkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpZDogKGUgPSB0KS5idW5kbGVJZCxcbiAgICAgICAgICAgICAgICBjcmVhdGVUaW1lOiBCaShlLmNyZWF0ZVRpbWUpLFxuICAgICAgICAgICAgICAgIHZlcnNpb246IGUudmVyc2lvblxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8qKiBFbmNvZGVzIGEgRGJCdW5kbGUgdG8gYSBCdW5kbGVNZXRhZGF0YSBvYmplY3QuICovXG4gICAgICAgICAgICB2YXIgZTtcbiAgICAgICAgICAgIC8qKiBFbmNvZGVzIGEgQnVuZGxlTWV0YWRhdGEgdG8gYSBEYkJ1bmRsZS4gKi8gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2F2ZUJ1bmRsZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFdpKHQpLnB1dCh7XG4gICAgICAgICAgICBidW5kbGVJZDogKG4gPSBlKS5pZCxcbiAgICAgICAgICAgIGNyZWF0ZVRpbWU6ICRpKHdzKG4uY3JlYXRlVGltZSkpLFxuICAgICAgICAgICAgdmVyc2lvbjogbi52ZXJzaW9uXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgbjtcbiAgICAgICAgLyoqIEVuY29kZXMgYSBEYk5hbWVkUXVlcnkgdG8gYSBOYW1lZFF1ZXJ5LiAqLyAgICB9XG4gICAgZ2V0TmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB6aSh0KS5nZXQoZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAodCkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAoZSA9IHQpLm5hbWUsXG4gICAgICAgICAgICAgICAgcXVlcnk6IEtpKGUuYnVuZGxlZFF1ZXJ5KSxcbiAgICAgICAgICAgICAgICByZWFkVGltZTogQmkoZS5yZWFkVGltZSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgZTtcbiAgICAgICAgICAgIC8qKiBFbmNvZGVzIGEgTmFtZWRRdWVyeSBmcm9tIGEgYnVuZGxlIHByb3RvIHRvIGEgRGJOYW1lZFF1ZXJ5LiAqLyAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzYXZlTmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB6aSh0KS5wdXQoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBuYW1lOiB0Lm5hbWUsXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6ICRpKHdzKHQucmVhZFRpbWUpKSxcbiAgICAgICAgICAgICAgICBidW5kbGVkUXVlcnk6IHQuYnVuZGxlZFF1ZXJ5XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBidW5kbGVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBXaSh0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwiYnVuZGxlc1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG5hbWVkUXVlcmllcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gemkodCkge1xuICAgIHJldHVybiBTaSh0LCBcIm5hbWVkUXVlcmllc1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW1wbGVtZW50YXRpb24gb2YgRG9jdW1lbnRPdmVybGF5Q2FjaGUgdXNpbmcgSW5kZXhlZERiLlxuICovIGNsYXNzIEhpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gc2VyaWFsaXplciAtIFRoZSBkb2N1bWVudCBzZXJpYWxpemVyLlxuICAgICAqIEBwYXJhbSB1c2VySWQgLSBUaGUgdXNlcklkIGZvciB3aGljaCB3ZSBhcmUgYWNjZXNzaW5nIG92ZXJsYXlzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5NID0gdCwgdGhpcy51c2VySWQgPSBlO1xuICAgIH1cbiAgICBzdGF0aWMgWXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS51aWQgfHwgXCJcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBIaSh0LCBuKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBKaSh0KS5nZXQoUWkodGhpcy51c2VySWQsIGUpKS5uZXh0KCh0ID0+IHQgPyBHaSh0aGlzLk0sIHQpIDogbnVsbCkpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKChuLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gbmV3IHhpKGUsIGkpO1xuICAgICAgICAgICAgcy5wdXNoKHRoaXMuWHQodCwgcikpO1xuICAgICAgICB9KSksIHlpLndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgU2V0O1xuICAgICAgICAvLyBHZXQgdGhlIHNldCBvZiB1bmlxdWUgY29sbGVjdGlvbiBwYXRocy5cbiAgICAgICAgICAgICAgICBlLmZvckVhY2goKHQgPT4gcy5hZGQoR3ModC5nZXRDb2xsZWN0aW9uUGF0aCgpKSkpKTtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBlLCBuIF0sIFsgdGhpcy51c2VySWQsIGUsIG4gKyAxIF0sIFxuICAgICAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICAgICAgaS5wdXNoKEppKHQpLlF0KFwiY29sbGVjdGlvblBhdGhPdmVybGF5SW5kZXhcIiwgcykpO1xuICAgICAgICB9KSksIHlpLndhaXRGb3IoaSk7XG4gICAgfVxuICAgIGdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB6bigpLCBpID0gR3MoZSksIHIgPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBpLCBuIF0sIFsgdGhpcy51c2VySWQsIGksIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gSmkodCkucXQoXCJjb2xsZWN0aW9uUGF0aE92ZXJsYXlJbmRleFwiLCByKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IEdpKHRoaXMuTSwgZSk7XG4gICAgICAgICAgICAgICAgcy5zZXQodC5nZXRLZXkoKSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSB6bigpO1xuICAgICAgICBsZXQgcjtcbiAgICAgICAgLy8gV2Ugd2FudCBiYXRjaCBJRHMgbGFyZ2VyIHRoYW4gYHNpbmNlQmF0Y2hJZGAsIGFuZCBzbyB0aGUgbG93ZXIgYm91bmRcbiAgICAgICAgLy8gaXMgbm90IGluY2x1c2l2ZS5cbiAgICAgICAgICAgICAgICBjb25zdCBvID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgZSwgbiBdLCBbIHRoaXMudXNlcklkLCBlLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIEppKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcImNvbGxlY3Rpb25Hcm91cE92ZXJsYXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IG9cbiAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBXZSBkbyBub3Qgd2FudCB0byByZXR1cm4gcGFydGlhbCBiYXRjaCBvdmVybGF5cywgZXZlbiBpZiB0aGUgc2l6ZVxuICAgICAgICAgICAgLy8gb2YgdGhlIHJlc3VsdCBzZXQgZXhjZWVkcyB0aGUgZ2l2ZW4gYGNvdW50YCBhcmd1bWVudC4gVGhlcmVmb3JlLCB3ZVxuICAgICAgICAgICAgLy8gY29udGludWUgdG8gYWdncmVnYXRlIHJlc3VsdHMgZXZlbiBhZnRlciB0aGUgcmVzdWx0IHNpemUgZXhjZWVkc1xuICAgICAgICAgICAgLy8gYGNvdW50YCBpZiB0aGVyZSBhcmUgbW9yZSBvdmVybGF5cyBmcm9tIHRoZSBgY3VycmVudEJhdGNoSWRgLlxuICAgICAgICAgICAgY29uc3QgbyA9IEdpKHRoaXMuTSwgZSk7XG4gICAgICAgICAgICBpLnNpemUoKSA8IHMgfHwgby5sYXJnZXN0QmF0Y2hJZCA9PT0gciA/IChpLnNldChvLmdldEtleSgpLCBvKSwgciA9IG8ubGFyZ2VzdEJhdGNoSWQpIDogbi5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIFh0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEppKHQpLnB1dChmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBjb25zdCBbcywgaSwgcl0gPSBRaShlLCBuLm11dGF0aW9uLmtleSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVzZXJJZDogZSxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uUGF0aDogaSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudElkOiByLFxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25Hcm91cDogbi5tdXRhdGlvbi5rZXkuZ2V0Q29sbGVjdGlvbkdyb3VwKCksXG4gICAgICAgICAgICAgICAgbGFyZ2VzdEJhdGNoSWQ6IG4ubGFyZ2VzdEJhdGNoSWQsXG4gICAgICAgICAgICAgICAgb3ZlcmxheU11dGF0aW9uOiB2cyh0Lkp0LCBuLm11dGF0aW9uKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0aGlzLk0sIHRoaXMudXNlcklkLCBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgZG9jdW1lbnQgb3ZlcmxheSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gSmkodCkge1xuICAgIHJldHVybiBTaSh0LCBcImRvY3VtZW50T3ZlcmxheXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBOb3RlOiBUaGlzIGNvZGUgaXMgY29waWVkIGZyb20gdGhlIGJhY2tlbmQuIENvZGUgdGhhdCBpcyBub3QgdXNlZCBieVxuLy8gRmlyZXN0b3JlIHdhcyByZW1vdmVkLlxuLyoqIEZpcmVzdG9yZSBpbmRleCB2YWx1ZSB3cml0ZXIuICAqL1xuY2xhc3MgWWkge1xuICAgIGNvbnN0cnVjdG9yKCkge31cbiAgICAvLyBUaGUgd3JpdGUgbWV0aG9kcyBiZWxvdyBzaG9ydC1jaXJjdWl0IHdyaXRpbmcgdGVybWluYXRvcnMgZm9yIHZhbHVlc1xuICAgIC8vIGNvbnRhaW5pbmcgYSAodGVybWluYXRpbmcpIHRydW5jYXRlZCB2YWx1ZS5cbiAgICAvLyBBcyBhbiBleGFtcGxlLCBjb25zaWRlciB0aGUgcmVzdWx0aW5nIGVuY29kaW5nIGZvcjpcbiAgICAvLyBbXCJiYXJcIiwgWzIsIFwiZm9vXCJdXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWSwgTlVNQkVSLCAyLCBTVFJJTkcsIFwiZm9vXCIsIFRFUk0sIFRFUk0sIFRFUk0pXG4gICAgLy8gW1wiYmFyXCIsIFsyLCB0cnVuY2F0ZWQoXCJmb29cIildXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWSwgTlVNQkVSLCAyLCBTVFJJTkcsIFwiZm9vXCIsIFRSVU5DKVxuICAgIC8vIFtcImJhclwiLCB0cnVuY2F0ZWQoW1wiZm9vXCJdKV0gLT4gKFNUUklORywgXCJiYXJcIiwgVEVSTSwgQVJSQVkuIFNUUklORywgXCJmb29cIiwgVEVSTSwgVFJVTkMpXG4gICAgLyoqIFdyaXRlcyBhbiBpbmRleCB2YWx1ZS4gICovXG4gICAgWnQodCwgZSkge1xuICAgICAgICB0aGlzLnRlKHQsIGUpLCBcbiAgICAgICAgLy8gV3JpdGUgc2VwYXJhdG9yIHRvIHNwbGl0IGluZGV4IHZhbHVlc1xuICAgICAgICAvLyAoc2VlIGdvL2ZpcmVzdG9yZS1zdG9yYWdlLWZvcm1hdCNlbmNvZGluZ3MpLlxuICAgICAgICBlLmVlKCk7XG4gICAgfVxuICAgIHRlKHQsIGUpIHtcbiAgICAgICAgaWYgKFwibnVsbFZhbHVlXCIgaW4gdCkgdGhpcy5uZShlLCA1KTsgZWxzZSBpZiAoXCJib29sZWFuVmFsdWVcIiBpbiB0KSB0aGlzLm5lKGUsIDEwKSwgXG4gICAgICAgIGUuc2UodC5ib29sZWFuVmFsdWUgPyAxIDogMCk7IGVsc2UgaWYgKFwiaW50ZWdlclZhbHVlXCIgaW4gdCkgdGhpcy5uZShlLCAxNSksIGUuc2UoRXQodC5pbnRlZ2VyVmFsdWUpKTsgZWxzZSBpZiAoXCJkb3VibGVWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBFdCh0LmRvdWJsZVZhbHVlKTtcbiAgICAgICAgICAgIGlzTmFOKG4pID8gdGhpcy5uZShlLCAxMykgOiAodGhpcy5uZShlLCAxNSksIER0KG4pID8gXG4gICAgICAgICAgICAvLyAtMC4wLCAwIGFuZCAwLjAgYXJlIGFsbCBjb25zaWRlcmVkIHRoZSBzYW1lXG4gICAgICAgICAgICBlLnNlKDApIDogZS5zZShuKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRpbWVzdGFtcFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5uZShlLCAyMCksIFwic3RyaW5nXCIgPT0gdHlwZW9mIG4gPyBlLmllKG4pIDogKGUuaWUoYCR7bi5zZWNvbmRzIHx8IFwiXCJ9YCksIGUuc2Uobi5uYW5vcyB8fCAwKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJzdHJpbmdWYWx1ZVwiIGluIHQpIHRoaXMucmUodC5zdHJpbmdWYWx1ZSwgZSksIHRoaXMub2UoZSk7IGVsc2UgaWYgKFwiYnl0ZXNWYWx1ZVwiIGluIHQpIHRoaXMubmUoZSwgMzApLCBcbiAgICAgICAgZS51ZShBdCh0LmJ5dGVzVmFsdWUpKSwgdGhpcy5vZShlKTsgZWxzZSBpZiAoXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQpIHRoaXMuYWUodC5yZWZlcmVuY2VWYWx1ZSwgZSk7IGVsc2UgaWYgKFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmdlb1BvaW50VmFsdWU7XG4gICAgICAgICAgICB0aGlzLm5lKGUsIDQ1KSwgZS5zZShuLmxhdGl0dWRlIHx8IDApLCBlLnNlKG4ubG9uZ2l0dWRlIHx8IDApO1xuICAgICAgICB9IGVsc2UgXCJtYXBWYWx1ZVwiIGluIHQgPyBIdCh0KSA/IHRoaXMubmUoZSwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpIDogKHRoaXMuY2UodC5tYXBWYWx1ZSwgZSksIFxuICAgICAgICB0aGlzLm9lKGUpKSA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyAodGhpcy5oZSh0LmFycmF5VmFsdWUsIGUpLCB0aGlzLm9lKGUpKSA6IEwoKTtcbiAgICB9XG4gICAgcmUodCwgZSkge1xuICAgICAgICB0aGlzLm5lKGUsIDI1KSwgdGhpcy5sZSh0LCBlKTtcbiAgICB9XG4gICAgbGUodCwgZSkge1xuICAgICAgICBlLmllKHQpO1xuICAgIH1cbiAgICBjZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LmZpZWxkcyB8fCB7fTtcbiAgICAgICAgdGhpcy5uZShlLCA1NSk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBPYmplY3Qua2V5cyhuKSkgdGhpcy5yZSh0LCBlKSwgdGhpcy50ZShuW3RdLCBlKTtcbiAgICB9XG4gICAgaGUodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgICAgIHRoaXMubmUoZSwgNTApO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgbikgdGhpcy50ZSh0LCBlKTtcbiAgICB9XG4gICAgYWUodCwgZSkge1xuICAgICAgICB0aGlzLm5lKGUsIDM3KTtcbiAgICAgICAgeHQuZnJvbU5hbWUodCkucGF0aC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMubmUoZSwgNjApLCB0aGlzLmxlKHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIG5lKHQsIGUpIHtcbiAgICAgICAgdC5zZShlKTtcbiAgICB9XG4gICAgb2UodCkge1xuICAgICAgICAvLyBXaGlsZSB0aGUgU0RLIGRvZXMgbm90IGltcGxlbWVudCB0cnVuY2F0aW9uLCB0aGUgdHJ1bmNhdGlvbiBtYXJrZXIgaXNcbiAgICAgICAgLy8gdXNlZCB0byB0ZXJtaW5hdGUgYWxsIHZhcmlhYmxlIGxlbmd0aCB2YWx1ZXMgKHdoaWNoIGFyZSBzdHJpbmdzLCBieXRlcyxcbiAgICAgICAgLy8gcmVmZXJlbmNlcywgYXJyYXlzIGFuZCBtYXBzKS5cbiAgICAgICAgdC5zZSgyKTtcbiAgICB9XG59XG5cbllpLmZlID0gbmV3IFlpO1xuXG4vKipcbiAqIENvdW50cyB0aGUgbnVtYmVyIG9mIHplcm9zIGluIGEgYnl0ZS5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5mdW5jdGlvbiBYaSh0KSB7XG4gICAgaWYgKDAgPT09IHQpIHJldHVybiA4O1xuICAgIGxldCBlID0gMDtcbiAgICByZXR1cm4gdCA+PiA0ID09IDAgJiYgKFxuICAgIC8vIFRlc3QgaWYgdGhlIGZpcnN0IGZvdXIgYml0cyBhcmUgemVyby5cbiAgICBlICs9IDQsIHQgPDw9IDQpLCB0ID4+IDYgPT0gMCAmJiAoXG4gICAgLy8gVGVzdCBpZiB0aGUgZmlyc3QgdHdvIChvciBuZXh0IHR3bykgYml0cyBhcmUgemVyby5cbiAgICBlICs9IDIsIHQgPDw9IDIpLCB0ID4+IDcgPT0gMCAmJiAoXG4gICAgLy8gVGVzdCBpZiB0aGUgcmVtYWluaW5nIGJpdCBpcyB6ZXJvLlxuICAgIGUgKz0gMSksIGU7XG59XG5cbi8qKiBDb3VudHMgdGhlIG51bWJlciBvZiBsZWFkaW5nIHplcm9zIGluIHRoZSBnaXZlbiBieXRlIGFycmF5LiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgYnl0ZXMgcmVxdWlyZWQgdG8gc3RvcmUgXCJ2YWx1ZVwiLiBMZWFkaW5nIHplcm8gYnl0ZXNcbiAqIGFyZSBza2lwcGVkLlxuICovXG5mdW5jdGlvbiBaaSh0KSB7XG4gICAgLy8gVGhpcyBpcyBqdXN0IHRoZSBudW1iZXIgb2YgYnl0ZXMgZm9yIHRoZSB1bnNpZ25lZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgbnVtYmVyLlxuICAgIGNvbnN0IGUgPSA2NCAtIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDg7ICsrbikge1xuICAgICAgICAgICAgY29uc3QgcyA9IFhpKDI1NSAmIHRbbl0pO1xuICAgICAgICAgICAgaWYgKGUgKz0gcywgOCAhPT0gcykgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfSh0KTtcbiAgICByZXR1cm4gTWF0aC5jZWlsKGUgLyA4KTtcbn1cblxuLyoqXG4gKiBPcmRlcmVkQ29kZVdyaXRlciBpcyBhIG1pbmltYWwtYWxsb2NhdGlvbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgd3JpdGluZ1xuICogYmVoYXZpb3IgZGVmaW5lZCBieSB0aGUgYmFja2VuZC5cbiAqXG4gKiBUaGUgY29kZSBpcyBwb3J0ZWQgZnJvbSBpdHMgSmF2YSBjb3VudGVycGFydC5cbiAqLyBjbGFzcyB0ciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTAyNCksIHRoaXMucG9zaXRpb24gPSAwO1xuICAgIH1cbiAgICBkZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0W1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICAgICAgbGV0IG4gPSBlLm5leHQoKTtcbiAgICAgICAgZm9yICg7IW4uZG9uZTsgKSB0aGlzLl9lKG4udmFsdWUpLCBuID0gZS5uZXh0KCk7XG4gICAgICAgIHRoaXMud2UoKTtcbiAgICB9XG4gICAgbWUodCkge1xuICAgICAgICBjb25zdCBlID0gdFtTeW1ib2wuaXRlcmF0b3JdKCk7XG4gICAgICAgIGxldCBuID0gZS5uZXh0KCk7XG4gICAgICAgIGZvciAoOyFuLmRvbmU7ICkgdGhpcy5nZShuLnZhbHVlKSwgbiA9IGUubmV4dCgpO1xuICAgICAgICB0aGlzLnllKCk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgdXRmOCBieXRlcyBpbnRvIHRoaXMgYnl0ZSBzZXF1ZW5jZSwgYXNjZW5kaW5nLiAqLyAgICBwZSh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgaWYgKHQgPCAxMjgpIHRoaXMuX2UodCk7IGVsc2UgaWYgKHQgPCAyMDQ4KSB0aGlzLl9lKDk2MCB8IHQgPj4+IDYpLCB0aGlzLl9lKDEyOCB8IDYzICYgdCk7IGVsc2UgaWYgKGUgPCBcIlxcdWQ4MDBcIiB8fCBcIlxcdWRiZmZcIiA8IGUpIHRoaXMuX2UoNDgwIHwgdCA+Pj4gMTIpLCBcbiAgICAgICAgICAgIHRoaXMuX2UoMTI4IHwgNjMgJiB0ID4+PiA2KSwgdGhpcy5fZSgxMjggfCA2MyAmIHQpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5jb2RlUG9pbnRBdCgwKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lKDI0MCB8IHQgPj4+IDE4KSwgdGhpcy5fZSgxMjggfCA2MyAmIHQgPj4+IDEyKSwgdGhpcy5fZSgxMjggfCA2MyAmIHQgPj4+IDYpLCBcbiAgICAgICAgICAgICAgICB0aGlzLl9lKDEyOCB8IDYzICYgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53ZSgpO1xuICAgIH1cbiAgICAvKiogV3JpdGVzIHV0ZjggYnl0ZXMgaW50byB0aGlzIGJ5dGUgc2VxdWVuY2UsIGRlc2NlbmRpbmcgKi8gICAgSWUodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuY2hhckNvZGVBdCgwKTtcbiAgICAgICAgICAgIGlmICh0IDwgMTI4KSB0aGlzLmdlKHQpOyBlbHNlIGlmICh0IDwgMjA0OCkgdGhpcy5nZSg5NjAgfCB0ID4+PiA2KSwgdGhpcy5nZSgxMjggfCA2MyAmIHQpOyBlbHNlIGlmIChlIDwgXCJcXHVkODAwXCIgfHwgXCJcXHVkYmZmXCIgPCBlKSB0aGlzLmdlKDQ4MCB8IHQgPj4+IDEyKSwgXG4gICAgICAgICAgICB0aGlzLmdlKDEyOCB8IDYzICYgdCA+Pj4gNiksIHRoaXMuZ2UoMTI4IHwgNjMgJiB0KTsgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuY29kZVBvaW50QXQoMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5nZSgyNDAgfCB0ID4+PiAxOCksIHRoaXMuZ2UoMTI4IHwgNjMgJiB0ID4+PiAxMiksIHRoaXMuZ2UoMTI4IHwgNjMgJiB0ID4+PiA2KSwgXG4gICAgICAgICAgICAgICAgdGhpcy5nZSgxMjggfCA2MyAmIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMueWUoKTtcbiAgICB9XG4gICAgVGUodCkge1xuICAgICAgICAvLyBWYWx1ZXMgYXJlIGVuY29kZWQgd2l0aCBhIHNpbmdsZSBieXRlIGxlbmd0aCBwcmVmaXgsIGZvbGxvd2VkIGJ5IHRoZVxuICAgICAgICAvLyBhY3R1YWwgdmFsdWUgaW4gYmlnLWVuZGlhbiBmb3JtYXQgd2l0aCBsZWFkaW5nIDAgYnl0ZXMgZHJvcHBlZC5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuRWUodCksIG4gPSBaaShlKTtcbiAgICAgICAgdGhpcy5BZSgxICsgbiksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSAyNTUgJiBuO1xuICAgICAgICAvLyBXcml0ZSB0aGUgbGVuZ3RoXG4gICAgICAgIGZvciAobGV0IHQgPSBlLmxlbmd0aCAtIG47IHQgPCBlLmxlbmd0aDsgKyt0KSB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gMjU1ICYgZVt0XTtcbiAgICB9XG4gICAgUmUodCkge1xuICAgICAgICAvLyBWYWx1ZXMgYXJlIGVuY29kZWQgd2l0aCBhIHNpbmdsZSBieXRlIGxlbmd0aCBwcmVmaXgsIGZvbGxvd2VkIGJ5IHRoZVxuICAgICAgICAvLyBpbnZlcnRlZCB2YWx1ZSBpbiBiaWctZW5kaWFuIGZvcm1hdCB3aXRoIGxlYWRpbmcgMCBieXRlcyBkcm9wcGVkLlxuICAgICAgICBjb25zdCBlID0gdGhpcy5FZSh0KSwgbiA9IFppKGUpO1xuICAgICAgICB0aGlzLkFlKDEgKyBuKSwgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IH4oMjU1ICYgbik7XG4gICAgICAgIC8vIFdyaXRlIHRoZSBsZW5ndGhcbiAgICAgICAgZm9yIChsZXQgdCA9IGUubGVuZ3RoIC0gbjsgdCA8IGUubGVuZ3RoOyArK3QpIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSB+KDI1NSAmIGVbdF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgdGhlIFwiaW5maW5pdHlcIiBieXRlIHNlcXVlbmNlIHRoYXQgc29ydHMgYWZ0ZXIgYWxsIG90aGVyIGJ5dGVcbiAgICAgKiBzZXF1ZW5jZXMgd3JpdHRlbiBpbiBhc2NlbmRpbmcgb3JkZXIuXG4gICAgICovICAgIGJlKCkge1xuICAgICAgICB0aGlzLlBlKDI1NSksIHRoaXMuUGUoMjU1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBcImluZmluaXR5XCIgYnl0ZSBzZXF1ZW5jZSB0aGF0IHNvcnRzIGJlZm9yZSBhbGwgb3RoZXIgYnl0ZVxuICAgICAqIHNlcXVlbmNlcyB3cml0dGVuIGluIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAgICovICAgIFZlKCkge1xuICAgICAgICB0aGlzLnZlKDI1NSksIHRoaXMudmUoMjU1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBidWZmZXIgc3VjaCB0aGF0IGl0IGlzIHRoZSBzYW1lIGFzIHdoZW4gaXQgd2FzIG5ld2x5XG4gICAgICogY29uc3RydWN0ZWQuXG4gICAgICovICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gMDtcbiAgICB9XG4gICAgc2VlZCh0KSB7XG4gICAgICAgIHRoaXMuQWUodC5sZW5ndGgpLCB0aGlzLmJ1ZmZlci5zZXQodCwgdGhpcy5wb3NpdGlvbiksIHRoaXMucG9zaXRpb24gKz0gdC5sZW5ndGg7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBhIGNvcHkgb2YgdGhlIGVuY29kZWQgYnl0ZXMgaW4gdGhpcyBidWZmZXIuICAqLyAgICBTZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLnNsaWNlKDAsIHRoaXMucG9zaXRpb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIGB2YWxgIGludG8gYW4gZW5jb2Rpbmcgc28gdGhhdCB0aGUgb3JkZXIgbWF0Y2hlcyB0aGUgSUVFRSA3NTRcbiAgICAgKiBmbG9hdGluZy1wb2ludCBjb21wYXJpc29uIHJlc3VsdHMgd2l0aCB0aGUgZm9sbG93aW5nIGV4Y2VwdGlvbnM6XG4gICAgICogICAtMC4wIDwgMC4wXG4gICAgICogICBhbGwgbm9uLU5hTiA8IE5hTlxuICAgICAqICAgTmFOID0gTmFOXG4gICAgICovICAgIEVlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAvKiogQ29udmVydHMgYSBKYXZhU2NyaXB0IG51bWJlciB0byBhIGJ5dGUgYXJyYXkgKHVzaW5nIGJpZyBlbmRpYW4gZW5jb2RpbmcpLiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcig4KSk7XG4gICAgICAgICAgICByZXR1cm4gZS5zZXRGbG9hdDY0KDAsIHQsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITEpLCBuZXcgVWludDhBcnJheShlLmJ1ZmZlcik7XG4gICAgICAgIH0odCksIG4gPSAwICE9ICgxMjggJiBlWzBdKTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGZpcnN0IGJpdCBpcyBzZXQuIFdlIHVzZSBhIGJpdCBtYXNrIHNpbmNlIHZhbHVlWzBdIGlzXG4gICAgICAgIC8vIGVuY29kZWQgYXMgYSBudW1iZXIgZnJvbSAwIHRvIDI1NS5cbiAgICAgICAgICAgICAgICAvLyBSZXZlcnQgdGhlIHR3byBjb21wbGVtZW50IHRvIGdldCBuYXR1cmFsIG9yZGVyaW5nXG4gICAgICAgIGVbMF0gXj0gbiA/IDI1NSA6IDEyODtcbiAgICAgICAgZm9yIChsZXQgdCA9IDE7IHQgPCBlLmxlbmd0aDsgKyt0KSBlW3RdIF49IG4gPyAyNTUgOiAwO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgLyoqIFdyaXRlcyBhIHNpbmdsZSBieXRlIGFzY2VuZGluZyB0byB0aGUgYnVmZmVyLiAqLyAgICBfZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAyNTUgJiB0O1xuICAgICAgICAwID09PSBlID8gKHRoaXMuUGUoMCksIHRoaXMuUGUoMjU1KSkgOiAyNTUgPT09IGUgPyAodGhpcy5QZSgyNTUpLCB0aGlzLlBlKDApKSA6IHRoaXMuUGUoZSk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgYSBzaW5nbGUgYnl0ZSBkZXNjZW5kaW5nIHRvIHRoZSBidWZmZXIuICAqLyAgICBnZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAyNTUgJiB0O1xuICAgICAgICAwID09PSBlID8gKHRoaXMudmUoMCksIHRoaXMudmUoMjU1KSkgOiAyNTUgPT09IGUgPyAodGhpcy52ZSgyNTUpLCB0aGlzLnZlKDApKSA6IHRoaXMudmUodCk7XG4gICAgfVxuICAgIHdlKCkge1xuICAgICAgICB0aGlzLlBlKDApLCB0aGlzLlBlKDEpO1xuICAgIH1cbiAgICB5ZSgpIHtcbiAgICAgICAgdGhpcy52ZSgwKSwgdGhpcy52ZSgxKTtcbiAgICB9XG4gICAgUGUodCkge1xuICAgICAgICB0aGlzLkFlKDEpLCB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gdDtcbiAgICB9XG4gICAgdmUodCkge1xuICAgICAgICB0aGlzLkFlKDEpLCB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gfnQ7XG4gICAgfVxuICAgIEFlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQgKyB0aGlzLnBvc2l0aW9uO1xuICAgICAgICBpZiAoZSA8PSB0aGlzLmJ1ZmZlci5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgLy8gVHJ5IGRvdWJsaW5nLlxuICAgICAgICAgICAgICAgIGxldCBuID0gMiAqIHRoaXMuYnVmZmVyLmxlbmd0aDtcbiAgICAgICAgLy8gU3RpbGwgbm90IGJpZyBlbm91Z2g/IEp1c3QgYWxsb2NhdGUgdGhlIHJpZ2h0IHNpemUuXG4gICAgICAgICAgICAgICAgbiA8IGUgJiYgKG4gPSBlKTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBuZXcgYnVmZmVyLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgVWludDhBcnJheShuKTtcbiAgICAgICAgcy5zZXQodGhpcy5idWZmZXIpLCAvLyBjb3B5IG9sZCBkYXRhXG4gICAgICAgIHRoaXMuYnVmZmVyID0gcztcbiAgICB9XG59XG5cbmNsYXNzIGVyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuRGUgPSB0O1xuICAgIH1cbiAgICB1ZSh0KSB7XG4gICAgICAgIHRoaXMuRGUuZGUodCk7XG4gICAgfVxuICAgIGllKHQpIHtcbiAgICAgICAgdGhpcy5EZS5wZSh0KTtcbiAgICB9XG4gICAgc2UodCkge1xuICAgICAgICB0aGlzLkRlLlRlKHQpO1xuICAgIH1cbiAgICBlZSgpIHtcbiAgICAgICAgdGhpcy5EZS5iZSgpO1xuICAgIH1cbn1cblxuY2xhc3MgbnIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5EZSA9IHQ7XG4gICAgfVxuICAgIHVlKHQpIHtcbiAgICAgICAgdGhpcy5EZS5tZSh0KTtcbiAgICB9XG4gICAgaWUodCkge1xuICAgICAgICB0aGlzLkRlLkllKHQpO1xuICAgIH1cbiAgICBzZSh0KSB7XG4gICAgICAgIHRoaXMuRGUuUmUodCk7XG4gICAgfVxuICAgIGVlKCkge1xuICAgICAgICB0aGlzLkRlLlZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEltcGxlbWVudHMgYERpcmVjdGlvbmFsSW5kZXhCeXRlRW5jb2RlcmAgdXNpbmcgYE9yZGVyZWRDb2RlV3JpdGVyYCBmb3IgdGhlXG4gKiBhY3R1YWwgZW5jb2RpbmcuXG4gKi8gY2xhc3Mgc3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLkRlID0gbmV3IHRyLCB0aGlzLkNlID0gbmV3IGVyKHRoaXMuRGUpLCB0aGlzLnhlID0gbmV3IG5yKHRoaXMuRGUpO1xuICAgIH1cbiAgICBzZWVkKHQpIHtcbiAgICAgICAgdGhpcy5EZS5zZWVkKHQpO1xuICAgIH1cbiAgICBOZSh0KSB7XG4gICAgICAgIHJldHVybiAwIC8qIEFTQ0VORElORyAqLyA9PT0gdCA/IHRoaXMuQ2UgOiB0aGlzLnhlO1xuICAgIH1cbiAgICBTZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRGUuU2UoKTtcbiAgICB9XG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuRGUucmVzZXQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUmVwcmVzZW50cyBhbiBpbmRleCBlbnRyeSBzYXZlZCBieSB0aGUgU0RLIGluIHBlcnNpc3RlZCBzdG9yYWdlLiAqLyBjbGFzcyBpciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLmluZGV4SWQgPSB0LCB0aGlzLmRvY3VtZW50S2V5ID0gZSwgdGhpcy5hcnJheVZhbHVlID0gbiwgdGhpcy5kaXJlY3Rpb25hbFZhbHVlID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBJbmRleEVudHJ5IGVudHJ5IHRoYXQgc29ydHMgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIGN1cnJlbnRcbiAgICAgKiBkaXJlY3Rpb25hbCB2YWx1ZS5cbiAgICAgKi8gICAga2UoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmRpcmVjdGlvbmFsVmFsdWUubGVuZ3RoLCBlID0gMCA9PT0gdCB8fCAyNTUgPT09IHRoaXMuZGlyZWN0aW9uYWxWYWx1ZVt0IC0gMV0gPyB0ICsgMSA6IHQsIG4gPSBuZXcgVWludDhBcnJheShlKTtcbiAgICAgICAgcmV0dXJuIG4uc2V0KHRoaXMuZGlyZWN0aW9uYWxWYWx1ZSwgMCksIGUgIT09IHQgPyBuLnNldChbIDAgXSwgdGhpcy5kaXJlY3Rpb25hbFZhbHVlLmxlbmd0aCkgOiArK25bbi5sZW5ndGggLSAxXSwgXG4gICAgICAgIG5ldyBpcih0aGlzLmluZGV4SWQsIHRoaXMuZG9jdW1lbnRLZXksIHRoaXMuYXJyYXlWYWx1ZSwgbik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBycih0LCBlKSB7XG4gICAgbGV0IG4gPSB0LmluZGV4SWQgLSBlLmluZGV4SWQ7XG4gICAgcmV0dXJuIDAgIT09IG4gPyBuIDogKG4gPSBvcih0LmFycmF5VmFsdWUsIGUuYXJyYXlWYWx1ZSksIDAgIT09IG4gPyBuIDogKG4gPSBvcih0LmRpcmVjdGlvbmFsVmFsdWUsIGUuZGlyZWN0aW9uYWxWYWx1ZSksIFxuICAgIDAgIT09IG4gPyBuIDogeHQuY29tcGFyYXRvcih0LmRvY3VtZW50S2V5LCBlLmRvY3VtZW50S2V5KSkpO1xufVxuXG5mdW5jdGlvbiBvcih0LCBlKSB7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aCAmJiBuIDwgZS5sZW5ndGg7ICsrbikge1xuICAgICAgICBjb25zdCBzID0gdFtuXSAtIGVbbl07XG4gICAgICAgIGlmICgwICE9PSBzKSByZXR1cm4gcztcbiAgICB9XG4gICAgcmV0dXJuIHQubGVuZ3RoIC0gZS5sZW5ndGg7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgbGlnaHQgcXVlcnkgcGxhbm5lciBmb3IgRmlyZXN0b3JlLlxuICpcbiAqIFRoaXMgY2xhc3MgbWF0Y2hlcyBhIGBGaWVsZEluZGV4YCBhZ2FpbnN0IGEgRmlyZXN0b3JlIFF1ZXJ5IGBUYXJnZXRgLiBJdFxuICogZGV0ZXJtaW5lcyB3aGV0aGVyIGEgZ2l2ZW4gaW5kZXggY2FuIGJlIHVzZWQgdG8gc2VydmUgdGhlIHNwZWNpZmllZCB0YXJnZXQuXG4gKlxuICogVGhlIGZvbGxvd2luZyB0YWJsZSBzaG93Y2FzZXMgc29tZSBwb3NzaWJsZSBpbmRleCBjb25maWd1cmF0aW9uczpcbiAqXG4gKiBRdWVyeSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBJbmRleFxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIHdoZXJlKCdhJywgJz09JywgJ2EnKS53aGVyZSgnYicsICc9PScsICdiJykgICAgICAgICB8IGEgQVNDLCBiIERFU0NcbiAqIHdoZXJlKCdhJywgJz09JywgJ2EnKS53aGVyZSgnYicsICc9PScsICdiJykgICAgICAgICB8IGEgQVNDXG4gKiB3aGVyZSgnYScsICc9PScsICdhJykud2hlcmUoJ2InLCAnPT0nLCAnYicpICAgICAgICAgfCBiIERFU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJykgICAgICAgICAgICAgICAgICB8IGEgQVNDXG4gKiB3aGVyZSgnYScsICc+PScsICdhJykub3JkZXJCeSgnYScsICdkZXNjJykgICAgICAgICAgfCBhIERFU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJykub3JkZXJCeSgnYicpICAgICB8IGEgQVNDLCBiIEFTQ1xuICogd2hlcmUoJ2EnLCAnPj0nLCAnYScpLm9yZGVyQnkoJ2EnKS5vcmRlckJ5KCdiJykgICAgIHwgYSBBU0NcbiAqIHdoZXJlKCdhJywgJ2FycmF5LWNvbnRhaW5zJywgJ2EnKS5vcmRlckJ5KCdiJykgICAgICB8IGEgQ09OVEFJTlMsIGIgQVNDRU5ESU5HXG4gKiB3aGVyZSgnYScsICdhcnJheS1jb250YWlucycsICdhJykub3JkZXJCeSgnYicpICAgICAgfCBhIENPTlRBSU5TXG4gKi8gY2xhc3MgdXIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uSWQgPSBudWxsICE9IHQuY29sbGVjdGlvbkdyb3VwID8gdC5jb2xsZWN0aW9uR3JvdXAgOiB0LnBhdGgubGFzdFNlZ21lbnQoKSwgXG4gICAgICAgIHRoaXMuTWUgPSB0Lm9yZGVyQnksIHRoaXMuT2UgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZmlsdGVycykge1xuICAgICAgICAgICAgY29uc3QgdCA9IGU7XG4gICAgICAgICAgICB0LlMoKSA/IHRoaXMuRmUgPSB0IDogdGhpcy5PZS5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgaW5kZXggY2FuIGJlIHVzZWQgdG8gc2VydmUgdGhlIFRhcmdldEluZGV4TWF0Y2hlcidzXG4gICAgICogdGFyZ2V0LlxuICAgICAqXG4gICAgICogQW4gaW5kZXggaXMgY29uc2lkZXJlZCBjYXBhYmxlIG9mIHNlcnZpbmcgdGhlIHRhcmdldCB3aGVuOlxuICAgICAqIC0gVGhlIHRhcmdldCB1c2VzIGFsbCBpbmRleCBzZWdtZW50cyBmb3IgaXRzIGZpbHRlcnMgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgKiAgIFRoZSB0YXJnZXQgY2FuIGhhdmUgYWRkaXRpb25hbCBmaWx0ZXIgYW5kIG9yZGVyQnkgY2xhdXNlcywgYnV0IG5vdFxuICAgICAqICAgZmV3ZXIuXG4gICAgICogLSBJZiBhbiBBcnJheUNvbnRhaW5zL0FycmF5Q29udGFpbnNBbnlmaWx0ZXIgaXMgdXNlZCwgdGhlIGluZGV4IG11c3QgYWxzb1xuICAgICAqICAgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgYENPTlRBSU5TYCBzZWdtZW50LlxuICAgICAqIC0gQWxsIGRpcmVjdGlvbmFsIGluZGV4IHNlZ21lbnRzIGNhbiBiZSBtYXBwZWQgdG8gdGhlIHRhcmdldCBhcyBhIHNlcmllcyBvZlxuICAgICAqICAgZXF1YWxpdHkgZmlsdGVycywgYSBzaW5nbGUgaW5lcXVhbGl0eSBmaWx0ZXIgYW5kIGEgc2VyaWVzIG9mIG9yZGVyQnlcbiAgICAgKiAgIGNsYXVzZXMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhlIGVxdWFsaXR5IGZpbHRlcnMgbWF5IGFwcGVhciBvdXQgb2Ygb3JkZXIuXG4gICAgICogLSBUaGUgb3B0aW9uYWwgc2VnbWVudCBmb3IgdGhlIGluZXF1YWxpdHkgZmlsdGVyIG11c3QgYXBwZWFyIGFmdGVyIGFsbFxuICAgICAqICAgZXF1YWxpdHkgc2VnbWVudHMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhhdCBvcmRlckJ5IGNsYXVzZSBvZiB0aGUgdGFyZ2V0IG11c3QgYXBwZWFyXG4gICAgICogICBpbiBvcmRlciBhZnRlciBhbGwgZXF1YWxpdHkgYW5kIGluZXF1YWxpdHkgc2VnbWVudHMuIFNpbmdsZSBvcmRlckJ5XG4gICAgICogICBjbGF1c2VzIGNhbm5vdCBiZSBza2lwcGVkLCBidXQgYSBjb250aW51b3VzIG9yZGVyQnkgc3VmZml4IG1heSBiZVxuICAgICAqICAgb21pdHRlZC5cbiAgICAgKi8gICAgJGUodCkge1xuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBhcnJheSBlbGVtZW50LCBmaW5kIGEgbWF0Y2hpbmcgZmlsdGVyLlxuICAgICAgICBjb25zdCBlID0gaWUodCk7XG4gICAgICAgIGlmICh2b2lkIDAgIT09IGUgJiYgIXRoaXMuQmUoZSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IHJlKHQpO1xuICAgICAgICBsZXQgcyA9IDAsIGkgPSAwO1xuICAgICAgICAvLyBQcm9jZXNzIGFsbCBlcXVhbGl0aWVzIGZpcnN0LiBFcXVhbGl0aWVzIGNhbiBhcHBlYXIgb3V0IG9mIG9yZGVyLlxuICAgICAgICBmb3IgKDtzIDwgbi5sZW5ndGggJiYgdGhpcy5CZShuW3NdKTsgKytzKSA7XG4gICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSBwcm9jZXNzZWQgYWxsIHNlZ21lbnRzLCBhbGwgc2VnbWVudHMgYXJlIHVzZWQgdG8gc2VydmVcbiAgICAgICAgLy8gdGhlIGVxdWFsaXR5IGZpbHRlcnMgYW5kIHdlIGRvIG5vdCBuZWVkIHRvIG1hcCBhbnkgc2VnbWVudHMgdG8gdGhlXG4gICAgICAgIC8vIHRhcmdldCdzIGluZXF1YWxpdHkgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgICAgICAgICAgICBpZiAocyA9PT0gbi5sZW5ndGgpIHJldHVybiAhMDtcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gaW5lcXVhbGl0eSBmaWx0ZXIsIHRoZSBuZXh0IHNlZ21lbnQgbXVzdCBtYXRjaCBib3RoIHRoZVxuICAgICAgICAvLyBmaWx0ZXIgYW5kIHRoZSBmaXJzdCBvcmRlckJ5IGNsYXVzZS5cbiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0aGlzLkZlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltzXTtcbiAgICAgICAgICAgIGlmICghdGhpcy5MZSh0aGlzLkZlLCB0KSB8fCAhdGhpcy5VZSh0aGlzLk1lW2krK10sIHQpKSByZXR1cm4gITE7XG4gICAgICAgICAgICArK3M7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQWxsIHJlbWFpbmluZyBzZWdtZW50cyBuZWVkIHRvIHJlcHJlc2VudCB0aGUgcHJlZml4IG9mIHRoZSB0YXJnZXQnc1xuICAgICAgICAvLyBvcmRlckJ5LlxuICAgICAgICAgICAgICAgIGZvciAoO3MgPCBuLmxlbmd0aDsgKytzKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltzXTtcbiAgICAgICAgICAgIGlmIChpID49IHRoaXMuTWUubGVuZ3RoIHx8ICF0aGlzLlVlKHRoaXMuTWVbaSsrXSwgdCkpIHJldHVybiAhMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIEJlKHQpIHtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuT2UpIGlmICh0aGlzLkxlKGUsIHQpKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgTGUodCwgZSkge1xuICAgICAgICBpZiAodm9pZCAwID09PSB0IHx8ICF0LmZpZWxkLmlzRXF1YWwoZS5maWVsZFBhdGgpKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IG4gPSBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IHQub3AgfHwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IHQub3A7XG4gICAgICAgIHJldHVybiAyIC8qIENPTlRBSU5TICovID09PSBlLmtpbmQgPT09IG47XG4gICAgfVxuICAgIFVlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICEhdC5maWVsZC5pc0VxdWFsKGUuZmllbGRQYXRoKSAmJiAoMCAvKiBBU0NFTkRJTkcgKi8gPT09IGUua2luZCAmJiBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA9PT0gdC5kaXIgfHwgMSAvKiBERVNDRU5ESU5HICovID09PSBlLmtpbmQgJiYgXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gdC5kaXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqLyBjbGFzcyBhciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucWUgPSBuZXcgY3I7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucWUuYWRkKGUpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUodGhpcy5xZS5nZXRFbnRyaWVzKGUpKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4geWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4geWkucmVzb2x2ZSgwIC8qIE5PTkUgKi8pO1xuICAgIH1cbiAgICBnZXRGaWVsZEluZGV4ZXModCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShbXSk7XG4gICAgfVxuICAgIGdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSh0KSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRNaW5PZmZzZXQodCwgZSkge1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShoZS5taW4oKSk7XG4gICAgfVxuICAgIHVwZGF0ZUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZUluZGV4RW50cmllcyh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEludGVybmFsIGltcGxlbWVudGF0aW9uIG9mIHRoZSBjb2xsZWN0aW9uLXBhcmVudCBpbmRleCBleHBvc2VkIGJ5IE1lbW9yeUluZGV4TWFuYWdlci5cbiAqIEFsc28gdXNlZCBmb3IgaW4tbWVtb3J5IGNhY2hpbmcgYnkgSW5kZXhlZERiSW5kZXhNYW5hZ2VyIGFuZCBpbml0aWFsIGluZGV4IHBvcHVsYXRpb25cbiAqIGluIGluZGV4ZWRkYl9zY2hlbWEudHNcbiAqLyBjbGFzcyBjciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuaW5kZXggPSB7fTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBmYWxzZSBpZiB0aGUgZW50cnkgYWxyZWFkeSBleGlzdGVkLlxuICAgIGFkZCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lmxhc3RTZWdtZW50KCksIG4gPSB0LnBvcExhc3QoKSwgcyA9IHRoaXMuaW5kZXhbZV0gfHwgbmV3IHdlKF90LmNvbXBhcmF0b3IpLCBpID0gIXMuaGFzKG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5pbmRleFtlXSA9IHMuYWRkKG4pLCBpO1xuICAgIH1cbiAgICBoYXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBuID0gdC5wb3BMYXN0KCksIHMgPSB0aGlzLmluZGV4W2VdO1xuICAgICAgICByZXR1cm4gcyAmJiBzLmhhcyhuKTtcbiAgICB9XG4gICAgZ2V0RW50cmllcyh0KSB7XG4gICAgICAgIHJldHVybiAodGhpcy5pbmRleFt0XSB8fCBuZXcgd2UoX3QuY29tcGFyYXRvcikpLnRvQXJyYXkoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IGhyID0gbmV3IFVpbnQ4QXJyYXkoMCk7XG5cbi8qKlxuICogQSBwZXJzaXN0ZWQgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVW5saWtlIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdlYiBTREsgZG9lcyBub3QgbWVtb2l6ZSBpbmRleFxuICogZGF0YSBhcyBpdCBzdXBwb3J0cyBtdWx0aS10YWIgYWNjZXNzLlxuICovXG5jbGFzcyBsciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnVzZXIgPSB0LCB0aGlzLmRhdGFiYXNlSWQgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGluLW1lbW9yeSBjb3B5IG9mIHRoZSBpbmRleCBlbnRyaWVzIHdlJ3ZlIGFscmVhZHkgd3JpdHRlbiBzaW5jZSB0aGUgU0RLXG4gICAgICAgICAqIGxhdW5jaGVkLiBVc2VkIHRvIGF2b2lkIHJlLXdyaXRpbmcgdGhlIHNhbWUgZW50cnkgcmVwZWF0ZWRseS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBpcyAqTk9UKiBhIGNvbXBsZXRlIGNhY2hlIG9mIHdoYXQncyBpbiBwZXJzaXN0ZW5jZSBhbmQgc28gY2FuIG5ldmVyIGJlXG4gICAgICAgICAqIHVzZWQgdG8gc2F0aXNmeSByZWFkcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuS2UgPSBuZXcgY3IsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBmcm9tIGEgdGFyZ2V0IHRvIGl0cyBlcXVpdmFsZW50IGxpc3Qgb2Ygc3ViLXRhcmdldHMuIEVhY2ggc3ViLXRhcmdldFxuICAgICAgICAgKiBjb250YWlucyBvbmx5IG9uZSB0ZXJtIGZyb20gdGhlIHRhcmdldCdzIGRpc2p1bmN0aXZlIG5vcm1hbCBmb3JtIChETkYpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5HZSA9IG5ldyBLbigodCA9PiBJZSh0KSksICgodCwgZSkgPT4gRWUodCwgZSkpKSwgdGhpcy51aWQgPSB0LnVpZCB8fCBcIlwiO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IGVudHJ5IHRvIHRoZSBjb2xsZWN0aW9uIHBhcmVudCBpbmRleC5cbiAgICAgKlxuICAgICAqIFJlcGVhdGVkIGNhbGxzIGZvciB0aGUgc2FtZSBjb2xsZWN0aW9uUGF0aCBzaG91bGQgYmUgYXZvaWRlZCB3aXRoaW4gYVxuICAgICAqIHRyYW5zYWN0aW9uIGFzIEluZGV4ZWREYkluZGV4TWFuYWdlciBvbmx5IGNhY2hlcyB3cml0ZXMgb25jZSBhIHRyYW5zYWN0aW9uXG4gICAgICogaGFzIGJlZW4gY29tbWl0dGVkLlxuICAgICAqLyAgICBhZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlKSB7XG4gICAgICAgIGlmICghdGhpcy5LZS5oYXMoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmxhc3RTZWdtZW50KCksIHMgPSBlLnBvcExhc3QoKTtcbiAgICAgICAgICAgIHQuYWRkT25Db21taXR0ZWRMaXN0ZW5lcigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY29sbGVjdGlvbiB0byB0aGUgaW4gbWVtb3J5IGNhY2hlIG9ubHkgaWYgdGhlIHRyYW5zYWN0aW9uIHdhc1xuICAgICAgICAgICAgICAgIC8vIHN1Y2Nlc3NmdWxseSBjb21taXR0ZWQuXG4gICAgICAgICAgICAgICAgdGhpcy5LZS5hZGQoZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCBpID0ge1xuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogbixcbiAgICAgICAgICAgICAgICBwYXJlbnQ6IEdzKHMpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGZyKHQpLnB1dChpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRDb2xsZWN0aW9uUGFyZW50cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXSwgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZSwgXCJcIiBdLCBbIHV0KGUpLCBcIlwiIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgcmV0dXJuIGZyKHQpLnF0KHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGNvbGxlY3Rpb25JZCBndWFyZCBzaG91bGRuJ3QgYmUgbmVjZXNzYXJ5IChhbmQgaXNuJ3QgYXMgbG9uZ1xuICAgICAgICAgICAgICAgIC8vIGFzIHdlJ3JlIHJ1bm5pbmcgaW4gYSByZWFsIGJyb3dzZXIpLCBidXQgdGhlcmUncyBhIGJ1ZyBpblxuICAgICAgICAgICAgICAgIC8vIGluZGV4ZWRkYnNoaW0gdGhhdCBicmVha3Mgb3VyIHJhbmdlIGluIG91ciB0ZXN0cyBydW5uaW5nIGluIG5vZGU6XG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2F4ZW1jbGlvbi9JbmRleGVkREJTaGltL2lzc3Vlcy8zMzRcbiAgICAgICAgICAgICAgICBpZiAocy5jb2xsZWN0aW9uSWQgIT09IGUpIGJyZWFrO1xuICAgICAgICAgICAgICAgIG4ucHVzaChXcyhzLnBhcmVudCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBWZXJpZnkgdGhhdCB0aGUgYXV0by1pbmNyZW1lbnRpbmcgaW5kZXggSUQgd29ya3MgaW5cbiAgICAgICAgLy8gU2FmYXJpICYgRmlyZWZveC5cbiAgICAgICAgY29uc3QgbiA9IF9yKHQpLCBzID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleElkOiB0LmluZGV4SWQsXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbkdyb3VwOiB0LmNvbGxlY3Rpb25Hcm91cCxcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHQuZmllbGRzLm1hcCgodCA9PiBbIHQuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCB0LmtpbmQgXSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KGUpO1xuICAgICAgICAvLyBgaW5kZXhJZGAgaXMgYXV0by1wb3B1bGF0ZWQgYnkgSW5kZXhlZERiXG4gICAgICAgIHJldHVybiBkZWxldGUgcy5pbmRleElkLCBuLmFkZChzKS5uZXh0KCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gX3IodCksIHMgPSB3cih0KSwgaSA9IGRyKHQpO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUoZS5pbmRleElkKS5uZXh0KCgoKSA9PiBzLmRlbGV0ZShJREJLZXlSYW5nZS5ib3VuZChbIGUuaW5kZXhJZCBdLCBbIGUuaW5kZXhJZCArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApKSkpLm5leHQoKCgpID0+IGkuZGVsZXRlKElEQktleVJhbmdlLmJvdW5kKFsgZS5pbmRleElkIF0sIFsgZS5pbmRleElkICsgMSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCkpKSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGRyKHQpO1xuICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICBjb25zdCBpID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIHlpLmZvckVhY2godGhpcy5RZShlKSwgKGUgPT4gdGhpcy5qZSh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHMgJiYgKHMgPSAhIXQpLCBpLnNldChlLCB0KTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdCA9IFluKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiB5aS5mb3JFYWNoKGksICgoaSwgcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvKiogUmV0dXJucyBhIGRlYnVnIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBmaWVsZCBpbmRleCAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgbztcbiAgICAgICAgICAgICAgICAgICAgTyhcIkluZGV4ZWREYkluZGV4TWFuYWdlclwiLCBgVXNpbmcgaW5kZXggJHtvID0gaSwgYGlkPSR7by5pbmRleElkfXxjZz0ke28uY29sbGVjdGlvbkdyb3VwfXxmPSR7by5maWVsZHMubWFwKCh0ID0+IGAke3QuZmllbGRQYXRofToke3Qua2luZH1gKSkuam9pbihcIixcIil9YH0gdG8gZXhlY3V0ZSAke0llKGUpfWApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGllKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gbikgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgUmUodCwgbi5maWVsZFBhdGgpKSBzd2l0Y2ggKGUub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUudmFsdWUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIGUudmFsdWUgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1haW5pbmcgZmlsdGVycyBhcmUgbm90IGFycmF5IGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdGhlIGxpc3Qgb2YgdmFsdWVzIHRoYXQgYXJlIHVzZWQgaW4gIT0gb3IgTk9UX0lOIGZpbHRlcnMuIFJldHVybnNcbiAqIGBudWxsYCBpZiB0aGVyZSBhcmUgbm8gc3VjaCBmaWx0ZXJzLlxuICovIChyLCBpKSwgYSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHJlKGUpKSBmb3IgKGNvbnN0IGUgb2YgUmUodCwgcy5maWVsZFBhdGgpKSBzd2l0Y2ggKGUub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIj09XCIgLyogRVFVQUwgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW5cIiAvKiBJTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW5jb2RlIGVxdWFsaXR5IHByZWZpeCwgd2hpY2ggaXMgZW5jb2RlZCBpbiB0aGUgaW5kZXggdmFsdWUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGluZXF1YWxpdHkgKGUuZy4gYGEgPT0gJ2EnICYmIGIgIT0gJ2InYCBpcyBlbmNvZGVkIHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYHZhbHVlICE9ICdhYidgKS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldChzLmZpZWxkUGF0aC5jYW5vbmljYWxTdHJpbmcoKSwgZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90SW4vTm90RXF1YWwgaXMgYWx3YXlzIGEgc3VmZml4LiBUaGVyZSBjYW5ub3QgYmUgYW55IHJlbWFpbmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlZ21lbnRzIGFuZCBoZW5jZSB3ZSBjYW4gcmV0dXJuIGVhcmx5IGhlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uc2V0KHMuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCBlLnZhbHVlKSwgQXJyYXkuZnJvbShuLnZhbHVlcygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1haW5pbmcgZmlsdGVycyBjYW5ub3QgYmUgdXNlZCBhcyBub3RJbiBib3VuZHMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgYSBsb3dlciBib3VuZCBvZiBmaWVsZCB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCBhcyBhIHN0YXJ0aW5nIHBvaW50IHRvXG4gKiBzY2FuIHRoZSBpbmRleCBkZWZpbmVkIGJ5IGBmaWVsZEluZGV4YC4gUmV0dXJucyBgTUlOX1ZBTFVFYCBpZiBubyBsb3dlciBib3VuZFxuICogZXhpc3RzLlxuICovIChyLCBpKSwgYyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzID0gITA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZWFjaCBzZWdtZW50LCByZXRyaWV2ZSBhIGxvd2VyIGJvdW5kIGlmIHRoZXJlIGlzIGEgc3VpdGFibGUgZmlsdGVyIG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydEF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHJlKGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IDAgLyogQVNDRU5ESU5HICovID09PSBpLmtpbmQgPyBiZSh0LCBpLmZpZWxkUGF0aCwgdC5zdGFydEF0KSA6IFBlKHQsIGkuZmllbGRQYXRoLCB0LnN0YXJ0QXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucHVzaChlLnZhbHVlKSwgcyAmJiAocyA9IGUuaW5jbHVzaXZlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2Uobiwgcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGFuIHVwcGVyIGJvdW5kIG9mIGZpZWxkIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIGFzIGFuIGVuZGluZyBwb2ludFxuICogd2hlbiBzY2FubmluZyB0aGUgaW5kZXggZGVmaW5lZCBieSBgZmllbGRJbmRleGAuIFJldHVybnMgYE1BWF9WQUxVRWAgaWYgbm9cbiAqIHVwcGVyIGJvdW5kIGV4aXN0cy5cbiAqLyAociwgaSksIGggPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIGVhY2ggc2VnbWVudCwgcmV0cmlldmUgYW4gdXBwZXIgYm91bmQgaWYgdGhlcmUgaXMgYSBzdWl0YWJsZSBmaWx0ZXIgb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuZEF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHJlKGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IDAgLyogQVNDRU5ESU5HICovID09PSBpLmtpbmQgPyBQZSh0LCBpLmZpZWxkUGF0aCwgdC5lbmRBdCkgOiBiZSh0LCBpLmZpZWxkUGF0aCwgdC5lbmRBdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKGUudmFsdWUpLCBzICYmIChzID0gZS5pbmNsdXNpdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPZShuLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgfShyLCBpKSwgbCA9IHRoaXMuV2UoaSwgciwgYyksIGYgPSB0aGlzLldlKGksIHIsIGgpLCBkID0gdGhpcy56ZShpLCByLCBhKSwgXyA9IHRoaXMuSGUoaS5pbmRleElkLCB1LCBsLCBjLmluY2x1c2l2ZSwgZiwgaC5pbmNsdXNpdmUsIGQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geWkuZm9yRWFjaChfLCAoaSA9PiBuLkd0KGksIGUubGltaXQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0geHQuZnJvbVNlZ21lbnRzKGUuZG9jdW1lbnRLZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuaGFzKG4pIHx8ICh0ID0gdC5hZGQobiksIHMucHVzaChuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geWkucmVzb2x2ZShudWxsKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBRZSh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5HZS5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChcbiAgICAgICAgLy8gVE9ETyhvcnF1ZXJ5KTogSW1wbGVtZW50IERORiB0cmFuc2Zvcm1cbiAgICAgICAgZSA9IFsgdCBdLCB0aGlzLkdlLnNldCh0LCBlKSwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBrZXkgcmFuZ2UgcXVlcnkgb24gYERiSW5kZXhFbnRyeVN0b3JlYCB0aGF0IHVuaW9ucyBhbGxcbiAgICAgKiBib3VuZHMuXG4gICAgICovICAgIEhlKHQsIGUsIG4sIHMsIGksIHIsIG8pIHtcbiAgICAgICAgLy8gVGhlIG51bWJlciBvZiB0b3RhbCBpbmRleCBzY2FucyB3ZSB1bmlvbiB0b2dldGhlci4gVGhpcyBpcyBzaW1pbGFyIHRvIGFcbiAgICAgICAgLy8gZGlzdHJpYnV0ZWQgbm9ybWFsIGZvcm0sIGJ1dCBhZGFwdGVkIGZvciBhcnJheSB2YWx1ZXMuIFdlIGNyZWF0ZSBhIHNpbmdsZVxuICAgICAgICAvLyBpbmRleCByYW5nZSBwZXIgdmFsdWUgaW4gYW4gQVJSQVlfQ09OVEFJTlMgb3IgQVJSQVlfQ09OVEFJTlNfQU5ZIGZpbHRlclxuICAgICAgICAvLyBjb21iaW5lZCB3aXRoIHRoZSB2YWx1ZXMgZnJvbSB0aGUgcXVlcnkgYm91bmRzLlxuICAgICAgICBjb25zdCB1ID0gKG51bGwgIT0gZSA/IGUubGVuZ3RoIDogMSkgKiBNYXRoLm1heChuLmxlbmd0aCwgaS5sZW5ndGgpLCBhID0gdSAvIChudWxsICE9IGUgPyBlLmxlbmd0aCA6IDEpLCBjID0gW107XG4gICAgICAgIGZvciAobGV0IGggPSAwOyBoIDwgdTsgKytoKSB7XG4gICAgICAgICAgICBjb25zdCB1ID0gZSA/IHRoaXMuSmUoZVtoIC8gYV0pIDogaHIsIGwgPSB0aGlzLlllKHQsIHUsIG5baCAlIGFdLCBzKSwgZiA9IHRoaXMuWGUodCwgdSwgaVtoICUgYV0sIHIpLCBkID0gby5tYXAoKGUgPT4gdGhpcy5ZZSh0LCB1LCBlLCBcbiAgICAgICAgICAgIC8qIGluY2x1c2l2ZT0gKi8gITApKSk7XG4gICAgICAgICAgICBjLnB1c2goLi4udGhpcy5jcmVhdGVSYW5nZShsLCBmLCBkKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGM7XG4gICAgfVxuICAgIC8qKiBHZW5lcmF0ZXMgdGhlIGxvd2VyIGJvdW5kIGZvciBgYXJyYXlWYWx1ZWAgYW5kIGBkaXJlY3Rpb25hbFZhbHVlYC4gKi8gICAgWWUodCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IGlyKHQsIHh0LmVtcHR5KCksIGUsIG4pO1xuICAgICAgICByZXR1cm4gcyA/IGkgOiBpLmtlKCk7XG4gICAgfVxuICAgIC8qKiBHZW5lcmF0ZXMgdGhlIHVwcGVyIGJvdW5kIGZvciBgYXJyYXlWYWx1ZWAgYW5kIGBkaXJlY3Rpb25hbFZhbHVlYC4gKi8gICAgWGUodCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IGlyKHQsIHh0LmVtcHR5KCksIGUsIG4pO1xuICAgICAgICByZXR1cm4gcyA/IGkua2UoKSA6IGk7XG4gICAgfVxuICAgIGplKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyB1cihlKSwgcyA9IG51bGwgIT0gZS5jb2xsZWN0aW9uR3JvdXAgPyBlLmNvbGxlY3Rpb25Hcm91cCA6IGUucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZEluZGV4ZXModCwgcykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGluZGV4IHdpdGggdGhlIG1vc3QgbnVtYmVyIG9mIHNlZ21lbnRzLlxuICAgICAgICAgICAgbGV0IGUgPSBudWxsO1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIHtcbiAgICAgICAgICAgICAgICBuLiRlKHMpICYmICghZSB8fCBzLmZpZWxkcy5sZW5ndGggPiBlLmZpZWxkcy5sZW5ndGgpICYmIChlID0gcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUodCwgZSkge1xuICAgICAgICBsZXQgbiA9IDIgLyogRlVMTCAqLztcbiAgICAgICAgcmV0dXJuIHlpLmZvckVhY2godGhpcy5RZShlKSwgKGUgPT4gdGhpcy5qZSh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHQgPyAwIC8qIE5PTkUgKi8gIT09IG4gJiYgdC5maWVsZHMubGVuZ3RoIDwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IHdlKG10LmNvbXBhcmF0b3IpLCBuID0gITE7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQuZmlsdGVycykge1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKG9ycXVlcnkpOiBVc2UgdGhlIGZsYXR0ZW5lZCBmaWx0ZXJzIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHM7XG4gICAgICAgICAgICAgICAgICAgIC8vIF9fbmFtZV9fIGlzIG5vdCBhbiBleHBsaWNpdCBzZWdtZW50IG9mIGFueSBpbmRleCwgc28gd2UgZG9uJ3QgbmVlZCB0b1xuICAgICAgICAgICAgICAgICAgICAvLyBjb3VudCBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmZpZWxkLmlzS2V5RmllbGQoKSB8fCAoXG4gICAgICAgICAgICAgICAgICAgIC8vIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWSBmaWx0ZXJzIG11c3QgYmUgY291bnRlZCBzZXBhcmF0ZWx5LlxuICAgICAgICAgICAgICAgICAgICAvLyBGb3IgaW5zdGFuY2UsIGl0IGlzIHBvc3NpYmxlIHRvIGhhdmUgYW4gaW5kZXggZm9yIFwiYSBBUlJBWSBhIEFTQ1wiLiBFdmVuXG4gICAgICAgICAgICAgICAgICAgIC8vIHRob3VnaCB0aGVzZSBhcmUgb24gdGhlIHNhbWUgZmllbGQsIHRoZXkgc2hvdWxkIGJlIGNvdW50ZWQgYXMgdHdvXG4gICAgICAgICAgICAgICAgICAgIC8vIHNlcGFyYXRlIHNlZ21lbnRzIGluIGFuIGluZGV4LlxuICAgICAgICAgICAgICAgICAgICBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IHQub3AgfHwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IHQub3AgPyBuID0gITAgOiBlID0gZS5hZGQodC5maWVsZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5vcmRlckJ5KSBcbiAgICAgICAgICAgICAgICAvLyBfX25hbWVfXyBpcyBub3QgYW4gZXhwbGljaXQgc2VnbWVudCBvZiBhbnkgaW5kZXgsIHNvIHdlIGRvbid0IG5lZWQgdG9cbiAgICAgICAgICAgICAgICAvLyBjb3VudCBpdC5cbiAgICAgICAgICAgICAgICBuLmZpZWxkLmlzS2V5RmllbGQoKSB8fCAoZSA9IGUuYWRkKG4uZmllbGQpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5zaXplICsgKG4gPyAxIDogMCk7XG4gICAgICAgICAgICB9KGUpICYmIChuID0gMSAvKiBQQVJUSUFMICovKSA6IG4gPSAwIC8qIE5PTkUgKi87XG4gICAgICAgIH0pKSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgYnl0ZSBlbmNvZGVkIGZvcm0gb2YgdGhlIGRpcmVjdGlvbmFsIHZhbHVlcyBpbiB0aGUgZmllbGQgaW5kZXguXG4gICAgICogUmV0dXJucyBgbnVsbGAgaWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGhhdmUgYWxsIGZpZWxkcyBzcGVjaWZpZWQgaW4gdGhlXG4gICAgICogaW5kZXguXG4gICAgICovICAgIFplKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBzcjtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHJlKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5kYXRhLmZpZWxkKHMuZmllbGRQYXRoKTtcbiAgICAgICAgICAgIGlmIChudWxsID09IHQpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uTmUocy5raW5kKTtcbiAgICAgICAgICAgIFlpLmZlLlp0KHQsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLlNlKCk7XG4gICAgfVxuICAgIC8qKiBFbmNvZGVzIGEgc2luZ2xlIHZhbHVlIHRvIHRoZSBhc2NlbmRpbmcgaW5kZXggZm9ybWF0LiAqLyAgICBKZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgc3I7XG4gICAgICAgIHJldHVybiBZaS5mZS5adCh0LCBlLk5lKDAgLyogQVNDRU5ESU5HICovKSksIGUuU2UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBlbmNvZGVkIGZvcm0gb2YgdGhlIGRvY3VtZW50IGtleSB0aGF0IHNvcnRzIGJhc2VkIG9uIHRoZSBrZXlcbiAgICAgKiBvcmRlcmluZyBvZiB0aGUgZmllbGQgaW5kZXguXG4gICAgICovICAgIHRuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBzcjtcbiAgICAgICAgcmV0dXJuIFlpLmZlLlp0KHF0KHRoaXMuZGF0YWJhc2VJZCwgZSksIG4uTmUoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHJlKHQpO1xuICAgICAgICAgICAgcmV0dXJuIDAgPT09IGUubGVuZ3RoID8gMCAvKiBBU0NFTkRJTkcgKi8gOiBlW2UubGVuZ3RoIC0gMV0ua2luZDtcbiAgICAgICAgfSh0KSkpLCBuLlNlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZXMgdGhlIGdpdmVuIGZpZWxkIHZhbHVlcyBhY2NvcmRpbmcgdG8gdGhlIHNwZWNpZmljYXRpb24gaW4gYHRhcmdldGAuXG4gICAgICogRm9yIElOIHF1ZXJpZXMsIGEgbGlzdCBvZiBwb3NzaWJsZSB2YWx1ZXMgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIHplKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKG51bGwgPT09IG4pIHJldHVybiBbXTtcbiAgICAgICAgbGV0IHMgPSBbXTtcbiAgICAgICAgcy5wdXNoKG5ldyBzcik7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgZm9yIChjb25zdCByIG9mIHJlKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbltpKytdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHMpIGlmICh0aGlzLmVuKGUsIHIuZmllbGRQYXRoKSAmJiBHdCh0KSkgcyA9IHRoaXMubm4ocywgciwgdCk7IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuLk5lKHIua2luZCk7XG4gICAgICAgICAgICAgICAgWWkuZmUuWnQodCwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuc24ocyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVuY29kZXMgdGhlIGdpdmVuIGJvdW5kcyBhY2NvcmRpbmcgdG8gdGhlIHNwZWNpZmljYXRpb24gaW4gYHRhcmdldGAuIEZvciBJTlxuICAgICAqIHF1ZXJpZXMsIGEgbGlzdCBvZiBwb3NzaWJsZSB2YWx1ZXMgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIFdlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuemUodCwgZSwgbi5wb3NpdGlvbik7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRoZSBieXRlIHJlcHJlc2VudGF0aW9uIGZvciB0aGUgcHJvdmlkZWQgZW5jb2RlcnMuICovICAgIHNuKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyArK24pIGVbbl0gPSB0W25dLlNlKCk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2VwYXJhdGUgZW5jb2RlciBmb3IgZWFjaCBlbGVtZW50IG9mIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogVGhlIG1ldGhvZCBhcHBlbmRzIGVhY2ggdmFsdWUgdG8gYWxsIGV4aXN0aW5nIGVuY29kZXJzIChlLmcuIGZpbHRlcihcImFcIixcbiAgICAgKiBcIj09XCIsIFwiYTFcIikuZmlsdGVyKFwiYlwiLCBcImluXCIsIFtcImIxXCIsIFwiYjJcIl0pIGJlY29tZXMgW1wiYTEsYjFcIiwgXCJhMSxiMlwiXSkuIEFcbiAgICAgKiBsaXN0IG9mIG5ldyBlbmNvZGVycyBpcyByZXR1cm5lZC5cbiAgICAgKi8gICAgbm4odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gWyAuLi50IF0sIGkgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIG4uYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10pIGZvciAoY29uc3QgbiBvZiBzKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IHNyO1xuICAgICAgICAgICAgcy5zZWVkKG4uU2UoKSksIFlpLmZlLlp0KHQsIHMuTmUoZS5raW5kKSksIGkucHVzaChzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaTtcbiAgICB9XG4gICAgZW4odCwgZSkge1xuICAgICAgICByZXR1cm4gISF0LmZpbHRlcnMuZmluZCgodCA9PiB0IGluc3RhbmNlb2YgVmUgJiYgdC5maWVsZC5pc0VxdWFsKGUpICYmIChcImluXCIgLyogSU4gKi8gPT09IHQub3AgfHwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gPT09IHQub3ApKSk7XG4gICAgfVxuICAgIGdldEZpZWxkSW5kZXhlcyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBfcih0KSwgcyA9IHdyKHQpO1xuICAgICAgICByZXR1cm4gKGUgPyBuLnF0KFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgSURCS2V5UmFuZ2UuYm91bmQoZSwgZSkpIDogbi5xdCgpKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiB5aS5mb3JFYWNoKHQsICh0ID0+IHMuZ2V0KFsgdC5pbmRleElkLCB0aGlzLnVpZCBdKS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgICAgICBlLnB1c2goZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSA/IG5ldyB1ZShlLnNlcXVlbmNlTnVtYmVyLCBuZXcgaGUoQmkoZS5yZWFkVGltZSksIG5ldyB4dChXcyhlLmRvY3VtZW50S2V5KSksIGUubGFyZ2VzdEJhdGNoSWQpKSA6IHVlLmVtcHR5KCksIHMgPSB0LmZpZWxkcy5tYXAoKChbdCwgZV0pID0+IG5ldyBvZShtdC5mcm9tU2VydmVyRm9ybWF0KHQpLCBlKSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHNlKHQuaW5kZXhJZCwgdC5jb2xsZWN0aW9uR3JvdXAsIHMsIG4pO1xuICAgICAgICAgICAgICAgIH0odCwgbikpO1xuICAgICAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gZSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkSW5kZXhlcyh0KS5uZXh0KCh0ID0+IDAgPT09IHQubGVuZ3RoID8gbnVsbCA6ICh0LnNvcnQoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyIC0gZS5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyO1xuICAgICAgICAgICAgcmV0dXJuIDAgIT09IG4gPyBuIDogcnQodC5jb2xsZWN0aW9uR3JvdXAsIGUuY29sbGVjdGlvbkdyb3VwKTtcbiAgICAgICAgfSkpLCB0WzBdLmNvbGxlY3Rpb25Hcm91cCkpKTtcbiAgICB9XG4gICAgdXBkYXRlQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IF9yKHQpLCBpID0gd3IodCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJuKHQpLm5leHQoKHQgPT4gcy5xdChcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsIElEQktleVJhbmdlLmJvdW5kKGUsIGUpKS5uZXh0KChlID0+IHlpLmZvckVhY2goZSwgKGUgPT4gaS5wdXQoZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleElkOiB0LFxuICAgICAgICAgICAgICAgIHVpZDogZS51aWQgfHwgXCJcIixcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogbixcbiAgICAgICAgICAgICAgICByZWFkVGltZTogJGkocy5yZWFkVGltZSksXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRLZXk6IEdzKHMuZG9jdW1lbnRLZXkucGF0aCksXG4gICAgICAgICAgICAgICAgbGFyZ2VzdEJhdGNoSWQ6IHMubGFyZ2VzdEJhdGNoSWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0oZS5pbmRleElkLCB0aGlzLnVzZXIsIHQsIG4pKSkpKSkpKTtcbiAgICB9XG4gICAgdXBkYXRlSW5kZXhFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgLy8gUG9ydGluZyBOb3RlOiBgZ2V0RmllbGRJbmRleGVzKClgIG9uIFdlYiBkb2VzIG5vdCBjYWNoZSBpbmRleCBsb29rdXBzIGFzXG4gICAgICAgIC8vIGl0IGNvdWxkIGJlIHVzZWQgYWNyb3NzIGRpZmZlcmVudCBJbmRleGVkREIgdHJhbnNhY3Rpb25zLiBBcyBhbnkgY2FjaGVkXG4gICAgICAgIC8vIGRhdGEgbWlnaHQgYmUgaW52YWxpZGF0ZWQgYnkgb3RoZXIgbXVsdGktdGFiIGNsaWVudHMsIHdlIGNhbiBvbmx5IHRydXN0XG4gICAgICAgIC8vIGRhdGEgd2l0aGluIGEgc2luZ2xlIEluZGV4ZWREQiB0cmFuc2FjdGlvbi4gV2UgdGhlcmVmb3JlIGFkZCBhIGNhY2hlXG4gICAgICAgIC8vIGhlcmUuXG4gICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4geWkuZm9yRWFjaChlLCAoKGUsIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLmdldChlLmNvbGxlY3Rpb25Hcm91cCk7XG4gICAgICAgICAgICByZXR1cm4gKGkgPyB5aS5yZXNvbHZlKGkpIDogdGhpcy5nZXRGaWVsZEluZGV4ZXModCwgZS5jb2xsZWN0aW9uR3JvdXApKS5uZXh0KChpID0+IChuLnNldChlLmNvbGxlY3Rpb25Hcm91cCwgaSksIFxuICAgICAgICAgICAgeWkuZm9yRWFjaChpLCAobiA9PiB0aGlzLm9uKHQsIGUsIG4pLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnVuKHMsIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBlLmlzRXF1YWwoaSkgPyB5aS5yZXNvbHZlKCkgOiB0aGlzLmFuKHQsIHMsIG4sIGUsIGkpO1xuICAgICAgICAgICAgfSkpKSkpKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY24odCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gZHIodCkucHV0KHtcbiAgICAgICAgICAgIGluZGV4SWQ6IHMuaW5kZXhJZCxcbiAgICAgICAgICAgIHVpZDogdGhpcy51aWQsXG4gICAgICAgICAgICBhcnJheVZhbHVlOiBzLmFycmF5VmFsdWUsXG4gICAgICAgICAgICBkaXJlY3Rpb25hbFZhbHVlOiBzLmRpcmVjdGlvbmFsVmFsdWUsXG4gICAgICAgICAgICBvcmRlcmVkRG9jdW1lbnRLZXk6IHRoaXMudG4obiwgZS5rZXkpLFxuICAgICAgICAgICAgZG9jdW1lbnRLZXk6IGUua2V5LnBhdGgudG9BcnJheSgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBobih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBkcih0KS5kZWxldGUoWyBzLmluZGV4SWQsIHRoaXMudWlkLCBzLmFycmF5VmFsdWUsIHMuZGlyZWN0aW9uYWxWYWx1ZSwgdGhpcy50bihuLCBlLmtleSksIGUua2V5LnBhdGgudG9BcnJheSgpIF0pO1xuICAgIH1cbiAgICBvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBkcih0KTtcbiAgICAgICAgbGV0IGkgPSBuZXcgd2UocnIpO1xuICAgICAgICByZXR1cm4gcy5XdCh7XG4gICAgICAgICAgICBpbmRleDogXCJkb2N1bWVudEtleUluZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2Uub25seShbIG4uaW5kZXhJZCwgdGhpcy51aWQsIHRoaXMudG4obiwgZSkgXSlcbiAgICAgICAgfSwgKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBpID0gaS5hZGQobmV3IGlyKG4uaW5kZXhJZCwgZSwgcy5hcnJheVZhbHVlLCBzLmRpcmVjdGlvbmFsVmFsdWUpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgdGhlIGluZGV4IGVudHJpZXMgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC4gKi8gICAgdW4odCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5ldyB3ZShycik7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLlplKGUsIHQpO1xuICAgICAgICBpZiAobnVsbCA9PSBzKSByZXR1cm4gbjtcbiAgICAgICAgY29uc3QgaSA9IGllKGUpO1xuICAgICAgICBpZiAobnVsbCAhPSBpKSB7XG4gICAgICAgICAgICBjb25zdCByID0gdC5kYXRhLmZpZWxkKGkuZmllbGRQYXRoKTtcbiAgICAgICAgICAgIGlmIChHdChyKSkgZm9yIChjb25zdCBpIG9mIHIuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10pIG4gPSBuLmFkZChuZXcgaXIoZS5pbmRleElkLCB0LmtleSwgdGhpcy5KZShpKSwgcykpO1xuICAgICAgICB9IGVsc2UgbiA9IG4uYWRkKG5ldyBpcihlLmluZGV4SWQsIHQua2V5LCBociwgcykpO1xuICAgICAgICByZXR1cm4gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgaW5kZXggZW50cmllcyBmb3IgdGhlIHByb3ZpZGVkIGRvY3VtZW50IGJ5IGRlbGV0aW5nIGVudHJpZXNcbiAgICAgKiB0aGF0IGFyZSBubyBsb25nZXIgcmVmZXJlbmNlZCBpbiBgbmV3RW50cmllc2AgYW5kIGFkZGluZyBhbGwgbmV3bHkgYWRkZWRcbiAgICAgKiBlbnRyaWVzLlxuICAgICAqLyAgICBhbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIE8oXCJJbmRleGVkRGJJbmRleE1hbmFnZXJcIiwgXCJVcGRhdGluZyBpbmRleCBlbnRyaWVzIGZvciBkb2N1bWVudCAnJXMnXCIsIGUua2V5KTtcbiAgICAgICAgY29uc3QgciA9IFtdO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgcywgaSkge1xuICAgICAgICAgICAgY29uc3QgciA9IHQuZ2V0SXRlcmF0b3IoKSwgbyA9IGUuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgICAgIGxldCB1ID0gZ2UociksIGEgPSBnZShvKTtcbiAgICAgICAgICAgIC8vIFdhbGsgdGhyb3VnaCB0aGUgdHdvIHNldHMgYXQgdGhlIHNhbWUgdGltZSwgdXNpbmcgdGhlIG9yZGVyaW5nIGRlZmluZWQgYnlcbiAgICAgICAgICAgIC8vIGBjb21wYXJhdG9yYC5cbiAgICAgICAgICAgIGZvciAoO3UgfHwgYTsgKSB7XG4gICAgICAgICAgICAgICAgbGV0IHQgPSAhMSwgZSA9ICExO1xuICAgICAgICAgICAgICAgIGlmICh1ICYmIGEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG4odSwgYSk7XG4gICAgICAgICAgICAgICAgICAgIHMgPCAwID8gXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBlbGVtZW50IHdhcyByZW1vdmVkIGlmIHRoZSBuZXh0IGVsZW1lbnQgaW4gb3VyIG9yZGVyZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gd2Fsa3Rocm91Z2ggaXMgb25seSBpbiBgYmVmb3JlYC5cbiAgICAgICAgICAgICAgICAgICAgZSA9ICEwIDogcyA+IDAgJiYgKFxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgYWRkZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZCB3YWxrdGhyb3VnaFxuICAgICAgICAgICAgICAgICAgICAvLyBpcyBvbmx5IGluIGBhZnRlcmAuXG4gICAgICAgICAgICAgICAgICAgIHQgPSAhMCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG51bGwgIT0gdSA/IGUgPSAhMCA6IHQgPSAhMDtcbiAgICAgICAgICAgICAgICB0ID8gKHMoYSksIGEgPSBnZShvKSkgOiBlID8gKGkodSksIHUgPSBnZShyKSkgOiAodSA9IGdlKHIpLCBhID0gZ2UobykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHMsIGksIHJyLCAoXG4gICAgICAgIC8qIG9uQWRkPSAqLyBzID0+IHtcbiAgICAgICAgICAgIHIucHVzaCh0aGlzLmNuKHQsIGUsIG4sIHMpKTtcbiAgICAgICAgfSksIChcbiAgICAgICAgLyogb25SZW1vdmU9ICovIHMgPT4ge1xuICAgICAgICAgICAgci5wdXNoKHRoaXMuaG4odCwgZSwgbiwgcykpO1xuICAgICAgICB9KSksIHlpLndhaXRGb3Iocik7XG4gICAgfVxuICAgIHJuKHQpIHtcbiAgICAgICAgbGV0IGUgPSAxO1xuICAgICAgICByZXR1cm4gd3IodCkuV3Qoe1xuICAgICAgICAgICAgaW5kZXg6IFwic2VxdWVuY2VOdW1iZXJJbmRleFwiLFxuICAgICAgICAgICAgcmV2ZXJzZTogITAsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2UudXBwZXJCb3VuZChbIHRoaXMudWlkLCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiBdKVxuICAgICAgICB9LCAoKHQsIG4sIHMpID0+IHtcbiAgICAgICAgICAgIHMuZG9uZSgpLCBlID0gbi5zZXF1ZW5jZU51bWJlciArIDE7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgc2V0IG9mIElEQiByYW5nZXMgdGhhdCBzcGxpdHMgdGhlIGV4aXN0aW5nIHJhbmdlIGFuZCBleGNsdWRlc1xuICAgICAqIGFueSB2YWx1ZXMgdGhhdCBtYXRjaCB0aGUgYG5vdEluVmFsdWVgIGZyb20gdGhlc2UgcmFuZ2VzLiBBcyBhbiBleGFtcGxlLFxuICAgICAqICdbZm9vID4gMiAmJiBmb28gIT0gM11gIGJlY29tZXMgIGBbZm9vID4gMiAmJiA8IDMsIGZvbyA+IDNdYC5cbiAgICAgKi8gICAgY3JlYXRlUmFuZ2UodCwgZSwgbikge1xuICAgICAgICAvLyBUaGUgbm90SW4gdmFsdWVzIG5lZWQgdG8gYmUgc29ydGVkIGFuZCB1bmlxdWUgc28gdGhhdCB3ZSBjYW4gcmV0dXJuIGFcbiAgICAgICAgLy8gc29ydGVkIHNldCBvZiBub24tb3ZlcmxhcHBpbmcgcmFuZ2VzLlxuICAgICAgICBuID0gbi5zb3J0KCgodCwgZSkgPT4gcnIodCwgZSkpKS5maWx0ZXIoKCh0LCBlLCBuKSA9PiAhZSB8fCAwICE9PSBycih0LCBuW2UgLSAxXSkpKTtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICBzLnB1c2godCk7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBuKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gcnIoaSwgdCksIHIgPSBycihpLCBlKTtcbiAgICAgICAgICAgIGlmICgwID09PSBuKSBcbiAgICAgICAgICAgIC8vIGBub3RJblZhbHVlYCBpcyB0aGUgbG93ZXIgYm91bmQuIFdlIHRoZXJlZm9yZSBuZWVkIHRvIHJhaXNlIHRoZSBib3VuZFxuICAgICAgICAgICAgLy8gdG8gdGhlIG5leHQgdmFsdWUuXG4gICAgICAgICAgICBzWzBdID0gdC5rZSgpOyBlbHNlIGlmIChuID4gMCAmJiByIDwgMCkgXG4gICAgICAgICAgICAvLyBgbm90SW5WYWx1ZWAgaXMgaW4gdGhlIG1pZGRsZSBvZiB0aGUgcmFuZ2VcbiAgICAgICAgICAgIHMucHVzaChpKSwgcy5wdXNoKGkua2UoKSk7IGVsc2UgaWYgKHIgPiAwKSBcbiAgICAgICAgICAgIC8vIGBub3RJblZhbHVlYCAoYW5kIGFsbCBmb2xsb3dpbmcgdmFsdWVzKSBhcmUgb3V0IG9mIHRoZSByYW5nZVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcy5wdXNoKGUpO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcy5sZW5ndGg7IHQgKz0gMikgaS5wdXNoKElEQktleVJhbmdlLmJvdW5kKFsgc1t0XS5pbmRleElkLCB0aGlzLnVpZCwgc1t0XS5hcnJheVZhbHVlLCBzW3RdLmRpcmVjdGlvbmFsVmFsdWUsIGhyLCBbXSBdLCBbIHNbdCArIDFdLmluZGV4SWQsIHRoaXMudWlkLCBzW3QgKyAxXS5hcnJheVZhbHVlLCBzW3QgKyAxXS5kaXJlY3Rpb25hbFZhbHVlLCBociwgW10gXSkpO1xuICAgICAgICByZXR1cm4gaTtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0KHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIHJldHVybiB5aS5mb3JFYWNoKHRoaXMuUWUoZSksIChlID0+IHRoaXMuamUodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0ID8gKCFuIHx8IGxlKHQuaW5kZXhTdGF0ZS5vZmZzZXQsIG4pIDwgMCkgJiYgKG4gPSB0LmluZGV4U3RhdGUub2Zmc2V0KSA6IG4gPSBoZS5taW4oKTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGNvbGxlY3Rpb25QYXJlbnRzXG4gKiBkb2N1bWVudCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBmcih0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwiY29sbGVjdGlvblBhcmVudHNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBpbmRleCBlbnRyeSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gZHIodCkge1xuICAgIHJldHVybiBTaSh0LCBcImluZGV4RW50cmllc1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IGNvbmZpZ3VyYXRpb24gb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIF9yKHQpIHtcbiAgICByZXR1cm4gU2kodCwgXCJpbmRleENvbmZpZ3VyYXRpb25cIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBpbmRleCBzdGF0ZSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gd3IodCkge1xuICAgIHJldHVybiBTaSh0LCBcImluZGV4U3RhdGVcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IG1yID0ge1xuICAgIGRpZFJ1bjogITEsXG4gICAgc2VxdWVuY2VOdW1iZXJzQ29sbGVjdGVkOiAwLFxuICAgIHRhcmdldHNSZW1vdmVkOiAwLFxuICAgIGRvY3VtZW50c1JlbW92ZWQ6IDBcbn07XG5cbmNsYXNzIGdyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvLyBXaGVuIHdlIGF0dGVtcHQgdG8gY29sbGVjdCwgd2Ugd2lsbCBvbmx5IGRvIHNvIGlmIHRoZSBjYWNoZSBzaXplIGlzIGdyZWF0ZXIgdGhhbiB0aGlzXG4gICAgLy8gdGhyZXNob2xkLiBQYXNzaW5nIGBDT0xMRUNUSU9OX0RJU0FCTEVEYCBoZXJlIHdpbGwgY2F1c2UgY29sbGVjdGlvbiB0byBhbHdheXMgYmUgc2tpcHBlZC5cbiAgICB0LCBcbiAgICAvLyBUaGUgcGVyY2VudGFnZSBvZiBzZXF1ZW5jZSBudW1iZXJzIHRoYXQgd2Ugd2lsbCBhdHRlbXB0IHRvIGNvbGxlY3RcbiAgICBlLCBcbiAgICAvLyBBIGNhcCBvbiB0aGUgdG90YWwgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3aWxsIGJlIGNvbGxlY3RlZC4gVGhpcyBwcmV2ZW50c1xuICAgIC8vIHVzIGZyb20gY29sbGVjdGluZyBhIGh1Z2UgbnVtYmVyIG9mIHNlcXVlbmNlIG51bWJlcnMgaWYgdGhlIGNhY2hlIGhhcyBncm93biB2ZXJ5IGxhcmdlLlxuICAgIG4pIHtcbiAgICAgICAgdGhpcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID0gdCwgdGhpcy5wZXJjZW50aWxlVG9Db2xsZWN0ID0gZSwgdGhpcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID0gbjtcbiAgICB9XG4gICAgc3RhdGljIHdpdGhDYWNoZVNpemUodCkge1xuICAgICAgICByZXR1cm4gbmV3IGdyKHQsIGdyLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFLCBnci5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGVsZXRlIGEgbXV0YXRpb24gYmF0Y2ggYW5kIHRoZSBhc3NvY2lhdGVkIGRvY3VtZW50IG11dGF0aW9ucy5cbiAqIEByZXR1cm5zIEEgUGVyc2lzdGVuY2VQcm9taXNlIG9mIHRoZSBkb2N1bWVudCBtdXRhdGlvbnMgdGhhdCB3ZXJlIHJlbW92ZWQuXG4gKi9cbmZ1bmN0aW9uIHlyKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gdC5zdG9yZShcIm11dGF0aW9uc1wiKSwgaSA9IHQuc3RvcmUoXCJkb2N1bWVudE11dGF0aW9uc1wiKSwgciA9IFtdLCBvID0gSURCS2V5UmFuZ2Uub25seShuLmJhdGNoSWQpO1xuICAgIGxldCB1ID0gMDtcbiAgICBjb25zdCBhID0gcy5XdCh7XG4gICAgICAgIHJhbmdlOiBvXG4gICAgfSwgKCh0LCBlLCBuKSA9PiAodSsrLCBuLmRlbGV0ZSgpKSkpO1xuICAgIHIucHVzaChhLm5leHQoKCgpID0+IHtcbiAgICAgICAgVSgxID09PSB1KTtcbiAgICB9KSkpO1xuICAgIGNvbnN0IGMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IHQgb2Ygbi5tdXRhdGlvbnMpIHtcbiAgICAgICAgY29uc3QgcyA9IEpzKGUsIHQua2V5LnBhdGgsIG4uYmF0Y2hJZCk7XG4gICAgICAgIHIucHVzaChpLmRlbGV0ZShzKSksIGMucHVzaCh0LmtleSk7XG4gICAgfVxuICAgIHJldHVybiB5aS53YWl0Rm9yKHIpLm5leHQoKCgpID0+IGMpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGFwcHJveGltYXRlIHNpemUgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC5cbiAqLyBmdW5jdGlvbiBwcih0KSB7XG4gICAgaWYgKCF0KSByZXR1cm4gMDtcbiAgICBsZXQgZTtcbiAgICBpZiAodC5kb2N1bWVudCkgZSA9IHQuZG9jdW1lbnQ7IGVsc2UgaWYgKHQudW5rbm93bkRvY3VtZW50KSBlID0gdC51bmtub3duRG9jdW1lbnQ7IGVsc2Uge1xuICAgICAgICBpZiAoIXQubm9Eb2N1bWVudCkgdGhyb3cgTCgpO1xuICAgICAgICBlID0gdC5ub0RvY3VtZW50O1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSkubGVuZ3RoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgbXV0YXRpb24gcXVldWUgZm9yIGEgc3BlY2lmaWMgdXNlciwgYmFja2VkIGJ5IEluZGV4ZWREQi4gKi8gZ3IuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUgPSAxMCwgXG5nci5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QgPSAxZTMsIGdyLkRFRkFVTFQgPSBuZXcgZ3IoNDE5NDMwNDAsIGdyLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFLCBnci5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpLCBcbmdyLkRJU0FCTEVEID0gbmV3IGdyKC0xLCAwLCAwKTtcblxuY2xhc3MgSXIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXJJZCAoZS5nLiBudWxsIFVJRCA9PiBcIlwiIHVzZXJJZCkgdXNlZCB0byBzdG9yZSAvXG4gICAgICogcmV0cmlldmUgbXV0YXRpb25zLlxuICAgICAqL1xuICAgIHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy51c2VySWQgPSB0LCB0aGlzLk0gPSBlLCB0aGlzLmluZGV4TWFuYWdlciA9IG4sIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBzLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhY2hlcyB0aGUgZG9jdW1lbnQga2V5cyBmb3IgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzLiBJZiB0aGUgbXV0YXRpb25cbiAgICAgICAgICogaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIEluZGV4ZWREYiwgdGhlIGNhY2hlZCB2YWx1ZSBtYXkgY29udGludWUgdG9cbiAgICAgICAgICogYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgYmF0Y2gncyBkb2N1bWVudCBrZXlzLiBUbyByZW1vdmUgYSBjYWNoZWQgdmFsdWVcbiAgICAgICAgICogbG9jYWxseSwgYHJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cygpYCBzaG91bGQgYmUgaW52b2tlZCBlaXRoZXIgZGlyZWN0bHlcbiAgICAgICAgICogb3IgdGhyb3VnaCBgcmVtb3ZlTXV0YXRpb25CYXRjaGVzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaXRoIG11bHRpLXRhYiwgd2hlbiB0aGUgcHJpbWFyeSBjbGllbnQgYWNrbm93bGVkZ2VzIG9yIHJlamVjdHMgYSBtdXRhdGlvbixcbiAgICAgICAgICogdGhpcyBjYWNoZSBpcyB1c2VkIGJ5IHNlY29uZGFyeSBjbGllbnRzIHRvIGludmFsaWRhdGUgdGhlIGxvY2FsXG4gICAgICAgICAqIHZpZXcgb2YgdGhlIGRvY3VtZW50cyB0aGF0IHdlcmUgcHJldmlvdXNseSBhZmZlY3RlZCBieSB0aGUgbXV0YXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgICAgICB0aGlzLmxuID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbXV0YXRpb24gcXVldWUgZm9yIHRoZSBnaXZlbiB1c2VyLlxuICAgICAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIgZm9yIHdoaWNoIHRvIGNyZWF0ZSBhIG11dGF0aW9uIHF1ZXVlLlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIHNlcmlhbGl6ZXIgdG8gdXNlIHdoZW4gcGVyc2lzdGluZyB0byBJbmRleGVkRGIuXG4gICAgICovICAgIHN0YXRpYyBZdCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFRPRE8obWNnKTogRmlndXJlIG91dCB3aGF0IGNvbnN0cmFpbnRzIHRoZXJlIGFyZSBvbiB1c2VySURzXG4gICAgICAgIC8vIEluIHBhcnRpY3VsYXIsIGFyZSB0aGVyZSBhbnkgcmVzZXJ2ZWQgY2hhcmFjdGVycz8gYXJlIGVtcHR5IGlkcyBhbGxvd2VkP1xuICAgICAgICAvLyBGb3IgdGhlIG1vbWVudCBzdG9yZSB0aGVzZSB0b2dldGhlciBpbiB0aGUgc2FtZSBtdXRhdGlvbnMgdGFibGUgYXNzdW1pbmdcbiAgICAgICAgLy8gdGhhdCBlbXB0eSB1c2VySURzIGFyZW4ndCBhbGxvd2VkLlxuICAgICAgICBVKFwiXCIgIT09IHQudWlkKTtcbiAgICAgICAgY29uc3QgaSA9IHQuaXNBdXRoZW50aWNhdGVkKCkgPyB0LnVpZCA6IFwiXCI7XG4gICAgICAgIHJldHVybiBuZXcgSXIoaSwgZSwgbiwgcyk7XG4gICAgfVxuICAgIGNoZWNrRW1wdHkodCkge1xuICAgICAgICBsZXQgZSA9ICEwO1xuICAgICAgICBjb25zdCBuID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZIF0sIFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgcmV0dXJuIEVyKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcInVzZXJNdXRhdGlvbnNJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IG5cbiAgICAgICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgICAgICBlID0gITEsIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICBhZGRNdXRhdGlvbkJhdGNoKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IEFyKHQpLCByID0gRXIodCk7XG4gICAgICAgIC8vIFRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gaW4gQ2hyb21lIChhbmQgRmlyZWZveCkgZG9lcyBub3QgaGFuZGxlXG4gICAgICAgIC8vIGNvbXBvdW5kIGluZGljZXMgdGhhdCBpbmNsdWRlIGF1dG8tZ2VuZXJhdGVkIGtleXMgY29ycmVjdGx5LiBUbyBlbnN1cmVcbiAgICAgICAgLy8gdGhhdCB0aGUgaW5kZXggZW50cnkgaXMgYWRkZWQgY29ycmVjdGx5IGluIGFsbCBicm93c2Vycywgd2UgcGVyZm9ybSB0d29cbiAgICAgICAgLy8gd3JpdGVzOiBUaGUgZmlyc3Qgd3JpdGUgaXMgdXNlZCB0byByZXRyaWV2ZSB0aGUgbmV4dCBhdXRvLWdlbmVyYXRlZCBCYXRjaFxuICAgICAgICAvLyBJRCwgYW5kIHRoZSBzZWNvbmQgd3JpdGUgcG9wdWxhdGVzIHRoZSBpbmRleCBhbmQgc3RvcmVzIHRoZSBhY3R1YWxcbiAgICAgICAgLy8gbXV0YXRpb24gYmF0Y2guXG4gICAgICAgIC8vIFNlZTogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NzAxOTcyXG4gICAgICAgIC8vIFdlIHdyaXRlIGFuIGVtcHR5IG9iamVjdCB0byBvYnRhaW4ga2V5XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiByLmFkZCh7fSkubmV4dCgobyA9PiB7XG4gICAgICAgICAgICBVKFwibnVtYmVyXCIgPT0gdHlwZW9mIG8pO1xuICAgICAgICAgICAgY29uc3QgdSA9IG5ldyBEaShvLCBlLCBuLCBzKSwgYSA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5iYXNlTXV0YXRpb25zLm1hcCgoZSA9PiB2cyh0Lkp0LCBlKSkpLCBpID0gbi5tdXRhdGlvbnMubWFwKChlID0+IHZzKHQuSnQsIGUpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBiYXRjaElkOiBuLmJhdGNoSWQsXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsV3JpdGVUaW1lTXM6IG4ubG9jYWxXcml0ZVRpbWUudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICAgICAgICAgYmFzZU11dGF0aW9uczogcyxcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zOiBpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0odGhpcy5NLCB0aGlzLnVzZXJJZCwgdSksIGMgPSBbXTtcbiAgICAgICAgICAgIGxldCBoID0gbmV3IHdlKCgodCwgZSkgPT4gcnQodC5jYW5vbmljYWxTdHJpbmcoKSwgZS5jYW5vbmljYWxTdHJpbmcoKSkpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IEpzKHRoaXMudXNlcklkLCB0LmtleS5wYXRoLCBvKTtcbiAgICAgICAgICAgICAgICBoID0gaC5hZGQodC5rZXkucGF0aC5wb3BMYXN0KCkpLCBjLnB1c2goci5wdXQoYSkpLCBjLnB1c2goaS5wdXQoZSwgWXMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBoLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGMucHVzaCh0aGlzLmluZGV4TWFuYWdlci5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlKSk7XG4gICAgICAgICAgICB9KSksIHQuYWRkT25Db21taXR0ZWRMaXN0ZW5lcigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubG5bb10gPSB1LmtleXMoKTtcbiAgICAgICAgICAgIH0pKSwgeWkud2FpdEZvcihjKS5uZXh0KCgoKSA9PiB1KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgbG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBFcih0KS5nZXQoZSkubmV4dCgodCA9PiB0ID8gKFUodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgTGkodGhpcy5NLCB0KSkgOiBudWxsKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHRoZSBtdXRhdGlvbiBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLlxuICAgICAqIEZvciBwcmltYXJ5IGNsaWVudHMsIHRoaXMgbWV0aG9kIHJldHVybnMgYG51bGxgIGFmdGVyXG4gICAgICogYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYCBoYXMgYmVlbiBjYWxsZWQuIFNlY29uZGFyeSBjbGllbnRzIHJldHVybiBhXG4gICAgICogY2FjaGVkIHJlc3VsdCB1bnRpbCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIGlzIGludm9rZWQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBmbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxuW2VdID8geWkucmVzb2x2ZSh0aGlzLmxuW2VdKSA6IHRoaXMubG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQua2V5cygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxuW2VdID0gbiwgbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgKyAxLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChbIHRoaXMudXNlcklkLCBuIF0pO1xuICAgICAgICBsZXQgaSA9IG51bGw7XG4gICAgICAgIHJldHVybiBFcih0KS5XdCh7XG4gICAgICAgICAgICBpbmRleDogXCJ1c2VyTXV0YXRpb25zSW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBzXG4gICAgICAgIH0sICgodCwgZSwgcykgPT4ge1xuICAgICAgICAgICAgZS51c2VySWQgPT09IHRoaXMudXNlcklkICYmIChVKGUuYmF0Y2hJZCA+PSBuKSwgaSA9IExpKHRoaXMuTSwgZSkpLCBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBJREJLZXlSYW5nZS51cHBlckJvdW5kKFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgbGV0IG4gPSAtMTtcbiAgICAgICAgcmV0dXJuIEVyKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcInVzZXJNdXRhdGlvbnNJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IGUsXG4gICAgICAgICAgICByZXZlcnNlOiAhMFxuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSBlLmJhdGNoSWQsIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgLTEgXSwgWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICByZXR1cm4gRXIodCkucXQoXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgZSkubmV4dCgodCA9PiB0Lm1hcCgodCA9PiBMaSh0aGlzLk0sIHQpKSkpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICAvLyBTY2FuIHRoZSBkb2N1bWVudC1tdXRhdGlvbiBpbmRleCBzdGFydGluZyB3aXRoIGEgcHJlZml4IHN0YXJ0aW5nIHdpdGhcbiAgICAgICAgLy8gdGhlIGdpdmVuIGRvY3VtZW50S2V5LlxuICAgICAgICBjb25zdCBuID0gSHModGhpcy51c2VySWQsIGUucGF0aCksIHMgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKG4pLCBpID0gW107XG4gICAgICAgIHJldHVybiBBcih0KS5XdCh7XG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKG4sIHMsIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IFtvLCB1LCBhXSA9IG4sIGMgPSBXcyh1KTtcbiAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcbiAgICAgICAgICAgIC8vIGludGVyZXN0LiBOb3RlIHRoYXQgYmVjYXVzZSB3ZSBvcmRlciBieSBwYXRoIGZpcnN0LCBhbmQgd2VcbiAgICAgICAgICAgIC8vIG9yZGVyIHRlcm1pbmF0b3JzIGJlZm9yZSBwYXRoIHNlcGFyYXRvcnMsIHdlJ2xsIGVuY291bnRlciBhbGxcbiAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxuICAgICAgICAgICAgLy8gdGhlIHJvd3MgZm9yIGRvY3VtZW50S2V5IHdpbGwgb2NjdXIgYmVmb3JlIGFueSByb3dzIGZvclxuICAgICAgICAgICAgLy8gZG9jdW1lbnRzIG5lc3RlZCBpbiBhIHN1YmNvbGxlY3Rpb24gYmVuZWF0aCBkb2N1bWVudEtleSBzbyB3ZVxuICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8gPT09IHRoaXMudXNlcklkICYmIGUucGF0aC5pc0VxdWFsKGMpKSBcbiAgICAgICAgICAgIC8vIExvb2sgdXAgdGhlIG11dGF0aW9uIGJhdGNoIGluIHRoZSBzdG9yZS5cbiAgICAgICAgICAgIHJldHVybiBFcih0KS5nZXQoYSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCF0KSB0aHJvdyBMKCk7XG4gICAgICAgICAgICAgICAgVSh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBpLnB1c2goTGkodGhpcy5NLCB0KSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBuZXcgd2UocnQpO1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IEhzKHRoaXMudXNlcklkLCBlLnBhdGgpLCByID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpKSwgbyA9IEFyKHQpLld0KHtcbiAgICAgICAgICAgICAgICByYW5nZTogclxuICAgICAgICAgICAgfSwgKCh0LCBzLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgW3IsIG8sIHVdID0gdCwgYSA9IFdzKG8pO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXG4gICAgICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbChhKSA/IG4gPSBuLmFkZCh1KSA6IGkuZG9uZSgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcy5wdXNoKG8pO1xuICAgICAgICB9KSksIHlpLndhaXRGb3IocykubmV4dCgoKCkgPT4gdGhpcy5kbih0LCBuKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDEsIGkgPSBIcyh0aGlzLnVzZXJJZCwgbiksIHIgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGkpO1xuICAgICAgICAvLyBDb2xsZWN0IHVwIHVuaXF1ZSBiYXRjaElEcyBlbmNvdW50ZXJlZCBkdXJpbmcgYSBzY2FuIG9mIHRoZSBpbmRleC4gVXNlIGFcbiAgICAgICAgLy8gU29ydGVkU2V0IHRvIGFjY3VtdWxhdGUgYmF0Y2ggSURzIHNvIHRoZXkgY2FuIGJlIHRyYXZlcnNlZCBpbiBvcmRlciBpbiBhXG4gICAgICAgIC8vIHNjYW4gb2YgdGhlIG1haW4gdGFibGUuXG4gICAgICAgIGxldCBvID0gbmV3IHdlKHJ0KTtcbiAgICAgICAgcmV0dXJuIEFyKHQpLld0KHtcbiAgICAgICAgICAgIHJhbmdlOiByXG4gICAgICAgIH0sICgodCwgZSwgaSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgW3IsIHUsIGFdID0gdCwgYyA9IFdzKHUpO1xuICAgICAgICAgICAgciA9PT0gdGhpcy51c2VySWQgJiYgbi5pc1ByZWZpeE9mKGMpID8gXG4gICAgICAgICAgICAvLyBSb3dzIHdpdGggZG9jdW1lbnQga2V5cyBtb3JlIHRoYW4gb25lIHNlZ21lbnQgbG9uZ2VyIHRoYW4gdGhlXG4gICAgICAgICAgICAvLyBxdWVyeSBwYXRoIGNhbid0IGJlIG1hdGNoZXMuIEZvciBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcydcbiAgICAgICAgICAgIC8vIGNhbid0IG1hdGNoIHRoZSBkb2N1bWVudCAvcm9vbXMvYWJjL21lc3NhZ2VzL3h5eC5cbiAgICAgICAgICAgIC8vIFRPRE8obWNnKTogd2UnbGwgbmVlZCBhIGRpZmZlcmVudCBzY2FubmVyIHdoZW4gd2UgaW1wbGVtZW50XG4gICAgICAgICAgICAvLyBhbmNlc3RvciBxdWVyaWVzLlxuICAgICAgICAgICAgYy5sZW5ndGggPT09IHMgJiYgKG8gPSBvLmFkZChhKSkgOiBpLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHRoaXMuZG4odCwgbykpKTtcbiAgICB9XG4gICAgZG4odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW10sIHMgPSBbXTtcbiAgICAgICAgLy8gVE9ETyhyb2Nrd29vZCk6IEltcGxlbWVudCB0aGlzIHVzaW5nIGl0ZXJhdGUuXG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgcy5wdXNoKEVyKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gdCkgdGhyb3cgTCgpO1xuICAgICAgICAgICAgICAgIFUodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgbi5wdXNoKExpKHRoaXMuTSwgdCkpO1xuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgfSkpLCB5aS53YWl0Rm9yKHMpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB5cih0Lkh0LCB0aGlzLnVzZXJJZCwgZSkubmV4dCgobiA9PiAodC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9uKGUuYmF0Y2hJZCk7XG4gICAgICAgIH0pKSwgeWkuZm9yRWFjaChuLCAoZSA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgY2FjaGVkIGtleXMgZm9yIGEgbXV0YXRpb24gYmF0Y2guIFRoaXMgbWV0aG9kIHNob3VsZCBiZVxuICAgICAqIGNhbGxlZCBieSBzZWNvbmRhcnkgY2xpZW50cyBhZnRlciB0aGV5IHByb2Nlc3MgbXV0YXRpb24gdXBkYXRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzIG5vdCBoYXZlIHRvIGJlIGNhbGxlZCBmcm9tIHByaW1hcnkgY2xpZW50cyBhc1xuICAgICAqIHRoZSBjb3JyZXNwb25kaW5nIGNhY2hlIGVudHJpZXMgYXJlIGNsZWFyZWQgd2hlbiBhbiBhY2tub3dsZWRnZWQgb3JcbiAgICAgKiByZWplY3RlZCBiYXRjaCBpcyByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBfbih0KSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxuW3RdO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrRW1wdHkodCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWUpIHJldHVybiB5aS5yZXNvbHZlKCk7XG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGVyZSBhcmUgbm8gZW50cmllcyBpbiB0aGUgZG9jdW1lbnRNdXRhdGlvbnMgaW5kZXggaWZcbiAgICAgICAgICAgIC8vIHRoZSBxdWV1ZSBpcyBlbXB0eS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdGhpcy51c2VySWQgXSk7XG4gICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gQXIodCkuV3Qoe1xuICAgICAgICAgICAgICAgIHJhbmdlOiBuXG4gICAgICAgICAgICB9LCAoKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodFswXSA9PT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFdzKHRbMV0pO1xuICAgICAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG4uZG9uZSgpO1xuICAgICAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBVKDAgPT09IHMubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBUcih0LCB0aGlzLnVzZXJJZCwgZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkgKHN0YXRlIGlzIGhlbGQgaW4gbWVtb3J5IGluIG90aGVyIGNsaWVudHMpLlxuICAgIC8qKiBSZXR1cm5zIHRoZSBtdXRhdGlvbiBxdWV1ZSdzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLiAqL1xuICAgIHduKHQpIHtcbiAgICAgICAgcmV0dXJuIFJyKHQpLmdldCh0aGlzLnVzZXJJZCkubmV4dCgodCA9PiB0IHx8IHtcbiAgICAgICAgICAgIHVzZXJJZDogdGhpcy51c2VySWQsXG4gICAgICAgICAgICBsYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZDogLTEsXG4gICAgICAgICAgICBsYXN0U3RyZWFtVG9rZW46IFwiXCJcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIgY29udGFpbnMgYSBwZW5kaW5nXG4gKiAgICAgICAgIG11dGF0aW9uIGZvciB0aGUgZ2l2ZW4ga2V5LlxuICovIGZ1bmN0aW9uIFRyKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gSHMoZSwgbi5wYXRoKSwgaSA9IHNbMV0sIHIgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKHMpO1xuICAgIGxldCBvID0gITE7XG4gICAgcmV0dXJuIEFyKHQpLld0KHtcbiAgICAgICAgcmFuZ2U6IHIsXG4gICAgICAgIGp0OiAhMFxuICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICBjb25zdCBbciwgdSwgLypiYXRjaElEKi8gYV0gPSB0O1xuICAgICAgICByID09PSBlICYmIHUgPT09IGkgJiYgKG8gPSAhMCksIHMuZG9uZSgpO1xuICAgIH0pKS5uZXh0KCgoKSA9PiBvKSk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYW55IG11dGF0aW9uIHF1ZXVlIGNvbnRhaW5zIHRoZSBnaXZlbiBkb2N1bWVudC4gKi9cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvbnMgb2JqZWN0IHN0b3JlLlxuICovXG5mdW5jdGlvbiBFcih0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwibXV0YXRpb25zXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIEFyKHQpIHtcbiAgICByZXR1cm4gU2kodCwgXCJkb2N1bWVudE11dGF0aW9uc1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9uUXVldWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBScih0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwibXV0YXRpb25RdWV1ZXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogT2Zmc2V0IHRvIGVuc3VyZSBub24tb3ZlcmxhcHBpbmcgdGFyZ2V0IGlkcy4gKi9cbi8qKlxuICogR2VuZXJhdGVzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyB0YXJnZXQgSURzIGZvciBzZW5kaW5nIHRhcmdldHMgdG8gdGhlXG4gKiB3YXRjaCBzdHJlYW0uXG4gKlxuICogVGhlIGNsaWVudCBjb25zdHJ1Y3RzIHR3byBnZW5lcmF0b3JzLCBvbmUgZm9yIHRoZSB0YXJnZXQgY2FjaGUsIGFuZCBvbmUgZm9yXG4gKiBmb3IgdGhlIHN5bmMgZW5naW5lICh0byBnZW5lcmF0ZSBsaW1ibyBkb2N1bWVudHMgdGFyZ2V0cykuIFRoZXNlXG4gKiBnZW5lcmF0b3JzIHByb2R1Y2Ugbm9uLW92ZXJsYXBwaW5nIElEcyAoYnkgdXNpbmcgZXZlbiBhbmQgb2RkIElEc1xuICogcmVzcGVjdGl2ZWx5KS5cbiAqXG4gKiBCeSBzZXBhcmF0aW5nIHRoZSB0YXJnZXQgSUQgc3BhY2UsIHRoZSBxdWVyeSBjYWNoZSBjYW4gZ2VuZXJhdGUgdGFyZ2V0IElEc1xuICogdGhhdCBwZXJzaXN0IGFjcm9zcyBjbGllbnQgcmVzdGFydHMsIHdoaWxlIHN5bmMgZW5naW5lIGNhbiBpbmRlcGVuZGVudGx5XG4gKiBnZW5lcmF0ZSBpbi1tZW1vcnkgdGFyZ2V0IElEcyB0aGF0IGFyZSB0cmFuc2llbnQgYW5kIGNhbiBiZSByZXVzZWQgYWZ0ZXIgYVxuICogcmVzdGFydC5cbiAqL1xuY2xhc3MgYnIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5tbiA9IHQ7XG4gICAgfVxuICAgIG5leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1uICs9IDIsIHRoaXMubW47XG4gICAgfVxuICAgIHN0YXRpYyBnbigpIHtcbiAgICAgICAgLy8gVGhlIHRhcmdldCBjYWNoZSBnZW5lcmF0b3IgbXVzdCByZXR1cm4gJzInIGluIGl0cyBmaXJzdCBjYWxsIHRvIGBuZXh0KClgXG4gICAgICAgIC8vIGFzIHRoZXJlIGlzIG5vIGRpZmZlcmVudGlhdGlvbiBpbiB0aGUgcHJvdG9jb2wgbGF5ZXIgYmV0d2VlbiBhbiB1bnNldFxuICAgICAgICAvLyBudW1iZXIgYW5kIHRoZSBudW1iZXIgJzAnLiBJZiB3ZSB3ZXJlIHRvIHNlbnQgYSB0YXJnZXQgd2l0aCB0YXJnZXQgSURcbiAgICAgICAgLy8gJzAnLCB0aGUgYmFja2VuZCB3b3VsZCBjb25zaWRlciBpdCB1bnNldCBhbmQgcmVwbGFjZSBpdCB3aXRoIGl0cyBvd24gSUQuXG4gICAgICAgIHJldHVybiBuZXcgYnIoMCk7XG4gICAgfVxuICAgIHN0YXRpYyB5bigpIHtcbiAgICAgICAgLy8gU3luYyBlbmdpbmUgYXNzaWducyB0YXJnZXQgSURzIGZvciBsaW1ibyBkb2N1bWVudCBkZXRlY3Rpb24uXG4gICAgICAgIHJldHVybiBuZXcgYnIoLTEpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgUHIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHQsIHRoaXMuTSA9IGU7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogV2UgZG9uJ3QgY2FjaGUgZ2xvYmFsIG1ldGFkYXRhIGZvciB0aGUgdGFyZ2V0IGNhY2hlLCBzaW5jZVxuICAgIC8vIHNvbWUgb2YgaXQgKGluIHBhcnRpY3VsYXIgYGhpZ2hlc3RUYXJnZXRJZGApIGNhbiBiZSBtb2RpZmllZCBieSBzZWNvbmRhcnlcbiAgICAvLyB0YWJzLiBXZSBjb3VsZCBwZXJoYXBzIGJlIG1vcmUgZ3JhbnVsYXIgKGFuZCBlLmcuIHN0aWxsIGNhY2hlXG4gICAgLy8gYGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb25gIGluIG1lbW9yeSkgYnV0IGZvciBzaW1wbGljaXR5IHdlIGN1cnJlbnRseSBnb1xuICAgIC8vIHRvIEluZGV4ZWREYiB3aGVuZXZlciB3ZSBuZWVkIHRvIHJlYWQgbWV0YWRhdGEuIFdlIGNhbiByZXZpc2l0IGlmIGl0IHR1cm5zXG4gICAgLy8gb3V0IHRvIGhhdmUgYSBtZWFuaW5nZnVsIHBlcmZvcm1hbmNlIGltcGFjdC5cbiAgICBhbGxvY2F0ZVRhcmdldElkKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG4odCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IGJyKGUuaGlnaGVzdFRhcmdldElkKTtcbiAgICAgICAgICAgIHJldHVybiBlLmhpZ2hlc3RUYXJnZXRJZCA9IG4ubmV4dCgpLCB0aGlzLkluKHQsIGUpLm5leHQoKCgpID0+IGUuaGlnaGVzdFRhcmdldElkKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBuKHQpLm5leHQoKHQgPT4gY3QuZnJvbVRpbWVzdGFtcChuZXcgYXQodC5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLnNlY29uZHMsIHQubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5uYW5vc2Vjb25kcykpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBuKHQpLm5leHQoKHQgPT4gdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpKTtcbiAgICB9XG4gICAgc2V0VGFyZ2V0c01ldGFkYXRhKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG4odCkubmV4dCgocyA9PiAocy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLCBuICYmIChzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuLnRvVGltZXN0YW1wKCkpLCBcbiAgICAgICAgZSA+IHMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGUpLCB0aGlzLkluKHQsIHMpKSkpO1xuICAgIH1cbiAgICBhZGRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVG4odCwgZSkubmV4dCgoKCkgPT4gdGhpcy5wbih0KS5uZXh0KChuID0+IChuLnRhcmdldENvdW50ICs9IDEsIHRoaXMuRW4oZSwgbiksIFxuICAgICAgICB0aGlzLkluKHQsIG4pKSkpKSk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ubih0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKCgpID0+IFZyKHQpLmRlbGV0ZShlLnRhcmdldElkKSkpLm5leHQoKCgpID0+IHRoaXMucG4odCkpKS5uZXh0KChlID0+IChVKGUudGFyZ2V0Q291bnQgPiAwKSwgXG4gICAgICAgIGUudGFyZ2V0Q291bnQgLT0gMSwgdGhpcy5Jbih0LCBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRHJvcHMgYW55IHRhcmdldHMgd2l0aCBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCwgZXhjZXB0aW5nIHRob3NlXG4gICAgICogcHJlc2VudCBpbiBgYWN0aXZlVGFyZ2V0SWRzYC4gRG9jdW1lbnQgYXNzb2NpYXRpb25zIGZvciB0aGUgcmVtb3ZlZCB0YXJnZXRzIGFyZSBhbHNvIHJlbW92ZWQuXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRhcmdldHMgcmVtb3ZlZC5cbiAgICAgKi8gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gVnIodCkuV3QoKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1ID0gVWkobyk7XG4gICAgICAgICAgICB1LnNlcXVlbmNlTnVtYmVyIDw9IGUgJiYgbnVsbCA9PT0gbi5nZXQodS50YXJnZXRJZCkgJiYgKHMrKywgaS5wdXNoKHRoaXMucmVtb3ZlVGFyZ2V0RGF0YSh0LCB1KSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4geWkud2FpdEZvcihpKSkpLm5leHQoKCgpID0+IHMpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbCBwcm92aWRlZCBmdW5jdGlvbiB3aXRoIGVhY2ggYFRhcmdldERhdGFgIHRoYXQgd2UgaGF2ZSBjYWNoZWQuXG4gICAgICovICAgIGZvckVhY2hUYXJnZXQodCwgZSkge1xuICAgICAgICByZXR1cm4gVnIodCkuV3QoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gVWkobik7XG4gICAgICAgICAgICBlKHMpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHBuKHQpIHtcbiAgICAgICAgcmV0dXJuIHZyKHQpLmdldChcInRhcmdldEdsb2JhbEtleVwiKS5uZXh0KCh0ID0+IChVKG51bGwgIT09IHQpLCB0KSkpO1xuICAgIH1cbiAgICBJbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB2cih0KS5wdXQoXCJ0YXJnZXRHbG9iYWxLZXlcIiwgZSk7XG4gICAgfVxuICAgIFRuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFZyKHQpLnB1dChxaSh0aGlzLk0sIGUpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4tcGxhY2UgdXBkYXRlcyB0aGUgcHJvdmlkZWQgbWV0YWRhdGEgdG8gYWNjb3VudCBmb3IgdmFsdWVzIGluIHRoZSBnaXZlblxuICAgICAqIFRhcmdldERhdGEuIFNhdmluZyBpcyBkb25lIHNlcGFyYXRlbHkuIFJldHVybnMgdHJ1ZSBpZiB0aGVyZSB3ZXJlIGFueVxuICAgICAqIGNoYW5nZXMgdG8gdGhlIG1ldGFkYXRhLlxuICAgICAqLyAgICBFbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gITE7XG4gICAgICAgIHJldHVybiB0LnRhcmdldElkID4gZS5oaWdoZXN0VGFyZ2V0SWQgJiYgKGUuaGlnaGVzdFRhcmdldElkID0gdC50YXJnZXRJZCwgbiA9ICEwKSwgXG4gICAgICAgIHQuc2VxdWVuY2VOdW1iZXIgPiBlLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciAmJiAoZS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSB0LnNlcXVlbmNlTnVtYmVyLCBcbiAgICAgICAgbiA9ICEwKSwgbjtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wbih0KS5uZXh0KCh0ID0+IHQudGFyZ2V0Q291bnQpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIC8vIEl0ZXJhdGluZyBieSB0aGUgY2Fub25pY2FsSWQgbWF5IHlpZWxkIG1vcmUgdGhhbiBvbmUgcmVzdWx0IGJlY2F1c2VcbiAgICAgICAgLy8gY2Fub25pY2FsSWQgdmFsdWVzIGFyZSBub3QgcmVxdWlyZWQgdG8gYmUgdW5pcXVlIHBlciB0YXJnZXQuIFRoaXMgcXVlcnlcbiAgICAgICAgLy8gZGVwZW5kcyBvbiB0aGUgcXVlcnlUYXJnZXRzIGluZGV4IHRvIGJlIGVmZmljaWVudC5cbiAgICAgICAgY29uc3QgbiA9IEllKGUpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBuLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXSwgWyBuLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIGxldCBpID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIFZyKHQpLld0KHtcbiAgICAgICAgICAgIHJhbmdlOiBzLFxuICAgICAgICAgICAgaW5kZXg6IFwicXVlcnlUYXJnZXRzSW5kZXhcIlxuICAgICAgICB9LCAoKHQsIG4sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBVaShuKTtcbiAgICAgICAgICAgIC8vIEFmdGVyIGZpbmRpbmcgYSBwb3RlbnRpYWwgbWF0Y2gsIGNoZWNrIHRoYXQgdGhlIHRhcmdldCBpc1xuICAgICAgICAgICAgLy8gYWN0dWFsbHkgZXF1YWwgdG8gdGhlIHJlcXVlc3RlZCB0YXJnZXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBFZShlLCByLnRhcmdldCkgJiYgKGkgPSByLCBzLmRvbmUoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGFkZE1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gW10sIGkgPSBTcih0KTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gR3MoZS5wYXRoKTtcbiAgICAgICAgICAgIHMucHVzaChpLnB1dCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG4sXG4gICAgICAgICAgICAgICAgcGF0aDogclxuICAgICAgICAgICAgfSkpLCBzLnB1c2godGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodCwgbiwgZSkpO1xuICAgICAgICB9KSksIHlpLndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gU3IodCk7XG4gICAgICAgIHJldHVybiB5aS5mb3JFYWNoKGUsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBHcyhlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHlpLndhaXRGb3IoWyBzLmRlbGV0ZShbIG4sIGkgXSksIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHQsIG4sIGUpIF0pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFNyKHQpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlIF0sIFsgZSArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUocyk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgZSBdLCBbIGUgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSwgcyA9IFNyKHQpO1xuICAgICAgICBsZXQgaSA9IFluKCk7XG4gICAgICAgIHJldHVybiBzLld0KHtcbiAgICAgICAgICAgIHJhbmdlOiBuLFxuICAgICAgICAgICAganQ6ICEwXG4gICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IFdzKHRbMV0pLCByID0gbmV3IHh0KHMpO1xuICAgICAgICAgICAgaSA9IGkuYWRkKHIpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBHcyhlLnBhdGgpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBuIF0sIFsgdXQobikgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHJldHVybiBTcih0KS5XdCh7XG4gICAgICAgICAgICBpbmRleDogXCJkb2N1bWVudFRhcmdldHNJbmRleFwiLFxuICAgICAgICAgICAganQ6ICEwLFxuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKChbdCwgZV0sIG4sIHMpID0+IHtcbiAgICAgICAgICAgIC8vIEhhdmluZyBhIHNlbnRpbmVsIHJvdyBmb3IgYSBkb2N1bWVudCBkb2VzIG5vdCBjb3VudCBhcyBjb250YWluaW5nIHRoYXQgZG9jdW1lbnQ7XG4gICAgICAgICAgICAvLyBGb3IgdGhlIHRhcmdldCBjYWNoZSwgY29udGFpbmluZyB0aGUgZG9jdW1lbnQgbWVhbnMgdGhlIGRvY3VtZW50IGlzIHBhcnQgb2Ygc29tZVxuICAgICAgICAgICAgLy8gdGFyZ2V0LlxuICAgICAgICAgICAgMCAhPT0gdCAmJiAoaSsrLCBzLmRvbmUoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpID4gMCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhIFRhcmdldERhdGEgZW50cnkgYnkgdGFyZ2V0IElELlxuICAgICAqXG4gICAgICogQHBhcmFtIHRhcmdldElkIC0gVGhlIHRhcmdldCBJRCBvZiB0aGUgVGFyZ2V0RGF0YSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgVGFyZ2V0RGF0YSBlbnRyeSwgb3IgbnVsbCBpZiB0aGUgY2FjaGUgaGFzIG5vIGVudHJ5IGZvclxuICAgICAqIHRoZSB0YXJnZXQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBFdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBWcih0KS5nZXQoZSkubmV4dCgodCA9PiB0ID8gVWkodCkgOiBudWxsKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcXVlcmllcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gVnIodCkge1xuICAgIHJldHVybiBTaSh0LCBcInRhcmdldHNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSB0YXJnZXQgZ2xvYmFscyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gdnIodCkge1xuICAgIHJldHVybiBTaSh0LCBcInRhcmdldEdsb2JhbFwiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gU3IodCkge1xuICAgIHJldHVybiBTaSh0LCBcInRhcmdldERvY3VtZW50c1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVmVyaWZpZXMgdGhlIGVycm9yIHRocm93biBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLiBJZiBhIExvY2FsU3RvcmVcbiAqIG9wZXJhdGlvbiBmYWlscyBiZWNhdXNlIHRoZSBwcmltYXJ5IGxlYXNlIGhhcyBiZWVuIHRha2VuIGJ5IGFub3RoZXIgY2xpZW50LFxuICogd2UgaWdub3JlIHRoZSBlcnJvciAodGhlIHBlcnNpc3RlbmNlIGxheWVyIHdpbGwgaW1tZWRpYXRlbHkgY2FsbFxuICogYGFwcGx5UHJpbWFyeUxlYXNlYCB0byBwcm9wYWdhdGUgdGhlIHByaW1hcnkgc3RhdGUgY2hhbmdlKS4gQWxsIG90aGVyIGVycm9yc1xuICogYXJlIHJlLXRocm93bi5cbiAqXG4gKiBAcGFyYW0gZXJyIC0gQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIHdlIHJlY292ZXJlZCwgb3IgdGhlIG9yaWdpbmFsIGVycm9yLlxuICovIGFzeW5jIGZ1bmN0aW9uIERyKHQpIHtcbiAgICBpZiAodC5jb2RlICE9PSBHLkZBSUxFRF9QUkVDT05ESVRJT04gfHwgdC5tZXNzYWdlICE9PSBtaSkgdGhyb3cgdDtcbiAgICBPKFwiTG9jYWxTdG9yZVwiLCBcIlVuZXhwZWN0ZWRseSBsb3N0IHByaW1hcnkgbGVhc2VcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIENyKFt0LCBlXSwgW24sIHNdKSB7XG4gICAgY29uc3QgaSA9IHJ0KHQsIG4pO1xuICAgIHJldHVybiAwID09PSBpID8gcnQoZSwgcykgOiBpO1xufVxuXG4vKipcbiAqIFVzZWQgdG8gY2FsY3VsYXRlIHRoZSBudGggc2VxdWVuY2UgbnVtYmVyLiBLZWVwcyBhIHJvbGxpbmcgYnVmZmVyIG9mIHRoZVxuICogbG93ZXN0IG4gdmFsdWVzIHBhc3NlZCB0byBgYWRkRWxlbWVudGAsIGFuZCBmaW5hbGx5IHJlcG9ydHMgdGhlIGxhcmdlc3Qgb2ZcbiAqIHRoZW0gaW4gYG1heFZhbHVlYC5cbiAqLyBjbGFzcyB4ciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLkFuID0gdCwgdGhpcy5idWZmZXIgPSBuZXcgd2UoQ3IpLCB0aGlzLlJuID0gMDtcbiAgICB9XG4gICAgYm4oKSB7XG4gICAgICAgIHJldHVybiArK3RoaXMuUm47XG4gICAgfVxuICAgIFBuKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFsgdCwgdGhpcy5ibigpIF07XG4gICAgICAgIGlmICh0aGlzLmJ1ZmZlci5zaXplIDwgdGhpcy5BbikgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5hZGQoZSk7IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuYnVmZmVyLmxhc3QoKTtcbiAgICAgICAgICAgIENyKGUsIHQpIDwgMCAmJiAodGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5kZWxldGUodCkuYWRkKGUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbWF4VmFsdWUoKSB7XG4gICAgICAgIC8vIEd1YXJhbnRlZWQgdG8gYmUgbm9uLWVtcHR5LiBJZiB3ZSBkZWNpZGUgd2UgYXJlIG5vdCBjb2xsZWN0aW5nIGFueVxuICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXJzLCBudGhTZXF1ZW5jZU51bWJlciBiZWxvdyBzaG9ydC1jaXJjdWl0cy4gSWYgd2UgaGF2ZVxuICAgICAgICAvLyBkZWNpZGVkIHRoYXQgd2UgYXJlIGNvbGxlY3RpbmcgbiBzZXF1ZW5jZSBudW1iZXJzLCBpdCdzIGJlY2F1c2UgbiBpcyBzb21lXG4gICAgICAgIC8vIHBlcmNlbnRhZ2Ugb2YgdGhlIGV4aXN0aW5nIHNlcXVlbmNlIG51bWJlcnMuIFRoYXQgbWVhbnMgd2Ugc2hvdWxkIG5ldmVyXG4gICAgICAgIC8vIGJlIGluIGEgc2l0dWF0aW9uIHdoZXJlIHdlIGFyZSBjb2xsZWN0aW5nIHNlcXVlbmNlIG51bWJlcnMgYnV0IGRvbid0XG4gICAgICAgIC8vIGFjdHVhbGx5IGhhdmUgYW55LlxuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGFzdCgpWzBdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciB0aGUgc2NoZWR1bGluZyBvZiBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiBJdCBoYW5kbGVzIGNoZWNraW5nXG4gKiB3aGV0aGVyIG9yIG5vdCBHQyBpcyBlbmFibGVkLCBhcyB3ZWxsIGFzIHdoaWNoIGRlbGF5IHRvIHVzZSBiZWZvcmUgdGhlIG5leHQgcnVuLlxuICovIGNsYXNzIE5yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IHQsIHRoaXMuYXN5bmNRdWV1ZSA9IGUsIHRoaXMuVm4gPSAhMSwgdGhpcy52biA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KHQpIHtcbiAgICAgICAgLTEgIT09IHRoaXMuZ2FyYmFnZUNvbGxlY3Rvci5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCAmJiB0aGlzLlNuKHQpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnZuICYmICh0aGlzLnZuLmNhbmNlbCgpLCB0aGlzLnZuID0gbnVsbCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy52bjtcbiAgICB9XG4gICAgU24odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5WbiA/IDNlNSA6IDZlNDtcbiAgICAgICAgTyhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYEdhcmJhZ2UgY29sbGVjdGlvbiBzY2hlZHVsZWQgaW4gJHtlfW1zYCksIHRoaXMudm4gPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoXCJscnVfZ2FyYmFnZV9jb2xsZWN0aW9uXCIgLyogTHJ1R2FyYmFnZUNvbGxlY3Rpb24gKi8gLCBlLCAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52biA9IG51bGwsIHRoaXMuVm4gPSAhMDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdC5jb2xsZWN0R2FyYmFnZSh0aGlzLmdhcmJhZ2VDb2xsZWN0b3IpO1xuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgIEFpKHQpID8gTyhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgXCJJZ25vcmluZyBJbmRleGVkREIgZXJyb3IgZHVyaW5nIGdhcmJhZ2UgY29sbGVjdGlvbjogXCIsIHQpIDogYXdhaXQgRHIodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCB0aGlzLlNuKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKiogSW1wbGVtZW50cyB0aGUgc3RlcHMgZm9yIExSVSBnYXJiYWdlIGNvbGxlY3Rpb24uICovIGNsYXNzIGtyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuRG4gPSB0LCB0aGlzLnBhcmFtcyA9IGU7XG4gICAgfVxuICAgIGNhbGN1bGF0ZVRhcmdldENvdW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRG4uQ24odCkubmV4dCgodCA9PiBNYXRoLmZsb29yKGUgLyAxMDAgKiB0KSkpO1xuICAgIH1cbiAgICBudGhTZXF1ZW5jZU51bWJlcih0LCBlKSB7XG4gICAgICAgIGlmICgwID09PSBlKSByZXR1cm4geWkucmVzb2x2ZShudC5BKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyB4cihlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuRG4uZm9yRWFjaFRhcmdldCh0LCAodCA9PiBuLlBuKHQuc2VxdWVuY2VOdW1iZXIpKSkubmV4dCgoKCkgPT4gdGhpcy5Ebi54bih0LCAodCA9PiBuLlBuKHQpKSkpKS5uZXh0KCgoKSA9PiBuLm1heFZhbHVlKSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5Ebi5yZW1vdmVUYXJnZXRzKHQsIGUsIG4pO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkRuLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIGUpO1xuICAgIH1cbiAgICBjb2xsZWN0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIC0xID09PSB0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID8gKE8oXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IGRpc2FibGVkXCIpLCBcbiAgICAgICAgeWkucmVzb2x2ZShtcikpIDogdGhpcy5nZXRDYWNoZVNpemUodCkubmV4dCgobiA9PiBuIDwgdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChPKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IENhY2hlIHNpemUgJHtufSBpcyBsb3dlciB0aGFuIHRocmVzaG9sZCAke3RoaXMucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGR9YCksIFxuICAgICAgICBtcikgOiB0aGlzLk5uKHQsIGUpKSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkRuLmdldENhY2hlU2l6ZSh0KTtcbiAgICB9XG4gICAgTm4odCwgZSkge1xuICAgICAgICBsZXQgbiwgcywgaSwgciwgbywgYSwgYztcbiAgICAgICAgY29uc3QgaCA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZVRhcmdldENvdW50KHQsIHRoaXMucGFyYW1zLnBlcmNlbnRpbGVUb0NvbGxlY3QpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBDYXAgYXQgdGhlIGNvbmZpZ3VyZWQgbWF4XG4gICAgICAgIGUgPiB0aGlzLnBhcmFtcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID8gKE8oXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBDYXBwaW5nIHNlcXVlbmNlIG51bWJlcnMgdG8gY29sbGVjdCBkb3duIHRvIHRoZSBtYXhpbXVtIG9mICR7dGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdH0gZnJvbSAke2V9YCksIFxuICAgICAgICBzID0gdGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCkgOiBzID0gZSwgciA9IERhdGUubm93KCksIHRoaXMubnRoU2VxdWVuY2VOdW1iZXIodCwgcykpKSkubmV4dCgocyA9PiAobiA9IHMsIFxuICAgICAgICBvID0gRGF0ZS5ub3coKSwgdGhpcy5yZW1vdmVUYXJnZXRzKHQsIG4sIGUpKSkpLm5leHQoKGUgPT4gKGkgPSBlLCBhID0gRGF0ZS5ub3coKSwgXG4gICAgICAgIHRoaXMucmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgbikpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAoYyA9IERhdGUubm93KCksIGsoKSA8PSBMb2dMZXZlbC5ERUJVRykge1xuICAgICAgICAgICAgICAgIE8oXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBMUlUgR2FyYmFnZSBDb2xsZWN0aW9uXFxuXFx0Q291bnRlZCB0YXJnZXRzIGluICR7ciAtIGh9bXNcXG5cXHREZXRlcm1pbmVkIGxlYXN0IHJlY2VudGx5IHVzZWQgJHtzfSBpbiBgICsgKG8gLSByKSArIFwibXNcXG5cIiArIGBcXHRSZW1vdmVkICR7aX0gdGFyZ2V0cyBpbiBgICsgKGEgLSBvKSArIFwibXNcXG5cIiArIGBcXHRSZW1vdmVkICR7dH0gZG9jdW1lbnRzIGluIGAgKyAoYyAtIGEpICsgXCJtc1xcblwiICsgYFRvdGFsIER1cmF0aW9uOiAke2MgLSBofW1zYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geWkucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgZGlkUnVuOiAhMCxcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcnNDb2xsZWN0ZWQ6IHMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0c1JlbW92ZWQ6IGksXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzUmVtb3ZlZDogdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUHJvdmlkZXMgTFJVIGZ1bmN0aW9uYWxpdHkgZm9yIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS4gKi9cbmNsYXNzIE1yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZGIgPSB0LCB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IGtyKHQsIGUpO1xuICAgICAgICB9KHRoaXMsIGUpO1xuICAgIH1cbiAgICBDbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmtuKHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRUYXJnZXRDYWNoZSgpLmdldFRhcmdldENvdW50KHQpLm5leHQoKHQgPT4gZS5uZXh0KChlID0+IHQgKyBlKSkpKTtcbiAgICB9XG4gICAga24odCkge1xuICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzLnhuKHQsICh0ID0+IHtcbiAgICAgICAgICAgIGUrKztcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGUpKTtcbiAgICB9XG4gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkuZm9yRWFjaFRhcmdldCh0LCBlKTtcbiAgICB9XG4gICAgeG4odCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Nbih0LCAoKHQsIG4pID0+IGUobikpKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIE9yKHQsIG4pO1xuICAgIH1cbiAgICByZW1vdmVSZWZlcmVuY2UodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gT3IodCwgbik7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRUYXJnZXRDYWNoZSgpLnJlbW92ZVRhcmdldHModCwgZSwgbik7XG4gICAgfVxuICAgIG1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIE9yKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgYW55dGhpbmcgd291bGQgcHJldmVudCB0aGlzIGRvY3VtZW50IGZyb20gYmVpbmcgZ2FyYmFnZVxuICAgICAqIGNvbGxlY3RlZCwgZ2l2ZW4gdGhhdCB0aGUgZG9jdW1lbnQgaW4gcXVlc3Rpb24gaXMgbm90IHByZXNlbnQgaW4gYW55XG4gICAgICogdGFyZ2V0cyBhbmQgaGFzIGEgc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQgZm9yXG4gICAgICogdGhlIGNvbGxlY3Rpb24gcnVuLlxuICAgICAqLyAgICBPbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBsZXQgbiA9ICExO1xuICAgICAgICAgICAgcmV0dXJuIFJyKHQpLnp0KChzID0+IFRyKHQsIHMsIGUpLm5leHQoKHQgPT4gKHQgJiYgKG4gPSAhMCksIHlpLnJlc29sdmUoIXQpKSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgICAgICB9KHQsIGUpO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmRiLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS5uZXdDaGFuZ2VCdWZmZXIoKSwgcyA9IFtdO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzLk1uKHQsICgociwgbykgPT4ge1xuICAgICAgICAgICAgaWYgKG8gPD0gZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLk9uKHQsIHIpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIFxuICAgICAgICAgICAgICAgICAgICAvLyBPdXIgc2l6ZSBhY2NvdW50aW5nIHJlcXVpcmVzIHVzIHRvIHJlYWQgYWxsIGRvY3VtZW50cyBiZWZvcmVcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZpbmcgdGhlbS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkrKywgbi5nZXRFbnRyeSh0LCByKS5uZXh0KCgoKSA9PiAobi5yZW1vdmVFbnRyeShyLCBjdC5taW4oKSksIFNyKHQpLmRlbGV0ZShbIDAsIEdzKHIucGF0aCkgXSkpKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIHMucHVzaChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHlpLndhaXRGb3IocykpKS5uZXh0KCgoKSA9PiBuLmFwcGx5KHQpKSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS53aXRoU2VxdWVuY2VOdW1iZXIodC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRUYXJnZXRDYWNoZSgpLnVwZGF0ZVRhcmdldERhdGEodCwgbik7XG4gICAgfVxuICAgIHVwZGF0ZUxpbWJvRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gT3IodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGwgcHJvdmlkZWQgZnVuY3Rpb24gZm9yIGVhY2ggZG9jdW1lbnQgaW4gdGhlIGNhY2hlIHRoYXQgaXMgJ29ycGhhbmVkJy4gT3JwaGFuZWRcbiAgICAgKiBtZWFucyBub3QgYSBwYXJ0IG9mIGFueSB0YXJnZXQsIHNvIHRoZSBvbmx5IGVudHJ5IGluIHRoZSB0YXJnZXQtZG9jdW1lbnQgaW5kZXggZm9yXG4gICAgICogdGhhdCBkb2N1bWVudCB3aWxsIGJlIHRoZSBzZW50aW5lbCByb3cgKHRhcmdldElkIDApLCB3aGljaCB3aWxsIGFsc28gaGF2ZSB0aGUgc2VxdWVuY2VcbiAgICAgKiBudW1iZXIgZm9yIHRoZSBsYXN0IHRpbWUgdGhlIGRvY3VtZW50IHdhcyBhY2Nlc3NlZC5cbiAgICAgKi8gICAgTW4odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gU3IodCk7XG4gICAgICAgIGxldCBzLCBpID0gbnQuQTtcbiAgICAgICAgcmV0dXJuIG4uV3Qoe1xuICAgICAgICAgICAgaW5kZXg6IFwiZG9jdW1lbnRUYXJnZXRzSW5kZXhcIlxuICAgICAgICB9LCAoKFt0LCBuXSwge3BhdGg6IHIsIHNlcXVlbmNlTnVtYmVyOiBvfSkgPT4ge1xuICAgICAgICAgICAgMCA9PT0gdCA/IChcbiAgICAgICAgICAgIC8vIGlmIG5leHRUb1JlcG9ydCBpcyB2YWxpZCwgcmVwb3J0IGl0LCB0aGlzIGlzIGEgbmV3IGtleSBzbyB0aGVcbiAgICAgICAgICAgIC8vIGxhc3Qgb25lIG11c3Qgbm90IGJlIGEgbWVtYmVyIG9mIGFueSB0YXJnZXRzLlxuICAgICAgICAgICAgaSAhPT0gbnQuQSAmJiBlKG5ldyB4dChXcyhzKSksIGkpLCBcbiAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgdGhpcyBzZXF1ZW5jZSBudW1iZXIuIEl0J3MgdGhlIG5leHQgb25lIHdlXG4gICAgICAgICAgICAvLyBtaWdodCByZXBvcnQsIGlmIHdlIGRvbid0IGZpbmQgYW55IHRhcmdldHMgZm9yIHRoaXMgZG9jdW1lbnQuXG4gICAgICAgICAgICAvLyBOb3RlIHRoYXQgdGhlIHNlcXVlbmNlIG51bWJlciBtdXN0IGJlIGRlZmluZWQgd2hlbiB0aGUgdGFyZ2V0SWRcbiAgICAgICAgICAgIC8vIGlzIDAuXG4gICAgICAgICAgICBpID0gbywgcyA9IHIpIDogXG4gICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIGludmFsaWQsIHdlIGtub3cgd2UgZG9uJ3QgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgIC8vIHRoaXMgb25lIHNpbmNlIHdlIGZvdW5kIGEgdGFyZ2V0IGZvciBpdC5cbiAgICAgICAgICAgIGkgPSBudC5BO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cbiAgICAgICAgICAgIGkgIT09IG50LkEgJiYgZShuZXcgeHQoV3MocykpLCBpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRDYWNoZVNpemUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkuZ2V0U2l6ZSh0KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIE9yKHQsIGUpIHtcbiAgICByZXR1cm4gU3IodCkucHV0KFxuICAgIC8qKlxuICogQHJldHVybnMgQSB2YWx1ZSBzdWl0YWJsZSBmb3Igd3JpdGluZyBhIHNlbnRpbmVsIHJvdyBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50XG4gKiBzdG9yZS5cbiAqL1xuICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRhcmdldElkOiAwLFxuICAgICAgICAgICAgcGF0aDogR3ModC5wYXRoKSxcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiBlXG4gICAgICAgIH07XG4gICAgfShlLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlcikpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbi1tZW1vcnkgYnVmZmVyIG9mIGVudHJpZXMgdG8gYmUgd3JpdHRlbiB0byBhIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKiBJdCBjYW4gYmUgdXNlZCB0byBiYXRjaCB1cCBhIHNldCBvZiBjaGFuZ2VzIHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGNhY2hlLCBidXRcbiAqIGFkZGl0aW9uYWxseSBzdXBwb3J0cyByZWFkaW5nIGVudHJpZXMgYmFjayB3aXRoIHRoZSBgZ2V0RW50cnkoKWAgbWV0aG9kLFxuICogZmFsbGluZyBiYWNrIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUgaWYgbm8gZW50cnkgaXNcbiAqIGJ1ZmZlcmVkLlxuICpcbiAqIEVudHJpZXMgYWRkZWQgdG8gdGhlIGNhY2hlICptdXN0KiBiZSByZWFkIGZpcnN0LiBUaGlzIGlzIHRvIGZhY2lsaXRhdGVcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplIGRlbHRhIG9mIHRoZSBwZW5kaW5nIGNoYW5nZXMuXG4gKlxuICogUE9SVElORyBOT1RFOiBUaGlzIGNsYXNzIHdhcyBpbXBsZW1lbnRlZCB0aGVuIHJlbW92ZWQgZnJvbSBvdGhlciBwbGF0Zm9ybXMuXG4gKiBJZiBieXRlLWNvdW50aW5nIGVuZHMgdXAgYmVpbmcgbmVlZGVkIG9uIHRoZSBvdGhlciBwbGF0Zm9ybXMsIGNvbnNpZGVyXG4gKiBwb3J0aW5nIHRoaXMgY2xhc3MgYXMgcGFydCBvZiB0aGF0IGltcGxlbWVudGF0aW9uIHdvcmsuXG4gKi8gY2xhc3MgRnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIG1hcHBpbmcgb2YgZG9jdW1lbnQga2V5IHRvIHRoZSBuZXcgY2FjaGUgZW50cnkgdGhhdCBzaG91bGQgYmUgd3JpdHRlbi5cbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IEtuKCh0ID0+IHQudG9TdHJpbmcoKSksICgodCwgZSkgPT4gdC5pc0VxdWFsKGUpKSksIHRoaXMuY2hhbmdlc0FwcGxpZWQgPSAhMTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVmZmVycyBhIGBSZW1vdGVEb2N1bWVudENhY2hlLmFkZEVudHJ5KClgIGNhbGwuXG4gICAgICpcbiAgICAgKiBZb3UgY2FuIG9ubHkgbW9kaWZ5IGRvY3VtZW50cyB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIHJldHJpZXZlZCB2aWFcbiAgICAgKiBgZ2V0RW50cnkoKS9nZXRFbnRyaWVzKClgIChlbmZvcmNlZCB2aWEgSW5kZXhlZERicyBgYXBwbHkoKWApLlxuICAgICAqLyAgICBhZGRFbnRyeSh0KSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXMuc2V0KHQua2V5LCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVmZmVycyBhIGBSZW1vdGVEb2N1bWVudENhY2hlLnJlbW92ZUVudHJ5KClgIGNhbGwuXG4gICAgICpcbiAgICAgKiBZb3UgY2FuIG9ubHkgcmVtb3ZlIGRvY3VtZW50cyB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIHJldHJpZXZlZCB2aWFcbiAgICAgKiBgZ2V0RW50cnkoKS9nZXRFbnRyaWVzKClgIChlbmZvcmNlZCB2aWEgSW5kZXhlZERicyBgYXBwbHkoKWApLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0LCBlKSB7XG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXMuc2V0KHQsIG5lLm5ld0ludmFsaWREb2N1bWVudCh0KS5zZXRSZWFkVGltZShlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS4gVGhlIGJ1ZmZlcmVkIGNoYW5nZXMgd2lsbCBmaXJzdCBiZSBjaGVja2VkLFxuICAgICAqIGFuZCBpZiBubyBidWZmZXJlZCBjaGFuZ2UgYXBwbGllcywgdGhpcyB3aWxsIGZvcndhcmQgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSAtIFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBkb2N1bWVudCBvciBhbiBpbnZhbGlkIGRvY3VtZW50IGlmIHdlIGhhdmUgbm90aGluZ1xuICAgICAqIGNhY2hlZC5cbiAgICAgKi8gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY2hhbmdlcy5nZXQoZSk7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IG4gPyB5aS5yZXNvbHZlKG4pIDogdGhpcy5nZXRGcm9tQ2FjaGUodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUsIGZvcndhcmRpbmcgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleXMgLSBUaGUga2V5cyBvZiB0aGUgZW50cmllcyB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIEEgbWFwIG9mIGNhY2hlZCBkb2N1bWVudHMsIGluZGV4ZWQgYnkga2V5LiBJZiBhbiBlbnRyeSBjYW5ub3QgYmVcbiAgICAgKiAgICAgZm91bmQsIHRoZSBjb3JyZXNwb25kaW5nIGtleSB3aWxsIGJlIG1hcHBlZCB0byBhbiBpbnZhbGlkIGRvY3VtZW50LlxuICAgICAqLyAgICBnZXRFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsRnJvbUNhY2hlKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGJ1ZmZlcmVkIGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSwgdXNpbmdcbiAgICAgKiB0aGUgcHJvdmlkZWQgdHJhbnNhY3Rpb24uXG4gICAgICovICAgIGFwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITAsIHRoaXMuYXBwbHlDaGFuZ2VzKHQpO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGFzc2VydCB0aGlzLmNoYW5nZXMgaXMgbm90IG51bGwgICovICAgIGFzc2VydE5vdEFwcGxpZWQoKSB7fVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgUmVtb3RlRG9jdW1lbnRDYWNoZSBmb3IgSW5kZXhlZERiLiBUbyBjb25zdHJ1Y3QsIGludm9rZVxuICogYG5ld0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUoKWAuXG4gKi8gY2xhc3MgJHIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5NID0gdDtcbiAgICB9XG4gICAgc2V0SW5kZXhNYW5hZ2VyKHQpIHtcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyaWVzIHRvIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgYWRkRW50cnlgIGFyZSByZXF1aXJlZCB0byBnbyB0aHJvdWdoIHRoZSBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlclxuICAgICAqIHJldHVybmVkIGJ5IGBuZXdDaGFuZ2VCdWZmZXIoKWAgdG8gZW5zdXJlIHByb3BlciBhY2NvdW50aW5nIG9mIG1ldGFkYXRhLlxuICAgICAqLyAgICBhZGRFbnRyeSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBVcih0KS5wdXQobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBkb2N1bWVudCBmcm9tIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgcmVtb3ZlRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgIHRvIGVuc3VyZSBwcm9wZXIgYWNjb3VudGluZyBvZiBtZXRhZGF0YS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gVXIodCkuZGVsZXRlKFxuICAgICAgICAvKipcbiAqIFJldHVybnMgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZG9jdW1lbnQgbG9va3VwcyB2aWEgdGhlIHByaW1hcnkga2V5IG9mXG4gKiB0aGUgRGJSZW1vdGVEb2N1bWVudCBvYmplY3Qgc3RvcmUuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQucGF0aC50b0FycmF5KCk7XG4gICAgICAgICAgICByZXR1cm4gWyBcbiAgICAgICAgICAgIC8qIHByZWZpeCBwYXRoICovIG4uc2xpY2UoMCwgbi5sZW5ndGggLSAyKSwgXG4gICAgICAgICAgICAvKiBjb2xsZWN0aW9uIGlkICovIG5bbi5sZW5ndGggLSAyXSwgRmkoZSksIFxuICAgICAgICAgICAgLyogZG9jdW1lbnQgaWQgKi8gbltuLmxlbmd0aCAtIDFdIF07XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEga2V5IHRoYXQgY2FuIGJlIHVzZWQgZm9yIGRvY3VtZW50IGxvb2t1cHMgb24gdGhlXG4gKiBgRGJSZW1vdGVEb2N1bWVudERvY3VtZW50Q29sbGVjdGlvbkdyb3VwSW5kZXhgIGluZGV4LlxuICovIChlLCBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGN1cnJlbnQgY2FjaGUgc2l6ZS5cbiAgICAgKlxuICAgICAqIENhbGxlcnMgdG8gYGFkZEVudHJ5KClgIGFuZCBgcmVtb3ZlRW50cnkoKWAgKm11c3QqIGNhbGwgdGhpcyBhZnRlcndhcmRzIHRvIHVwZGF0ZSB0aGVcbiAgICAgKiBjYWNoZSdzIG1ldGFkYXRhLlxuICAgICAqLyAgICB1cGRhdGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKHQpLm5leHQoKG4gPT4gKG4uYnl0ZVNpemUgKz0gZSwgdGhpcy5Gbih0LCBuKSkpKTtcbiAgICB9XG4gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5lLm5ld0ludmFsaWREb2N1bWVudChlKTtcbiAgICAgICAgcmV0dXJuIFVyKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5vbmx5KHFyKGUpKVxuICAgICAgICB9LCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSB0aGlzLiRuKGUsIHMpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgLSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgZG9jdW1lbnQgZW50cnkgYW5kIGl0cyBzaXplLlxuICAgICAqLyAgICBCbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0ge1xuICAgICAgICAgICAgc2l6ZTogMCxcbiAgICAgICAgICAgIGRvY3VtZW50OiBuZS5uZXdJbnZhbGlkRG9jdW1lbnQoZSlcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFVyKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5vbmx5KHFyKGUpKVxuICAgICAgICB9LCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMuJG4oZSwgcyksXG4gICAgICAgICAgICAgICAgc2l6ZTogcHIocylcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIGdldEVudHJpZXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IFFuKCk7XG4gICAgICAgIHJldHVybiB0aGlzLkxuKHQsIGUsICgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuJG4odCwgZSk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgcyk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXlzIC0gVGhlIHNldCBvZiBrZXlzIGVudHJpZXMgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBIG1hcCBvZiBkb2N1bWVudHMgaW5kZXhlZCBieSBrZXkgYW5kIGEgbWFwIG9mIHNpemVzIGluZGV4ZWQgYnlcbiAgICAgKiAgICAga2V5ICh6ZXJvIGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdCkuXG4gICAgICovICAgIFVuKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBRbigpLCBzID0gbmV3IGZlKHh0LmNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gdGhpcy5Mbih0LCBlLCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLiRuKHQsIGUpO1xuICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KHQsIGkpLCBzID0gcy5pbnNlcnQodCwgcHIoZSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHtcbiAgICAgICAgICAgIGRvY3VtZW50czogbixcbiAgICAgICAgICAgIHFuOiBzXG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIExuKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKGUuaXNFbXB0eSgpKSByZXR1cm4geWkucmVzb2x2ZSgpO1xuICAgICAgICBsZXQgcyA9IG5ldyB3ZShHcik7XG4gICAgICAgIGUuZm9yRWFjaCgodCA9PiBzID0gcy5hZGQodCkpKTtcbiAgICAgICAgY29uc3QgaSA9IElEQktleVJhbmdlLmJvdW5kKHFyKHMuZmlyc3QoKSksIHFyKHMubGFzdCgpKSksIHIgPSBzLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGxldCBvID0gci5nZXROZXh0KCk7XG4gICAgICAgIHJldHVybiBVcih0KS5XdCh7XG4gICAgICAgICAgICBpbmRleDogXCJkb2N1bWVudEtleUluZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogaVxuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB4dC5mcm9tU2VnbWVudHMoWyAuLi5lLnByZWZpeFBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCBlLmRvY3VtZW50SWQgXSk7XG4gICAgICAgICAgICAvLyBHbyB0aHJvdWdoIGtleXMgbm90IGZvdW5kIGluIGNhY2hlLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7byAmJiBHcihvLCBpKSA8IDA7ICkgbihvLCBudWxsKSwgbyA9IHIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgbyAmJiBvLmlzRXF1YWwoaSkgJiYgKFxuICAgICAgICAgICAgLy8gS2V5IGZvdW5kIGluIGNhY2hlLlxuICAgICAgICAgICAgbihvLCBlKSwgbyA9IHIuaGFzTmV4dCgpID8gci5nZXROZXh0KCkgOiBudWxsKSwgXG4gICAgICAgICAgICAvLyBTa2lwIHRvIHRoZSBuZXh0IGtleSAoaWYgdGhlcmUgaXMgb25lKS5cbiAgICAgICAgICAgIG8gPyBzLlV0KHFyKG8pKSA6IHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGhlIHJlc3Qgb2YgdGhlIGtleXMgYXJlIG5vdCBpbiB0aGUgY2FjaGUuIE9uZSBjYXNlIHdoZXJlIGBpdGVyYXRlYFxuICAgICAgICAgICAgLy8gYWJvdmUgd29uJ3QgZ28gdGhyb3VnaCB0aGVtIGlzIHdoZW4gdGhlIGNhY2hlIGlzIGVtcHR5LlxuICAgICAgICAgICAgZm9yICg7bzsgKSBuKG8sIG51bGwpLCBvID0gci5oYXNOZXh0KCkgPyByLmdldE5leHQoKSA6IG51bGw7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNvbGxlY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gWyBlLnBvcExhc3QoKS50b0FycmF5KCksIGUubGFzdFNlZ21lbnQoKSwgRmkobi5yZWFkVGltZSksIG4uZG9jdW1lbnRLZXkucGF0aC5pc0VtcHR5KCkgPyBcIlwiIDogbi5kb2N1bWVudEtleS5wYXRoLmxhc3RTZWdtZW50KCkgXSwgaSA9IFsgZS5wb3BMYXN0KCkudG9BcnJheSgpLCBlLmxhc3RTZWdtZW50KCksIFsgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIF0sIFwiXCIgXTtcbiAgICAgICAgcmV0dXJuIFVyKHQpLnF0KElEQktleVJhbmdlLmJvdW5kKHMsIGksICEwKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IFFuKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLiRuKHh0LmZyb21TZWdtZW50cyhuLnByZWZpeFBhdGguY29uY2F0KG4uY29sbGVjdGlvbkdyb3VwLCBuLmRvY3VtZW50SWQpKSwgbik7XG4gICAgICAgICAgICAgICAgZSA9IGUuaW5zZXJ0KHQua2V5LCB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICBsZXQgaSA9IFFuKCk7XG4gICAgICAgIGNvbnN0IHIgPSBLcihlLCBuKSwgbyA9IEtyKGUsIGhlLm1heCgpKTtcbiAgICAgICAgcmV0dXJuIFVyKHQpLld0KHtcbiAgICAgICAgICAgIGluZGV4OiBcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2UuYm91bmQociwgbywgITApXG4gICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuJG4oeHQuZnJvbVNlZ21lbnRzKGUucHJlZml4UGF0aC5jb25jYXQoZS5jb2xsZWN0aW9uR3JvdXAsIGUuZG9jdW1lbnRJZCkpLCBlKTtcbiAgICAgICAgICAgIGkgPSBpLmluc2VydChyLmtleSwgciksIGkuc2l6ZSA9PT0gcyAmJiBuLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgbmV3Q2hhbmdlQnVmZmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCcih0aGlzLCAhIXQgJiYgdC50cmFja1JlbW92YWxzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKHQpLm5leHQoKHQgPT4gdC5ieXRlU2l6ZSkpO1xuICAgIH1cbiAgICBnZXRNZXRhZGF0YSh0KSB7XG4gICAgICAgIHJldHVybiBMcih0KS5nZXQoXCJyZW1vdGVEb2N1bWVudEdsb2JhbEtleVwiKS5uZXh0KCh0ID0+IChVKCEhdCksIHQpKSk7XG4gICAgfVxuICAgIEZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIExyKHQpLnB1dChcInJlbW90ZURvY3VtZW50R2xvYmFsS2V5XCIsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWNvZGVzIGBkYlJlbW90ZURvY2AgYW5kIHJldHVybnMgdGhlIGRvY3VtZW50IChvciBhbiBpbnZhbGlkIGRvY3VtZW50IGlmXG4gICAgICogdGhlIGRvY3VtZW50IGNvcnJlc3BvbmRzIHRvIHRoZSBmb3JtYXQgdXNlZCBmb3Igc2VudGluZWwgZGVsZXRlcykuXG4gICAgICovICAgICRuKHQsIGUpIHtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBNaSh0aGlzLk0sIGUpO1xuICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgYSBzZW50aW5lbCByZW1vdmFsIGFuZCBzaG91bGQgb25seSBiZSB1c2VkIGluIHRoZVxuICAgICAgICAgICAgLy8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodC5pc05vRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChjdC5taW4oKSkpKSByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmUubmV3SW52YWxpZERvY3VtZW50KHQpO1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS4gKi9cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBVbmxpa2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLCB0aGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGNvbXB1dGVzIHRoZSBzaXplXG4gKiBkZWx0YSBmb3IgYWxsIHN1Ym1pdHRlZCBjaGFuZ2VzLiBUaGlzIGF2b2lkcyBoYXZpbmcgdG8gcmUtcmVhZCBhbGwgZG9jdW1lbnRzIGZyb20gSW5kZXhlZERiXG4gKiB3aGVuIHdlIGFwcGx5IHRoZSBjaGFuZ2VzLlxuICovXG5jbGFzcyBCciBleHRlbmRzIEZyIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRDYWNoZSAtIFRoZSBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlIHRvIGFwcGx5IHRoZSBjaGFuZ2VzIHRvLlxuICAgICAqIEBwYXJhbSB0cmFja1JlbW92YWxzIC0gV2hldGhlciB0byBjcmVhdGUgc2VudGluZWwgZGVsZXRlcyB0aGF0IGNhbiBiZSB0cmFja2VkIGJ5XG4gICAgICogYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuS24gPSB0LCB0aGlzLnRyYWNrUmVtb3ZhbHMgPSBlLCBcbiAgICAgICAgLy8gQSBtYXAgb2YgZG9jdW1lbnQgc2l6ZXMgYW5kIHJlYWQgdGltZXMgcHJpb3IgdG8gYXBwbHlpbmcgdGhlIGNoYW5nZXMgaW5cbiAgICAgICAgLy8gdGhpcyBidWZmZXIuXG4gICAgICAgIHRoaXMuR24gPSBuZXcgS24oKHQgPT4gdC50b1N0cmluZygpKSwgKCh0LCBlKSA9PiB0LmlzRXF1YWwoZSkpKTtcbiAgICB9XG4gICAgYXBwbHlDaGFuZ2VzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IDAsIHMgPSBuZXcgd2UoKCh0LCBlKSA9PiBydCh0LmNhbm9uaWNhbFN0cmluZygpLCBlLmNhbm9uaWNhbFN0cmluZygpKSkpO1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VzLmZvckVhY2goKChpLCByKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvID0gdGhpcy5Hbi5nZXQoaSk7XG4gICAgICAgICAgICBpZiAoZS5wdXNoKHRoaXMuS24ucmVtb3ZlRW50cnkodCwgaSwgby5yZWFkVGltZSkpLCByLmlzVmFsaWREb2N1bWVudCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdSA9IE9pKHRoaXMuS24uTSwgcik7XG4gICAgICAgICAgICAgICAgcyA9IHMuYWRkKGkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBwcih1KTtcbiAgICAgICAgICAgICAgICBuICs9IGEgLSBvLnNpemUsIGUucHVzaCh0aGlzLktuLmFkZEVudHJ5KHQsIGksIHUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiAtPSBvLnNpemUsIHRoaXMudHJhY2tSZW1vdmFscykge1xuICAgICAgICAgICAgICAgIC8vIEluIG9yZGVyIHRvIHRyYWNrIHJlbW92YWxzLCB3ZSBzdG9yZSBhIFwic2VudGluZWwgZGVsZXRlXCIgaW4gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlRG9jdW1lbnRDYWNoZS4gVGhpcyBlbnRyeSBpcyByZXByZXNlbnRlZCBieSBhIE5vRG9jdW1lbnRcbiAgICAgICAgICAgICAgICAvLyB3aXRoIGEgdmVyc2lvbiBvZiAwIGFuZCBpZ25vcmVkIGJ5IGBtYXliZURlY29kZURvY3VtZW50KClgIGJ1dFxuICAgICAgICAgICAgICAgIC8vIHByZXNlcnZlZCBpbiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBPaSh0aGlzLktuLk0sIHIuY29udmVydFRvTm9Eb2N1bWVudChjdC5taW4oKSkpO1xuICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLktuLmFkZEVudHJ5KHQsIGksIG4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCBzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHRoaXMuS24uaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4pKTtcbiAgICAgICAgfSkpLCBlLnB1c2godGhpcy5Lbi51cGRhdGVNZXRhZGF0YSh0LCBuKSksIHlpLndhaXRGb3IoZSk7XG4gICAgfVxuICAgIGdldEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGUgYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuS24uQm4odCwgZSkubmV4dCgodCA9PiAodGhpcy5Hbi5zZXQoZSwge1xuICAgICAgICAgICAgc2l6ZTogdC5zaXplLFxuICAgICAgICAgICAgcmVhZFRpbWU6IHQuZG9jdW1lbnQucmVhZFRpbWVcbiAgICAgICAgfSksIHQuZG9jdW1lbnQpKSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGVcbiAgICAgICAgLy8gYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuS24uVW4odCwgZSkubmV4dCgoKHtkb2N1bWVudHM6IHQsIHFuOiBlfSkgPT4gKFxuICAgICAgICAvLyBOb3RlOiBgZ2V0QWxsRnJvbUNhY2hlYCByZXR1cm5zIHR3byBtYXBzIGluc3RlYWQgb2YgYSBzaW5nbGUgbWFwIGZyb21cbiAgICAgICAgLy8ga2V5cyB0byBgRG9jdW1lbnRTaXplRW50cnlgcy4gVGhpcyBpcyB0byBhbGxvdyByZXR1cm5pbmcgdGhlXG4gICAgICAgIC8vIGBNdXRhYmxlRG9jdW1lbnRNYXBgIGRpcmVjdGx5LCB3aXRob3V0IGEgY29udmVyc2lvbi5cbiAgICAgICAgZS5mb3JFYWNoKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5Hbi5zZXQoZSwge1xuICAgICAgICAgICAgICAgIHNpemU6IG4sXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IHQuZ2V0KGUpLnJlYWRUaW1lXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpLCB0KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gTHIodCkge1xuICAgIHJldHVybiBTaSh0LCBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcmVtb3RlRG9jdW1lbnRzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBVcih0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwicmVtb3RlRG9jdW1lbnRzVjE0XCIpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZG9jdW1lbnQgbG9va3VwcyBvbiB0aGVcbiAqIGBEYlJlbW90ZURvY3VtZW50RG9jdW1lbnRLZXlJbmRleGAgaW5kZXguXG4gKi8gZnVuY3Rpb24gcXIodCkge1xuICAgIGNvbnN0IGUgPSB0LnBhdGgudG9BcnJheSgpO1xuICAgIHJldHVybiBbIFxuICAgIC8qIHByZWZpeCBwYXRoICovIGUuc2xpY2UoMCwgZS5sZW5ndGggLSAyKSwgXG4gICAgLyogY29sbGVjdGlvbiBpZCAqLyBlW2UubGVuZ3RoIC0gMl0sIFxuICAgIC8qIGRvY3VtZW50IGlkICovIGVbZS5sZW5ndGggLSAxXSBdO1xufVxuXG5mdW5jdGlvbiBLcih0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUuZG9jdW1lbnRLZXkucGF0aC50b0FycmF5KCk7XG4gICAgcmV0dXJuIFsgXG4gICAgLyogY29sbGVjdGlvbiBpZCAqLyB0LCBGaShlLnJlYWRUaW1lKSwgXG4gICAgLyogcHJlZml4IHBhdGggKi8gbi5zbGljZSgwLCBuLmxlbmd0aCAtIDIpLCBcbiAgICAvKiBkb2N1bWVudCBpZCAqLyBuLmxlbmd0aCA+IDAgPyBuW24ubGVuZ3RoIC0gMV0gOiBcIlwiIF07XG59XG5cbi8qKlxuICogQ29tcGFyYXRvciB0aGF0IGNvbXBhcmVzIGRvY3VtZW50IGtleXMgYWNjb3JkaW5nIHRvIHRoZSBwcmltYXJ5IGtleSBzb3J0aW5nXG4gKiB1c2VkIGJ5IHRoZSBgRGJSZW1vdGVEb2N1bWVudERvY3VtZW50YCBzdG9yZSAoYnkgcHJlZml4IHBhdGgsIGNvbGxlY3Rpb24gaWRcbiAqIGFuZCB0aGVuIGRvY3VtZW50IElEKS5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovIGZ1bmN0aW9uIEdyKHQsIGUpIHtcbiAgICBjb25zdCBuID0gdC5wYXRoLnRvQXJyYXkoKSwgcyA9IGUucGF0aC50b0FycmF5KCk7XG4gICAgLy8gVGhlIG9yZGVyaW5nIGlzIGJhc2VkIG9uIGh0dHBzOi8vY2hyb21pdW0uZ29vZ2xlc291cmNlLmNvbS9jaHJvbWl1bS9ibGluay8rL2ZlNWMyMWZlZjk0ZGFlNzFjMWMzMzQ0Nzc1YjhkOGE3ZjdlNmQ5ZWMvU291cmNlL21vZHVsZXMvaW5kZXhlZGRiL0lEQktleS5jcHAjNzRcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCBuLmxlbmd0aCAtIDIgJiYgdCA8IHMubGVuZ3RoIC0gMjsgKyt0KSBpZiAoaSA9IHJ0KG5bdF0sIHNbdF0pLCBcbiAgICBpKSByZXR1cm4gaTtcbiAgICByZXR1cm4gaSA9IHJ0KG4ubGVuZ3RoLCBzLmxlbmd0aCksIGkgfHwgKGkgPSBydChuW24ubGVuZ3RoIC0gMl0sIHNbcy5sZW5ndGggLSAyXSksIFxuICAgIGkgfHwgcnQobltuLmxlbmd0aCAtIDFdLCBzW3MubGVuZ3RoIC0gMV0pKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRPRE8oaW5kZXhpbmcpOiBSZW1vdmUgdGhpcyBjb25zdGFudFxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLiAqL1xuY2xhc3MgUXIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5NID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBpbiBwcm9kdWN0aW9uLCB0aGlzIG1ldGhvZCBpcyBvbmx5IGV2ZXIgdXNlZCB0byB1cGdyYWRlIHRoZSBzY2hlbWFcbiAgICAgKiB0byBTQ0hFTUFfVkVSU0lPTi4gRGlmZmVyZW50IHZhbHVlcyBvZiB0b1ZlcnNpb24gYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZ1xuICAgICAqIGFuZCBsb2NhbCBmZWF0dXJlIGRldmVsb3BtZW50LlxuICAgICAqLyAgICBrdCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBuZXcgcGkoXCJjcmVhdGVPclVwZ3JhZGVcIiwgZSk7XG4gICAgICAgIG4gPCAxICYmIHMgPj0gMSAmJiAoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm93bmVyXCIpO1xuICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwibXV0YXRpb25RdWV1ZXNcIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IFwidXNlcklkXCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm11dGF0aW9uc1wiLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogXCJiYXRjaElkXCIsXG4gICAgICAgICAgICAgICAgYXV0b0luY3JlbWVudDogITBcbiAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KFwidXNlck11dGF0aW9uc0luZGV4XCIsIHpzLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgfSksIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJkb2N1bWVudE11dGF0aW9uc1wiKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cbiAqLyAodCksIGpyKHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpO1xuICAgICAgICB9KHQpKTtcbiAgICAgICAgLy8gTWlncmF0aW9uIDIgdG8gcG9wdWxhdGUgdGhlIHRhcmdldEdsb2JhbCBvYmplY3Qgbm8gbG9uZ2VyIG5lZWRlZCBzaW5jZVxuICAgICAgICAvLyBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxuICAgICAgICAgICAgICAgIGxldCByID0geWkucmVzb2x2ZSgpO1xuICAgICAgICByZXR1cm4gbiA8IDMgJiYgcyA+PSAzICYmIChcbiAgICAgICAgLy8gQnJhbmQgbmV3IGNsaWVudHMgZG9uJ3QgbmVlZCB0byBkcm9wIGFuZCByZWNyZWF0ZS0tb25seSBjbGllbnRzIHRoYXRcbiAgICAgICAgLy8gcG90ZW50aWFsbHkgaGF2ZSBjb3JydXB0IGRhdGEuXG4gICAgICAgIDAgIT09IG4gJiYgKCFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmRlbGV0ZU9iamVjdFN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIpLCB0LmRlbGV0ZU9iamVjdFN0b3JlKFwidGFyZ2V0c1wiKSwgdC5kZWxldGVPYmplY3RTdG9yZShcInRhcmdldEdsb2JhbFwiKTtcbiAgICAgICAgfSh0KSwganIodCkpLCByID0gci5uZXh0KCgoKSA9PiBcbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIHRoZSB0YXJnZXQgZ2xvYmFsIHNpbmdsZXRvbiByb3cuXG4gKlxuICogQHBhcmFtIHR4biAtIFRoZSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZm9yIGluZGV4ZWRkYlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKFwidGFyZ2V0R2xvYmFsXCIpLCBuID0ge1xuICAgICAgICAgICAgICAgIGhpZ2hlc3RUYXJnZXRJZDogMCxcbiAgICAgICAgICAgICAgICBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI6IDAsXG4gICAgICAgICAgICAgICAgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbjogY3QubWluKCkudG9UaW1lc3RhbXAoKSxcbiAgICAgICAgICAgICAgICB0YXJnZXRDb3VudDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBlLnB1dChcInRhcmdldEdsb2JhbEtleVwiLCBuKTtcbiAgICAgICAgfShpKSkpKSwgbiA8IDQgJiYgcyA+PSA0ICYmICgwICE9PSBuICYmIChcbiAgICAgICAgLy8gU2NoZW1hIHZlcnNpb24gMyB1c2VzIGF1dG8tZ2VuZXJhdGVkIGtleXMgdG8gZ2VuZXJhdGUgZ2xvYmFsbHkgdW5pcXVlXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoIElEcyAodGhpcyB3YXMgcHJldmlvdXNseSBlbnN1cmVkIGludGVybmFsbHkgYnkgdGhlXG4gICAgICAgIC8vIGNsaWVudCkuIFRvIG1pZ3JhdGUgdG8gdGhlIG5ldyBzY2hlbWEsIHdlIGhhdmUgdG8gcmVhZCBhbGwgbXV0YXRpb25zXG4gICAgICAgIC8vIGFuZCB3cml0ZSB0aGVtIGJhY2sgb3V0LiBXZSBwcmVzZXJ2ZSB0aGUgZXhpc3RpbmcgYmF0Y2ggSURzIHRvIGd1YXJhbnRlZVxuICAgICAgICAvLyBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIG9iamVjdCBzdG9yZXMuIEFueSBmdXJ0aGVyIG11dGF0aW9uIGJhdGNoIElEcyB3aWxsXG4gICAgICAgIC8vIGJlIGF1dG8tZ2VuZXJhdGVkLlxuICAgICAgICByID0gci5uZXh0KCgoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gZS5zdG9yZShcIm11dGF0aW9uc1wiKS5xdCgpLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgICAgIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJtdXRhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm11dGF0aW9uc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiYmF0Y2hJZFwiLFxuICAgICAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KFwidXNlck11dGF0aW9uc0luZGV4XCIsIHpzLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5zdG9yZShcIm11dGF0aW9uc1wiKSwgaSA9IG4ubWFwKCh0ID0+IHMucHV0KHQpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHlpLndhaXRGb3IoaSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0odCwgaSkpKSksIHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImNsaWVudE1ldGFkYXRhXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogXCJjbGllbnRJZFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICB9KSkpLCBuIDwgNSAmJiBzID49IDUgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuUW4oaSkpKSksIG4gPCA2ICYmIHMgPj0gNiAmJiAociA9IHIubmV4dCgoKCkgPT4gKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudEdsb2JhbFwiKTtcbiAgICAgICAgfSh0KSwgdGhpcy5qbihpKSkpKSksIG4gPCA3ICYmIHMgPj0gNyAmJiAociA9IHIubmV4dCgoKCkgPT4gdGhpcy5XbihpKSkpKSwgbiA8IDggJiYgcyA+PSA4ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLnpuKHQsIGkpKSkpLCBcbiAgICAgICAgbiA8IDkgJiYgcyA+PSA5ICYmIChyID0gci5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBNdWx0aS1UYWIgdXNlZCB0byBtYW5hZ2UgaXRzIG93biBjaGFuZ2Vsb2csIGJ1dCB0aGlzIGhhcyBiZWVuIG1vdmVkXG4gICAgICAgICAgICAvLyB0byB0aGUgRGJSZW1vdGVEb2N1bWVudCBvYmplY3Qgc3RvcmUgaXRzZWxmLiBTaW5jZSB0aGUgcHJldmlvdXMgY2hhbmdlXG4gICAgICAgICAgICAvLyBsb2cgb25seSBjb250YWluZWQgdHJhbnNpZW50IGRhdGEsIHdlIGNhbiBkcm9wIGl0cyBvYmplY3Qgc3RvcmUuXG4gICAgICAgICAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcInJlbW90ZURvY3VtZW50Q2hhbmdlc1wiKSAmJiB0LmRlbGV0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgICAgIC8vIE5vdGU6IFNjaGVtYSB2ZXJzaW9uIDkgdXNlZCB0byBjcmVhdGUgYSByZWFkIHRpbWUgaW5kZXggZm9yIHRoZVxuICAgICAgICAgICAgLy8gUmVtb3RlRG9jdW1lbnRDYWNoZS4gVGhpcyBpcyBub3cgZG9uZSB3aXRoIHNjaGVtYSB2ZXJzaW9uIDEzLlxuICAgICAgICAgICAgICAgIH0pKSksIG4gPCAxMCAmJiBzID49IDEwICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLkhuKGkpKSkpLCBuIDwgMTEgJiYgcyA+PSAxMSAmJiAociA9IHIubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiYnVuZGxlc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiYnVuZGxlSWRcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJuYW1lZFF1ZXJpZXNcIiwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBcIm5hbWVcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgfSkpKSwgbiA8IDEyICYmIHMgPj0gMTIgJiYgKHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJkb2N1bWVudE92ZXJsYXlzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogY2lcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvblBhdGhPdmVybGF5SW5kZXhcIiwgaGksIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pLCBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvbkdyb3VwT3ZlcmxheUluZGV4XCIsIGxpLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0odCk7XG4gICAgICAgIH0pKSksIG4gPCAxMyAmJiBzID49IDEzICYmIChyID0gci5uZXh0KCgoKSA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC5jcmVhdGVPYmplY3RTdG9yZShcInJlbW90ZURvY3VtZW50c1YxNFwiLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogWHNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZS5jcmVhdGVJbmRleChcImRvY3VtZW50S2V5SW5kZXhcIiwgWnMpLCBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgdGkpO1xuICAgICAgICB9KHQpKSkubmV4dCgoKCkgPT4gdGhpcy5Kbih0LCBpKSkpLm5leHQoKCgpID0+IHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudHNcIikpKSksIFxuICAgICAgICBuIDwgMTQgJiYgcyA+PSAxNCAmJiAociA9IHIubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiaW5kZXhDb25maWd1cmF0aW9uXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogXCJpbmRleElkXCIsXG4gICAgICAgICAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6ICEwXG4gICAgICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgoXCJjb2xsZWN0aW9uR3JvdXBJbmRleFwiLCBcImNvbGxlY3Rpb25Hcm91cFwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiaW5kZXhTdGF0ZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IHJpXG4gICAgICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgoXCJzZXF1ZW5jZU51bWJlckluZGV4XCIsIG9pLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiaW5kZXhFbnRyaWVzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogdWlcbiAgICAgICAgICAgICAgICB9KS5jcmVhdGVJbmRleChcImRvY3VtZW50S2V5SW5kZXhcIiwgYWksIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgfSkpKSwgcjtcbiAgICB9XG4gICAgam4odCkge1xuICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLld0KCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSArPSBwcihuKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICAgICAgYnl0ZVNpemU6IGVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdC5zdG9yZShcInJlbW90ZURvY3VtZW50R2xvYmFsXCIpLnB1dChcInJlbW90ZURvY3VtZW50R2xvYmFsS2V5XCIsIG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFFuKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuc3RvcmUoXCJtdXRhdGlvblF1ZXVlc1wiKSwgbiA9IHQuc3RvcmUoXCJtdXRhdGlvbnNcIik7XG4gICAgICAgIHJldHVybiBlLnF0KCkubmV4dCgoZSA9PiB5aS5mb3JFYWNoKGUsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIGUudXNlcklkLCAtMSBdLCBbIGUudXNlcklkLCBlLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkIF0pO1xuICAgICAgICAgICAgcmV0dXJuIG4ucXQoXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgcykubmV4dCgobiA9PiB5aS5mb3JFYWNoKG4sIChuID0+IHtcbiAgICAgICAgICAgICAgICBVKG4udXNlcklkID09PSBlLnVzZXJJZCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IExpKHRoaXMuTSwgbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHlyKHQsIGUudXNlcklkLCBzKS5uZXh0KCgoKSA9PiB7fSkpO1xuICAgICAgICAgICAgfSkpKSk7XG4gICAgICAgIH0pKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbnN1cmVzIHRoYXQgZXZlcnkgZG9jdW1lbnQgaW4gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSBoYXMgYSBjb3JyZXNwb25kaW5nIHNlbnRpbmVsIHJvd1xuICAgICAqIHdpdGggYSBzZXF1ZW5jZSBudW1iZXIuIE1pc3Npbmcgcm93cyBhcmUgZ2l2ZW4gdGhlIG1vc3QgcmVjZW50bHkgdXNlZCBzZXF1ZW5jZSBudW1iZXIuXG4gICAgICovICAgIFduKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuc3RvcmUoXCJ0YXJnZXREb2N1bWVudHNcIiksIG4gPSB0LnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpO1xuICAgICAgICByZXR1cm4gdC5zdG9yZShcInRhcmdldEdsb2JhbFwiKS5nZXQoXCJ0YXJnZXRHbG9iYWxLZXlcIikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gbi5XdCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IF90KG4pLCBvID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCBHcyh0KSBdO1xuICAgICAgICAgICAgICAgIH0ocik7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuZ2V0KG8pLm5leHQoKG4gPT4gbiA/IHlpLnJlc29sdmUoKSA6IChuID0+IGUucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IEdzKG4pLFxuICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXJcbiAgICAgICAgICAgICAgICB9KSkocikpKSk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4geWkud2FpdEZvcihzKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHpuKHQsIGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIsIHtcbiAgICAgICAgICAgIGtleVBhdGg6IGlpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBuID0gZS5zdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIpLCBzID0gbmV3IGNyLCBpID0gdCA9PiB7XG4gICAgICAgICAgICBpZiAocy5hZGQodCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBzID0gdC5wb3BMYXN0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IEdzKHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiBlLnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLld0KHtcbiAgICAgICAgICAgIGp0OiAhMFxuICAgICAgICB9LCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgX3QodCk7XG4gICAgICAgICAgICByZXR1cm4gaShuLnBvcExhc3QoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlLnN0b3JlKFwiZG9jdW1lbnRNdXRhdGlvbnNcIikuV3Qoe1xuICAgICAgICAgICAganQ6ICEwXG4gICAgICAgIH0sICgoW3QsIGUsIG5dLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gV3MoZSk7XG4gICAgICAgICAgICByZXR1cm4gaShyLnBvcExhc3QoKSk7XG4gICAgICAgIH0pKSkpO1xuICAgIH1cbiAgICBIbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKFwidGFyZ2V0c1wiKTtcbiAgICAgICAgcmV0dXJuIGUuV3QoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gVWkobiksIGkgPSBxaSh0aGlzLk0sIHMpO1xuICAgICAgICAgICAgcmV0dXJuIGUucHV0KGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEpuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUuc3RvcmUoXCJyZW1vdGVEb2N1bWVudHNcIiksIHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIG4uV3QoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gZS5zdG9yZShcInJlbW90ZURvY3VtZW50c1YxNFwiKSwgciA9IChvID0gbiwgby5kb2N1bWVudCA/IG5ldyB4dChfdC5mcm9tU3RyaW5nKG8uZG9jdW1lbnQubmFtZSkucG9wRmlyc3QoNSkpIDogby5ub0RvY3VtZW50ID8geHQuZnJvbVNlZ21lbnRzKG8ubm9Eb2N1bWVudC5wYXRoKSA6IG8udW5rbm93bkRvY3VtZW50ID8geHQuZnJvbVNlZ21lbnRzKG8udW5rbm93bkRvY3VtZW50LnBhdGgpIDogTCgpKS5wYXRoLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIHZhciBvO1xuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gICAgICAgICAgICBjb25zdCB1ID0ge1xuICAgICAgICAgICAgICAgIHByZWZpeFBhdGg6IHIuc2xpY2UoMCwgci5sZW5ndGggLSAyKSxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IHJbci5sZW5ndGggLSAyXSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudElkOiByW3IubGVuZ3RoIC0gMV0sXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IG4ucmVhZFRpbWUgfHwgWyAwLCAwIF0sXG4gICAgICAgICAgICAgICAgdW5rbm93bkRvY3VtZW50OiBuLnVua25vd25Eb2N1bWVudCxcbiAgICAgICAgICAgICAgICBub0RvY3VtZW50OiBuLm5vRG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IG4uZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiAhIW4uaGFzQ29tbWl0dGVkTXV0YXRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcy5wdXNoKGkucHV0KHUpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHlpLndhaXRGb3IocykpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGpyKHQpIHtcbiAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIsIHtcbiAgICAgICAga2V5UGF0aDogbmlcbiAgICB9KS5jcmVhdGVJbmRleChcImRvY3VtZW50VGFyZ2V0c0luZGV4XCIsIHNpLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KTtcbiAgICAvLyBOT1RFOiBUaGlzIGlzIHVuaXF1ZSBvbmx5IGJlY2F1c2UgdGhlIFRhcmdldElkIGlzIHRoZSBzdWZmaXguXG4gICAgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldHNcIiwge1xuICAgICAgICBrZXlQYXRoOiBcInRhcmdldElkXCJcbiAgICB9KS5jcmVhdGVJbmRleChcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIGVpLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KSwgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldEdsb2JhbFwiKTtcbn1cblxuY29uc3QgV3IgPSBcIkZhaWxlZCB0byBvYnRhaW4gZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuIFRvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24gaGFzIHRvIGJlIGVuYWJsZWQgaW4gYWxsIHRhYnMuIElmIHlvdSBhcmUgdXNpbmcgYGV4cGVyaW1lbnRhbEZvcmNlT3duaW5nVGFiOnRydWVgLCBtYWtlIHN1cmUgdGhhdCBvbmx5IG9uZSB0YWIgaGFzIHBlcnNpc3RlbmNlIGVuYWJsZWQgYXQgYW55IGdpdmVuIHRpbWUuXCI7XG5cbi8qKlxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxuICovXG4vKipcbiAqIEFuIEluZGV4ZWREQi1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIHBlcnNpc3RlbnRseVxuICogYWNyb3NzIHNlc3Npb25zLlxuICpcbiAqIE9uIFdlYiBvbmx5LCB0aGUgRmlyZXN0b3JlIFNES3Mgc3VwcG9ydCBzaGFyZWQgYWNjZXNzIHRvIGl0cyBwZXJzaXN0ZW5jZVxuICogbGF5ZXIuIFRoaXMgYWxsb3dzIG11bHRpcGxlIGJyb3dzZXIgdGFicyB0byByZWFkIGFuZCB3cml0ZSB0byBJbmRleGVkRGIgYW5kXG4gKiB0byBzeW5jaHJvbml6ZSBzdGF0ZSBldmVuIHdpdGhvdXQgbmV0d29yayBjb25uZWN0aXZpdHkuIFNoYXJlZCBhY2Nlc3MgaXNcbiAqIGN1cnJlbnRseSBvcHRpb25hbCBhbmQgbm90IGVuYWJsZWQgdW5sZXNzIGFsbCBjbGllbnRzIGludm9rZVxuICogYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYHtzeW5jaHJvbml6ZVRhYnM6dHJ1ZX1gLlxuICpcbiAqIEluIG11bHRpLXRhYiBtb2RlLCBpZiBtdWx0aXBsZSBjbGllbnRzIGFyZSBhY3RpdmUgYXQgdGhlIHNhbWUgdGltZSwgdGhlIFNES1xuICogd2lsbCBkZXNpZ25hdGUgb25lIGNsaWVudCBhcyB0aGUg4oCccHJpbWFyeSBjbGllbnTigJ0uIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyDigJxvd25lcuKAnSBzdG9yZSBldmVyeSA0IHNlY29uZHMuIElmIHRoZSBwcmltYXJ5IGNsaWVudCBmYWlscyB0b1xuICogdXBkYXRlIHRoaXMgZW50cnksIGFub3RoZXIgY2xpZW50IGNhbiBhY3F1aXJlIHRoZSBsZWFzZSBhbmQgdGFrZSBvdmVyIGFzXG4gKiBwcmltYXJ5LlxuICpcbiAqIFNvbWUgcGVyc2lzdGVuY2Ugb3BlcmF0aW9ucyBpbiB0aGUgU0RLIGFyZSBkZXNpZ25hdGVkIGFzIHByaW1hcnktY2xpZW50IG9ubHlcbiAqIG9wZXJhdGlvbnMuIFRoaXMgaW5jbHVkZXMgdGhlIGFja25vd2xlZGdtZW50IG9mIG11dGF0aW9ucyBhbmQgYWxsIHVwZGF0ZXMgb2ZcbiAqIHJlbW90ZSBkb2N1bWVudHMuIFRoZSBlZmZlY3RzIG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHdyaXR0ZW4gdG8gcGVyc2lzdGVuY2VcbiAqIGFuZCB0aGVuIGJyb2FkY2FzdCB0byBvdGhlciB0YWJzIHZpYSBMb2NhbFN0b3JhZ2UgKHNlZVxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWApLCB3aGljaCB0aGVuIHJlZnJlc2ggdGhlaXIgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogU2ltaWxhcmx5LCB0aGUgcHJpbWFyeSBjbGllbnQgbGlzdGVucyB0byBub3RpZmljYXRpb25zIHNlbnQgYnkgc2Vjb25kYXJ5XG4gKiBjbGllbnRzIHRvIGRpc2NvdmVyIHBlcnNpc3RlbmNlIGNoYW5nZXMgd3JpdHRlbiBieSBzZWNvbmRhcnkgY2xpZW50cywgc3VjaCBhc1xuICogdGhlIGFkZGl0aW9uIG9mIG5ldyBtdXRhdGlvbnMgYW5kIHF1ZXJ5IHRhcmdldHMuXG4gKlxuICogSWYgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkIGFuZCBhbm90aGVyIHRhYiBhbHJlYWR5IG9idGFpbmVkIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSwgSW5kZXhlZERiUGVyc2lzdGVuY2UgZW50ZXJzIGEgZmFpbGVkIHN0YXRlIGFuZCBhbGwgc3Vic2VxdWVudFxuICogb3BlcmF0aW9ucyB3aWxsIGF1dG9tYXRpY2FsbHkgZmFpbC5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGFuIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gYSB0YWIgaXMgY2xvc2VkLCB0aGVcbiAqIHByaW1hcnkgbGVhc2UgaXMgcmVsZWFzZWQgaW1tZWRpYXRlbHkgKHRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbWFrZVxuICogc3VyZSB0aGF0IGEgcmVmcmVzaGVkIHRhYiBpcyBhYmxlIHRvIGltbWVkaWF0ZWx5IHJlLWFjcXVpcmUgdGhlIHByaW1hcnlcbiAqIGxlYXNlKS4gVW5mb3J0dW5hdGVseSwgSW5kZXhlZERCIGNhbm5vdCBiZSByZWxpYWJseSB1c2VkIGluIHdpbmRvdy51bmxvYWRcbiAqIHNpbmNlIGl0IGlzIGFuIGFzeW5jaHJvbm91cyBBUEkuIFNvIGluIGFkZGl0aW9uIHRvIGF0dGVtcHRpbmcgdG8gZ2l2ZSB1cCB0aGVcbiAqIGxlYXNlLCB0aGUgbGVhc2Vob2xkZXIgd3JpdGVzIGl0cyBjbGllbnQgSUQgdG8gYSBcInpvbWJpZWRDbGllbnRcIiBlbnRyeSBpblxuICogTG9jYWxTdG9yYWdlIHdoaWNoIGFjdHMgYXMgYW4gaW5kaWNhdG9yIHRoYXQgYW5vdGhlciB0YWIgc2hvdWxkIGdvIGFoZWFkIGFuZFxuICogdGFrZSB0aGUgcHJpbWFyeSBsZWFzZSBpbW1lZGlhdGVseSByZWdhcmRsZXNzIG9mIHRoZSBjdXJyZW50IGxlYXNlIHRpbWVzdGFtcC5cbiAqXG4gKiBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIGBzeW5jaHJvbml6ZVRhYnNgIHNlY3Rpb24gd2hlbiBtdWx0aS10YWIgaXMgbm9cbiAqIGxvbmdlciBvcHRpb25hbC5cbiAqL1xuY2xhc3MgenIge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gc3luY2hyb25pemUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiBtdWx0aXBsZSB0YWJzIGFuZCBzaGFyZVxuICAgICAqIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzLCBpLCByLCBvLCB1LCBhLCBcbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgZm9yY2VmdWxseSBvYnRhaW5zIGRhdGFiYXNlIGFjY2Vzcy4gRXhpc3RpbmcgdGFicyB3aWxsXG4gICAgICogbm8gbG9uZ2VyIGJlIGFibGUgdG8gYWNjZXNzIEluZGV4ZWREQi5cbiAgICAgKi9cbiAgICBjLCBoID0gMTMpIHtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSB0LCB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gZSwgdGhpcy5jbGllbnRJZCA9IG4sIFxuICAgICAgICB0aGlzLlluID0gaSwgdGhpcy53aW5kb3cgPSByLCB0aGlzLmRvY3VtZW50ID0gbywgdGhpcy5YbiA9IGEsIHRoaXMuWm4gPSBjLCB0aGlzLnRzID0gaCwgXG4gICAgICAgIHRoaXMuZXMgPSBudWxsLCB0aGlzLm5zID0gITEsIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMubmV0d29ya0VuYWJsZWQgPSAhMCwgXG4gICAgICAgIC8qKiBPdXIgd2luZG93LnVubG9hZCBoYW5kbGVyLCBpZiByZWdpc3RlcmVkLiAqL1xuICAgICAgICB0aGlzLnNzID0gbnVsbCwgdGhpcy5pbkZvcmVncm91bmQgPSAhMSwgXG4gICAgICAgIC8qKiBPdXIgJ3Zpc2liaWxpdHljaGFuZ2UnIGxpc3RlbmVyIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMucnMgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBjbGllbnQgbWV0YWRhdGEgcmVmcmVzaCB0YXNrLiAqL1xuICAgICAgICB0aGlzLm9zID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLiAqL1xuICAgICAgICB0aGlzLnVzID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cbiAgICAgICAgdGhpcy5jcyA9IHQgPT4gUHJvbWlzZS5yZXNvbHZlKCksICF6ci52dCgpKSB0aHJvdyBuZXcgUShHLlVOSU1QTEVNRU5URUQsIFwiVGhpcyBwbGF0Zm9ybSBpcyBlaXRoZXIgbWlzc2luZyBJbmRleGVkREIgb3IgaXMga25vd24gdG8gaGF2ZSBhbiBpbmNvbXBsZXRlIGltcGxlbWVudGF0aW9uLiBPZmZsaW5lIHBlcnNpc3RlbmNlIGhhcyBiZWVuIGRpc2FibGVkLlwiKTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBNcih0aGlzLCBzKSwgdGhpcy5ocyA9IGUgKyBcIm1haW5cIiwgdGhpcy5NID0gbmV3IGtpKHUpLCBcbiAgICAgICAgdGhpcy5scyA9IG5ldyBJaSh0aGlzLmhzLCB0aGlzLnRzLCBuZXcgUXIodGhpcy5NKSksIHRoaXMuZnMgPSBuZXcgUHIodGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSwgdGhpcy5NKSwgXG4gICAgICAgIHRoaXMuZHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3ICRyKHQpO1xuICAgICAgICB9KHRoaXMuTSksIHRoaXMuX3MgPSBuZXcgamksIHRoaXMud2luZG93ICYmIHRoaXMud2luZG93LmxvY2FsU3RvcmFnZSA/IHRoaXMud3MgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UgOiAodGhpcy53cyA9IG51bGwsIFxuICAgICAgICAhMSA9PT0gYyAmJiBGKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJMb2NhbFN0b3JhZ2UgaXMgdW5hdmFpbGFibGUuIEFzIGEgcmVzdWx0LCBwZXJzaXN0ZW5jZSBtYXkgbm90IHdvcmsgcmVsaWFibHkuIEluIHBhcnRpY3VsYXIgZW5hYmxlUGVyc2lzdGVuY2UoKSBjb3VsZCBmYWlsIGltbWVkaWF0ZWx5IGFmdGVyIHJlZnJlc2hpbmcgdGhlIHBhZ2UuXCIpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXR0ZW1wdCB0byBzdGFydCBJbmRleGVkRGIgcGVyc2lzdGVuY2UuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBXaGV0aGVyIHBlcnNpc3RlbmNlIHdhcyBlbmFibGVkLlxuICAgICAqLyAgICBzdGFydCgpIHtcbiAgICAgICAgLy8gTk9URTogVGhpcyBpcyBleHBlY3RlZCB0byBmYWlsIHNvbWV0aW1lcyAoaW4gdGhlIGNhc2Ugb2YgYW5vdGhlciB0YWJcbiAgICAgICAgLy8gYWxyZWFkeSBoYXZpbmcgdGhlIHBlcnNpc3RlbmNlIGxvY2spLCBzbyBpdCdzIHRoZSBmaXJzdCB0aGluZyB3ZSBzaG91bGRcbiAgICAgICAgLy8gZG8uXG4gICAgICAgIHJldHVybiB0aGlzLmdzKCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzUHJpbWFyeSAmJiAhdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgXG4gICAgICAgICAgICAvLyBGYWlsIGBzdGFydCgpYCBpZiBgc3luY2hyb25pemVUYWJzYCBpcyBkaXNhYmxlZCBhbmQgd2UgY2Fubm90XG4gICAgICAgICAgICAvLyBvYnRhaW4gdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICAgICAgICB0aHJvdyBuZXcgUShHLkZBSUxFRF9QUkVDT05ESVRJT04sIFdyKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnlzKCksIHRoaXMucHMoKSwgdGhpcy5JcygpLCB0aGlzLnJ1blRyYW5zYWN0aW9uKFwiZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gdGhpcy5mcy5nZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIodCkpKTtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5lcyA9IG5ldyBudCh0LCB0aGlzLlhuKTtcbiAgICAgICAgfSkpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubnMgPSAhMDtcbiAgICAgICAgfSkpLmNhdGNoKCh0ID0+ICh0aGlzLmxzICYmIHRoaXMubHMuY2xvc2UoKSwgUHJvbWlzZS5yZWplY3QodCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgcHJpbWFyeSBzdGF0ZSBvZiB0aGVcbiAgICAgKiBpbnN0YW5jZSBjaGFuZ2VzLiBVcG9uIHJlZ2lzdGVyaW5nLCB0aGlzIGxpc3RlbmVyIGlzIGludm9rZWQgaW1tZWRpYXRlbHlcbiAgICAgKiB3aXRoIHRoZSBjdXJyZW50IHByaW1hcnkgc3RhdGUuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBUcyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNzID0gYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSByZXR1cm4gdChlKTtcbiAgICAgICAgfSwgdCh0aGlzLmlzUHJpbWFyeSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgZGF0YWJhc2UgcmVjZWl2ZXMgYVxuICAgICAqIHZlcnNpb24gY2hhbmdlIGV2ZW50IGluZGljYXRpbmcgdGhhdCBpdCBoYXMgZGVsZXRlZC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5scy5PdCgoYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gZGVsZXRlIEluZGV4ZWREQi5cbiAgICAgICAgICAgIG51bGwgPT09IGUubmV3VmVyc2lvbiAmJiBhd2FpdCB0KCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRqdXN0cyB0aGUgY3VycmVudCBuZXR3b3JrIHN0YXRlIGluIHRoZSBjbGllbnQncyBtZXRhZGF0YSwgcG90ZW50aWFsbHlcbiAgICAgKiBhZmZlY3RpbmcgdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBzZXROZXR3b3JrRW5hYmxlZCh0KSB7XG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgIT09IHQgJiYgKHRoaXMubmV0d29ya0VuYWJsZWQgPSB0LCBcbiAgICAgICAgLy8gU2NoZWR1bGUgYSBwcmltYXJ5IGxlYXNlIHJlZnJlc2ggZm9yIGltbWVkaWF0ZSBleGVjdXRpb24uIFRoZSBldmVudHVhbFxuICAgICAgICAvLyBsZWFzZSB1cGRhdGUgd2lsbCBiZSBwcm9wYWdhdGVkIHZpYSBgcHJpbWFyeVN0YXRlTGlzdGVuZXJgLlxuICAgICAgICB0aGlzLlluLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCAmJiBhd2FpdCB0aGlzLmdzKCk7XG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIgYW5kIGF0dGVtcHRzIHRvIGVpdGhlciBvYnRhaW4gb3JcbiAgICAgKiBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIEFzeW5jaHJvbm91c2x5IG5vdGlmaWVzIHRoZVxuICAgICAqIHByaW1hcnkgc3RhdGUgbGlzdGVuZXIgaWYgdGhlIGNsaWVudCBlaXRoZXIgbmV3bHkgb2J0YWluZWQgb3IgcmVsZWFzZWQgaXRzXG4gICAgICogcHJpbWFyeSBsZWFzZS5cbiAgICAgKi8gICAgZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJ1blRyYW5zYWN0aW9uKFwidXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IEpyKHQpLnB1dCh7XG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIG5ldHdvcmtFbmFibGVkOiB0aGlzLm5ldHdvcmtFbmFibGVkLFxuICAgICAgICAgICAgaW5Gb3JlZ3JvdW5kOiB0aGlzLmluRm9yZWdyb3VuZFxuICAgICAgICB9KS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHJldHVybiB0aGlzLkVzKHQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQgfHwgKHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMuWW4uZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5jcyghMSkpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0aGlzLkFzKHQpKSkubmV4dCgoZSA9PiB0aGlzLmlzUHJpbWFyeSAmJiAhZSA/IHRoaXMuUnModCkubmV4dCgoKCkgPT4gITEpKSA6ICEhZSAmJiB0aGlzLmJzKHQpLm5leHQoKCgpID0+ICEwKSkpKSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgIGlmIChBaSh0KSkgXG4gICAgICAgICAgICAvLyBQcm9jZWVkIHdpdGggdGhlIGV4aXN0aW5nIHN0YXRlLiBBbnkgc3Vic2VxdWVudCBhY2Nlc3MgdG9cbiAgICAgICAgICAgIC8vIEluZGV4ZWREQiB3aWxsIHZlcmlmeSB0aGUgbGVhc2UuXG4gICAgICAgICAgICByZXR1cm4gTyhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiRmFpbGVkIHRvIGV4dGVuZCBvd25lciBsZWFzZTogXCIsIHQpLCB0aGlzLmlzUHJpbWFyeTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgdGhyb3cgdDtcbiAgICAgICAgICAgIHJldHVybiBPKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJSZWxlYXNpbmcgb3duZXIgbGVhc2UgYWZ0ZXIgZXJyb3IgZHVyaW5nIGxlYXNlIHJlZnJlc2hcIiwgdCksIFxuICAgICAgICAgICAgLyogaXNQcmltYXJ5PSAqLyAhMTtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgIT09IHQgJiYgdGhpcy5Zbi5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0aGlzLmNzKHQpKSksIHRoaXMuaXNQcmltYXJ5ID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBFcyh0KSB7XG4gICAgICAgIHJldHVybiBIcih0KS5nZXQoXCJvd25lclwiKS5uZXh0KCh0ID0+IHlpLnJlc29sdmUodGhpcy5Qcyh0KSkpKTtcbiAgICB9XG4gICAgVnModCkge1xuICAgICAgICByZXR1cm4gSnIodCkuZGVsZXRlKHRoaXMuY2xpZW50SWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIHRocmVzaG9sZCBoYXMgcGFzc2VkLCBwcnVuZXMgdGhlXG4gICAgICogUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIGFuZCB0aGUgQ2xpZW50TWV0YWRhdGEgc3RvcmUgYmFzZWQgb24gdGhlIGxhc3QgdXBkYXRlXG4gICAgICogdGltZSBvZiBhbGwgY2xpZW50cy5cbiAgICAgKi8gICAgYXN5bmMgdnMoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSAmJiAhdGhpcy5Tcyh0aGlzLnVzLCAxOGU1KSkge1xuICAgICAgICAgICAgdGhpcy51cyA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5ydW5UcmFuc2FjdGlvbihcIm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBTaSh0LCBcImNsaWVudE1ldGFkYXRhXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBlLnF0KCkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLkRzKHQsIDE4ZTUpLCBzID0gdC5maWx0ZXIoKHQgPT4gLTEgPT09IG4uaW5kZXhPZih0KSkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgbWV0YWRhdGEgZm9yIGNsaWVudHMgdGhhdCBhcmUgbm8gbG9uZ2VyIGNvbnNpZGVyZWQgYWN0aXZlLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geWkuZm9yRWFjaChzLCAodCA9PiBlLmRlbGV0ZSh0LmNsaWVudElkKSkpLm5leHQoKCgpID0+IHMpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSkuY2F0Y2goKCgpID0+IFtdKSk7XG4gICAgICAgICAgICAvLyBEZWxldGUgcG90ZW50aWFsIGxlZnRvdmVyIGVudHJpZXMgdGhhdCBtYXkgY29udGludWUgdG8gbWFyayB0aGVcbiAgICAgICAgICAgIC8vIGluYWN0aXZlIGNsaWVudHMgYXMgem9tYmllZCBpbiBMb2NhbFN0b3JhZ2UuXG4gICAgICAgICAgICAvLyBJZGVhbGx5IHdlJ2QgZGVsZXRlIHRoZSBJbmRleGVkRGIgYW5kIExvY2FsU3RvcmFnZSB6b21iaWUgZW50cmllcyBmb3JcbiAgICAgICAgICAgIC8vIHRoZSBjbGllbnQgYXRvbWljYWxseSwgYnV0IHdlIGNhbid0LiBTbyB3ZSBvcHQgdG8gZGVsZXRlIHRoZSBJbmRleGVkRGJcbiAgICAgICAgICAgIC8vIGVudHJpZXMgZmlyc3QgdG8gYXZvaWQgcG90ZW50aWFsbHkgcmV2aXZpbmcgYSB6b21iaWVkIGNsaWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndzKSBmb3IgKGNvbnN0IGUgb2YgdCkgdGhpcy53cy5yZW1vdmVJdGVtKHRoaXMuQ3MoZS5jbGllbnRJZCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNjaGVkdWxlcyBhIHJlY3VycmluZyB0aW1lciB0byB1cGRhdGUgdGhlIGNsaWVudCBtZXRhZGF0YSBhbmQgdG8gZWl0aGVyXG4gICAgICogZXh0ZW5kIG9yIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgaWYgdGhlIGNsaWVudCBpcyBlbGlnaWJsZS5cbiAgICAgKi8gICAgSXMoKSB7XG4gICAgICAgIHRoaXMub3MgPSB0aGlzLlluLmVucXVldWVBZnRlckRlbGF5KFwiY2xpZW50X21ldGFkYXRhX3JlZnJlc2hcIiAvKiBDbGllbnRNZXRhZGF0YVJlZnJlc2ggKi8gLCA0ZTMsICgoKSA9PiB0aGlzLmdzKCkudGhlbigoKCkgPT4gdGhpcy52cygpKSkudGhlbigoKCkgPT4gdGhpcy5JcygpKSkpKTtcbiAgICB9XG4gICAgLyoqIENoZWNrcyB3aGV0aGVyIGBjbGllbnRgIGlzIHRoZSBsb2NhbCBjbGllbnQuICovICAgIFBzKHQpIHtcbiAgICAgICAgcmV0dXJuICEhdCAmJiB0Lm93bmVySWQgPT09IHRoaXMuY2xpZW50SWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV2YWx1YXRlIHRoZSBzdGF0ZSBvZiBhbGwgYWN0aXZlIGNsaWVudHMgYW5kIGRldGVybWluZSB3aGV0aGVyIHRoZSBsb2NhbFxuICAgICAqIGNsaWVudCBpcyBvciBjYW4gYWN0IGFzIHRoZSBob2xkZXIgb2YgdGhlIHByaW1hcnkgbGVhc2UuIFJldHVybnMgd2hldGhlclxuICAgICAqIHRoZSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoZSBsZWFzZSwgYnV0IGRvZXMgbm90IGFjdHVhbGx5IGFjcXVpcmUgaXQuXG4gICAgICogTWF5IHJldHVybiAnZmFsc2UnIGV2ZW4gaWYgdGhlcmUgaXMgbm8gYWN0aXZlIGxlYXNlaG9sZGVyIGFuZCBhbm90aGVyXG4gICAgICogKGZvcmVncm91bmQpIGNsaWVudCBzaG91bGQgYmVjb21lIGxlYXNlaG9sZGVyIGluc3RlYWQuXG4gICAgICovICAgIEFzKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuWm4pIHJldHVybiB5aS5yZXNvbHZlKCEwKTtcbiAgICAgICAgcmV0dXJuIEhyKHQpLmdldChcIm93bmVyXCIpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgLy8gQSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoZSBwcmltYXJ5IGxlYXNlIGlmOlxuICAgICAgICAgICAgLy8gLSBpdHMgbmV0d29yayBpcyBlbmFibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZSBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBpdHMgbmV0d29yayBpcyBlbmFibGVkIGFuZCBubyBvdGhlciBjbGllbnQncyB0YWIgaXMgaW4gdGhlXG4gICAgICAgICAgICAvLyAgIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGV2ZXJ5IGNsaWVudHMgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgdGhlIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCBubyBvdGhlciBjbGllbnQncyB0YWIgaXMgaW5cbiAgICAgICAgICAgIC8vICAgdGhlIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIHRoZSBgZm9yY2VPd25pbmdUYWJgIHNldHRpbmcgd2FzIHBhc3NlZCBpbi5cbiAgICAgICAgICAgIGlmIChudWxsICE9PSBlICYmIHRoaXMuU3MoZS5sZWFzZVRpbWVzdGFtcE1zLCA1ZTMpICYmICF0aGlzLnhzKGUub3duZXJJZCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5QcyhlKSAmJiB0aGlzLm5ldHdvcmtFbmFibGVkKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLlBzKGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgXG4gICAgICAgICAgICAgICAgICAgIC8vIEZhaWwgdGhlIGBjYW5BY3RBc1ByaW1hcnlgIGNoZWNrIGlmIHRoZSBjdXJyZW50IGxlYXNlaG9sZGVyIGhhc1xuICAgICAgICAgICAgICAgICAgICAvLyBub3Qgb3B0ZWQgaW50byBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLiBJZiB0aGlzIGhhcHBlbnMgYXRcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xpZW50IHN0YXJ0dXAsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSByZXR1cm5lZCBieVxuICAgICAgICAgICAgICAgICAgICAvLyBgZW5hYmxlUGVyc2lzdGVuY2UoKWAgYW5kIHRoZSB1c2VyIGNhbiBjb250aW51ZSB0byB1c2UgRmlyZXN0b3JlXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGZhaWxzIGR1cmluZyBhIGxlYXNlIHJlZnJlc2gsIHdlIHdpbGwgaW5zdGVhZCBibG9jayB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gQXN5bmNRdWV1ZSBmcm9tIGV4ZWN1dGluZyBmdXJ0aGVyIG9wZXJhdGlvbnMuIE5vdGUgdGhhdCB0aGlzIGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIGFjY2VwdGFibGUgc2luY2UgbWl4aW5nICYgbWF0Y2hpbmcgZGlmZmVyZW50IGBzeW5jaHJvbml6ZVRhYnNgXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldHRpbmdzIGlzIG5vdCBzdXBwb3J0ZWQuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8xMTQyMjYyMzQpOiBSZW1vdmUgdGhpcyBjaGVjayB3aGVuIGBzeW5jaHJvbml6ZVRhYnNgIGNhblxuICAgICAgICAgICAgICAgICAgICAvLyBubyBsb25nZXIgYmUgdHVybmVkIG9mZi5cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBXcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gISghdGhpcy5uZXR3b3JrRW5hYmxlZCB8fCAhdGhpcy5pbkZvcmVncm91bmQpIHx8IEpyKHQpLnF0KCkubmV4dCgodCA9PiB2b2lkIDAgPT09IHRoaXMuRHModCwgNWUzKS5maW5kKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGllbnRJZCAhPT0gdC5jbGllbnRJZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gIXRoaXMubmV0d29ya0VuYWJsZWQgJiYgdC5uZXR3b3JrRW5hYmxlZCwgbiA9ICF0aGlzLmluRm9yZWdyb3VuZCAmJiB0LmluRm9yZWdyb3VuZCwgcyA9IHRoaXMubmV0d29ya0VuYWJsZWQgPT09IHQubmV0d29ya0VuYWJsZWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlIHx8IG4gJiYgcykgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgfSkpLm5leHQoKHQgPT4gKHRoaXMuaXNQcmltYXJ5ICE9PSB0ICYmIE8oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBgQ2xpZW50ICR7dCA/IFwiaXNcIiA6IFwiaXMgbm90XCJ9IGVsaWdpYmxlIGZvciBhIHByaW1hcnkgbGVhc2UuYCksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICBhc3luYyBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gVGhlIHNodXRkb3duKCkgb3BlcmF0aW9ucyBhcmUgaWRlbXBvdGVudCBhbmQgY2FuIGJlIGNhbGxlZCBldmVuIHdoZW5cbiAgICAgICAgLy8gc3RhcnQoKSBhYm9ydGVkIChlLmcuIGJlY2F1c2UgaXQgY291bGRuJ3QgYWNxdWlyZSB0aGUgcGVyc2lzdGVuY2UgbGVhc2UpLlxuICAgICAgICB0aGlzLm5zID0gITEsIHRoaXMuTnMoKSwgdGhpcy5vcyAmJiAodGhpcy5vcy5jYW5jZWwoKSwgdGhpcy5vcyA9IG51bGwpLCB0aGlzLmtzKCksIFxuICAgICAgICB0aGlzLk1zKCksIFxuICAgICAgICAvLyBVc2UgYFNpbXBsZURiLnJ1blRyYW5zYWN0aW9uYCBkaXJlY3RseSB0byBhdm9pZCBmYWlsaW5nIGlmIGFub3RoZXIgdGFiXG4gICAgICAgIC8vIGhhcyBvYnRhaW5lZCB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgICAgYXdhaXQgdGhpcy5scy5ydW5UcmFuc2FjdGlvbihcInNodXRkb3duXCIsIFwicmVhZHdyaXRlXCIsIFsgXCJvd25lclwiLCBcImNsaWVudE1ldGFkYXRhXCIgXSwgKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyB2aSh0LCBudC5BKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlJzKGUpLm5leHQoKCgpID0+IHRoaXMuVnMoZSkpKTtcbiAgICAgICAgfSkpLCB0aGlzLmxzLmNsb3NlKCksIFxuICAgICAgICAvLyBSZW1vdmUgdGhlIGVudHJ5IG1hcmtpbmcgdGhlIGNsaWVudCBhcyB6b21iaWVkIGZyb20gTG9jYWxTdG9yYWdlIHNpbmNlXG4gICAgICAgIC8vIHdlIHN1Y2Nlc3NmdWxseSBkZWxldGVkIGl0cyBtZXRhZGF0YSBmcm9tIEluZGV4ZWREYi5cbiAgICAgICAgdGhpcy5PcygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGNsaWVudHMgdGhhdCBhcmUgbm90IHpvbWJpZWQgYW5kIGhhdmUgYW4gdXBkYXRlVGltZSB3aXRoaW4gdGhlXG4gICAgICogcHJvdmlkZWQgdGhyZXNob2xkLlxuICAgICAqLyAgICBEcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0LmZpbHRlcigodCA9PiB0aGlzLlNzKHQudXBkYXRlVGltZU1zLCBlKSAmJiAhdGhpcy54cyh0LmNsaWVudElkKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBJRHMgb2YgdGhlIGNsaWVudHMgdGhhdCBhcmUgY3VycmVudGx5IGFjdGl2ZS4gSWYgbXVsdGktdGFiXG4gICAgICogaXMgbm90IHN1cHBvcnRlZCwgcmV0dXJucyBhbiBhcnJheSB0aGF0IG9ubHkgY29udGFpbnMgdGhlIGxvY2FsIGNsaWVudCdzXG4gICAgICogSUQuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBGcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucnVuVHJhbnNhY3Rpb24oXCJnZXRBY3RpdmVDbGllbnRzXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gSnIodCkucXQoKS5uZXh0KCh0ID0+IHRoaXMuRHModCwgMThlNSkubWFwKCh0ID0+IHQuY2xpZW50SWQpKSkpKSk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ucztcbiAgICB9XG4gICAgZ2V0TXV0YXRpb25RdWV1ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBJci5ZdCh0LCB0aGlzLk0sIGUsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZnM7XG4gICAgfVxuICAgIGdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRzO1xuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IGxyKHQsIHRoaXMuTS5KdC5kYXRhYmFzZUlkKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUodCkge1xuICAgICAgICByZXR1cm4gSGkuWXQodGhpcy5NLCB0KTtcbiAgICB9XG4gICAgZ2V0QnVuZGxlQ2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zO1xuICAgIH1cbiAgICBydW5UcmFuc2FjdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIE8oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIlN0YXJ0aW5nIHRyYW5zYWN0aW9uOlwiLCB0KTtcbiAgICAgICAgY29uc3QgcyA9IFwicmVhZG9ubHlcIiA9PT0gZSA/IFwicmVhZG9ubHlcIiA6IFwicmVhZHdyaXRlXCIsIGkgPSAxNCA9PT0gKHIgPSB0aGlzLnRzKSA/IHdpIDogMTMgPT09IHIgPyBfaSA6IDEyID09PSByID8gZGkgOiAxMSA9PT0gciA/IGZpIDogdm9pZCBMKCk7XG4gICAgICAgIC8qKiBSZXR1cm5zIHRoZSBvYmplY3Qgc3RvcmVzIGZvciB0aGUgcHJvdmlkZWQgc2NoZW1hLiAqL1xuICAgICAgICB2YXIgcjtcbiAgICAgICAgbGV0IG87XG4gICAgICAgIC8vIERvIGFsbCB0cmFuc2FjdGlvbnMgYXMgcmVhZHdyaXRlIGFnYWluc3QgYWxsIG9iamVjdCBzdG9yZXMsIHNpbmNlIHdlXG4gICAgICAgIC8vIGFyZSB0aGUgb25seSByZWFkZXIvd3JpdGVyLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxzLnJ1blRyYW5zYWN0aW9uKHQsIHMsIGksIChzID0+IChvID0gbmV3IHZpKHMsIHRoaXMuZXMgPyB0aGlzLmVzLm5leHQoKSA6IG50LkEpLCBcbiAgICAgICAgXCJyZWFkd3JpdGUtcHJpbWFyeVwiID09PSBlID8gdGhpcy5FcyhvKS5uZXh0KCh0ID0+ICEhdCB8fCB0aGlzLkFzKG8pKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWUpIHRocm93IEYoYEZhaWxlZCB0byBvYnRhaW4gcHJpbWFyeSBsZWFzZSBmb3IgYWN0aW9uICcke3R9Jy5gKSwgdGhpcy5pc1ByaW1hcnkgPSAhMSwgXG4gICAgICAgICAgICB0aGlzLlluLmVucXVldWVSZXRyeWFibGUoKCgpID0+IHRoaXMuY3MoITEpKSksIG5ldyBRKEcuRkFJTEVEX1BSRUNPTkRJVElPTiwgbWkpO1xuICAgICAgICAgICAgcmV0dXJuIG4obyk7XG4gICAgICAgIH0pKS5uZXh0KCh0ID0+IHRoaXMuYnMobykubmV4dCgoKCkgPT4gdCkpKSkgOiB0aGlzLiRzKG8pLm5leHQoKCgpID0+IG4obykpKSkpKS50aGVuKCh0ID0+IChvLnJhaXNlT25Db21taXR0ZWRFdmVudCgpLCBcbiAgICAgICAgdCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgY3VycmVudCB0YWIgaXMgdGhlIHByaW1hcnkgbGVhc2Vob2xkZXIgb3IgYWx0ZXJuYXRpdmVseVxuICAgICAqIHRoYXQgdGhlIGxlYXNlaG9sZGVyIGhhcyBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXG4gICAgICovXG4gICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuIG5vIGxvbmdlclxuICAgIC8vIGJlIHR1cm5lZCBvZmYuXG4gICAgJHModCkge1xuICAgICAgICByZXR1cm4gSHIodCkuZ2V0KFwib3duZXJcIikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdCAmJiB0aGlzLlNzKHQubGVhc2VUaW1lc3RhbXBNcywgNWUzKSAmJiAhdGhpcy54cyh0Lm93bmVySWQpICYmICF0aGlzLlBzKHQpICYmICEodGhpcy5abiB8fCB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uICYmIHQuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pKSB0aHJvdyBuZXcgUShHLkZBSUxFRF9QUkVDT05ESVRJT04sIFdyKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPYnRhaW5zIG9yIGV4dGVuZHMgdGhlIG5ldyBwcmltYXJ5IGxlYXNlIGZvciB0aGUgbG9jYWwgY2xpZW50LiBUaGlzXG4gICAgICogbWV0aG9kIGRvZXMgbm90IHZlcmlmeSB0aGF0IHRoZSBjbGllbnQgaXMgZWxpZ2libGUgZm9yIHRoaXMgbGVhc2UuXG4gICAgICovICAgIGJzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIG93bmVySWQ6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgICBhbGxvd1RhYlN5bmNocm9uaXphdGlvbjogdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbixcbiAgICAgICAgICAgIGxlYXNlVGltZXN0YW1wTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEhyKHQpLnB1dChcIm93bmVyXCIsIGUpO1xuICAgIH1cbiAgICBzdGF0aWMgdnQoKSB7XG4gICAgICAgIHJldHVybiBJaS52dCgpO1xuICAgIH1cbiAgICAvKiogQ2hlY2tzIHRoZSBwcmltYXJ5IGxlYXNlIGFuZCByZW1vdmVzIGl0IGlmIHdlIGFyZSB0aGUgY3VycmVudCBwcmltYXJ5LiAqLyAgICBScyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBIcih0KTtcbiAgICAgICAgcmV0dXJuIGUuZ2V0KFwib3duZXJcIikubmV4dCgodCA9PiB0aGlzLlBzKHQpID8gKE8oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIlJlbGVhc2luZyBwcmltYXJ5IGxlYXNlLlwiKSwgXG4gICAgICAgIGUuZGVsZXRlKFwib3duZXJcIikpIDogeWkucmVzb2x2ZSgpKSk7XG4gICAgfVxuICAgIC8qKiBWZXJpZmllcyB0aGF0IGB1cGRhdGVUaW1lTXNgIGlzIHdpdGhpbiBgbWF4QWdlTXNgLiAqLyAgICBTcyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBEYXRlLm5vdygpO1xuICAgICAgICByZXR1cm4gISh0IDwgbiAtIGUpICYmICghKHQgPiBuKSB8fCAoRihgRGV0ZWN0ZWQgYW4gdXBkYXRlIHRpbWUgdGhhdCBpcyBpbiB0aGUgZnV0dXJlOiAke3R9ID4gJHtufWApLCBcbiAgICAgICAgITEpKTtcbiAgICB9XG4gICAgeXMoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuZG9jdW1lbnQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgJiYgKHRoaXMucnMgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLlluLmVucXVldWVBbmRGb3JnZXQoKCgpID0+ICh0aGlzLmluRm9yZWdyb3VuZCA9IFwidmlzaWJsZVwiID09PSB0aGlzLmRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSwgXG4gICAgICAgICAgICB0aGlzLmdzKCkpKSk7XG4gICAgICAgIH0sIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5ycyksIHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlKTtcbiAgICB9XG4gICAga3MoKSB7XG4gICAgICAgIHRoaXMucnMgJiYgKHRoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5ycyksIHRoaXMucnMgPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXR0YWNoZXMgYSB3aW5kb3cudW5sb2FkIGhhbmRsZXIgdGhhdCB3aWxsIHN5bmNocm9ub3VzbHkgd3JpdGUgb3VyXG4gICAgICogY2xpZW50SWQgdG8gYSBcInpvbWJpZSBjbGllbnQgaWRcIiBsb2NhdGlvbiBpbiBMb2NhbFN0b3JhZ2UuIFRoaXMgY2FuIGJlIHVzZWRcbiAgICAgKiBieSB0YWJzIHRyeWluZyB0byBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIHRvIGRldGVybWluZSB0aGF0IHRoZSBsZWFzZVxuICAgICAqIGlzIG5vIGxvbmdlciB2YWxpZCBldmVuIGlmIHRoZSB0aW1lc3RhbXAgaXMgcmVjZW50LiBUaGlzIGlzIHBhcnRpY3VsYXJseVxuICAgICAqIGltcG9ydGFudCBmb3IgdGhlIHJlZnJlc2ggY2FzZSAoc28gdGhlIHRhYiBjb3JyZWN0bHkgcmUtYWNxdWlyZXMgdGhlXG4gICAgICogcHJpbWFyeSBsZWFzZSkuIExvY2FsU3RvcmFnZSBpcyB1c2VkIGZvciB0aGlzIHJhdGhlciB0aGFuIEluZGV4ZWREYiBiZWNhdXNlXG4gICAgICogaXQgaXMgYSBzeW5jaHJvbm91cyBBUEkgYW5kIHNvIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGZyb20gIGFuIHVubG9hZFxuICAgICAqIGhhbmRsZXIuXG4gICAgICovICAgIHBzKCkge1xuICAgICAgICB2YXIgdDtcbiAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiAobnVsbCA9PT0gKHQgPSB0aGlzLndpbmRvdykgfHwgdm9pZCAwID09PSB0ID8gdm9pZCAwIDogdC5hZGRFdmVudExpc3RlbmVyKSAmJiAodGhpcy5zcyA9ICgpID0+IHtcbiAgICAgICAgICAgIC8vIE5vdGU6IEluIHRoZW9yeSwgdGhpcyBzaG91bGQgYmUgc2NoZWR1bGVkIG9uIHRoZSBBc3luY1F1ZXVlIHNpbmNlIGl0XG4gICAgICAgICAgICAvLyBhY2Nlc3NlcyBpbnRlcm5hbCBzdGF0ZS4gV2UgZXhlY3V0ZSB0aGlzIGNvZGUgZGlyZWN0bHkgZHVyaW5nIHNodXRkb3duXG4gICAgICAgICAgICAvLyB0byBtYWtlIHN1cmUgaXQgZ2V0cyBhIGNoYW5jZSB0byBydW4uXG4gICAgICAgICAgICB0aGlzLk5zKCksIGlzU2FmYXJpKCkgJiYgbmF2aWdhdG9yLmFwcFZlcnNpb24ubWF0Y2goL1ZlcnNpb25cXC8xWzQ1XS8pICYmIFxuICAgICAgICAgICAgLy8gT24gU2FmYXJpIDE0IGFuZCAxNSwgd2UgZG8gbm90IHJ1biBhbnkgY2xlYW51cCBhY3Rpb25zIGFzIGl0IG1pZ2h0XG4gICAgICAgICAgICAvLyB0cmlnZ2VyIGEgYnVnIHRoYXQgcHJldmVudHMgU2FmYXJpIGZyb20gcmUtb3BlbmluZyBJbmRleGVkREIgZHVyaW5nXG4gICAgICAgICAgICAvLyB0aGUgbmV4dCBwYWdlIGxvYWQuXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTIyNjU0N1xuICAgICAgICAgICAgdGhpcy5Zbi5lbnRlclJlc3RyaWN0ZWRNb2RlKC8qIHB1cmdlRXhpc3RpbmdUYXNrcz0gKi8gITApLCB0aGlzLlluLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc2h1dGRvd24oKSkpO1xuICAgICAgICB9LCB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5zcykpO1xuICAgIH1cbiAgICBNcygpIHtcbiAgICAgICAgdGhpcy5zcyAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsIHRoaXMuc3MpLCB0aGlzLnNzID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBhIGNsaWVudCBpcyBcInpvbWJpZWRcIiBiYXNlZCBvbiBpdHMgTG9jYWxTdG9yYWdlIGVudHJ5LlxuICAgICAqIENsaWVudHMgYmVjb21lIHpvbWJpZWQgd2hlbiB0aGVpciB0YWIgY2xvc2VzIHdpdGhvdXQgcnVubmluZyBhbGwgb2YgdGhlXG4gICAgICogY2xlYW51cCBsb2dpYyBpbiBgc2h1dGRvd24oKWAuXG4gICAgICovICAgIHhzKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuID0gbnVsbCAhPT0gKG51bGwgPT09IChlID0gdGhpcy53cykgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5nZXRJdGVtKHRoaXMuQ3ModCkpKTtcbiAgICAgICAgICAgIHJldHVybiBPKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgYENsaWVudCAnJHt0fScgJHtuID8gXCJpc1wiIDogXCJpcyBub3RcIn0gem9tYmllZCBpbiBMb2NhbFN0b3JhZ2VgKSwgXG4gICAgICAgICAgICBuO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgIHJldHVybiBGKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLlwiLCB0KSwgITE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXG4gICAgICovICAgIE5zKCkge1xuICAgICAgICBpZiAodGhpcy53cykgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud3Muc2V0SXRlbSh0aGlzLkNzKHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cbiAgICAgICAgICAgIEYoXCJGYWlsZWQgdG8gc2V0IHpvbWJpZSBjbGllbnQgaWQuXCIsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBSZW1vdmVzIHRoZSB6b21iaWVkIGNsaWVudCBlbnRyeSBpZiBpdCBleGlzdHMuICovICAgIE9zKCkge1xuICAgICAgICBpZiAodGhpcy53cykgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud3MucmVtb3ZlSXRlbSh0aGlzLkNzKHRoaXMuY2xpZW50SWQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgIH1cbiAgICB9XG4gICAgQ3ModCkge1xuICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV96b21iaWVfJHt0aGlzLnBlcnNpc3RlbmNlS2V5fV8ke3R9YDtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBwcmltYXJ5IGNsaWVudCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gSHIodCkge1xuICAgIHJldHVybiBTaSh0LCBcIm93bmVyXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY2xpZW50IG1ldGFkYXRhIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBKcih0KSB7XG4gICAgcmV0dXJuIFNpKHQsIFwiY2xpZW50TWV0YWRhdGFcIik7XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHVzZWQgYXMgYSBwcmVmaXggd2hlbiBzdG9yaW5nIGRhdGEgaW4gSW5kZXhlZERCIGFuZFxuICogTG9jYWxTdG9yYWdlLlxuICovIGZ1bmN0aW9uIFlyKHQsIGUpIHtcbiAgICAvLyBVc2UgdHdvIGRpZmZlcmVudCBwcmVmaXggZm9ybWF0czpcbiAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLiBkYXRhYmFzZUlEIC8gLi4uXG4gICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC8gLi4uXG4gICAgLy8gcHJvamVjdElEcyBhcmUgRE5TLWNvbXBhdGlibGUgbmFtZXMgYW5kIGNhbm5vdCBjb250YWluIGRvdHNcbiAgICAvLyBzbyB0aGVyZSdzIG5vIGRhbmdlciBvZiBjb2xsaXNpb25zLlxuICAgIGxldCBuID0gdC5wcm9qZWN0SWQ7XG4gICAgcmV0dXJuIHQuaXNEZWZhdWx0RGF0YWJhc2UgfHwgKG4gKz0gXCIuXCIgKyB0LmRhdGFiYXNlKSwgXCJmaXJlc3RvcmUvXCIgKyBlICsgXCIvXCIgKyBuICsgXCIvXCI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcmVhZG9ubHkgdmlldyBvZiB0aGUgbG9jYWwgc3RhdGUgb2YgYWxsIGRvY3VtZW50cyB3ZSdyZSB0cmFja2luZyAoaS5lLiB3ZVxuICogaGF2ZSBhIGNhY2hlZCB2ZXJzaW9uIGluIHJlbW90ZURvY3VtZW50Q2FjaGUgb3IgbG9jYWwgbXV0YXRpb25zIGZvciB0aGVcbiAqIGRvY3VtZW50KS4gVGhlIHZpZXcgaXMgY29tcHV0ZWQgYnkgYXBwbHlpbmcgdGhlIG11dGF0aW9ucyBpbiB0aGVcbiAqIE11dGF0aW9uUXVldWUgdG8gdGhlIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi9cbmNsYXNzIFhyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZHMgPSB0LCB0aGlzLkJzID0gZSwgdGhpcy5pbmRleE1hbmFnZXIgPSBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IGlkZW50aWZpZWQgYnkgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBMb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBvciBudWxsIGlmIHdlIGRvbid0IGhhdmUgYW55IGNhY2hlZFxuICAgICAqIHN0YXRlIGZvciBpdC5cbiAgICAgKi8gICAgTHModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ccy5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKS5uZXh0KChuID0+IHRoaXMuVXModCwgZSwgbikpKTtcbiAgICB9XG4gICAgLyoqIEludGVybmFsIHZlcnNpb24gb2YgYGdldERvY3VtZW50YCB0aGF0IGFsbG93cyByZXVzaW5nIGJhdGNoZXMuICovICAgIFVzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHMuZ2V0RW50cnkodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgbikgZS5hcHBseVRvTG9jYWxWaWV3KHQpO1xuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmlldyBvZiB0aGUgZ2l2ZW4gYGRvY3NgIGFzIHRoZXkgd291bGQgYXBwZWFyIGFmdGVyIGFwcGx5aW5nXG4gICAgLy8gYWxsIG11dGF0aW9ucyBpbiB0aGUgZ2l2ZW4gYGJhdGNoZXNgLlxuICAgIHFzKHQsIGUpIHtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHQuYXBwbHlUb0xvY2FsVmlldyhuKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cbiAgICAgKi8gICAgS3ModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kcy5nZXRFbnRyaWVzKHQsIGUpLm5leHQoKGUgPT4gdGhpcy5Hcyh0LCBlKS5uZXh0KCgoKSA9PiBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgbG9jYWwgdmlldyB0aGUgZ2l2ZW4gYGJhc2VEb2NzYCB3aXRob3V0IHJldHJpZXZpbmcgZG9jdW1lbnRzXG4gICAgICogZnJvbSB0aGUgbG9jYWwgc3RvcmUuXG4gICAgICovICAgIEdzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQnMuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKHQsIGUpLm5leHQoKHQgPT4gdGhpcy5xcyhlLCB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHZpZXcgb2YgYWxsIGRvY3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbi5cbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkgdG8gbWF0Y2ggZG9jdW1lbnRzIGFnYWluc3QuXG4gICAgICogQHBhcmFtIG9mZnNldCAtIFJlYWQgdGltZSBhbmQga2V5IHRvIHN0YXJ0IHNjYW5uaW5nIGJ5IChleGNsdXNpdmUpLlxuICAgICAqLyAgICBRcyh0LCBlLCBuKSB7XG4gICAgICAgIC8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgc2luZ2xlIGRvY3VtZW50IGJ5IHBhdGggKHJhdGhlciB0aGFuIGFcbiAqIGNvbGxlY3Rpb24pLlxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4geHQuaXNEb2N1bWVudEtleSh0LnBhdGgpICYmIG51bGwgPT09IHQuY29sbGVjdGlvbkdyb3VwICYmIDAgPT09IHQuZmlsdGVycy5sZW5ndGg7XG4gICAgICAgIH0oZSkgPyB0aGlzLmpzKHQsIGUucGF0aCkgOiBXZShlKSA/IHRoaXMuV3ModCwgZSwgbikgOiB0aGlzLnpzKHQsIGUsIG4pO1xuICAgIH1cbiAgICBqcyh0LCBlKSB7XG4gICAgICAgIC8vIEp1c3QgZG8gYSBzaW1wbGUgZG9jdW1lbnQgbG9va3VwLlxuICAgICAgICByZXR1cm4gdGhpcy5Mcyh0LCBuZXcgeHQoZSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgbGV0IGUgPSBXbigpO1xuICAgICAgICAgICAgcmV0dXJuIHQuaXNGb3VuZERvY3VtZW50KCkgJiYgKGUgPSBlLmluc2VydCh0LmtleSwgdCkpLCBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFdzKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IGUuY29sbGVjdGlvbkdyb3VwO1xuICAgICAgICBsZXQgaSA9IFduKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlci5nZXRDb2xsZWN0aW9uUGFyZW50cyh0LCBzKS5uZXh0KChyID0+IHlpLmZvckVhY2gociwgKHIgPT4ge1xuICAgICAgICAgICAgY29uc3QgbyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVlKGUsIFxuICAgICAgICAgICAgICAgIC8qY29sbGVjdGlvbkdyb3VwPSovIG51bGwsIHQuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbiAgICAgICAgICAgIH0oZSwgci5jaGlsZChzKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy56cyh0LCBvLCBuKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGkgPSBpLmluc2VydCh0LCBlKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSkpKTtcbiAgICB9XG4gICAgenModCwgZSwgbikge1xuICAgICAgICAvLyBRdWVyeSB0aGUgcmVtb3RlIGRvY3VtZW50cyBhbmQgb3ZlcmxheSBtdXRhdGlvbnMuXG4gICAgICAgIGxldCBzO1xuICAgICAgICByZXR1cm4gdGhpcy5kcy5nZXRBbGxGcm9tQ29sbGVjdGlvbih0LCBlLnBhdGgsIG4pLm5leHQoKG4gPT4gKHMgPSBuLCB0aGlzLkJzLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5KHQsIGUpKSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIGZvciAoY29uc3QgdCBvZiBlLm11dGF0aW9ucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmtleTtcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHMuZ2V0KG4pO1xuICAgICAgICAgICAgICAgIG51bGwgPT0gaSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGludmFsaWQgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIG9uIHRvcCBvZlxuICAgICAgICAgICAgICAgIGkgPSBuZS5uZXdJbnZhbGlkRG9jdW1lbnQobiksIHMgPSBzLmluc2VydChuLCBpKSksIFZuKHQsIGksIGUubG9jYWxXcml0ZVRpbWUpLCBpLmlzRm91bmREb2N1bWVudCgpIHx8IChzID0gcy5yZW1vdmUobikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKFxuICAgICAgICAvLyBGaW5hbGx5LCBmaWx0ZXIgb3V0IGFueSBkb2N1bWVudHMgdGhhdCBkb24ndCBhY3R1YWxseSBtYXRjaFxuICAgICAgICAvLyB0aGUgcXVlcnkuXG4gICAgICAgIHMuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgIHRuKGUsIG4pIHx8IChzID0gcy5yZW1vdmUodCkpO1xuICAgICAgICB9KSksIHMpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHNldCBvZiBjaGFuZ2VzIHRvIHdoYXQgZG9jdW1lbnRzIGFyZSBjdXJyZW50bHkgaW4gdmlldyBhbmQgb3V0IG9mIHZpZXcgZm9yXG4gKiBhIGdpdmVuIHF1ZXJ5LiBUaGVzZSBjaGFuZ2VzIGFyZSBzZW50IHRvIHRoZSBMb2NhbFN0b3JlIGJ5IHRoZSBWaWV3ICh2aWFcbiAqIHRoZSBTeW5jRW5naW5lKSBhbmQgYXJlIHVzZWQgdG8gcGluIC8gdW5waW4gZG9jdW1lbnRzIGFzIGFwcHJvcHJpYXRlLlxuICovIGNsYXNzIFpyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLmZyb21DYWNoZSA9IGUsIHRoaXMuSHMgPSBuLCB0aGlzLkpzID0gcztcbiAgICB9XG4gICAgc3RhdGljIFlzKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBZbigpLCBzID0gWW4oKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuZG9jQ2hhbmdlcykgc3dpdGNoICh0LnR5cGUpIHtcbiAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgbiA9IG4uYWRkKHQuZG9jLmtleSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgMSAvKiBSZW1vdmVkICovIDpcbiAgICAgICAgICAgIHMgPSBzLmFkZCh0LmRvYy5rZXkpO1xuIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgWnIodCwgZS5mcm9tQ2FjaGUsIG4sIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIEZpcmVzdG9yZSBxdWVyeSBlbmdpbmUuXG4gKlxuICogRmlyZXN0b3JlIHF1ZXJpZXMgY2FuIGJlIGV4ZWN1dGVkIGluIHRocmVlIG1vZGVzLiBUaGUgUXVlcnkgRW5naW5lIGRldGVybWluZXNcbiAqIHdoYXQgbW9kZSB0byB1c2UgYmFzZWQgb24gd2hhdCBkYXRhIGlzIHBlcnNpc3RlZC4gVGhlIG1vZGUgb25seSBkZXRlcm1pbmVzXG4gKiB0aGUgcnVudGltZSBjb21wbGV4aXR5IG9mIHRoZSBxdWVyeSAtIHRoZSByZXN1bHQgc2V0IGlzIGVxdWl2YWxlbnQgYWNyb3NzIGFsbFxuICogaW1wbGVtZW50YXRpb25zLlxuICpcbiAqIFRoZSBRdWVyeSBlbmdpbmUgd2lsbCB1c2UgaW5kZXhlZC1iYXNlZCBleGVjdXRpb24gaWYgYSB1c2VyIGhhcyBjb25maWd1cmVkXG4gKiBhbnkgaW5kZXggdGhhdCBjYW4gYmUgdXNlZCB0byBleGVjdXRlIHF1ZXJ5ICh2aWEgYHNldEluZGV4Q29uZmlndXJhdGlvbigpYCkuXG4gKiBPdGhlcndpc2UsIHRoZSBlbmdpbmUgd2lsbCB0cnkgdG8gb3B0aW1pemUgdGhlIHF1ZXJ5IGJ5IHJlLXVzaW5nIGEgcHJldmlvdXNseVxuICogcGVyc2lzdGVkIHF1ZXJ5IHJlc3VsdC4gSWYgdGhhdCBpcyBub3QgcG9zc2libGUsIHRoZSBxdWVyeSB3aWxsIGJlIGV4ZWN1dGVkXG4gKiB2aWEgYSBmdWxsIGNvbGxlY3Rpb24gc2Nhbi5cbiAqXG4gKiBJbmRleC1iYXNlZCBleGVjdXRpb24gaXMgdGhlIGRlZmF1bHQgd2hlbiBhdmFpbGFibGUuIFRoZSBxdWVyeSBlbmdpbmVcbiAqIHN1cHBvcnRzIHBhcnRpYWwgaW5kZXhlZCBleGVjdXRpb24gYW5kIG1lcmdlcyB0aGUgcmVzdWx0IGZyb20gdGhlIGluZGV4XG4gKiBsb29rdXAgd2l0aCBkb2N1bWVudHMgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBpbmRleGVkLiBUaGUgaW5kZXggZXZhbHVhdGlvblxuICogbWF0Y2hlcyB0aGUgYmFja2VuZCdzIGZvcm1hdCBhbmQgYXMgc3VjaCwgdGhlIFNESyBjYW4gdXNlIGluZGV4aW5nIGZvciBhbGxcbiAqIHF1ZXJpZXMgdGhhdCB0aGUgYmFja2VuZCBzdXBwb3J0cy5cbiAqXG4gKiBJZiBubyBpbmRleCBleGlzdHMsIHRoZSBxdWVyeSBlbmdpbmUgdHJpZXMgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgdGhlIHRhcmdldFxuICogZG9jdW1lbnQgbWFwcGluZyBpbiB0aGUgVGFyZ2V0Q2FjaGUuIFRoZXNlIG1hcHBpbmdzIGV4aXN0cyBmb3IgYWxsIHF1ZXJpZXNcbiAqIHRoYXQgaGF2ZSBiZWVuIHN5bmNlZCB3aXRoIHRoZSBiYWNrZW5kIGF0IGxlYXN0IG9uY2UgYW5kIGFsbG93IHRoZSBxdWVyeVxuICogZW5naW5lIHRvIG9ubHkgcmVhZCBkb2N1bWVudHMgdGhhdCBwcmV2aW91c2x5IG1hdGNoZWQgYSBxdWVyeSBwbHVzIGFueVxuICogZG9jdW1lbnRzIHRoYXQgd2VyZSBlZGl0ZWQgYWZ0ZXIgdGhlIHF1ZXJ5IHdhcyBsYXN0IGxpc3RlbmVkIHRvLlxuICpcbiAqIFRoZXJlIGFyZSBzb21lIGNhc2VzIHdoZW4gdGhpcyBvcHRpbWl6YXRpb24gaXMgbm90IGd1YXJhbnRlZWQgdG8gcHJvZHVjZVxuICogdGhlIHNhbWUgcmVzdWx0cyBhcyBmdWxsIGNvbGxlY3Rpb24gc2NhbnMuIEluIHRoZXNlIGNhc2VzLCBxdWVyeVxuICogcHJvY2Vzc2luZyBmYWxscyBiYWNrIHRvIGZ1bGwgc2NhbnMuIFRoZXNlIGNhc2VzIGFyZTpcbiAqXG4gKiAtIExpbWl0IHF1ZXJpZXMgd2hlcmUgYSBkb2N1bWVudCB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IHByZXZpb3VzbHkgbm8gbG9uZ2VyXG4gKiAgIG1hdGNoZXMgdGhlIHF1ZXJ5LlxuICpcbiAqIC0gTGltaXQgcXVlcmllcyB3aGVyZSBhIGRvY3VtZW50IGVkaXQgbWF5IGNhdXNlIHRoZSBkb2N1bWVudCB0byBzb3J0IGJlbG93XG4gKiAgIGFub3RoZXIgZG9jdW1lbnQgdGhhdCBpcyBpbiB0aGUgbG9jYWwgY2FjaGUuXG4gKlxuICogLSBRdWVyaWVzIHRoYXQgaGF2ZSBuZXZlciBiZWVuIENVUlJFTlQgb3IgZnJlZSBvZiBsaW1ibyBkb2N1bWVudHMuXG4gKi8gY2xhc3MgdG8ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLlhzID0gITE7XG4gICAgfVxuICAgIC8qKiBTZXRzIHRoZSBkb2N1bWVudCB2aWV3IHRvIHF1ZXJ5IGFnYWluc3QuICovICAgIGluaXRpYWxpemUodCwgZSkge1xuICAgICAgICB0aGlzLlpzID0gdCwgdGhpcy5pbmRleE1hbmFnZXIgPSBlLCB0aGlzLlhzID0gITA7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGFsbCBsb2NhbCBkb2N1bWVudHMgbWF0Y2hpbmcgdGhlIHNwZWNpZmllZCBxdWVyeS4gKi8gICAgUXModCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gdGhpcy50aSh0LCBlKS5uZXh0KChpID0+IGkgfHwgdGhpcy5laSh0LCBlLCBzLCBuKSkpLm5leHQoKG4gPT4gbiB8fCB0aGlzLm5pKHQsIGUpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGFuIGluZGV4ZWQgcXVlcnkgdGhhdCBldmFsdWF0ZXMgdGhlIHF1ZXJ5IGJhc2VkIG9uIGEgY29sbGVjdGlvbidzXG4gICAgICogcGVyc2lzdGVkIGluZGV4IHZhbHVlcy4gUmV0dXJucyBgbnVsbGAgaWYgYW4gaW5kZXggaXMgbm90IGF2YWlsYWJsZS5cbiAgICAgKi8gICAgdGkodCwgZSkge1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYSBxdWVyeSBiYXNlZCBvbiB0aGUgdGFyZ2V0J3MgcGVyc2lzdGVkIHF1ZXJ5IG1hcHBpbmcuIFJldHVybnNcbiAgICAgKiBgbnVsbGAgaWYgdGhlIG1hcHBpbmcgaXMgbm90IGF2YWlsYWJsZSBvciBjYW5ub3QgYmUgdXNlZC5cbiAgICAgKi8gICAgZWkodCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gR2UoZSkgfHwgcy5pc0VxdWFsKGN0Lm1pbigpKSA/IHRoaXMubmkodCwgZSkgOiB0aGlzLlpzLktzKHQsIG4pLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuc2koZSwgaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5paShlLCByLCBuLCBzKSA/IHRoaXMubmkodCwgZSkgOiAoaygpIDw9IExvZ0xldmVsLkRFQlVHICYmIE8oXCJRdWVyeUVuZ2luZVwiLCBcIlJlLXVzaW5nIHByZXZpb3VzIHJlc3VsdCBmcm9tICVzIHRvIGV4ZWN1dGUgcXVlcnk6ICVzXCIsIHMudG9TdHJpbmcoKSwgWmUoZSkpLCBcbiAgICAgICAgICAgIHRoaXMucmkodCwgciwgZSwgYWUocywgLTEpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBzaSh0LCBlKSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyB3ZShubih0KSk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBzKSA9PiB7XG4gICAgICAgICAgICB0bih0LCBzKSAmJiAobiA9IG4uYWRkKHMpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgbGltaXQgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgZnJvbSBjYWNoZSwgbWFraW5nIGl0XG4gICAgICogaW5lbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnkgVGhlIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSBzb3J0ZWRQcmV2aW91c1Jlc3VsdHMgLSBUaGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2hlZCB0aGUgcXVlcnkgd2hlbiBpdFxuICAgICAqIHdhcyBsYXN0IHN5bmNocm9uaXplZCwgc29ydGVkIGJ5IHRoZSBxdWVyeSdzIGNvbXBhcmF0b3IuXG4gICAgICogQHBhcmFtIHJlbW90ZUtleXMgLSBUaGUgZG9jdW1lbnQga2V5cyB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IGF0IHRoZSBsYXN0XG4gICAgICogc25hcHNob3QuXG4gICAgICogQHBhcmFtIGxpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiAtIFRoZSB2ZXJzaW9uIG9mIHRoZSBzbmFwc2hvdCB3aGVuIHRoZVxuICAgICAqIHF1ZXJ5IHdhcyBsYXN0IHN5bmNocm9uaXplZC5cbiAgICAgKi8gICAgaWkodCwgZSwgbiwgcykge1xuICAgICAgICBpZiAobnVsbCA9PT0gdC5saW1pdCkgXG4gICAgICAgIC8vIFF1ZXJpZXMgd2l0aG91dCBsaW1pdHMgZG8gbm90IG5lZWQgdG8gYmUgcmVmaWxsZWQuXG4gICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgaWYgKG4uc2l6ZSAhPT0gZS5zaXplKSBcbiAgICAgICAgLy8gVGhlIHF1ZXJ5IG5lZWRzIHRvIGJlIHJlZmlsbGVkIGlmIGEgcHJldmlvdXNseSBtYXRjaGluZyBkb2N1bWVudCBub1xuICAgICAgICAvLyBsb25nZXIgbWF0Y2hlcy5cbiAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICAvLyBMaW1pdCBxdWVyaWVzIGFyZSBub3QgZWxpZ2libGUgZm9yIGluZGV4LWZyZWUgcXVlcnkgZXhlY3V0aW9uIGlmIHRoZXJlIGlzXG4gICAgICAgIC8vIGEgcG90ZW50aWFsIHRoYXQgYW4gb2xkZXIgZG9jdW1lbnQgZnJvbSBjYWNoZSBub3cgc29ydHMgYmVmb3JlIGEgZG9jdW1lbnRcbiAgICAgICAgLy8gdGhhdCB3YXMgcHJldmlvdXNseSBwYXJ0IG9mIHRoZSBsaW1pdC4gVGhpcywgaG93ZXZlciwgY2FuIG9ubHkgaGFwcGVuIGlmXG4gICAgICAgIC8vIHRoZSBkb2N1bWVudCBhdCB0aGUgZWRnZSBvZiB0aGUgbGltaXQgZ29lcyBvdXQgb2YgbGltaXQuXG4gICAgICAgIC8vIElmIGEgZG9jdW1lbnQgdGhhdCBpcyBub3QgdGhlIGxpbWl0IGJvdW5kYXJ5IHNvcnRzIGRpZmZlcmVudGx5LFxuICAgICAgICAvLyB0aGUgYm91bmRhcnkgb2YgdGhlIGxpbWl0IGl0c2VsZiBkaWQgbm90IGNoYW5nZSBhbmQgZG9jdW1lbnRzIGZyb20gY2FjaGVcbiAgICAgICAgLy8gd2lsbCBjb250aW51ZSB0byBiZSBcInJlamVjdGVkXCIgYnkgdGhpcyBib3VuZGFyeS4gVGhlcmVmb3JlLCB3ZSBjYW4gaWdub3JlXG4gICAgICAgIC8vIGFueSBtb2RpZmljYXRpb25zIHRoYXQgZG9uJ3QgYWZmZWN0IHRoZSBsYXN0IGRvY3VtZW50LlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBcIkZcIiAvKiBGaXJzdCAqLyA9PT0gdC5saW1pdFR5cGUgPyBlLmxhc3QoKSA6IGUuZmlyc3QoKTtcbiAgICAgICAgcmV0dXJuICEhaSAmJiAoaS5oYXNQZW5kaW5nV3JpdGVzIHx8IGkudmVyc2lvbi5jb21wYXJlVG8ocykgPiAwKTtcbiAgICB9XG4gICAgbmkodCwgZSkge1xuICAgICAgICByZXR1cm4gaygpIDw9IExvZ0xldmVsLkRFQlVHICYmIE8oXCJRdWVyeUVuZ2luZVwiLCBcIlVzaW5nIGZ1bGwgY29sbGVjdGlvbiBzY2FuIHRvIGV4ZWN1dGUgcXVlcnk6XCIsIFplKGUpKSwgXG4gICAgICAgIHRoaXMuWnMuUXModCwgZSwgaGUubWluKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21iaW5lcyB0aGUgcmVzdWx0cyBmcm9tIGFuIGluZGV4ZWQgZXhlY3V0aW9uIHdpdGggdGhlIHJlbWFpbmluZyBkb2N1bWVudHNcbiAgICAgKiB0aGF0IGhhdmUgbm90IHlldCBiZWVuIGluZGV4ZWQuXG4gICAgICovICAgIHJpKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gUmV0cmlldmUgYWxsIHJlc3VsdHMgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmUgdXBkYXRlZCBzaW5jZSB0aGUgb2Zmc2V0LlxuICAgICAgICByZXR1cm4gdGhpcy5acy5Rcyh0LCBuLCBzKS5uZXh0KCh0ID0+IChcbiAgICAgICAgLy8gTWVyZ2Ugd2l0aCBleGlzdGluZyByZXN1bHRzXG4gICAgICAgIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0ID0gdC5pbnNlcnQoZS5rZXksIGUpO1xuICAgICAgICB9KSksIHQpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbXBsZW1lbnRzIGBMb2NhbFN0b3JlYCBpbnRlcmZhY2UuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi9cbmNsYXNzIGVvIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG4gICAgdCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgdGhpcy5vaSA9IGUsIHRoaXMuTSA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBhIHRhcmdldElEIHRvIGRhdGEgYWJvdXQgaXRzIHRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBXZSBhcmUgdXNpbmcgYW4gaW1tdXRhYmxlIGRhdGEgc3RydWN0dXJlIG9uIFdlYiB0byBtYWtlIHJlLXJ1bnNcbiAgICAgICAgICogb2YgYGFwcGx5UmVtb3RlRXZlbnQoKWAgaWRlbXBvdGVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudWkgPSBuZXcgZmUocnQpLCBcbiAgICAgICAgLyoqIE1hcHMgYSB0YXJnZXQgdG8gaXRzIHRhcmdldElELiAqL1xuICAgICAgICAvLyBUT0RPKHd1YW5keSk6IEV2YWx1YXRlIGlmIFRhcmdldElkIGNhbiBiZSBwYXJ0IG9mIFRhcmdldC5cbiAgICAgICAgdGhpcy5haSA9IG5ldyBLbigodCA9PiBJZSh0KSksIEVlKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHBlciBjb2xsZWN0aW9uIGdyb3VwIGluZGV4IG9mIHRoZSBsYXN0IHJlYWQgdGltZSBwcm9jZXNzZWQgYnlcbiAgICAgICAgICogYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2kgPSBuZXcgTWFwLCB0aGlzLmhpID0gdC5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCksIHRoaXMuZnMgPSB0LmdldFRhcmdldENhY2hlKCksIFxuICAgICAgICB0aGlzLl9zID0gdC5nZXRCdW5kbGVDYWNoZSgpLCB0aGlzLmxpKG4pO1xuICAgIH1cbiAgICBsaSh0KSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBBZGQgc3BlYyB0ZXN0cyB0aGF0IHRlc3QgdGhlc2UgY29tcG9uZW50cyBjaGFuZ2UgYWZ0ZXIgYVxuICAgICAgICAvLyB1c2VyIGNoYW5nZVxuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0SW5kZXhNYW5hZ2VyKHQpLCB0aGlzLkJzID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRNdXRhdGlvblF1ZXVlKHQsIHRoaXMuaW5kZXhNYW5hZ2VyKSwgXG4gICAgICAgIHRoaXMuZmkgPSBuZXcgWHIodGhpcy5oaSwgdGhpcy5CcywgdGhpcy5pbmRleE1hbmFnZXIpLCB0aGlzLmhpLnNldEluZGV4TWFuYWdlcih0aGlzLmluZGV4TWFuYWdlciksIFxuICAgICAgICB0aGlzLm9pLmluaXRpYWxpemUodGhpcy5maSwgdGhpcy5pbmRleE1hbmFnZXIpO1xuICAgIH1cbiAgICBjb2xsZWN0R2FyYmFnZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQ29sbGVjdCBnYXJiYWdlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKGUgPT4gdC5jb2xsZWN0KGUsIHRoaXMudWkpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBubyhcbi8qKiBNYW5hZ2VzIG91ciBpbi1tZW1vcnkgb3IgZHVyYWJsZSBwZXJzaXN0ZW5jZS4gKi9cbnQsIGUsIG4sIHMpIHtcbiAgICByZXR1cm4gbmV3IGVvKHQsIGUsIG4sIHMpO1xufVxuXG4vKipcbiAqIFRlbGxzIHRoZSBMb2NhbFN0b3JlIHRoYXQgdGhlIGN1cnJlbnRseSBhdXRoZW50aWNhdGVkIHVzZXIgaGFzIGNoYW5nZWQuXG4gKlxuICogSW4gcmVzcG9uc2UgdGhlIGxvY2FsIHN0b3JlIHN3aXRjaGVzIHRoZSBtdXRhdGlvbiBxdWV1ZSB0byB0aGUgbmV3IHVzZXIgYW5kXG4gKiByZXR1cm5zIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcy5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBBbmRyb2lkIGFuZCBpT1Mgb25seSByZXR1cm4gdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSB0aGVcbi8vIGNoYW5nZS5cbmFzeW5jIGZ1bmN0aW9uIHNvKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICByZXR1cm4gYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkhhbmRsZSB1c2VyIGNoYW5nZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHtcbiAgICAgICAgLy8gU3dhcCBvdXQgdGhlIG11dGF0aW9uIHF1ZXVlLCBncmFiYmluZyB0aGUgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzXG4gICAgICAgIC8vIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gICAgICAgIGxldCBzO1xuICAgICAgICByZXR1cm4gbi5Ccy5nZXRBbGxNdXRhdGlvbkJhdGNoZXModCkubmV4dCgoaSA9PiAocyA9IGksIG4ubGkoZSksIG4uQnMuZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpKSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IFtdLCByID0gW107XG4gICAgICAgICAgICAvLyBVbmlvbiB0aGUgb2xkL25ldyBjaGFuZ2VkIGtleXMuXG4gICAgICAgICAgICBsZXQgbyA9IFluKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcykge1xuICAgICAgICAgICAgICAgIGkucHVzaCh0LmJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0Lm11dGF0aW9ucykgbyA9IG8uYWRkKGUua2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICAgICAgci5wdXNoKHQuYmF0Y2hJZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSBvID0gby5hZGQoZS5rZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0dXJuIHRoZSBzZXQgb2YgYWxsIChwb3RlbnRpYWxseSkgY2hhbmdlZCBkb2N1bWVudHMgYW5kIHRoZSBsaXN0XG4gICAgICAgICAgICAvLyBvZiBtdXRhdGlvbiBiYXRjaCBJRHMgdGhhdCB3ZXJlIGFmZmVjdGVkIGJ5IGNoYW5nZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmZpLktzKHQsIG8pLm5leHQoKHQgPT4gKHtcbiAgICAgICAgICAgICAgICBkaTogdCxcbiAgICAgICAgICAgICAgICByZW1vdmVkQmF0Y2hJZHM6IGksXG4gICAgICAgICAgICAgICAgYWRkZWRCYXRjaElkczogclxuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgfSkpO1xuICAgIH0pKTtcbn1cblxuLyogQWNjZXB0cyBsb2NhbGx5IGdlbmVyYXRlZCBNdXRhdGlvbnMgYW5kIGNvbW1pdCB0aGVtIHRvIHN0b3JhZ2UuICovXG4vKipcbiAqIEFja25vd2xlZGdlcyB0aGUgZ2l2ZW4gYmF0Y2guXG4gKlxuICogT24gdGhlIGhhcHB5IHBhdGggd2hlbiBhIGJhdGNoIGlzIGFja25vd2xlZGdlZCwgdGhlIGxvY2FsIHN0b3JlIHdpbGxcbiAqXG4gKiAgKyByZW1vdmUgdGhlIGJhdGNoIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlO1xuICogICsgYXBwbHkgdGhlIGNoYW5nZXMgdG8gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZTtcbiAqICArIHJlY2FsY3VsYXRlIHRoZSBsYXRlbmN5IGNvbXBlbnNhdGVkIHZpZXcgaW1wbGllZCBieSB0aG9zZSBjaGFuZ2VzICh0aGVyZVxuICogICAgbWF5IGJlIG11dGF0aW9ucyBpbiB0aGUgcXVldWUgdGhhdCBhZmZlY3QgdGhlIGRvY3VtZW50cyBidXQgaGF2ZW4ndCBiZWVuXG4gKiAgICBhY2tub3dsZWRnZWQgeWV0KTsgYW5kXG4gKiAgKyBnaXZlIHRoZSBjaGFuZ2VkIGRvY3VtZW50cyBiYWNrIHRoZSBzeW5jIGVuZ2luZVxuICpcbiAqIEByZXR1cm5zIFRoZSByZXN1bHRpbmcgKG1vZGlmaWVkKSBkb2N1bWVudHMuXG4gKi9cbmZ1bmN0aW9uIGlvKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkFja25vd2xlZGdlIGJhdGNoXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICBjb25zdCBzID0gZS5iYXRjaC5rZXlzKCksIGkgPSBuLmhpLm5ld0NoYW5nZUJ1ZmZlcih7XG4gICAgICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuLmJhdGNoLCByID0gaS5rZXlzKCk7XG4gICAgICAgICAgICBsZXQgbyA9IHlpLnJlc29sdmUoKTtcbiAgICAgICAgICAgIHJldHVybiByLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgIG8gPSBvLm5leHQoKCgpID0+IHMuZ2V0RW50cnkoZSwgdCkpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG4uZG9jVmVyc2lvbnMuZ2V0KHQpO1xuICAgICAgICAgICAgICAgICAgICBVKG51bGwgIT09IHIpLCBlLnZlcnNpb24uY29tcGFyZVRvKHIpIDwgMCAmJiAoaS5hcHBseVRvUmVtb3RlRG9jdW1lbnQoZSwgbiksIGUuaXNWYWxpZERvY3VtZW50KCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICAvLyBXZSB1c2UgdGhlIGNvbW1pdFZlcnNpb24gYXMgdGhlIHJlYWRUaW1lIHJhdGhlciB0aGFuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudCdzIHVwZGF0ZVRpbWUgc2luY2UgdGhlIHVwZGF0ZVRpbWUgaXMgbm90IGFkdmFuY2VkXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB1cGRhdGVzIHRoYXQgZG8gbm90IG1vZGlmeSB0aGUgdW5kZXJseWluZyBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICAgICAgZS5zZXRSZWFkVGltZShuLmNvbW1pdFZlcnNpb24pLCBzLmFkZEVudHJ5KGUpKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLCBvLm5leHQoKCgpID0+IHQuQnMucmVtb3ZlTXV0YXRpb25CYXRjaChlLCBpKSkpO1xuICAgICAgICB9XG4gICAgICAgIC8qKiBSZXR1cm5zIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgYSBtdXRhdGlvbiBiYXRjaC4gKi9cbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbiAgICAgICAgKG4sIHQsIGUsIGkpLm5leHQoKCgpID0+IGkuYXBwbHkodCkpKS5uZXh0KCgoKSA9PiBuLkJzLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHQpKSkubmV4dCgoKCkgPT4gbi5maS5Lcyh0LCBzKSkpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIG11dGF0aW9ucyBmcm9tIHRoZSBNdXRhdGlvblF1ZXVlIGZvciB0aGUgc3BlY2lmaWVkIGJhdGNoO1xuICogTG9jYWxEb2N1bWVudHMgd2lsbCBiZSByZWNhbGN1bGF0ZWQuXG4gKlxuICogQHJldHVybnMgVGhlIHJlc3VsdGluZyBtb2RpZmllZCBkb2N1bWVudHMuXG4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgbGFzdCBjb25zaXN0ZW50IHNuYXBzaG90IHByb2Nlc3NlZCAodXNlZCBieSB0aGUgUmVtb3RlU3RvcmUgdG9cbiAqIGRldGVybWluZSB3aGV0aGVyIHRvIGJ1ZmZlciBpbmNvbWluZyBzbmFwc2hvdHMgZnJvbSB0aGUgYmFja2VuZCkuXG4gKi9cbmZ1bmN0aW9uIHJvKHQpIHtcbiAgICBjb25zdCBlID0gSyh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBsYXN0IHJlbW90ZSBzbmFwc2hvdCB2ZXJzaW9uXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5mcy5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpKSk7XG59XG5cbi8qKlxuICogVXBkYXRlcyB0aGUgXCJncm91bmQtc3RhdGVcIiAocmVtb3RlKSBkb2N1bWVudHMuIFdlIGFzc3VtZSB0aGF0IHRoZSByZW1vdGVcbiAqIGV2ZW50IHJlZmxlY3RzIGFueSB3cml0ZSBiYXRjaGVzIHRoYXQgaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBvciByZWplY3RlZFxuICogKGkuZS4gd2UgZG8gbm90IHJlLWFwcGx5IGxvY2FsIG11dGF0aW9ucyB0byB1cGRhdGVzIGZyb20gdGhpcyBldmVudCkuXG4gKlxuICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXG4gKiBxdWV1ZS5cbiAqLyBmdW5jdGlvbiBvbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCksIHMgPSBlLnNuYXBzaG90VmVyc2lvbjtcbiAgICBsZXQgaSA9IG4udWk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSByZW1vdGUgZXZlbnRcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAodCA9PiB7XG4gICAgICAgIGNvbnN0IHIgPSBuLmhpLm5ld0NoYW5nZUJ1ZmZlcih7XG4gICAgICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gUmVzZXQgbmV3VGFyZ2V0RGF0YUJ5VGFyZ2V0TWFwIGluIGNhc2UgdGhpcyB0cmFuc2FjdGlvbiBnZXRzIHJlLXJ1bi5cbiAgICAgICAgICAgICAgICBpID0gbi51aTtcbiAgICAgICAgY29uc3QgbyA9IFtdO1xuICAgICAgICBlLnRhcmdldENoYW5nZXMuZm9yRWFjaCgoKHIsIHUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBpLmdldCh1KTtcbiAgICAgICAgICAgIGlmICghYSkgcmV0dXJuO1xuICAgICAgICAgICAgLy8gT25seSB1cGRhdGUgdGhlIHJlbW90ZSBrZXlzIGlmIHRoZSB0YXJnZXQgaXMgc3RpbGwgYWN0aXZlLiBUaGlzXG4gICAgICAgICAgICAvLyBlbnN1cmVzIHRoYXQgd2UgY2FuIHBlcnNpc3QgdGhlIHVwZGF0ZWQgdGFyZ2V0IGRhdGEgYWxvbmcgd2l0aFxuICAgICAgICAgICAgLy8gdGhlIHVwZGF0ZWQgYXNzaWdubWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaChuLmZzLnJlbW92ZU1hdGNoaW5nS2V5cyh0LCByLnJlbW92ZWREb2N1bWVudHMsIHUpLm5leHQoKCgpID0+IG4uZnMuYWRkTWF0Y2hpbmdLZXlzKHQsIHIuYWRkZWREb2N1bWVudHMsIHUpKSkpO1xuICAgICAgICAgICAgbGV0IGMgPSBhLndpdGhTZXF1ZW5jZU51bWJlcih0LmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICBlLnRhcmdldE1pc21hdGNoZXMuaGFzKHUpID8gYyA9IGMud2l0aFJlc3VtZVRva2VuKHB0LkVNUFRZX0JZVEVfU1RSSU5HLCBjdC5taW4oKSkud2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24oY3QubWluKCkpIDogci5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkgPiAwICYmIChjID0gYy53aXRoUmVzdW1lVG9rZW4oci5yZXN1bWVUb2tlbiwgcykpLCBcbiAgICAgICAgICAgIGkgPSBpLmluc2VydCh1LCBjKSwgXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHRhcmdldCBkYXRhIGlmIHRoZXJlIGFyZSB0YXJnZXQgY2hhbmdlcyAob3IgaWZcbiAgICAgICAgICAgIC8vIHN1ZmZpY2llbnQgdGltZSBoYXMgcGFzc2VkIHNpbmNlIHRoZSBsYXN0IHVwZGF0ZSkuXG4gICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmV3VGFyZ2V0RGF0YSBzaG91bGQgYmUgcGVyc2lzdGVkIGR1cmluZyBhbiB1cGRhdGUgb2ZcbiAqIGFuIGFjdGl2ZSB0YXJnZXQuIFRhcmdldERhdGEgc2hvdWxkIGFsd2F5cyBiZSBwZXJzaXN0ZWQgd2hlbiBhIHRhcmdldCBpc1xuICogYmVpbmcgcmVsZWFzZWQgYW5kIHNob3VsZCBub3QgY2FsbCB0aGlzIGZ1bmN0aW9uLlxuICpcbiAqIFdoaWxlIHRoZSB0YXJnZXQgaXMgYWN0aXZlLCBUYXJnZXREYXRhIHVwZGF0ZXMgY2FuIGJlIG9taXR0ZWQgd2hlbiBub3RoaW5nXG4gKiBhYm91dCB0aGUgdGFyZ2V0IGhhcyBjaGFuZ2VkIGV4Y2VwdCBtZXRhZGF0YSBsaWtlIHRoZSByZXN1bWUgdG9rZW4gb3JcbiAqIHNuYXBzaG90IHZlcnNpb24uIE9jY2FzaW9uYWxseSBpdCdzIHdvcnRoIHRoZSBleHRyYSB3cml0ZSB0byBwcmV2ZW50IHRoZXNlXG4gKiB2YWx1ZXMgZnJvbSBnZXR0aW5nIHRvbyBzdGFsZSBhZnRlciBhIGNyYXNoLCBidXQgdGhpcyBkb2Vzbid0IGhhdmUgdG8gYmVcbiAqIHRvbyBmcmVxdWVudC5cbiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBwZXJzaXN0IHRhcmdldCBkYXRhIGlmIHdlIGRvbid0IGFscmVhZHkgaGF2ZSBhIHJlc3VtZSB0b2tlbi5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdC5yZXN1bWVUb2tlbi5hcHByb3hpbWF0ZUJ5dGVTaXplKCkpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICAvLyBEb24ndCBhbGxvdyByZXN1bWUgdG9rZW4gY2hhbmdlcyB0byBiZSBidWZmZXJlZCBpbmRlZmluaXRlbHkuIFRoaXNcbiAgICAgICAgICAgICAgICAvLyBhbGxvd3MgdXMgdG8gYmUgcmVhc29uYWJseSB1cC10by1kYXRlIGFmdGVyIGEgY3Jhc2ggYW5kIGF2b2lkcyBuZWVkaW5nXG4gICAgICAgICAgICAgICAgLy8gdG8gbG9vcCBvdmVyIGFsbCBhY3RpdmUgcXVlcmllcyBvbiBzaHV0ZG93bi4gRXNwZWNpYWxseSBpbiB0aGUgYnJvd3NlclxuICAgICAgICAgICAgICAgIC8vIHdlIG1heSBub3QgZ2V0IHRpbWUgdG8gZG8gYW55dGhpbmcgaW50ZXJlc3Rpbmcgd2hpbGUgdGhlIGN1cnJlbnQgdGFiIGlzXG4gICAgICAgICAgICAgICAgLy8gY2xvc2luZy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCkgLSB0LnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpID49IDNlOCkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBpZiB0aGUgb25seSB0aGluZyB0aGF0IGhhcyBjaGFuZ2VkIGFib3V0IGEgdGFyZ2V0IGlzIGl0cyByZXN1bWVcbiAgICAgICAgICAgICAgICAvLyB0b2tlbiBpdCdzIG5vdCB3b3J0aCBwZXJzaXN0aW5nLiBOb3RlIHRoYXQgdGhlIFJlbW90ZVN0b3JlIGtlZXBzIGFuXG4gICAgICAgICAgICAgICAgLy8gaW4tbWVtb3J5IHZpZXcgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFyZ2V0cyB3aGljaCBpbmNsdWRlcyB0aGUgY3VycmVudFxuICAgICAgICAgICAgICAgIC8vIHJlc3VtZSB0b2tlbiwgc28gc3RyZWFtIGZhaWx1cmUgb3IgdXNlciBjaGFuZ2VzIHdpbGwgc3RpbGwgdXNlIGFuXG4gICAgICAgICAgICAgICAgLy8gdXAtdG8tZGF0ZSByZXN1bWUgdG9rZW4gcmVnYXJkbGVzcyBvZiB3aGF0IHdlIGRvIGhlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmFkZGVkRG9jdW1lbnRzLnNpemUgKyBuLm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgKyBuLnJlbW92ZWREb2N1bWVudHMuc2l6ZSA+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIE5vdGlmaWVzIGxvY2FsIHN0b3JlIG9mIHRoZSBjaGFuZ2VkIHZpZXdzIHRvIGxvY2FsbHkgcGluIGRvY3VtZW50cy5cbiAqLyAoYSwgYywgcikgJiYgby5wdXNoKG4uZnMudXBkYXRlVGFyZ2V0RGF0YSh0LCBjKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IHUgPSBRbigpO1xuICAgICAgICAvLyBIQUNLOiBUaGUgb25seSByZWFzb24gd2UgYWxsb3cgYSBudWxsIHNuYXBzaG90IHZlcnNpb24gaXMgc28gdGhhdCB3ZVxuICAgICAgICAvLyBjYW4gc3ludGhlc2l6ZSByZW1vdGUgZXZlbnRzIHdoZW4gd2UgZ2V0IHBlcm1pc3Npb24gZGVuaWVkIGVycm9ycyB3aGlsZVxuICAgICAgICAvLyB0cnlpbmcgdG8gcmVzb2x2ZSB0aGUgc3RhdGUgb2YgYSBsb2NhbGx5IGNhY2hlZCBkb2N1bWVudCB0aGF0IGlzIGluXG4gICAgICAgIC8vIGxpbWJvLlxuICAgICAgICBpZiAoZS5kb2N1bWVudFVwZGF0ZXMuZm9yRWFjaCgocyA9PiB7XG4gICAgICAgICAgICBlLnJlc29sdmVkTGltYm9Eb2N1bWVudHMuaGFzKHMpICYmIG8ucHVzaChuLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnVwZGF0ZUxpbWJvRG9jdW1lbnQodCwgcykpO1xuICAgICAgICB9KSksIFxuICAgICAgICAvLyBFYWNoIGxvb3AgaXRlcmF0aW9uIG9ubHkgYWZmZWN0cyBpdHMgXCJvd25cIiBkb2MsIHNvIGl0J3Mgc2FmZSB0byBnZXQgYWxsIHRoZSByZW1vdGVcbiAgICAgICAgLy8gZG9jdW1lbnRzIGluIGFkdmFuY2UgaW4gYSBzaW5nbGUgY2FsbC5cbiAgICAgICAgby5wdXNoKHVvKHQsIHIsIGUuZG9jdW1lbnRVcGRhdGVzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHUgPSB0O1xuICAgICAgICB9KSkpLCAhcy5pc0VxdWFsKGN0Lm1pbigpKSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG4uZnMuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KS5uZXh0KChlID0+IG4uZnMuc2V0VGFyZ2V0c01ldGFkYXRhKHQsIHQuY3VycmVudFNlcXVlbmNlTnVtYmVyLCBzKSkpO1xuICAgICAgICAgICAgby5wdXNoKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB5aS53YWl0Rm9yKG8pLm5leHQoKCgpID0+IHIuYXBwbHkodCkpKS5uZXh0KCgoKSA9PiBuLmZpLkdzKHQsIHUpKSkubmV4dCgoKCkgPT4gdSkpO1xuICAgIH0pKS50aGVuKCh0ID0+IChuLnVpID0gaSwgdCkpKTtcbn1cblxuLyoqXG4gKiBQb3B1bGF0ZXMgZG9jdW1lbnQgY2hhbmdlIGJ1ZmZlciB3aXRoIGRvY3VtZW50cyBmcm9tIGJhY2tlbmQgb3IgYSBidW5kbGUuXG4gKiBSZXR1cm5zIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHJlc3VsdGluZyBmcm9tIGFwcGx5aW5nIHRob3NlIGRvY3VtZW50cy5cbiAqXG4gKiBAcGFyYW0gdHhuIC0gVHJhbnNhY3Rpb24gdG8gdXNlIHRvIHJlYWQgZXhpc3RpbmcgZG9jdW1lbnRzIGZyb20gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudEJ1ZmZlciAtIERvY3VtZW50IGJ1ZmZlciB0byBjb2xsZWN0IHRoZSByZXN1bHRlZCBjaGFuZ2VzIHRvIGJlXG4gKiAgICAgICAgYXBwbGllZCB0byBzdG9yYWdlLlxuICogQHBhcmFtIGRvY3VtZW50cyAtIERvY3VtZW50cyB0byBiZSBhcHBsaWVkLlxuICogQHBhcmFtIGdsb2JhbFZlcnNpb24gLSBBIGBTbmFwc2hvdFZlcnNpb25gIHJlcHJlc2VudGluZyB0aGUgcmVhZCB0aW1lIGlmIGFsbFxuICogICAgICAgIGRvY3VtZW50cyBoYXZlIHRoZSBzYW1lIHJlYWQgdGltZS5cbiAqIEBwYXJhbSBkb2N1bWVudFZlcnNpb25zIC0gQSBEb2N1bWVudEtleS10by1TbmFwc2hvdFZlcnNpb24gbWFwIGlmIGRvY3VtZW50c1xuICogICAgICAgIGhhdmUgdGhlaXIgb3duIHJlYWQgdGltZS5cbiAqXG4gKiBOb3RlOiB0aGlzIGZ1bmN0aW9uIHdpbGwgdXNlIGBkb2N1bWVudFZlcnNpb25zYCBpZiBpdCBpcyBkZWZpbmVkO1xuICogd2hlbiBpdCBpcyBub3QgZGVmaW5lZCwgcmVzb3J0cyB0byBgZ2xvYmFsVmVyc2lvbmAuXG4gKi8gZnVuY3Rpb24gdW8odCwgZSwgbikge1xuICAgIGxldCBzID0gWW4oKTtcbiAgICByZXR1cm4gbi5mb3JFYWNoKCh0ID0+IHMgPSBzLmFkZCh0KSkpLCBlLmdldEVudHJpZXModCwgcykubmV4dCgodCA9PiB7XG4gICAgICAgIGxldCBzID0gUW4oKTtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LmdldChuKTtcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSBvcmRlciBvZiB0aGUgc3RlcHMgYmVsb3cgaXMgaW1wb3J0YW50LCBzaW5jZSB3ZSB3YW50XG4gICAgICAgICAgICAvLyB0byBlbnN1cmUgdGhhdCByZWplY3RlZCBsaW1ibyByZXNvbHV0aW9ucyAod2hpY2ggZmFicmljYXRlXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSkgbmV2ZXIgYWRkIGRvY3VtZW50cyB0b1xuICAgICAgICAgICAgLy8gY2FjaGUuXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmlzTm9Eb2N1bWVudCgpICYmIGkudmVyc2lvbi5pc0VxdWFsKGN0Lm1pbigpKSA/IChcbiAgICAgICAgICAgIC8vIE5vRG9jdW1lbnRzIHdpdGggU25hcHNob3RWZXJzaW9uLm1pbigpIGFyZSB1c2VkIGluIG1hbnVmYWN0dXJlZFxuICAgICAgICAgICAgLy8gZXZlbnRzLiBXZSByZW1vdmUgdGhlc2UgZG9jdW1lbnRzIGZyb20gY2FjaGUgc2luY2Ugd2UgbG9zdFxuICAgICAgICAgICAgLy8gYWNjZXNzLlxuICAgICAgICAgICAgZS5yZW1vdmVFbnRyeShuLCBpLnJlYWRUaW1lKSwgcyA9IHMuaW5zZXJ0KG4sIGkpKSA6ICFyLmlzVmFsaWREb2N1bWVudCgpIHx8IGkudmVyc2lvbi5jb21wYXJlVG8oci52ZXJzaW9uKSA+IDAgfHwgMCA9PT0gaS52ZXJzaW9uLmNvbXBhcmVUbyhyLnZlcnNpb24pICYmIHIuaGFzUGVuZGluZ1dyaXRlcyA/IChlLmFkZEVudHJ5KGkpLCBcbiAgICAgICAgICAgIHMgPSBzLmluc2VydChuLCBpKSkgOiBPKFwiTG9jYWxTdG9yZVwiLCBcIklnbm9yaW5nIG91dGRhdGVkIHdhdGNoIHVwZGF0ZSBmb3IgXCIsIG4sIFwiLiBDdXJyZW50IHZlcnNpb246XCIsIHIudmVyc2lvbiwgXCIgV2F0Y2ggdmVyc2lvbjpcIiwgaS52ZXJzaW9uKTtcbiAgICAgICAgfSkpLCBzO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBtdXRhdGlvbiBiYXRjaCBhZnRlciB0aGUgcGFzc2VkIGluIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlXG4gKiBvciBudWxsIGlmIGVtcHR5LlxuICogQHBhcmFtIGFmdGVyQmF0Y2hJZCAtIElmIHByb3ZpZGVkLCB0aGUgYmF0Y2ggdG8gc2VhcmNoIGFmdGVyLlxuICogQHJldHVybnMgVGhlIG5leHQgbXV0YXRpb24gb3IgbnVsbCBpZiB0aGVyZSB3YXNuJ3Qgb25lLlxuICovXG5mdW5jdGlvbiBhbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgbmV4dCBtdXRhdGlvbiBiYXRjaFwiLCBcInJlYWRvbmx5XCIsICh0ID0+ICh2b2lkIDAgPT09IGUgJiYgKGUgPSAtMSksIFxuICAgIG4uQnMuZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodCwgZSkpKSk7XG59XG5cbi8qKlxuICogUmVhZHMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgYSBEb2N1bWVudCB3aXRoIGEgZ2l2ZW4ga2V5IG9yIG51bGwgaWYgbm90XG4gKiBmb3VuZCAtIHVzZWQgZm9yIHRlc3RpbmcuXG4gKi9cbi8qKlxuICogQXNzaWducyB0aGUgZ2l2ZW4gdGFyZ2V0IGFuIGludGVybmFsIElEIHNvIHRoYXQgaXRzIHJlc3VsdHMgY2FuIGJlIHBpbm5lZCBzb1xuICogdGhleSBkb24ndCBnZXQgR0MnZC4gQSB0YXJnZXQgbXVzdCBiZSBhbGxvY2F0ZWQgaW4gdGhlIGxvY2FsIHN0b3JlIGJlZm9yZVxuICogdGhlIHN0b3JlIGNhbiBiZSB1c2VkIHRvIG1hbmFnZSBpdHMgdmlldy5cbiAqXG4gKiBBbGxvY2F0aW5nIGFuIGFscmVhZHkgYWxsb2NhdGVkIGBUYXJnZXRgIHdpbGwgcmV0dXJuIHRoZSBleGlzdGluZyBgVGFyZ2V0RGF0YWBcbiAqIGZvciB0aGF0IGBUYXJnZXRgLlxuICovXG5mdW5jdGlvbiBjbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBbGxvY2F0ZSB0YXJnZXRcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4ge1xuICAgICAgICBsZXQgcztcbiAgICAgICAgcmV0dXJuIG4uZnMuZ2V0VGFyZ2V0RGF0YSh0LCBlKS5uZXh0KChpID0+IGkgPyAoXG4gICAgICAgIC8vIFRoaXMgdGFyZ2V0IGhhcyBiZWVuIGxpc3RlbmVkIHRvIHByZXZpb3VzbHksIHNvIHJldXNlIHRoZVxuICAgICAgICAvLyBwcmV2aW91cyB0YXJnZXRJRC5cbiAgICAgICAgLy8gVE9ETyhtY2cpOiBmcmVzaGVuIGxhc3QgYWNjZXNzZWQgZGF0ZT9cbiAgICAgICAgcyA9IGksIHlpLnJlc29sdmUocykpIDogbi5mcy5hbGxvY2F0ZVRhcmdldElkKHQpLm5leHQoKGkgPT4gKHMgPSBuZXcgTmkoZSwgaSwgMCAvKiBMaXN0ZW4gKi8gLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIFxuICAgICAgICBuLmZzLmFkZFRhcmdldERhdGEodCwgcykubmV4dCgoKCkgPT4gcykpKSkpKSk7XG4gICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAvLyBJZiBNdWx0aS1UYWIgaXMgZW5hYmxlZCwgdGhlIGV4aXN0aW5nIHRhcmdldCBkYXRhIG1heSBiZSBuZXdlciB0aGFuXG4gICAgICAgIC8vIHRoZSBpbi1tZW1vcnkgZGF0YVxuICAgICAgICBjb25zdCBzID0gbi51aS5nZXQodC50YXJnZXRJZCk7XG4gICAgICAgIHJldHVybiAobnVsbCA9PT0gcyB8fCB0LnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8ocy5zbmFwc2hvdFZlcnNpb24pID4gMCkgJiYgKG4udWkgPSBuLnVpLmluc2VydCh0LnRhcmdldElkLCB0KSwgXG4gICAgICAgIG4uYWkuc2V0KGUsIHQudGFyZ2V0SWQpKSwgdDtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBhcyBzZWVuIGJ5IHRoZSBMb2NhbFN0b3JlLCBpbmNsdWRpbmcgdXBkYXRlcyB0aGF0IG1heVxuICogaGF2ZSBub3QgeWV0IGJlZW4gcGVyc2lzdGVkIHRvIHRoZSBUYXJnZXRDYWNoZS5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbi8qKlxuICogVW5waW5zIGFsbCB0aGUgZG9jdW1lbnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZlxuICogYGtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhYCBpcyBzZXQgdG8gZmFsc2UgYW5kIEVhZ2VyIEdDIGVuYWJsZWQsIHRoZSBtZXRob2RcbiAqIGRpcmVjdGx5IHJlbW92ZXMgdGhlIGFzc29jaWF0ZWQgdGFyZ2V0IGRhdGEgZnJvbSB0aGUgdGFyZ2V0IGNhY2hlLlxuICpcbiAqIFJlbGVhc2luZyBhIG5vbi1leGlzdGluZyBgVGFyZ2V0YCBpcyBhIG5vLW9wLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgbXVsdGktdGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBobyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEsodCksIGkgPSBzLnVpLmdldChlKSwgciA9IG4gPyBcInJlYWR3cml0ZVwiIDogXCJyZWFkd3JpdGUtcHJpbWFyeVwiO1xuICAgIHRyeSB7XG4gICAgICAgIG4gfHwgYXdhaXQgcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlbGVhc2UgdGFyZ2V0XCIsIHIsICh0ID0+IHMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlVGFyZ2V0KHQsIGkpKSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBpZiAoIUFpKHQpKSB0aHJvdyB0O1xuICAgICAgICAvLyBBbGwgYHJlbGVhc2VUYXJnZXRgIGRvZXMgaXMgcmVjb3JkIHRoZSBmaW5hbCBtZXRhZGF0YSBzdGF0ZSBmb3IgdGhlXG4gICAgICAgIC8vIHRhcmdldCwgYnV0IHdlJ3ZlIGJlZW4gcmVjb3JkaW5nIHRoaXMgcGVyaW9kaWNhbGx5IGR1cmluZyB0YXJnZXRcbiAgICAgICAgLy8gYWN0aXZpdHkuIElmIHdlIGxvc2UgdGhpcyB3cml0ZSB0aGlzIGNvdWxkIGNhdXNlIGEgdmVyeSBzbGlnaHRcbiAgICAgICAgLy8gZGlmZmVyZW5jZSBpbiB0aGUgb3JkZXIgb2YgdGFyZ2V0IGRlbGV0aW9uIGR1cmluZyBHQywgYnV0IHdlXG4gICAgICAgIC8vIGRvbid0IGRlZmluZSBleGFjdCBMUlUgc2VtYW50aWNzIHNvIHRoaXMgaXMgYWNjZXB0YWJsZS5cbiAgICAgICAgTyhcIkxvY2FsU3RvcmVcIiwgYEZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgbnVtYmVycyBmb3IgdGFyZ2V0ICR7ZX06ICR7dH1gKTtcbiAgICB9XG4gICAgcy51aSA9IHMudWkucmVtb3ZlKGUpLCBzLmFpLmRlbGV0ZShpLnRhcmdldCk7XG59XG5cbi8qKlxuICogUnVucyB0aGUgc3BlY2lmaWVkIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIGFuZCByZXR1cm5zIHRoZSByZXN1bHRzLFxuICogcG90ZW50aWFsbHkgdGFraW5nIGFkdmFudGFnZSBvZiBxdWVyeSBkYXRhIGZyb20gcHJldmlvdXMgZXhlY3V0aW9ucyAoc3VjaFxuICogYXMgdGhlIHNldCBvZiByZW1vdGUga2V5cykuXG4gKlxuICogQHBhcmFtIHVzZVByZXZpb3VzUmVzdWx0cyAtIFdoZXRoZXIgcmVzdWx0cyBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgY2FuXG4gKiBiZSB1c2VkIHRvIG9wdGltaXplIHRoaXMgcXVlcnkgZXhlY3V0aW9uLlxuICovIGZ1bmN0aW9uIGxvKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gSyh0KTtcbiAgICBsZXQgaSA9IGN0Lm1pbigpLCByID0gWW4oKTtcbiAgICByZXR1cm4gcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkV4ZWN1dGUgcXVlcnlcIiwgXCJyZWFkb25seVwiLCAodCA9PiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBLKHQpLCBpID0gcy5haS5nZXQobik7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGkgPyB5aS5yZXNvbHZlKHMudWkuZ2V0KGkpKSA6IHMuZnMuZ2V0VGFyZ2V0RGF0YShlLCBuKTtcbiAgICB9KHMsIHQsIEhlKGUpKS5uZXh0KChlID0+IHtcbiAgICAgICAgaWYgKGUpIHJldHVybiBpID0gZS5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCBzLmZzLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgciA9IHQ7XG4gICAgICAgIH0pKTtcbiAgICB9KSkubmV4dCgoKCkgPT4gcy5vaS5Rcyh0LCBlLCBuID8gaSA6IGN0Lm1pbigpLCBuID8gciA6IFluKCkpKSkubmV4dCgodCA9PiAod28ocywgZW4oZSksIHQpLCBcbiAgICB7XG4gICAgICAgIGRvY3VtZW50czogdCxcbiAgICAgICAgX2k6IHJcbiAgICB9KSkpKSk7XG59XG5cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5mdW5jdGlvbiBmbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCksIHMgPSBLKG4uZnMpLCBpID0gbi51aS5nZXQoZSk7XG4gICAgcmV0dXJuIGkgPyBQcm9taXNlLnJlc29sdmUoaS50YXJnZXQpIDogbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCB0YXJnZXQgZGF0YVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHMuRXQodCwgZSkubmV4dCgodCA9PiB0ID8gdC50YXJnZXQgOiBudWxsKSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHVwZGF0ZWQgc2luY2UgdGhlIGxhc3QgY2FsbC5cbiAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGNhbGwsIHJldHVybnMgdGhlIHNldCBvZiBjaGFuZ2VzIHNpbmNlIGNsaWVudFxuICogaW5pdGlhbGl6YXRpb24uIEZ1cnRoZXIgaW52b2NhdGlvbnMgd2lsbCByZXR1cm4gZG9jdW1lbnQgdGhhdCBoYXZlIGNoYW5nZWRcbiAqIHNpbmNlIHRoZSBwcmlvciBjYWxsLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX28odCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpLCBzID0gbi5jaS5nZXQoZSkgfHwgY3QubWluKCk7XG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IG1heGltdW0gcmVhZCB0aW1lIGZvciB0aGUgY29sbGVjdGlvbi4gVGhpcyBzaG91bGQgYWx3YXlzXG4gICAgLy8gZXhpc3QsIGJ1dCB0byByZWR1Y2UgdGhlIGNoYW5jZSBmb3IgcmVncmVzc2lvbnMgd2UgZGVmYXVsdCB0b1xuICAgIC8vIFNuYXBzaG90VmVyc2lvbi5NaW4oKVxuICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBDb25zaWRlciByZW1vdmluZyB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgbmV3IGRvY3VtZW50IGNoYW5nZXNcIiwgXCJyZWFkb25seVwiLCAodCA9PiBuLmhpLmdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgYWUocywgLTEpLCBcbiAgICAvKiBsaW1pdD0gKi8gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpKSkudGhlbigodCA9PiAod28obiwgZSwgdCksIHQpKSk7XG59XG5cbi8qKiBTZXRzIHRoZSBjb2xsZWN0aW9uIGdyb3VwJ3MgbWF4aW11bSByZWFkIHRpbWUgZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnRzLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIHdvKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IGN0Lm1pbigpO1xuICAgIG4uZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgZS5yZWFkVGltZS5jb21wYXJlVG8ocykgPiAwICYmIChzID0gZS5yZWFkVGltZSk7XG4gICAgfSkpLCB0LmNpLnNldChlLCBzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHRhcmdldCB1c2luZyB0aGUgZ2l2ZW4gYnVuZGxlIG5hbWUsIHdoaWNoIHdpbGwgYmUgdXNlZCB0b1xuICogaG9sZCB0aGUga2V5cyBvZiBhbGwgZG9jdW1lbnRzIGZyb20gdGhlIGJ1bmRsZSBpbiBxdWVyeS1kb2N1bWVudCBtYXBwaW5ncy5cbiAqIFRoaXMgZW5zdXJlcyB0aGF0IHRoZSBsb2FkZWQgZG9jdW1lbnRzIGRvIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWRcbiAqIHJpZ2h0IGF3YXkuXG4gKi9cbi8qKlxuICogQXBwbGllcyB0aGUgZG9jdW1lbnRzIGZyb20gYSBidW5kbGUgdG8gdGhlIFwiZ3JvdW5kLXN0YXRlXCIgKHJlbW90ZSlcbiAqIGRvY3VtZW50cy5cbiAqXG4gKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcbiAqIHF1ZXVlLlxuICovXG5hc3luYyBmdW5jdGlvbiBtbyh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IEsodCk7XG4gICAgbGV0IHIgPSBZbigpLCBvID0gUW4oKTtcbiAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xuICAgICAgICBjb25zdCBuID0gZS53aSh0Lm1ldGFkYXRhLm5hbWUpO1xuICAgICAgICB0LmRvY3VtZW50ICYmIChyID0gci5hZGQobikpO1xuICAgICAgICBjb25zdCBzID0gZS5taSh0KTtcbiAgICAgICAgcy5zZXRSZWFkVGltZShlLmdpKHQubWV0YWRhdGEucmVhZFRpbWUpKSwgbyA9IG8uaW5zZXJ0KG4sIHMpO1xuICAgIH1cbiAgICBjb25zdCB1ID0gaS5oaS5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgIH0pLCBhID0gYXdhaXQgY28oaSwgZnVuY3Rpb24odCkge1xuICAgICAgICAvLyBJdCBpcyBPSyB0aGF0IHRoZSBwYXRoIHVzZWQgZm9yIHRoZSBxdWVyeSBpcyBub3QgdmFsaWQsIGJlY2F1c2UgdGhpcyB3aWxsXG4gICAgICAgIC8vIG5vdCBiZSByZWFkIGFuZCBxdWVyaWVkLlxuICAgICAgICByZXR1cm4gSGUoS2UoX3QuZnJvbVN0cmluZyhgX19idW5kbGVfXy9kb2NzLyR7dH1gKSkpO1xuICAgIH0ocykpO1xuICAgIC8vIEFsbG9jYXRlcyBhIHRhcmdldCB0byBob2xkIGFsbCBkb2N1bWVudCBrZXlzIGZyb20gdGhlIGJ1bmRsZSwgc3VjaCB0aGF0XG4gICAgLy8gdGhleSB3aWxsIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWQgcmlnaHQgYXdheS5cbiAgICAgICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSBidW5kbGUgZG9jdW1lbnRzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHVvKHQsIHUsIG8pLm5leHQoKGUgPT4gKHUuYXBwbHkodCksIFxuICAgIGUpKSkubmV4dCgoZSA9PiBpLmZzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGEudGFyZ2V0SWQpLm5leHQoKCgpID0+IGkuZnMuYWRkTWF0Y2hpbmdLZXlzKHQsIHIsIGEudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5maS5Hcyh0LCBlKSkpLm5leHQoKCgpID0+IGUpKSkpKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBib29sZWFuIHRvIGluZGljYXRlIGlmIHRoZSBnaXZlbiBidW5kbGUgaGFzIGFscmVhZHlcbiAqIGJlZW4gbG9hZGVkIGFuZCB0aGUgY3JlYXRlIHRpbWUgaXMgbmV3ZXIgdGhhbiB0aGUgY3VycmVudCBsb2FkaW5nIGJ1bmRsZS5cbiAqL1xuLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYE5hbWVkUXVlcnlgIHRvIGxvY2FsIHBlcnNpc3RlbmNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBnbyh0LCBlLCBuID0gWW4oKSkge1xuICAgIC8vIEFsbG9jYXRlIGEgdGFyZ2V0IGZvciB0aGUgbmFtZWQgcXVlcnkgc3VjaCB0aGF0IGl0IGNhbiBiZSByZXN1bWVkXG4gICAgLy8gZnJvbSBhc3NvY2lhdGVkIHJlYWQgdGltZSBpZiB1c2VycyB1c2UgaXQgdG8gbGlzdGVuLlxuICAgIC8vIE5PVEU6IHRoaXMgYWxzbyBtZWFucyBpZiBubyBjb3JyZXNwb25kaW5nIHRhcmdldCBleGlzdHMsIHRoZSBuZXcgdGFyZ2V0XG4gICAgLy8gd2lsbCByZW1haW4gYWN0aXZlIGFuZCB3aWxsIG5vdCBnZXQgY29sbGVjdGVkLCB1bmxlc3MgdXNlcnMgaGFwcGVuIHRvXG4gICAgLy8gdW5saXN0ZW4gdGhlIHF1ZXJ5IHNvbWVob3cuXG4gICAgY29uc3QgcyA9IGF3YWl0IGNvKHQsIEhlKEtpKGUuYnVuZGxlZFF1ZXJ5KSkpLCBpID0gSyh0KTtcbiAgICByZXR1cm4gaS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlNhdmUgbmFtZWQgcXVlcnlcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4ge1xuICAgICAgICBjb25zdCByID0gd3MoZS5yZWFkVGltZSk7XG4gICAgICAgIC8vIFNpbXBseSBzYXZlIHRoZSBxdWVyeSBpdHNlbGYgaWYgaXQgaXMgb2xkZXIgdGhhbiB3aGF0IHRoZSBTREsgYWxyZWFkeVxuICAgICAgICAvLyBoYXMuXG4gICAgICAgICAgICAgICAgaWYgKHMuc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhyKSA+PSAwKSByZXR1cm4gaS5fcy5zYXZlTmFtZWRRdWVyeSh0LCBlKTtcbiAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIHRhcmdldCBkYXRhIGJlY2F1c2UgdGhlIHF1ZXJ5IGZyb20gdGhlIGJ1bmRsZSBpcyBuZXdlci5cbiAgICAgICAgICAgICAgICBjb25zdCBvID0gcy53aXRoUmVzdW1lVG9rZW4ocHQuRU1QVFlfQllURV9TVFJJTkcsIHIpO1xuICAgICAgICByZXR1cm4gaS51aSA9IGkudWkuaW5zZXJ0KG8udGFyZ2V0SWQsIG8pLCBpLmZzLnVwZGF0ZVRhcmdldERhdGEodCwgbykubmV4dCgoKCkgPT4gaS5mcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBzLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuZnMuYWRkTWF0Y2hpbmdLZXlzKHQsIG4sIHMudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5fcy5zYXZlTmFtZWRRdWVyeSh0LCBlKSkpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgeW8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5NID0gdCwgdGhpcy55aSA9IG5ldyBNYXAsIHRoaXMucGkgPSBuZXcgTWFwO1xuICAgIH1cbiAgICBnZXRCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKHRoaXMueWkuZ2V0KGUpKTtcbiAgICB9XG4gICAgc2F2ZUJ1bmRsZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgLyoqIERlY29kZXMgYSBCdW5kbGVNZXRhZGF0YSBwcm90byBpbnRvIGEgQnVuZGxlTWV0YWRhdGEgb2JqZWN0LiAqL1xuICAgICAgICB2YXIgbjtcbiAgICAgICAgcmV0dXJuIHRoaXMueWkuc2V0KGUuaWQsIHtcbiAgICAgICAgICAgIGlkOiAobiA9IGUpLmlkLFxuICAgICAgICAgICAgdmVyc2lvbjogbi52ZXJzaW9uLFxuICAgICAgICAgICAgY3JlYXRlVGltZTogd3Mobi5jcmVhdGVUaW1lKVxuICAgICAgICB9KSwgeWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXROYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUodGhpcy5waS5nZXQoZSkpO1xuICAgIH1cbiAgICBzYXZlTmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpLnNldChlLm5hbWUsIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogdC5uYW1lLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiBLaSh0LmJ1bmRsZWRRdWVyeSksXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IHdzKHQucmVhZFRpbWUpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KGUpKSwgeWkucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIERvY3VtZW50T3ZlcmxheUNhY2hlLlxuICovIGNsYXNzIHBvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBtYXAgc29ydGVkIGJ5IERvY3VtZW50S2V5LCB3aG9zZSB2YWx1ZSBpcyBhIHBhaXIgb2YgdGhlIGxhcmdlc3QgYmF0Y2ggaWRcbiAgICAgICAgLy8gZm9yIHRoZSBvdmVybGF5IGFuZCB0aGUgb3ZlcmxheSBpdHNlbGYuXG4gICAgICAgIHRoaXMub3ZlcmxheXMgPSBuZXcgZmUoeHQuY29tcGFyYXRvciksIHRoaXMuSWkgPSBuZXcgTWFwO1xuICAgIH1cbiAgICBnZXRPdmVybGF5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUodGhpcy5vdmVybGF5cy5nZXQoZSkpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgdGhpcy5YdCh0LCBlLCBzKTtcbiAgICAgICAgfSkpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLklpLmdldChuKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gcyAmJiAocy5mb3JFYWNoKCh0ID0+IHRoaXMub3ZlcmxheXMgPSB0aGlzLm92ZXJsYXlzLnJlbW92ZSh0KSkpLCBcbiAgICAgICAgdGhpcy5JaS5kZWxldGUobikpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB6bigpLCBpID0gZS5sZW5ndGggKyAxLCByID0gbmV3IHh0KGUuY2hpbGQoXCJcIikpLCBvID0gdGhpcy5vdmVybGF5cy5nZXRJdGVyYXRvckZyb20ocik7XG4gICAgICAgIGZvciAoO28uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBvLmdldE5leHQoKS52YWx1ZSwgciA9IHQuZ2V0S2V5KCk7XG4gICAgICAgICAgICBpZiAoIWUuaXNQcmVmaXhPZihyLnBhdGgpKSBicmVhaztcbiAgICAgICAgICAgIC8vIERvY3VtZW50cyBmcm9tIHN1Yi1jb2xsZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgci5wYXRoLmxlbmd0aCA9PT0gaSAmJiAodC5sYXJnZXN0QmF0Y2hJZCA+IG4gJiYgcy5zZXQodC5nZXRLZXkoKSwgdCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKHMpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGxldCBpID0gbmV3IGZlKCgodCwgZSkgPT4gdCAtIGUpKTtcbiAgICAgICAgY29uc3QgciA9IHRoaXMub3ZlcmxheXMuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ci5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHIuZ2V0TmV4dCgpLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHQuZ2V0S2V5KCkuZ2V0Q29sbGVjdGlvbkdyb3VwKCkgPT09IGUgJiYgdC5sYXJnZXN0QmF0Y2hJZCA+IG4pIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IGkuZ2V0KHQubGFyZ2VzdEJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIG51bGwgPT09IGUgJiYgKGUgPSB6bigpLCBpID0gaS5pbnNlcnQodC5sYXJnZXN0QmF0Y2hJZCwgZSkpLCBlLnNldCh0LmdldEtleSgpLCB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvID0gem4oKSwgdSA9IGkuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7dS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgaWYgKHUuZ2V0TmV4dCgpLnZhbHVlLmZvckVhY2goKCh0LCBlKSA9PiBvLnNldCh0LCBlKSkpLCBvLnNpemUoKSA+PSBzKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShvKTtcbiAgICB9XG4gICAgWHQodCwgZSwgbikge1xuICAgICAgICBpZiAobnVsbCA9PT0gbikgcmV0dXJuO1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGFzc29jaWF0aW9uIG9mIHRoZSBvdmVybGF5IHRvIGl0cyBiYXRjaCBpZC5cbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdGhpcy5vdmVybGF5cy5nZXQobi5rZXkpO1xuICAgICAgICBpZiAobnVsbCAhPT0gcykge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuSWkuZ2V0KHMubGFyZ2VzdEJhdGNoSWQpLmRlbGV0ZShuLmtleSk7XG4gICAgICAgICAgICB0aGlzLklpLnNldChzLmxhcmdlc3RCYXRjaElkLCB0KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm92ZXJsYXlzID0gdGhpcy5vdmVybGF5cy5pbnNlcnQobi5rZXksIG5ldyB4aShlLCBuKSk7XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgYXNzb2NpYXRpb24gb2YgdGhpcyBvdmVybGF5IHRvIHRoZSBnaXZlbiBsYXJnZXN0QmF0Y2hJZC5cbiAgICAgICAgbGV0IGkgPSB0aGlzLklpLmdldChlKTtcbiAgICAgICAgdm9pZCAwID09PSBpICYmIChpID0gWW4oKSwgdGhpcy5JaS5zZXQoZSwgaSkpLCB0aGlzLklpLnNldChlLCBpLmFkZChuLmtleSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBmcm9tIHNvbWUga2luZCBvZiBudW1iZXJlZCBlbnRpdHlcbiAqIChlaXRoZXIgYSB0YXJnZXQgSUQgb3IgYmF0Y2ggSUQpLiBBcyByZWZlcmVuY2VzIGFyZSBhZGRlZCB0byBvciByZW1vdmVkIGZyb21cbiAqIHRoZSBzZXQgY29ycmVzcG9uZGluZyBldmVudHMgYXJlIGVtaXR0ZWQgdG8gYSByZWdpc3RlcmVkIGdhcmJhZ2UgY29sbGVjdG9yLlxuICpcbiAqIEVhY2ggcmVmZXJlbmNlIGlzIHJlcHJlc2VudGVkIGJ5IGEgRG9jdW1lbnRSZWZlcmVuY2Ugb2JqZWN0LiBFYWNoIG9mIHRoZW1cbiAqIGNvbnRhaW5zIGVub3VnaCBpbmZvcm1hdGlvbiB0byB1bmlxdWVseSBpZGVudGlmeSB0aGUgcmVmZXJlbmNlLiBUaGV5IGFyZSBhbGxcbiAqIHN0b3JlZCBwcmltYXJpbHkgaW4gYSBzZXQgc29ydGVkIGJ5IGtleS4gQSBkb2N1bWVudCBpcyBjb25zaWRlcmVkIGdhcmJhZ2UgaWZcbiAqIHRoZXJlJ3Mgbm8gcmVmZXJlbmNlcyBpbiB0aGF0IHNldCAodGhpcyBjYW4gYmUgZWZmaWNpZW50bHkgY2hlY2tlZCB0aGFua3MgdG9cbiAqIHNvcnRpbmcgYnkga2V5KS5cbiAqXG4gKiBSZWZlcmVuY2VTZXQgYWxzbyBrZWVwcyBhIHNlY29uZGFyeSBzZXQgdGhhdCBjb250YWlucyByZWZlcmVuY2VzIHNvcnRlZCBieVxuICogSURzLiBUaGlzIG9uZSBpcyB1c2VkIHRvIGVmZmljaWVudGx5IGltcGxlbWVudCByZW1vdmFsIG9mIGFsbCByZWZlcmVuY2VzIGJ5XG4gKiBzb21lIHRhcmdldCBJRC5cbiAqLyBjbGFzcyBJbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkga2V5LlxuICAgICAgICB0aGlzLlRpID0gbmV3IHdlKFRvLkVpKSwgXG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkgdGFyZ2V0IGlkLlxuICAgICAgICB0aGlzLkFpID0gbmV3IHdlKFRvLlJpKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlIHNldCBjb250YWlucyBubyByZWZlcmVuY2VzLiAqLyAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5UaS5pc0VtcHR5KCk7XG4gICAgfVxuICAgIC8qKiBBZGRzIGEgcmVmZXJlbmNlIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkgZm9yIHRoZSBnaXZlbiBJRC4gKi8gICAgYWRkUmVmZXJlbmNlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBUbyh0LCBlKTtcbiAgICAgICAgdGhpcy5UaSA9IHRoaXMuVGkuYWRkKG4pLCB0aGlzLkFpID0gdGhpcy5BaS5hZGQobik7XG4gICAgfVxuICAgIC8qKiBBZGQgcmVmZXJlbmNlcyB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5cyBmb3IgdGhlIGdpdmVuIElELiAqLyAgICBiaSh0LCBlKSB7XG4gICAgICAgIHQuZm9yRWFjaCgodCA9PiB0aGlzLmFkZFJlZmVyZW5jZSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgcmVmZXJlbmNlIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkgZm9yIHRoZSBnaXZlblxuICAgICAqIElELlxuICAgICAqLyAgICByZW1vdmVSZWZlcmVuY2UodCwgZSkge1xuICAgICAgICB0aGlzLlBpKG5ldyBUbyh0LCBlKSk7XG4gICAgfVxuICAgIFZpKHQsIGUpIHtcbiAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMucmVtb3ZlUmVmZXJlbmNlKHQsIGUpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyBhbGwgcmVmZXJlbmNlcyB3aXRoIGEgZ2l2ZW4gSUQuIENhbGxzIHJlbW92ZVJlZigpIGZvciBlYWNoIGtleVxuICAgICAqIHJlbW92ZWQuXG4gICAgICovICAgIHZpKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyB4dChuZXcgX3QoW10pKSwgbiA9IG5ldyBUbyhlLCB0KSwgcyA9IG5ldyBUbyhlLCB0ICsgMSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQWkuZm9yRWFjaEluUmFuZ2UoWyBuLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuUGkodCksIGkucHVzaCh0LmtleSk7XG4gICAgICAgIH0pKSwgaTtcbiAgICB9XG4gICAgU2koKSB7XG4gICAgICAgIHRoaXMuVGkuZm9yRWFjaCgodCA9PiB0aGlzLlBpKHQpKSk7XG4gICAgfVxuICAgIFBpKHQpIHtcbiAgICAgICAgdGhpcy5UaSA9IHRoaXMuVGkuZGVsZXRlKHQpLCB0aGlzLkFpID0gdGhpcy5BaS5kZWxldGUodCk7XG4gICAgfVxuICAgIERpKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyB4dChuZXcgX3QoW10pKSwgbiA9IG5ldyBUbyhlLCB0KSwgcyA9IG5ldyBUbyhlLCB0ICsgMSk7XG4gICAgICAgIGxldCBpID0gWW4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQWkuZm9yRWFjaEluUmFuZ2UoWyBuLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgIGkgPSBpLmFkZCh0LmtleSk7XG4gICAgICAgIH0pKSwgaTtcbiAgICB9XG4gICAgY29udGFpbnNLZXkodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IFRvKHQsIDApLCBuID0gdGhpcy5UaS5maXJzdEFmdGVyT3JFcXVhbChlKTtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IG4gJiYgdC5pc0VxdWFsKG4ua2V5KTtcbiAgICB9XG59XG5cbmNsYXNzIFRvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgdGhpcy5DaSA9IGU7XG4gICAgfVxuICAgIC8qKiBDb21wYXJlIGJ5IGtleSB0aGVuIGJ5IElEICovICAgIHN0YXRpYyBFaSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB4dC5jb21wYXJhdG9yKHQua2V5LCBlLmtleSkgfHwgcnQodC5DaSwgZS5DaSk7XG4gICAgfVxuICAgIC8qKiBDb21wYXJlIGJ5IElEIHRoZW4gYnkga2V5ICovICAgIHN0YXRpYyBSaSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBydCh0LkNpLCBlLkNpKSB8fCB4dC5jb21wYXJhdG9yKHQua2V5LCBlLmtleSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBFbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzZXQgb2YgYWxsIG11dGF0aW9ucyB0aGF0IGhhdmUgYmVlbiBzZW50IGJ1dCBub3QgeWV0IGJlZW4gYXBwbGllZCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuQnMgPSBbXSwgXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICB0aGlzLnhpID0gMSwgXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xuICAgICAgICB0aGlzLk5pID0gbmV3IHdlKFRvLkVpKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKDAgPT09IHRoaXMuQnMubGVuZ3RoKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLnhpO1xuICAgICAgICB0aGlzLnhpKyssIHRoaXMuQnMubGVuZ3RoID4gMCAmJiB0aGlzLkJzW3RoaXMuQnMubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgRGkoaSwgZSwgbiwgcyk7XG4gICAgICAgIHRoaXMuQnMucHVzaChyKTtcbiAgICAgICAgLy8gVHJhY2sgcmVmZXJlbmNlcyBieSBkb2N1bWVudCBrZXkgYW5kIGluZGV4IGNvbGxlY3Rpb24gcGFyZW50cy5cbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHRoaXMuTmkgPSB0aGlzLk5pLmFkZChuZXcgVG8oZS5rZXksIGkpKSwgdGhpcy5pbmRleE1hbmFnZXIuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgZS5rZXkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShyKTtcbiAgICB9XG4gICAgbG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKHRoaXMua2koZSkpO1xuICAgIH1cbiAgICBnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlICsgMSwgcyA9IHRoaXMuTWkobiksIGkgPSBzIDwgMCA/IDAgOiBzO1xuICAgICAgICAvLyBUaGUgcmVxdWVzdGVkIGJhdGNoSWQgbWF5IHN0aWxsIGJlIG91dCBvZiByYW5nZSBzbyBub3JtYWxpemUgaXQgdG8gdGhlXG4gICAgICAgIC8vIHN0YXJ0IG9mIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4geWkucmVzb2x2ZSh0aGlzLkJzLmxlbmd0aCA+IGkgPyB0aGlzLkJzW2ldIDogbnVsbCk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQoKSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKDAgPT09IHRoaXMuQnMubGVuZ3RoID8gLTEgOiB0aGlzLnhpIC0gMSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKHRoaXMuQnMuc2xpY2UoKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBUbyhlLCAwKSwgcyA9IG5ldyBUbyhlLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpLCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLk5pLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5raSh0LkNpKTtcbiAgICAgICAgICAgIGkucHVzaChlKTtcbiAgICAgICAgfSkpLCB5aS5yZXNvbHZlKGkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5ldyB3ZShydCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBUbyh0LCAwKSwgcyA9IG5ldyBUbyh0LCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xuICAgICAgICAgICAgdGhpcy5OaS5mb3JFYWNoSW5SYW5nZShbIGUsIHMgXSwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIG4gPSBuLmFkZCh0LkNpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLCB5aS5yZXNvbHZlKHRoaXMuT2kobikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIC8vIFVzZSB0aGUgcXVlcnkgcGF0aCBhcyBhIHByZWZpeCBmb3IgdGVzdGluZyBpZiBhIGRvY3VtZW50IG1hdGNoZXMgdGhlXG4gICAgICAgIC8vIHF1ZXJ5LlxuICAgICAgICBjb25zdCBuID0gZS5wYXRoLCBzID0gbi5sZW5ndGggKyAxO1xuICAgICAgICAvLyBDb25zdHJ1Y3QgYSBkb2N1bWVudCByZWZlcmVuY2UgZm9yIGFjdHVhbGx5IHNjYW5uaW5nIHRoZSBpbmRleC4gVW5saWtlXG4gICAgICAgIC8vIHRoZSBwcmVmaXggdGhlIGRvY3VtZW50IGtleSBpbiB0aGlzIHJlZmVyZW5jZSBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2ZcbiAgICAgICAgLy8gc2VnbWVudHMuIFRoZSBlbXB0eSBzZWdtZW50IGNhbiBiZSB1c2VkIGEgc3VmZml4IG9mIHRoZSBxdWVyeSBwYXRoXG4gICAgICAgIC8vIGJlY2F1c2UgaXQgcHJlY2VkZXMgYWxsIG90aGVyIHNlZ21lbnRzIGluIGFuIG9yZGVyZWQgdHJhdmVyc2FsLlxuICAgICAgICBsZXQgaSA9IG47XG4gICAgICAgIHh0LmlzRG9jdW1lbnRLZXkoaSkgfHwgKGkgPSBpLmNoaWxkKFwiXCIpKTtcbiAgICAgICAgY29uc3QgciA9IG5ldyBUbyhuZXcgeHQoaSksIDApO1xuICAgICAgICAvLyBGaW5kIHVuaXF1ZSBiYXRjaElEcyByZWZlcmVuY2VkIGJ5IGFsbCBkb2N1bWVudHMgcG90ZW50aWFsbHkgbWF0Y2hpbmcgdGhlXG4gICAgICAgIC8vIHF1ZXJ5LlxuICAgICAgICAgICAgICAgIGxldCBvID0gbmV3IHdlKHJ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuTmkuZm9yRWFjaFdoaWxlKCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmtleS5wYXRoO1xuICAgICAgICAgICAgcmV0dXJuICEhbi5pc1ByZWZpeE9mKGUpICYmIChcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJyBjYW4ndCBtYXRjaFxuICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICBlLmxlbmd0aCA9PT0gcyAmJiAobyA9IG8uYWRkKHQuQ2kpKSwgITApO1xuICAgICAgICB9KSwgciksIHlpLnJlc29sdmUodGhpcy5PaShvKSk7XG4gICAgfVxuICAgIE9pKHQpIHtcbiAgICAgICAgLy8gQ29uc3RydWN0IGFuIGFycmF5IG9mIG1hdGNoaW5nIGJhdGNoZXMsIHNvcnRlZCBieSBiYXRjaElEIHRvIGVuc3VyZSB0aGF0XG4gICAgICAgIC8vIG11bHRpcGxlIG11dGF0aW9ucyBhZmZlY3RpbmcgdGhlIHNhbWUgZG9jdW1lbnQga2V5IGFyZSBhcHBsaWVkIGluIG9yZGVyLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMua2kodCk7XG4gICAgICAgICAgICBudWxsICE9PSBuICYmIGUucHVzaChuKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgVSgwID09PSB0aGlzLkZpKGUuYmF0Y2hJZCwgXCJyZW1vdmVkXCIpKSwgdGhpcy5Ccy5zaGlmdCgpO1xuICAgICAgICBsZXQgbiA9IHRoaXMuTmk7XG4gICAgICAgIHJldHVybiB5aS5mb3JFYWNoKGUubXV0YXRpb25zLCAocyA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IFRvKHMua2V5LCBlLmJhdGNoSWQpO1xuICAgICAgICAgICAgcmV0dXJuIG4gPSBuLmRlbGV0ZShpKSwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5tYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBzLmtleSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLk5pID0gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBfbih0KSB7XG4gICAgICAgIC8vIE5vLW9wIHNpbmNlIHRoZSBtZW1vcnkgbXV0YXRpb24gcXVldWUgZG9lcyBub3QgbWFpbnRhaW4gYSBzZXBhcmF0ZSBjYWNoZS5cbiAgICB9XG4gICAgY29udGFpbnNLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFRvKGUsIDApLCBzID0gdGhpcy5OaS5maXJzdEFmdGVyT3JFcXVhbChuKTtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUoZS5pc0VxdWFsKHMgJiYgcy5rZXkpKTtcbiAgICB9XG4gICAgcGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ccy5sZW5ndGgsIHlpLnJlc29sdmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZSBhbmQgYXNzZXJ0cyB0aGF0XG4gICAgICogdGhlIHJlc3VsdGluZyBpbmRleCBpcyB3aXRoaW4gdGhlIGJvdW5kcyBvZiB0aGUgcXVldWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYmF0Y2hJZCAtIFRoZSBiYXRjaElkIHRvIHNlYXJjaCBmb3JcbiAgICAgKiBAcGFyYW0gYWN0aW9uIC0gQSBkZXNjcmlwdGlvbiBvZiB3aGF0IHRoZSBjYWxsZXIgaXMgZG9pbmcsIHBocmFzZWQgaW4gcGFzc2l2ZVxuICAgICAqIGZvcm0gKGUuZy4gXCJhY2tub3dsZWRnZWRcIiBpbiBhIHJvdXRpbmUgdGhhdCBhY2tub3dsZWRnZXMgYmF0Y2hlcykuXG4gICAgICovICAgIEZpKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTWkodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWUuIFRoaXMgb3BlcmF0aW9uXG4gICAgICogaXMgTygxKS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBjb21wdXRlZCBpbmRleCBvZiB0aGUgYmF0Y2ggd2l0aCB0aGUgZ2l2ZW4gYmF0Y2hJZCwgYmFzZWQgb25cbiAgICAgKiB0aGUgc3RhdGUgb2YgdGhlIHF1ZXVlLiBOb3RlIHRoaXMgaW5kZXggY2FuIGJlIG5lZ2F0aXZlIGlmIHRoZSByZXF1ZXN0ZWRcbiAgICAgKiBiYXRjaElkIGhhcyBhbHJlYWR5IGJlZW4gcmVtdm9lZCBmcm9tIHRoZSBxdWV1ZSBvciBwYXN0IHRoZSBlbmQgb2YgdGhlXG4gICAgICogcXVldWUgaWYgdGhlIGJhdGNoSWQgaXMgbGFyZ2VyIHRoYW4gdGhlIGxhc3QgYWRkZWQgYmF0Y2guXG4gICAgICovICAgIE1pKHQpIHtcbiAgICAgICAgaWYgKDAgPT09IHRoaXMuQnMubGVuZ3RoKSBcbiAgICAgICAgLy8gQXMgYW4gaW5kZXggdGhpcyBpcyBwYXN0IHRoZSBlbmQgb2YgdGhlIHF1ZXVlXG4gICAgICAgIHJldHVybiAwO1xuICAgICAgICAvLyBFeGFtaW5lIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgdG8gZmlndXJlIG91dCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZVxuICAgICAgICAvLyBiYXRjaElkIGFuZCBpbmRleGVzIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHNpbmNlIHRoZSBxdWV1ZSBpcyBvcmRlcmVkXG4gICAgICAgIC8vIGJ5IGJhdGNoSWQsIGlmIHRoZSBmaXJzdCBiYXRjaCBoYXMgYSBsYXJnZXIgYmF0Y2hJZCB0aGVuIHRoZSByZXF1ZXN0ZWRcbiAgICAgICAgLy8gYmF0Y2hJZCBkb2Vzbid0IGV4aXN0IGluIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gdCAtIHRoaXMuQnNbMF0uYmF0Y2hJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSB2ZXJzaW9uIG9mIGxvb2t1cE11dGF0aW9uQmF0Y2ggdGhhdCBkb2Vzbid0IHJldHVybiBhIHByb21pc2UsIHRoaXMgbWFrZXNcbiAgICAgKiBvdGhlciBmdW5jdGlvbnMgdGhhdCB1c2VzIHRoaXMgY29kZSBlYXNpZXIgdG8gcmVhZCBhbmQgbW9yZSBlZmZpY2VudC5cbiAgICAgKi8gICAga2kodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5NaSh0KTtcbiAgICAgICAgaWYgKGUgPCAwIHx8IGUgPj0gdGhpcy5Ccy5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gdGhpcy5Cc1tlXTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBtZW1vcnktb25seSBSZW1vdGVEb2N1bWVudENhY2hlIGZvciBJbmRleGVkRGIuIFRvIGNvbnN0cnVjdCwgaW52b2tlXG4gKiBgbmV3TWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSgpYC5cbiAqL1xuY2xhc3MgQW8ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzaXplciAtIFVzZWQgdG8gYXNzZXNzIHRoZSBzaXplIG9mIGEgZG9jdW1lbnQuIEZvciBlYWdlciBHQywgdGhpcyBpc1xuICAgICAqIGV4cGVjdGVkIHRvIGp1c3QgcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZlxuICAgICAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy4kaSA9IHQsIFxuICAgICAgICAvKiogVW5kZXJseWluZyBjYWNoZSBvZiBkb2N1bWVudHMgYW5kIHRoZWlyIHJlYWQgdGltZXMuICovXG4gICAgICAgIHRoaXMuZG9jcyA9IG5ldyBmZSh4dC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBTaXplIG9mIGFsbCBjYWNoZWQgZG9jdW1lbnRzLiAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBzZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJ5IHRvIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgY2FjaGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgYWRkRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICBhZGRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IHRoaXMuZG9jcy5nZXQobiksIGkgPSBzID8gcy5zaXplIDogMCwgciA9IHRoaXMuJGkoZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3MgPSB0aGlzLmRvY3MuaW5zZXJ0KG4sIHtcbiAgICAgICAgICAgIGRvY3VtZW50OiBlLm11dGFibGVDb3B5KCksXG4gICAgICAgICAgICBzaXplOiByXG4gICAgICAgIH0pLCB0aGlzLnNpemUgKz0gciAtIGksIHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4ucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgZW50cnkgZnJvbSB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYHJlbW92ZUVudHJ5YCBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvY3MuZ2V0KHQpO1xuICAgICAgICBlICYmICh0aGlzLmRvY3MgPSB0aGlzLmRvY3MucmVtb3ZlKHQpLCB0aGlzLnNpemUgLT0gZS5zaXplKTtcbiAgICB9XG4gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kb2NzLmdldChlKTtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUobiA/IG4uZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IG5lLm5ld0ludmFsaWREb2N1bWVudChlKSk7XG4gICAgfVxuICAgIGdldEVudHJpZXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IFFuKCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgZSA/IGUuZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IG5lLm5ld0ludmFsaWREb2N1bWVudCh0KSk7XG4gICAgICAgIH0pKSwgeWkucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNvbGxlY3Rpb24odCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IFFuKCk7XG4gICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3cgZG93blxuICAgICAgICAvLyB0aGUgZG9jdW1lbnRzIHdlIG5lZWQgdG8gbWF0Y2ggdGhlIHF1ZXJ5IGFnYWluc3QuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyB4dChlLmNoaWxkKFwiXCIpKSwgciA9IHRoaXMuZG9jcy5nZXRJdGVyYXRvckZyb20oaSk7XG4gICAgICAgIGZvciAoO3IuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHtrZXk6IHQsIHZhbHVlOiB7ZG9jdW1lbnQ6IGl9fSA9IHIuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgaWYgKCFlLmlzUHJlZml4T2YodC5wYXRoKSkgYnJlYWs7XG4gICAgICAgICAgICB0LnBhdGgubGVuZ3RoID4gZS5sZW5ndGggKyAxIHx8IChsZShjZShpKSwgbikgPD0gMCB8fCAocyA9IHMuaW5zZXJ0KGkua2V5LCBpLm11dGFibGVDb3B5KCkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUocyk7XG4gICAgfVxuICAgIGdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICAvLyBUaGlzIG1ldGhvZCBzaG91bGQgb25seSBiZSBjYWxsZWQgZnJvbSB0aGUgSW5kZXhCYWNrZmlsbGVyIGlmIHBlcnNpc3RlbmNlXG4gICAgICAgIC8vIGlzIGVuYWJsZWQuXG4gICAgICAgIEwoKTtcbiAgICB9XG4gICAgQmkodCwgZSkge1xuICAgICAgICByZXR1cm4geWkuZm9yRWFjaCh0aGlzLmRvY3MsICh0ID0+IGUodCkpKTtcbiAgICB9XG4gICAgbmV3Q2hhbmdlQnVmZmVyKHQpIHtcbiAgICAgICAgLy8gYHRyYWNrUmVtb3ZhbHNgIGlzIGlnbm9yZXMgc2luY2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUga2VlcHNcbiAgICAgICAgLy8gYSBzZXBhcmF0ZSBjaGFuZ2Vsb2cgYW5kIGRvZXMgbm90IG5lZWQgc3BlY2lhbCBoYW5kbGluZyBmb3IgcmVtb3ZhbHMuXG4gICAgICAgIHJldHVybiBuZXcgUm8odGhpcyk7XG4gICAgfVxuICAgIGdldFNpemUodCkge1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZSh0aGlzLnNpemUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IG1lbW9yeS1vbmx5IFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKlxuICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gKiBleHBlY3RlZCB0byBqdXN0IHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2ZcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICovXG4vKipcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi9cbmNsYXNzIFJvIGV4dGVuZHMgRnIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5LbiA9IHQ7XG4gICAgfVxuICAgIGFwcGx5Q2hhbmdlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgcy5pc1ZhbGlkRG9jdW1lbnQoKSA/IGUucHVzaCh0aGlzLktuLmFkZEVudHJ5KHQsIHMpKSA6IHRoaXMuS24ucmVtb3ZlRW50cnkobik7XG4gICAgICAgIH0pKSwgeWkud2FpdEZvcihlKTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuS24uZ2V0RW50cnkodCwgZSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLktuLmdldEVudHJpZXModCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBibyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIGEgdGFyZ2V0IHRvIHRoZSBkYXRhIGFib3V0IHRoYXQgdGFyZ2V0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkxpID0gbmV3IEtuKCh0ID0+IEllKHQpKSwgRWUpLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGN0Lm1pbigpLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBJRCBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSAwLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IHNlcXVlbmNlIG51bWJlciBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5VaSA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBvcmRlcmVkIGJpZGlyZWN0aW9uYWwgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIHJlbW90ZSB0YXJnZXRcbiAgICAgICAgICogSURzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5xaSA9IG5ldyBJbywgdGhpcy50YXJnZXRDb3VudCA9IDAsIHRoaXMuS2kgPSBici5nbigpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTGkuZm9yRWFjaCgoKHQsIG4pID0+IGUobikpKSwgeWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIHlpLnJlc29sdmUodGhpcy5VaSk7XG4gICAgfVxuICAgIGFsbG9jYXRlVGFyZ2V0SWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSB0aGlzLktpLm5leHQoKSwgeWkucmVzb2x2ZSh0aGlzLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuICYmICh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuKSwgZSA+IHRoaXMuVWkgJiYgKHRoaXMuVWkgPSBlKSwgXG4gICAgICAgIHlpLnJlc29sdmUoKTtcbiAgICB9XG4gICAgVG4odCkge1xuICAgICAgICB0aGlzLkxpLnNldCh0LnRhcmdldCwgdCk7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICBlID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgJiYgKHRoaXMuS2kgPSBuZXcgYnIoZSksIHRoaXMuaGlnaGVzdFRhcmdldElkID0gZSksIHQuc2VxdWVuY2VOdW1iZXIgPiB0aGlzLlVpICYmICh0aGlzLlVpID0gdC5zZXF1ZW5jZU51bWJlcik7XG4gICAgfVxuICAgIGFkZFRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5UbihlKSwgdGhpcy50YXJnZXRDb3VudCArPSAxLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5UbihlKSwgeWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTGkuZGVsZXRlKGUudGFyZ2V0KSwgdGhpcy5xaS52aShlLnRhcmdldElkKSwgdGhpcy50YXJnZXRDb3VudCAtPSAxLCBcbiAgICAgICAgeWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLkxpLmZvckVhY2goKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBvLnNlcXVlbmNlTnVtYmVyIDw9IGUgJiYgbnVsbCA9PT0gbi5nZXQoby50YXJnZXRJZCkgJiYgKHRoaXMuTGkuZGVsZXRlKHIpLCBpLnB1c2godGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBvLnRhcmdldElkKSksIFxuICAgICAgICAgICAgcysrKTtcbiAgICAgICAgfSkpLCB5aS53YWl0Rm9yKGkpLm5leHQoKCgpID0+IHMpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQodCkge1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLkxpLmdldChlKSB8fCBudWxsO1xuICAgICAgICByZXR1cm4geWkucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucWkuYmkoZSwgbiksIHlpLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5xaS5WaShlLCBuKTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUsIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHMgJiYgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKTtcbiAgICAgICAgfSkpLCB5aS53YWl0Rm9yKGkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnFpLnZpKGUpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMucWkuRGkoZSk7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB5aS5yZXNvbHZlKHRoaXMucWkuY29udGFpbnNLZXkoZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtZW1vcnktYmFja2VkIGluc3RhbmNlIG9mIFBlcnNpc3RlbmNlLiBEYXRhIGlzIHN0b3JlZCBvbmx5IGluIFJBTSBhbmRcbiAqIG5vdCBwZXJzaXN0ZWQgYWNyb3NzIHNlc3Npb25zLlxuICovXG5jbGFzcyBQbyB7XG4gICAgLyoqXG4gICAgICogVGhlIGNvbnN0cnVjdG9yIGFjY2VwdHMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBhIHJlZmVyZW5jZSBkZWxlZ2F0ZS4gVGhpc1xuICAgICAqIGFsbG93cyBib3RoIHRoZSBkZWxlZ2F0ZSBhbmQgdGhpcyBpbnN0YW5jZSB0byBoYXZlIHN0cm9uZyByZWZlcmVuY2VzIHRvXG4gICAgICogZWFjaCBvdGhlciB3aXRob3V0IGhhdmluZyBudWxsYWJsZSBmaWVsZHMgdGhhdCB3b3VsZCB0aGVuIG5lZWQgdG8gYmVcbiAgICAgKiBjaGVja2VkIG9yIGFzc2VydGVkIG9uIGV2ZXJ5IGFjY2Vzcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuR2kgPSB7fSwgdGhpcy5vdmVybGF5cyA9IHt9LCB0aGlzLmVzID0gbmV3IG50KDApLCB0aGlzLm5zID0gITEsIHRoaXMubnMgPSAhMCwgXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSB0KHRoaXMpLCB0aGlzLmZzID0gbmV3IGJvKHRoaXMpO1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IG5ldyBhciwgdGhpcy5kcyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQW8odCk7XG4gICAgICAgIH0oKHQgPT4gdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5RaSh0KSkpLCB0aGlzLk0gPSBuZXcga2koZSksIHRoaXMuX3MgPSBuZXcgeW8odGhpcy5NKTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIC8vIE5vIGR1cmFibGUgc3RhdGUgdG8gZW5zdXJlIGlzIGNsb3NlZCBvbiBzaHV0ZG93bi5cbiAgICAgICAgcmV0dXJuIHRoaXMubnMgPSAhMSwgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ucztcbiAgICB9XG4gICAgc2V0RGF0YWJhc2VEZWxldGVkTGlzdGVuZXIoKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzZXROZXR3b3JrRW5hYmxlZCgpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIGdldEluZGV4TWFuYWdlcih0KSB7XG4gICAgICAgIC8vIFdlIGRvIG5vdCBjdXJyZW50bHkgc3VwcG9ydCBpbmRpY2VzIGZvciBtZW1vcnkgcGVyc2lzdGVuY2UsIHNvIHdlIGNhblxuICAgICAgICAvLyByZXR1cm4gdGhlIHNhbWUgc2hhcmVkIGluc3RhbmNlIG9mIHRoZSBtZW1vcnkgaW5kZXggbWFuYWdlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhNYW5hZ2VyO1xuICAgIH1cbiAgICBnZXREb2N1bWVudE92ZXJsYXlDYWNoZSh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5vdmVybGF5c1t0LnRvS2V5KCldO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyBwbywgdGhpcy5vdmVybGF5c1t0LnRvS2V5KCldID0gZSksIGU7XG4gICAgfVxuICAgIGdldE11dGF0aW9uUXVldWUodCwgZSkge1xuICAgICAgICBsZXQgbiA9IHRoaXMuR2lbdC50b0tleSgpXTtcbiAgICAgICAgcmV0dXJuIG4gfHwgKG4gPSBuZXcgRW8oZSwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSksIHRoaXMuR2lbdC50b0tleSgpXSA9IG4pLCBuO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZnM7XG4gICAgfVxuICAgIGdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRzO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3M7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgTyhcIk1lbW9yeVBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gbmV3IFZvKHRoaXMuZXMubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuamkoKSwgbihzKS5uZXh0KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuV2kocykubmV4dCgoKCkgPT4gdCkpKSkudG9Qcm9taXNlKCkudGhlbigodCA9PiAocy5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIHppKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHlpLm9yKE9iamVjdC52YWx1ZXModGhpcy5HaSkubWFwKChuID0+ICgpID0+IG4uY29udGFpbnNLZXkodCwgZSkpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cbiAqLyBjbGFzcyBWbyBleHRlbmRzIGdpIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIHZvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyBhbGwgZG9jdW1lbnRzIHRoYXQgYXJlIGFjdGl2ZSBpbiBRdWVyeSB2aWV3cy4gKi9cbiAgICAgICAgdGhpcy5IaSA9IG5ldyBJbywgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLkppID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIFlpKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB2byh0KTtcbiAgICB9XG4gICAgZ2V0IFhpKCkge1xuICAgICAgICBpZiAodGhpcy5KaSkgcmV0dXJuIHRoaXMuSmk7XG4gICAgICAgIHRocm93IEwoKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSGkuYWRkUmVmZXJlbmNlKG4sIGUpLCB0aGlzLlhpLmRlbGV0ZShuLnRvU3RyaW5nKCkpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhpLnJlbW92ZVJlZmVyZW5jZShuLCBlKSwgdGhpcy5YaS5hZGQobi50b1N0cmluZygpKSwgeWkucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlhpLmFkZChlLnRvU3RyaW5nKCkpLCB5aS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuSGkudmkoZS50YXJnZXRJZCkuZm9yRWFjaCgodCA9PiB0aGlzLlhpLmFkZCh0LnRvU3RyaW5nKCkpKSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCk7XG4gICAgICAgIHJldHVybiBuLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMuWGkuYWRkKHQudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ucmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSkpO1xuICAgIH1cbiAgICBqaSgpIHtcbiAgICAgICAgdGhpcy5KaSA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIFdpKHQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIG5ld2x5IG9ycGhhbmVkIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4geWkuZm9yRWFjaCh0aGlzLlhpLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0geHQuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5aaSh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8IGUucmVtb3ZlRW50cnkocywgY3QubWluKCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHRoaXMuSmkgPSBudWxsLCBlLmFwcGx5KHQpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWmkodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0ID8gdGhpcy5YaS5kZWxldGUoZS50b1N0cmluZygpKSA6IHRoaXMuWGkuYWRkKGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgUWkodCkge1xuICAgICAgICAvLyBGb3IgZWFnZXIgR0MsIHdlIGRvbid0IGNhcmUgYWJvdXQgdGhlIGRvY3VtZW50IHNpemUsIHRoZXJlIGFyZSBubyBzaXplIHRocmVzaG9sZHMuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBaaSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB5aS5vcihbICgpID0+IHlpLnJlc29sdmUodGhpcy5IaS5jb250YWluc0tleShlKSksICgpID0+IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5jb250YWluc0tleSh0LCBlKSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS56aSh0LCBlKSBdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBMb2NhbFN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHRoZSBjbGllbnQgc3RhdGUgaXM6XG4vLyAgICAgZmlyZXN0b3JlX2NsaWVudHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGluc3RhbmNlX2tleT5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBjbGllbnQgc3RhdGUgaW4gV2ViU3RvcmFnZSAqL1xuZnVuY3Rpb24gU28odCwgZSkge1xuICAgIHJldHVybiBgZmlyZXN0b3JlX2NsaWVudHNfJHt0fV8ke2V9YDtcbn1cblxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgV2ViU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIG11dGF0aW9uIHN0YXRlIGlzOlxuLy8gICAgIGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPlxuLy8gICAgIChmb3IgdW5hdXRoZW50aWNhdGVkIHVzZXJzKVxuLy8gb3I6IGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPl88dXNlcl91aWQ+XG5cbi8vICd1c2VyX3VpZCcgaXMgbGFzdCB0byBhdm9pZCBuZWVkaW5nIHRvIGVzY2FwZSAnXycgY2hhcmFjdGVycyB0aGF0IGl0IG1pZ2h0XG4vLyBjb250YWluLlxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIG11dGF0aW9uIGJhdGNoIGluIFdlYlN0b3JhZ2UgKi9cbmZ1bmN0aW9uIERvKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IGBmaXJlc3RvcmVfbXV0YXRpb25zXyR7dH1fJHtufWA7XG4gICAgcmV0dXJuIGUuaXNBdXRoZW50aWNhdGVkKCkgJiYgKHMgKz0gYF8ke2UudWlkfWApLCBzO1xufVxuXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyBhIHF1ZXJ5IHRhcmdldCdzIG1ldGFkYXRhIGlzOlxuLy8gICAgIGZpcmVzdG9yZV90YXJnZXRzXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Xzx0YXJnZXRfaWQ+XG4vKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgcXVlcnkgc3RhdGUgaW4gV2ViU3RvcmFnZSAqL1xuZnVuY3Rpb24gQ28odCwgZSkge1xuICAgIHJldHVybiBgZmlyZXN0b3JlX3RhcmdldHNfJHt0fV8ke2V9YDtcbn1cblxuLy8gVGhlIFdlYlN0b3JhZ2UgcHJlZml4IHRoYXQgc3RvcmVzIHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZS4gVGhlXG4vLyBmb3JtYXQgb2YgdGhlIGtleSBpczpcbi8vICAgICBmaXJlc3RvcmVfb25saW5lX3N0YXRlXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XG4vKipcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIG11dGF0aW9uIGJhdGNoLCBpbmNsdWRpbmcgaXRzIHVzZXIgSUQsIGJhdGNoIElEIGFuZFxuICogd2hldGhlciB0aGUgYmF0Y2ggaXMgJ3BlbmRpbmcnLCAnYWNrbm93bGVkZ2VkJyBvciAncmVqZWN0ZWQnLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyB4byB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnVzZXIgPSB0LCB0aGlzLmJhdGNoSWQgPSBlLCB0aGlzLnN0YXRlID0gbiwgdGhpcy5lcnJvciA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIE11dGF0aW9uTWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyB0cih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBKU09OLnBhcnNlKG4pO1xuICAgICAgICBsZXQgaSwgciA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIHMgJiYgLTEgIT09IFsgXCJwZW5kaW5nXCIsIFwiYWNrbm93bGVkZ2VkXCIsIFwicmVqZWN0ZWRcIiBdLmluZGV4T2Yocy5zdGF0ZSkgJiYgKHZvaWQgMCA9PT0gcy5lcnJvciB8fCBcIm9iamVjdFwiID09IHR5cGVvZiBzLmVycm9yKTtcbiAgICAgICAgcmV0dXJuIHIgJiYgcy5lcnJvciAmJiAociA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIHMuZXJyb3IubWVzc2FnZSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBzLmVycm9yLmNvZGUsIFxuICAgICAgICByICYmIChpID0gbmV3IFEocy5lcnJvci5jb2RlLCBzLmVycm9yLm1lc3NhZ2UpKSksIHIgPyBuZXcgeG8odCwgZSwgcy5zdGF0ZSwgaSkgOiAoRihcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2UgbXV0YXRpb24gc3RhdGUgZm9yIElEICcke2V9JzogJHtufWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxuICAgIGVyKCkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3IgJiYgKHQuZXJyb3IgPSB7XG4gICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXG4gICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSksIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIb2xkcyB0aGUgc3RhdGUgb2YgYSBxdWVyeSB0YXJnZXQsIGluY2x1ZGluZyBpdHMgdGFyZ2V0IElEIGFuZCB3aGV0aGVyIHRoZVxuICogdGFyZ2V0IGlzICdub3QtY3VycmVudCcsICdjdXJyZW50JyBvciAncmVqZWN0ZWQnLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyBObyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gdCwgdGhpcy5zdGF0ZSA9IGUsIHRoaXMuZXJyb3IgPSBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBRdWVyeVRhcmdldE1ldGFkYXRhIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgdHIodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZShlKTtcbiAgICAgICAgbGV0IHMsIGkgPSBcIm9iamVjdFwiID09IHR5cGVvZiBuICYmIC0xICE9PSBbIFwibm90LWN1cnJlbnRcIiwgXCJjdXJyZW50XCIsIFwicmVqZWN0ZWRcIiBdLmluZGV4T2Yobi5zdGF0ZSkgJiYgKHZvaWQgMCA9PT0gbi5lcnJvciB8fCBcIm9iamVjdFwiID09IHR5cGVvZiBuLmVycm9yKTtcbiAgICAgICAgcmV0dXJuIGkgJiYgbi5lcnJvciAmJiAoaSA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIG4uZXJyb3IubWVzc2FnZSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBuLmVycm9yLmNvZGUsIFxuICAgICAgICBpICYmIChzID0gbmV3IFEobi5lcnJvci5jb2RlLCBuLmVycm9yLm1lc3NhZ2UpKSksIGkgPyBuZXcgTm8odCwgbi5zdGF0ZSwgcykgOiAoRihcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2UgdGFyZ2V0IHN0YXRlIGZvciBJRCAnJHt0fSc6ICR7ZX1gKSwgXG4gICAgICAgIG51bGwpO1xuICAgIH1cbiAgICBlcigpIHtcbiAgICAgICAgY29uc3QgdCA9IHtcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgdXBkYXRlVGltZU1zOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yICYmICh0LmVycm9yID0ge1xuICAgICAgICAgICAgY29kZTogdGhpcy5lcnJvci5jb2RlLFxuICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5lcnJvci5tZXNzYWdlXG4gICAgICAgIH0pLCBKU09OLnN0cmluZ2lmeSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBpbW11dGFibGUgQ2xpZW50U3RhdGUgZm9yIGEgY2xpZW50IHJlYWQgZnJvbVxuICogV2ViU3RvcmFnZSwgY29udGFpbmluZyB0aGUgbGlzdCBvZiBhY3RpdmUgcXVlcnkgdGFyZ2V0cy5cbiAqLyBjbGFzcyBrbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmNsaWVudElkID0gdCwgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBSZW1vdGVDbGllbnRTdGF0ZSBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIHRyKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UoZSk7XG4gICAgICAgIGxldCBzID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgbiAmJiBuLmFjdGl2ZVRhcmdldElkcyBpbnN0YW5jZW9mIEFycmF5LCBpID0gWm4oKTtcbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHMgJiYgdCA8IG4uYWN0aXZlVGFyZ2V0SWRzLmxlbmd0aDsgKyt0KSBzID0gQ3Qobi5hY3RpdmVUYXJnZXRJZHNbdF0pLCBcbiAgICAgICAgaSA9IGkuYWRkKG4uYWN0aXZlVGFyZ2V0SWRzW3RdKTtcbiAgICAgICAgcmV0dXJuIHMgPyBuZXcga28odCwgaSkgOiAoRihcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2UgY2xpZW50IGRhdGEgZm9yIGluc3RhbmNlICcke3R9JzogJHtlfWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoaXMgY2xhc3MgcmVwcmVzZW50cyB0aGUgb25saW5lIHN0YXRlIGZvciBhbGwgY2xpZW50cyBwYXJ0aWNpcGF0aW5nIGluXG4gKiBtdWx0aS10YWIuIFRoZSBvbmxpbmUgc3RhdGUgaXMgb25seSB3cml0dGVuIHRvIGJ5IHRoZSBwcmltYXJ5IGNsaWVudCwgYW5kXG4gKiB1c2VkIGluIHNlY29uZGFyeSBjbGllbnRzIHRvIHVwZGF0ZSB0aGVpciBxdWVyeSB2aWV3cy5cbiAqLyBjbGFzcyBNbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmNsaWVudElkID0gdCwgdGhpcy5vbmxpbmVTdGF0ZSA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFNoYXJlZE9ubGluZVN0YXRlIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgdHIodCkge1xuICAgICAgICBjb25zdCBlID0gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIGUgJiYgLTEgIT09IFsgXCJVbmtub3duXCIsIFwiT25saW5lXCIsIFwiT2ZmbGluZVwiIF0uaW5kZXhPZihlLm9ubGluZVN0YXRlKSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBlLmNsaWVudElkID8gbmV3IE1vKGUuY2xpZW50SWQsIGUub25saW5lU3RhdGUpIDogKEYoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgRmFpbGVkIHRvIHBhcnNlIG9ubGluZSBzdGF0ZTogJHt0fWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1ldGFkYXRhIHN0YXRlIG9mIHRoZSBsb2NhbCBjbGllbnQuIFVubGlrZSBgUmVtb3RlQ2xpZW50U3RhdGVgLCB0aGlzIGNsYXNzIGlzXG4gKiBtdXRhYmxlIGFuZCBrZWVwcyB0cmFjayBvZiBhbGwgcGVuZGluZyBtdXRhdGlvbnMsIHdoaWNoIGFsbG93cyB1cyB0b1xuICogdXBkYXRlIHRoZSByYW5nZSBvZiBwZW5kaW5nIG11dGF0aW9uIGJhdGNoIElEcyBhcyBuZXcgbXV0YXRpb25zIGFyZSBhZGRlZCBvclxuICogcmVtb3ZlZC5cbiAqXG4gKiBUaGUgZGF0YSBpbiBgTG9jYWxDbGllbnRTdGF0ZWAgaXMgbm90IHJlYWQgZnJvbSBXZWJTdG9yYWdlIGFuZCBpbnN0ZWFkXG4gKiB1cGRhdGVkIHZpYSBpdHMgaW5zdGFuY2UgbWV0aG9kcy4gVGhlIHVwZGF0ZWQgc3RhdGUgY2FuIGJlIHNlcmlhbGl6ZWQgdmlhXG4gKiBgdG9XZWJTdG9yYWdlSlNPTigpYC5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbmNsYXNzIE9vIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSBabigpO1xuICAgIH1cbiAgICBucih0KSB7XG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdGhpcy5hY3RpdmVUYXJnZXRJZHMuYWRkKHQpO1xuICAgIH1cbiAgICBzcih0KSB7XG4gICAgICAgIHRoaXMuYWN0aXZlVGFyZ2V0SWRzID0gdGhpcy5hY3RpdmVUYXJnZXRJZHMuZGVsZXRlKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGlzIGVudHJ5IGludG8gYSBKU09OLWVuY29kZWQgZm9ybWF0IHdlIGNhbiB1c2UgZm9yIFdlYlN0b3JhZ2UuXG4gICAgICogRG9lcyBub3QgZW5jb2RlIGBjbGllbnRJZGAgYXMgaXQgaXMgcGFydCBvZiB0aGUga2V5IGluIFdlYlN0b3JhZ2UuXG4gICAgICovICAgIGVyKCkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgYWN0aXZlVGFyZ2V0SWRzOiB0aGlzLmFjdGl2ZVRhcmdldElkcy50b0FycmF5KCksXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlYCB1c2VzIFdlYlN0b3JhZ2UgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIGFzIHRoZVxuICogYmFja2luZyBzdG9yZSBmb3IgdGhlIFNoYXJlZENsaWVudFN0YXRlLiBJdCBrZWVwcyB0cmFjayBvZiBhbGwgYWN0aXZlXG4gKiBjbGllbnRzIGFuZCBzdXBwb3J0cyBtb2RpZmljYXRpb25zIG9mIHRoZSBsb2NhbCBjbGllbnQncyBkYXRhLlxuICovIGNsYXNzIEZvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMud2luZG93ID0gdCwgdGhpcy5ZbiA9IGUsIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBuLCB0aGlzLmlyID0gcywgdGhpcy5zeW5jRW5naW5lID0gbnVsbCwgXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbCwgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsLCB0aGlzLnJyID0gdGhpcy51ci5iaW5kKHRoaXMpLCBcbiAgICAgICAgdGhpcy5hciA9IG5ldyBmZShydCksIHRoaXMuc3RhcnRlZCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENhcHR1cmVzIFdlYlN0b3JhZ2UgZXZlbnRzIHRoYXQgb2NjdXIgYmVmb3JlIGBzdGFydCgpYCBpcyBjYWxsZWQuIFRoZXNlXG4gICAgICAgICAqIGV2ZW50cyBhcmUgcmVwbGF5ZWQgb25jZSBgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlYCBpcyBzdGFydGVkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jciA9IFtdO1xuICAgICAgICAvLyBFc2NhcGUgdGhlIHNwZWNpYWwgY2hhcmFjdGVycyBtZW50aW9uZWQgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9SZWd1bGFyX0V4cHJlc3Npb25zXG4gICAgICAgIGNvbnN0IHIgPSBuLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCBcIlxcXFwkJlwiKTtcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlLCB0aGlzLmN1cnJlbnRVc2VyID0gaSwgdGhpcy5ociA9IFNvKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuaXIpLCBcbiAgICAgICAgdGhpcy5sciA9IFxuICAgICAgICAvKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIHRoZSBjdXJyZW50IHNlcXVlbmNlIG51bWJlci4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0aGlzLnBlcnNpc3RlbmNlS2V5KSwgdGhpcy5hciA9IHRoaXMuYXIuaW5zZXJ0KHRoaXMuaXIsIG5ldyBPbyksIHRoaXMuZHIgPSBuZXcgUmVnRXhwKGBeZmlyZXN0b3JlX2NsaWVudHNfJHtyfV8oW15fXSopJGApLCBcbiAgICAgICAgdGhpcy5fciA9IG5ldyBSZWdFeHAoYF5maXJlc3RvcmVfbXV0YXRpb25zXyR7cn1fKFxcXFxkKykoPzpfKC4qKSk/JGApLCB0aGlzLndyID0gbmV3IFJlZ0V4cChgXmZpcmVzdG9yZV90YXJnZXRzXyR7cn1fKFxcXFxkKykkYCksIFxuICAgICAgICB0aGlzLm1yID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIG9ubGluZSBzdGF0ZSBvZiB0aGUgcHJpbWFyeSB0YWIuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBgZmlyZXN0b3JlX29ubGluZV9zdGF0ZV8ke3R9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBwbGF5cyBhcyBhIGV2ZW50IHRvIGluZGljYXRlIHRoZSByZW1vdGUgZG9jdW1lbnRzXG4gICAgICAgIC8vIG1pZ2h0IGhhdmUgY2hhbmdlZCBkdWUgdG8gc29tZSBzZWNvbmRhcnkgdGFicyBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAgICAvLyBmb3JtYXQgb2YgdGhlIGtleSBpczpcbiAgICAgICAgLy8gICAgIGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkX3YyXzxwZXJzaXN0ZW5jZUtleT5cbiAgICAgICAgLy8gVGhlIHZlcnNpb24gZW5kaW5nIHdpdGggXCJ2MlwiIHN0b3JlcyB0aGUgbGlzdCBvZiBtb2RpZmllZCBjb2xsZWN0aW9uIGdyb3Vwcy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLmdyID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfYnVuZGxlX2xvYWRlZF92Ml8ke3R9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgV2ViU3RvcmFnZSBrZXkgcHJlZml4IGZvciB0aGUga2V5IHRoYXQgc3RvcmVzIHRoZSBsYXN0IHNlcXVlbmNlIG51bWJlciBhbGxvY2F0ZWQuIFRoZSBrZXlcbiAgICAgICAgLy8gbG9va3MgbGlrZSAnZmlyZXN0b3JlX3NlcXVlbmNlX251bWJlcl88cGVyc2lzdGVuY2VfcHJlZml4PicuXG4gICAgICAgICh0aGlzLnBlcnNpc3RlbmNlS2V5KSwgXG4gICAgICAgIC8vIFJhdGhlciB0aGFuIGFkZGluZyB0aGUgc3RvcmFnZSBvYnNlcnZlciBkdXJpbmcgc3RhcnQoKSwgd2UgYWRkIHRoZVxuICAgICAgICAvLyBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBpbml0aWFsaXphdGlvbi4gVGhpcyBlbnN1cmVzIHRoYXQgd2UgY29sbGVjdFxuICAgICAgICAvLyBldmVudHMgYmVmb3JlIG90aGVyIGNvbXBvbmVudHMgcG9wdWxhdGUgdGhlaXIgaW5pdGlhbCBzdGF0ZSAoZHVyaW5nIHRoZWlyXG4gICAgICAgIC8vIHJlc3BlY3RpdmUgc3RhcnQoKSBjYWxscykuIE90aGVyd2lzZSwgd2UgbWlnaHQgZm9yIGV4YW1wbGUgbWlzcyBhXG4gICAgICAgIC8vIG11dGF0aW9uIHRoYXQgaXMgYWRkZWQgYWZ0ZXIgTG9jYWxTdG9yZSdzIHN0YXJ0KCkgcHJvY2Vzc2VkIHRoZSBleGlzdGluZ1xuICAgICAgICAvLyBtdXRhdGlvbnMgYnV0IGJlZm9yZSB3ZSBvYnNlcnZlIFdlYlN0b3JhZ2UgZXZlbnRzLlxuICAgICAgICB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLnJyKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgJ3RydWUnIGlmIFdlYlN0b3JhZ2UgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqLyAgICBzdGF0aWMgdnQodCkge1xuICAgICAgICByZXR1cm4gISghdCB8fCAhdC5sb2NhbFN0b3JhZ2UpO1xuICAgIH1cbiAgICBhc3luYyBzdGFydCgpIHtcbiAgICAgICAgLy8gUmV0cmlldmUgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgY2xpZW50cyB0byBiYWNrZmlsbCB0aGUgZGF0YSBpblxuICAgICAgICAvLyBTaGFyZWRDbGllbnRTdGF0ZS5cbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IHRoaXMuc3luY0VuZ2luZS5GcygpO1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICAgICAgaWYgKGUgPT09IHRoaXMuaXIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0SXRlbShTbyh0aGlzLnBlcnNpc3RlbmNlS2V5LCBlKSk7XG4gICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBrby50cihlLCB0KTtcbiAgICAgICAgICAgICAgICBuICYmICh0aGlzLmFyID0gdGhpcy5hci5pbnNlcnQobi5jbGllbnRJZCwgbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMueXIoKTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gZXhpc3Rpbmcgb25saW5lIHN0YXRlIGFuZCBjYWxsIHRoZSBjYWxsYmFjayBoYW5kbGVyXG4gICAgICAgIC8vIGlmIGFwcGxpY2FibGUuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0aGlzLm1yKTtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnByKGUpO1xuICAgICAgICAgICAgdCAmJiB0aGlzLklyKHQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmNyKSB0aGlzLnVyKHQpO1xuICAgICAgICB0aGlzLmNyID0gW10sIFxuICAgICAgICAvLyBSZWdpc3RlciBhIHdpbmRvdyB1bmxvYWQgaG9vayB0byByZW1vdmUgdGhlIGNsaWVudCBtZXRhZGF0YSBlbnRyeSBmcm9tXG4gICAgICAgIC8vIFdlYlN0b3JhZ2UgZXZlbiBpZiBgc2h1dGRvd24oKWAgd2FzIG5vdCBjYWxsZWQuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwYWdlaGlkZVwiLCAoKCkgPT4gdGhpcy5zaHV0ZG93bigpKSksIHRoaXMuc3RhcnRlZCA9ICEwO1xuICAgIH1cbiAgICB3cml0ZVNlcXVlbmNlTnVtYmVyKHQpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMubHIsIEpTT04uc3RyaW5naWZ5KHQpKTtcbiAgICB9XG4gICAgZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ucih0aGlzLmFyKTtcbiAgICB9XG4gICAgaXNBY3RpdmVRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIGxldCBlID0gITE7XG4gICAgICAgIHJldHVybiB0aGlzLmFyLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBzLmFjdGl2ZVRhcmdldElkcy5oYXModCkgJiYgKGUgPSAhMCk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG4gICAgYWRkUGVuZGluZ011dGF0aW9uKHQpIHtcbiAgICAgICAgdGhpcy5Fcih0LCBcInBlbmRpbmdcIik7XG4gICAgfVxuICAgIHVwZGF0ZU11dGF0aW9uU3RhdGUodCwgZSwgbikge1xuICAgICAgICB0aGlzLkVyKHQsIGUsIG4pLCBcbiAgICAgICAgLy8gT25jZSBhIGZpbmFsIG11dGF0aW9uIHJlc3VsdCBpcyBvYnNlcnZlZCBieSBvdGhlciBjbGllbnRzLCB0aGV5IG5vIGxvbmdlclxuICAgICAgICAvLyBhY2Nlc3MgdGhlIG11dGF0aW9uJ3MgbWV0YWRhdGEgZW50cnkuIFNpbmNlIFdlYlN0b3JhZ2UgcmVwbGF5cyBldmVudHNcbiAgICAgICAgLy8gaW4gb3JkZXIsIGl0IGlzIHNhZmUgdG8gZGVsZXRlIHRoZSBlbnRyeSByaWdodCBhZnRlciB1cGRhdGluZyBpdC5cbiAgICAgICAgdGhpcy5Bcih0KTtcbiAgICB9XG4gICAgYWRkTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIGxldCBlID0gXCJub3QtY3VycmVudFwiO1xuICAgICAgICAvLyBMb29rdXAgYW4gZXhpc3RpbmcgcXVlcnkgc3RhdGUgaWYgdGhlIHRhcmdldCBJRCB3YXMgYWxyZWFkeSByZWdpc3RlcmVkXG4gICAgICAgIC8vIGJ5IGFub3RoZXIgdGFiXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmVRdWVyeVRhcmdldCh0KSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKENvKHRoaXMucGVyc2lzdGVuY2VLZXksIHQpKTtcbiAgICAgICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IE5vLnRyKHQsIG4pO1xuICAgICAgICAgICAgICAgIHMgJiYgKGUgPSBzLnN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5Sci5ucih0KSwgdGhpcy55cigpLCBlO1xuICAgIH1cbiAgICByZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5Sci5zcih0KSwgdGhpcy55cigpO1xuICAgIH1cbiAgICBpc0xvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Sci5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpO1xuICAgIH1cbiAgICBjbGVhclF1ZXJ5U3RhdGUodCkge1xuICAgICAgICB0aGlzLnJlbW92ZUl0ZW0oQ28odGhpcy5wZXJzaXN0ZW5jZUtleSwgdCkpO1xuICAgIH1cbiAgICB1cGRhdGVRdWVyeVN0YXRlKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5icih0LCBlLCBuKTtcbiAgICB9XG4gICAgaGFuZGxlVXNlckNoYW5nZSh0LCBlLCBuKSB7XG4gICAgICAgIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLkFyKHQpO1xuICAgICAgICB9KSksIHRoaXMuY3VycmVudFVzZXIgPSB0LCBuLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRQZW5kaW5nTXV0YXRpb24odCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0T25saW5lU3RhdGUodCkge1xuICAgICAgICB0aGlzLlByKHQpO1xuICAgIH1cbiAgICBub3RpZnlCdW5kbGVMb2FkZWQodCkge1xuICAgICAgICB0aGlzLlZyKHQpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5zdGFydGVkICYmICh0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLnJyKSwgdGhpcy5yZW1vdmVJdGVtKHRoaXMuaHIpLCBcbiAgICAgICAgdGhpcy5zdGFydGVkID0gITEpO1xuICAgIH1cbiAgICBnZXRJdGVtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHQpO1xuICAgICAgICByZXR1cm4gTyhcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiUkVBRFwiLCB0LCBlKSwgZTtcbiAgICB9XG4gICAgc2V0SXRlbSh0LCBlKSB7XG4gICAgICAgIE8oXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIlNFVFwiLCB0LCBlKSwgdGhpcy5zdG9yYWdlLnNldEl0ZW0odCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZUl0ZW0odCkge1xuICAgICAgICBPKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJSRU1PVkVcIiwgdCksIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKHQpO1xuICAgIH1cbiAgICB1cih0KSB7XG4gICAgICAgIC8vIE5vdGU6IFRoZSBmdW5jdGlvbiBpcyB0eXBlZCB0byB0YWtlIEV2ZW50IHRvIGJlIGludGVyZmFjZS1jb21wYXRpYmxlIHdpdGhcbiAgICAgICAgLy8gYFdpbmRvdy5hZGRFdmVudExpc3RlbmVyYC5cbiAgICAgICAgY29uc3QgZSA9IHQ7XG4gICAgICAgIGlmIChlLnN0b3JhZ2VBcmVhID09PSB0aGlzLnN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGlmIChPKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJFVkVOVFwiLCBlLmtleSwgZS5uZXdWYWx1ZSksIGUua2V5ID09PSB0aGlzLmhyKSByZXR1cm4gdm9pZCBGKFwiUmVjZWl2ZWQgV2ViU3RvcmFnZSBub3RpZmljYXRpb24gZm9yIGxvY2FsIGNoYW5nZS4gQW5vdGhlciBjbGllbnQgbWlnaHQgaGF2ZSBnYXJiYWdlLWNvbGxlY3RlZCBvdXIgc3RhdGVcIik7XG4gICAgICAgICAgICB0aGlzLlluLmVucXVldWVSZXRyeWFibGUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLmtleSkgaWYgKHRoaXMuZHIudGVzdChlLmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy52cihlLmtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuU3IodCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuRHIoZS5rZXksIGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5Tcih0LmNsaWVudElkLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9yLnRlc3QoZS5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLkNyKGUua2V5LCBlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMuTnIodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy53ci50ZXN0KGUua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5rcihlLmtleSwgZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLk1yKHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSB0aGlzLm1yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnByKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5Jcih0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5scikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IG50LkE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gdCkgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEpTT04ucGFyc2UodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFUoXCJudW1iZXJcIiA9PSB0eXBlb2YgbiksIGUgPSBuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRihcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiRmFpbGVkIHRvIHJlYWQgc2VxdWVuY2UgbnVtYmVyIGZyb20gV2ViU3RvcmFnZVwiLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAqIGBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZWAgaXMgYSBzaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgU2hhcmVkQ2xpZW50U3RhdGUgZm9yXG4gKiBjbGllbnRzIHVzaW5nIG1lbW9yeSBwZXJzaXN0ZW5jZS4gVGhlIHN0YXRlIGluIHRoaXMgY2xhc3MgcmVtYWlucyBmdWxseVxuICogaXNvbGF0ZWQgYW5kIG5vIHN5bmNocm9uaXphdGlvbiBpcyBwZXJmb3JtZWQuXG4gKi8gKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdCAhPT0gbnQuQSAmJiB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlcih0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5ncikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuT3IoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh0Lm1hcCgodCA9PiB0aGlzLnN5bmNFbmdpbmUuRnIodCkpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5jci5wdXNoKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBScigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXIuZ2V0KHRoaXMuaXIpO1xuICAgIH1cbiAgICB5cigpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMuaHIsIHRoaXMuUnIuZXIoKSk7XG4gICAgfVxuICAgIEVyKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyB4byh0aGlzLmN1cnJlbnRVc2VyLCB0LCBlLCBuKSwgaSA9IERvKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuY3VycmVudFVzZXIsIHQpO1xuICAgICAgICB0aGlzLnNldEl0ZW0oaSwgcy5lcigpKTtcbiAgICB9XG4gICAgQXIodCkge1xuICAgICAgICBjb25zdCBlID0gRG8odGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5jdXJyZW50VXNlciwgdCk7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShlKTtcbiAgICB9XG4gICAgUHIodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuaXIsXG4gICAgICAgICAgICBvbmxpbmVTdGF0ZTogdFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLm1yLCBKU09OLnN0cmluZ2lmeShlKSk7XG4gICAgfVxuICAgIGJyKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IENvKHRoaXMucGVyc2lzdGVuY2VLZXksIHQpLCBpID0gbmV3IE5vKHQsIGUsIG4pO1xuICAgICAgICB0aGlzLnNldEl0ZW0ocywgaS5lcigpKTtcbiAgICB9XG4gICAgVnIodCkge1xuICAgICAgICBjb25zdCBlID0gSlNPTi5zdHJpbmdpZnkoQXJyYXkuZnJvbSh0KSk7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLmdyLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGtleSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zIG51bGwgaWYgdGhlIGtleSBkb2VzIG5vdFxuICAgICAqIG1hdGNoIHRoZSBleHBlY3RlZCBrZXkgZm9ybWF0LlxuICAgICAqLyAgICB2cih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRyLmV4ZWModCk7XG4gICAgICAgIHJldHVybiBlID8gZVsxXSA6IG51bGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWUgY291bGQgbm90XG4gICAgICogYmUgcGFyc2VkLlxuICAgICAqLyAgICBEcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnZyKHQpO1xuICAgICAgICByZXR1cm4ga28udHIobiwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIG11dGF0aW9uIGJhdGNoIHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIENyKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuX3IuZXhlYyh0KSwgcyA9IE51bWJlcihuWzFdKSwgaSA9IHZvaWQgMCAhPT0gblsyXSA/IG5bMl0gOiBudWxsO1xuICAgICAgICByZXR1cm4geG8udHIobmV3IEMoaSksIHMsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBxdWVyeSB0YXJnZXQgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICAgICAqLyAgICBrcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLndyLmV4ZWModCksIHMgPSBOdW1iZXIoblsxXSk7XG4gICAgICAgIHJldHVybiBOby50cihzLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGFuIG9ubGluZSBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIHByKHQpIHtcbiAgICAgICAgcmV0dXJuIE1vLnRyKHQpO1xuICAgIH1cbiAgICBPcih0KSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHQpO1xuICAgIH1cbiAgICBhc3luYyBOcih0KSB7XG4gICAgICAgIGlmICh0LnVzZXIudWlkID09PSB0aGlzLmN1cnJlbnRVc2VyLnVpZCkgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS4kcih0LmJhdGNoSWQsIHQuc3RhdGUsIHQuZXJyb3IpO1xuICAgICAgICBPKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYElnbm9yaW5nIG11dGF0aW9uIGZvciBub24tYWN0aXZlIHVzZXIgJHt0LnVzZXIudWlkfWApO1xuICAgIH1cbiAgICBNcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuQnIodC50YXJnZXRJZCwgdC5zdGF0ZSwgdC5lcnJvcik7XG4gICAgfVxuICAgIFNyKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgPyB0aGlzLmFyLmluc2VydCh0LCBlKSA6IHRoaXMuYXIucmVtb3ZlKHQpLCBzID0gdGhpcy5Ucih0aGlzLmFyKSwgaSA9IHRoaXMuVHIobiksIHIgPSBbXSwgbyA9IFtdO1xuICAgICAgICByZXR1cm4gaS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHMuaGFzKHQpIHx8IHIucHVzaCh0KTtcbiAgICAgICAgfSkpLCBzLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgaS5oYXModCkgfHwgby5wdXNoKHQpO1xuICAgICAgICB9KSksIHRoaXMuc3luY0VuZ2luZS5McihyLCBvKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFyID0gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBJcih0KSB7XG4gICAgICAgIC8vIFdlIGNoZWNrIHdoZXRoZXIgdGhlIGNsaWVudCB0aGF0IHdyb3RlIHRoaXMgb25saW5lIHN0YXRlIGlzIHN0aWxsIGFjdGl2ZVxuICAgICAgICAvLyBieSBjb21wYXJpbmcgaXRzIGNsaWVudCBJRCB0byB0aGUgbGlzdCBvZiBjbGllbnRzIGtlcHQgYWN0aXZlIGluXG4gICAgICAgIC8vIEluZGV4ZWREYi4gSWYgYSBjbGllbnQgZG9lcyBub3QgdXBkYXRlIHRoZWlyIEluZGV4ZWREYiBjbGllbnQgc3RhdGVcbiAgICAgICAgLy8gd2l0aGluIDUgc2Vjb25kcywgaXQgaXMgY29uc2lkZXJlZCBpbmFjdGl2ZSBhbmQgd2UgZG9uJ3QgZW1pdCBhbiBvbmxpbmVcbiAgICAgICAgLy8gc3RhdGUgZXZlbnQuXG4gICAgICAgIHRoaXMuYXIuZ2V0KHQuY2xpZW50SWQpICYmIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKHQub25saW5lU3RhdGUpO1xuICAgIH1cbiAgICBUcih0KSB7XG4gICAgICAgIGxldCBlID0gWm4oKTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgIGUgPSBlLnVuaW9uV2l0aChuLmFjdGl2ZVRhcmdldElkcyk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG59XG5cbmNsYXNzICRvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5VciA9IG5ldyBPbywgdGhpcy5xciA9IHt9LCB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG51bGwsIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gbnVsbDtcbiAgICB9XG4gICAgYWRkUGVuZGluZ011dGF0aW9uKHQpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHVwZGF0ZU11dGF0aW9uU3RhdGUodCwgZSwgbikge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgYWRkTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlVyLm5yKHQpLCB0aGlzLnFyW3RdIHx8IFwibm90LWN1cnJlbnRcIjtcbiAgICB9XG4gICAgdXBkYXRlUXVlcnlTdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMucXJbdF0gPSBlO1xuICAgIH1cbiAgICByZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5Vci5zcih0KTtcbiAgICB9XG4gICAgaXNMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXIuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KTtcbiAgICB9XG4gICAgY2xlYXJRdWVyeVN0YXRlKHQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMucXJbdF07XG4gICAgfVxuICAgIGdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXIuYWN0aXZlVGFyZ2V0SWRzO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVXIuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlVyID0gbmV3IE9vLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgaGFuZGxlVXNlckNoYW5nZSh0LCBlLCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZSh0KSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG4gICAgd3JpdGVTZXF1ZW5jZU51bWJlcih0KSB7fVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZCh0KSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgQm8ge1xuICAgIEtyKHQpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICAvLyBOby1vcC5cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBSZWZlcmVuY2VzIHRvIGB3aW5kb3dgIGFyZSBndWFyZGVkIGJ5IEJyb3dzZXJDb25uZWN0aXZpdHlNb25pdG9yLmlzQXZhaWxhYmxlKClcbi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyoqXG4gKiBCcm93c2VyIGltcGxlbWVudGF0aW9uIG9mIENvbm5lY3Rpdml0eU1vbml0b3IuXG4gKi9cbmNsYXNzIExvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5HciA9ICgpID0+IHRoaXMuUXIoKSwgdGhpcy5qciA9ICgpID0+IHRoaXMuV3IoKSwgdGhpcy56ciA9IFtdLCB0aGlzLkhyKCk7XG4gICAgfVxuICAgIEtyKHQpIHtcbiAgICAgICAgdGhpcy56ci5wdXNoKHQpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIiwgdGhpcy5HciksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib2ZmbGluZVwiLCB0aGlzLmpyKTtcbiAgICB9XG4gICAgSHIoKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuR3IpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5qcik7XG4gICAgfVxuICAgIFFyKCkge1xuICAgICAgICBPKFwiQ29ubmVjdGl2aXR5TW9uaXRvclwiLCBcIk5ldHdvcmsgY29ubmVjdGl2aXR5IGNoYW5nZWQ6IEFWQUlMQUJMRVwiKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuenIpIHQoMCAvKiBBVkFJTEFCTEUgKi8pO1xuICAgIH1cbiAgICBXcigpIHtcbiAgICAgICAgTyhcIkNvbm5lY3Rpdml0eU1vbml0b3JcIiwgXCJOZXR3b3JrIGNvbm5lY3Rpdml0eSBjaGFuZ2VkOiBVTkFWQUlMQUJMRVwiKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuenIpIHQoMSAvKiBVTkFWQUlMQUJMRSAqLyk7XG4gICAgfVxuICAgIC8vIFRPRE8oY2hlbmJyaWFuKTogQ29uc2lkZXIgcGFzc2luZyBpbiB3aW5kb3cgZWl0aGVyIGludG8gdGhpcyBjb21wb25lbnQgb3JcbiAgICAvLyBoZXJlIGZvciB0ZXN0aW5nIHZpYSBGYWtlV2luZG93LlxuICAgIC8qKiBDaGVja3MgdGhhdCBhbGwgdXNlZCBhdHRyaWJ1dGVzIG9mIHdpbmRvdyBhcmUgYXZhaWxhYmxlLiAqL1xuICAgIHN0YXRpYyB2dCgpIHtcbiAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB2b2lkIDAgIT09IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICYmIHZvaWQgMCAhPT0gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBVbyA9IHtcbiAgICBCYXRjaEdldERvY3VtZW50czogXCJiYXRjaEdldFwiLFxuICAgIENvbW1pdDogXCJjb21taXRcIixcbiAgICBSdW5RdWVyeTogXCJydW5RdWVyeVwiXG59O1xuXG4vKipcbiAqIE1hcHMgUlBDIG5hbWVzIHRvIHRoZSBjb3JyZXNwb25kaW5nIFJFU1QgZW5kcG9pbnQgbmFtZS5cbiAqXG4gKiBXZSB1c2UgYXJyYXkgbm90YXRpb24gdG8gYXZvaWQgbWFuZ2xpbmcuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2ltcGxlIGhlbHBlciBjbGFzcyB0aGF0IGltcGxlbWVudHMgdGhlIFN0cmVhbSBpbnRlcmZhY2UgdG9cbiAqIGJyaWRnZSB0byBvdGhlciBpbXBsZW1lbnRhdGlvbnMgdGhhdCBhcmUgc3RyZWFtcyBidXQgZG8gbm90IGltcGxlbWVudCB0aGVcbiAqIGludGVyZmFjZS4gVGhlIHN0cmVhbSBjYWxsYmFja3MgYXJlIGludm9rZWQgd2l0aCB0aGUgY2FsbE9uLi4uIG1ldGhvZHMuXG4gKi9cbmNsYXNzIHFvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuSnIgPSB0LkpyLCB0aGlzLllyID0gdC5ZcjtcbiAgICB9XG4gICAgWHIodCkge1xuICAgICAgICB0aGlzLlpyID0gdDtcbiAgICB9XG4gICAgZW8odCkge1xuICAgICAgICB0aGlzLm5vID0gdDtcbiAgICB9XG4gICAgb25NZXNzYWdlKHQpIHtcbiAgICAgICAgdGhpcy5zbyA9IHQ7XG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLllyKCk7XG4gICAgfVxuICAgIHNlbmQodCkge1xuICAgICAgICB0aGlzLkpyKHQpO1xuICAgIH1cbiAgICBpbygpIHtcbiAgICAgICAgdGhpcy5acigpO1xuICAgIH1cbiAgICBybyh0KSB7XG4gICAgICAgIHRoaXMubm8odCk7XG4gICAgfVxuICAgIG9vKHQpIHtcbiAgICAgICAgdGhpcy5zbyh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEtvIGV4dGVuZHMgXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIGFsbCBSZXN0LWJhc2VkIGNvbm5lY3Rpb25zIHRvIHRoZSBiYWNrZW5kIChXZWJDaGFubmVsIGFuZFxuICogSFRUUCkuXG4gKi9cbmNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gdC5kYXRhYmFzZUlkO1xuICAgICAgICBjb25zdCBlID0gdC5zc2wgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgdGhpcy51byA9IGUgKyBcIjovL1wiICsgdC5ob3N0LCB0aGlzLmFvID0gXCJwcm9qZWN0cy9cIiArIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQgKyBcIi9kYXRhYmFzZXMvXCIgKyB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UgKyBcIi9kb2N1bWVudHNcIjtcbiAgICB9XG4gICAgY28odCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gdGhpcy5obyh0LCBlKTtcbiAgICAgICAgTyhcIlJlc3RDb25uZWN0aW9uXCIsIFwiU2VuZGluZzogXCIsIHIsIG4pO1xuICAgICAgICBjb25zdCBvID0ge307XG4gICAgICAgIHJldHVybiB0aGlzLmxvKG8sIHMsIGkpLCB0aGlzLmZvKHQsIHIsIG8sIG4pLnRoZW4oKHQgPT4gKE8oXCJSZXN0Q29ubmVjdGlvblwiLCBcIlJlY2VpdmVkOiBcIiwgdCksIFxuICAgICAgICB0KSksIChlID0+IHtcbiAgICAgICAgICAgIHRocm93ICQoXCJSZXN0Q29ubmVjdGlvblwiLCBgJHt0fSBmYWlsZWQgd2l0aCBlcnJvcjogYCwgZSwgXCJ1cmw6IFwiLCByLCBcInJlcXVlc3Q6XCIsIG4pLCBcbiAgICAgICAgICAgIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgX28odCwgZSwgbiwgcywgaSkge1xuICAgICAgICAvLyBUaGUgUkVTVCBBUEkgYXV0b21hdGljYWxseSBhZ2dyZWdhdGVzIGFsbCBvZiB0aGUgc3RyZWFtZWQgcmVzdWx0cywgc28gd2VcbiAgICAgICAgLy8gY2FuIGp1c3QgdXNlIHRoZSBub3JtYWwgaW52b2tlKCkgbWV0aG9kLlxuICAgICAgICByZXR1cm4gdGhpcy5jbyh0LCBlLCBuLCBzLCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdCwgYWRkaW5nIGFueSBhdXRob3JpemF0aW9uIHRva2VuIGlmXG4gICAgICogcHJlc2VudCBhbmQgYW55IGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3QuXG4gICAgICovICAgIGxvKHQsIGUsIG4pIHtcbiAgICAgICAgdFtcIlgtR29vZy1BcGktQ2xpZW50XCJdID0gXCJnbC1qcy8gZmlyZS9cIiArIHgsIFxuICAgICAgICAvLyBDb250ZW50LVR5cGU6IHRleHQvcGxhaW4gd2lsbCBhdm9pZCBwcmVmbGlnaHQgcmVxdWVzdHMgd2hpY2ggbWlnaHRcbiAgICAgICAgLy8gbWVzcyB3aXRoIENPUlMgYW5kIHJlZGlyZWN0cyBieSBwcm94aWVzLiBJZiB3ZSBhZGQgY3VzdG9tIGhlYWRlcnNcbiAgICAgICAgLy8gd2Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB0aGlzIGNvZGUgdG8gcG90ZW50aWFsbHkgdXNlIHRoZSAkaHR0cE92ZXJ3cml0ZVxuICAgICAgICAvLyBwYXJhbWV0ZXIgc3VwcG9ydGVkIGJ5IEVTRiB0byBhdm9pZCB0cmlnZ2VyaW5nIHByZWZsaWdodCByZXF1ZXN0cy5cbiAgICAgICAgdFtcIkNvbnRlbnQtVHlwZVwiXSA9IFwidGV4dC9wbGFpblwiLCB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCAmJiAodFtcIlgtRmlyZWJhc2UtR01QSURcIl0gPSB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCksIFxuICAgICAgICBlICYmIGUuaGVhZGVycy5mb3JFYWNoKCgoZSwgbikgPT4gdFtuXSA9IGUpKSwgbiAmJiBuLmhlYWRlcnMuZm9yRWFjaCgoKGUsIG4pID0+IHRbbl0gPSBlKSk7XG4gICAgfVxuICAgIGhvKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFVvW3RdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy51b30vdjEvJHtlfToke259YDtcbiAgICB9XG59IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSB0LmZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gdC5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIFxuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBmbyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgWGhySW87XG4gICAgICAgICAgICBvLmxpc3Rlbk9uY2UoRXZlbnRUeXBlLkNPTVBMRVRFLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoby5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEVycm9yQ29kZS5OT19FUlJPUjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBvLmdldFJlc3BvbnNlSnNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTyhcIkNvbm5lY3Rpb25cIiwgXCJYSFIgcmVjZWl2ZWQ6XCIsIEpTT04uc3RyaW5naWZ5KGUpKSwgaShlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBFcnJvckNvZGUuVElNRU9VVDpcbiAgICAgICAgICAgICAgICAgICAgICAgIE8oXCJDb25uZWN0aW9uXCIsICdSUEMgXCInICsgdCArICdcIiB0aW1lZCBvdXQnKSwgcihuZXcgUShHLkRFQURMSU5FX0VYQ0VFREVELCBcIlJlcXVlc3QgdGltZSBvdXRcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEVycm9yQ29kZS5IVFRQX0VSUk9SOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG8uZ2V0U3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTyhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIGZhaWxlZCB3aXRoIHN0YXR1czonLCBuLCBcInJlc3BvbnNlIHRleHQ6XCIsIG8uZ2V0UmVzcG9uc2VUZXh0KCkpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG8uZ2V0UmVzcG9uc2VKc29uKCkuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgdC5zdGF0dXMgJiYgdC5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgXCItXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoRykuaW5kZXhPZihlKSA+PSAwID8gZSA6IEcuVU5LTk9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSh0LnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIobmV3IFEoZSwgdC5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIobmV3IFEoRy5VTktOT1dOLCBcIlNlcnZlciByZXNwb25kZWQgd2l0aCBzdGF0dXMgXCIgKyBvLmdldFN0YXR1cygpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlZCBhbiBIVFRQX0VSUk9SIGJ1dCB0aGVyZSdzIG5vIHN0YXR1cyBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBtb3N0IHByb2JhYmx5IGEgY29ubmVjdGlvbiBpc3N1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcihuZXcgUShHLlVOQVZBSUxBQkxFLCBcIkNvbm5lY3Rpb24gZmFpbGVkLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBMKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBPKFwiQ29ubmVjdGlvblwiLCAnUlBDIFwiJyArIHQgKyAnXCIgY29tcGxldGVkLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBKU09OLnN0cmluZ2lmeShzKTtcbiAgICAgICAgICAgIG8uc2VuZChlLCBcIlBPU1RcIiwgdSwgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHdvKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFsgdGhpcy51bywgXCIvXCIsIFwiZ29vZ2xlLmZpcmVzdG9yZS52MS5GaXJlc3RvcmVcIiwgXCIvXCIsIHQsIFwiL2NoYW5uZWxcIiBdLCBpID0gY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCgpLCByID0gZ2V0U3RhdEV2ZW50VGFyZ2V0KCksIG8gPSB7XG4gICAgICAgICAgICAvLyBSZXF1aXJlZCBmb3IgYmFja2VuZCBzdGlja2luZXNzLCByb3V0aW5nIGJlaGF2aW9yIGlzIGJhc2VkIG9uIHRoaXNcbiAgICAgICAgICAgIC8vIHBhcmFtZXRlci5cbiAgICAgICAgICAgIGh0dHBTZXNzaW9uSWRQYXJhbTogXCJnc2Vzc2lvbmlkXCIsXG4gICAgICAgICAgICBpbml0TWVzc2FnZUhlYWRlcnM6IHt9LFxuICAgICAgICAgICAgbWVzc2FnZVVybFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW0gaXMgdXNlZCB0byBpbXByb3ZlIHJvdXRpbmcgYW5kIHByb2plY3QgaXNvbGF0aW9uIGJ5IHRoZVxuICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQgYW5kIG11c3QgYmUgaW5jbHVkZWQgaW4gZXZlcnkgcmVxdWVzdC5cbiAgICAgICAgICAgICAgICBkYXRhYmFzZTogYHByb2plY3RzLyR7dGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZH0vZGF0YWJhc2VzLyR7dGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlfWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZW5kUmF3SnNvbjogITAsXG4gICAgICAgICAgICBzdXBwb3J0c0Nyb3NzRG9tYWluWGhyOiAhMCxcbiAgICAgICAgICAgIGludGVybmFsQ2hhbm5lbFBhcmFtczoge1xuICAgICAgICAgICAgICAgIC8vIE92ZXJyaWRlIHRoZSBkZWZhdWx0IHRpbWVvdXQgKHJhbmRvbWl6ZWQgYmV0d2VlbiAxMC0yMCBzZWNvbmRzKSBzaW5jZVxuICAgICAgICAgICAgICAgIC8vIGEgbGFyZ2Ugd3JpdGUgYmF0Y2ggb24gYSBzbG93IGludGVybmV0IGNvbm5lY3Rpb24gbWF5IHRha2UgYSBsb25nXG4gICAgICAgICAgICAgICAgLy8gdGltZSB0byBzZW5kIHRvIHRoZSBiYWNrZW5kLiBSYXRoZXIgdGhhbiBoYXZlIFdlYkNoYW5uZWwgaW1wb3NlIGFcbiAgICAgICAgICAgICAgICAvLyB0aWdodCB0aW1lb3V0IHdoaWNoIGNvdWxkIGxlYWQgdG8gaW5maW5pdGUgdGltZW91dHMgYW5kIHJldHJpZXMsIHdlXG4gICAgICAgICAgICAgICAgLy8gc2V0IGl0IHZlcnkgbGFyZ2UgKDUtMTAgbWludXRlcykgYW5kIHJlbHkgb24gdGhlIGJyb3dzZXIncyBidWlsdGluXG4gICAgICAgICAgICAgICAgLy8gdGltZW91dHMgdG8ga2ljayBpbiBpZiB0aGUgcmVxdWVzdCBpc24ndCB3b3JraW5nLlxuICAgICAgICAgICAgICAgIGZvcndhcmRDaGFubmVsUmVxdWVzdFRpbWVvdXRNczogNmU1XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZm9yY2VMb25nUG9sbGluZzogdGhpcy5mb3JjZUxvbmdQb2xsaW5nLFxuICAgICAgICAgICAgZGV0ZWN0QnVmZmVyaW5nUHJveHk6IHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudXNlRmV0Y2hTdHJlYW1zICYmIChvLnhtbEh0dHBGYWN0b3J5ID0gbmV3IEZldGNoWG1sSHR0cEZhY3Rvcnkoe30pKSwgdGhpcy5sbyhvLmluaXRNZXNzYWdlSGVhZGVycywgZSwgbiksIFxuICAgICAgICAvLyBTZW5kaW5nIHRoZSBjdXN0b20gaGVhZGVycyB3ZSBqdXN0IGFkZGVkIHRvIHJlcXVlc3QuaW5pdE1lc3NhZ2VIZWFkZXJzXG4gICAgICAgIC8vIChBdXRob3JpemF0aW9uLCBldGMuKSB3aWxsIHRyaWdnZXIgdGhlIGJyb3dzZXIgdG8gbWFrZSBhIENPUlMgcHJlZmxpZ2h0XG4gICAgICAgIC8vIHJlcXVlc3QgYmVjYXVzZSB0aGUgWEhSIHdpbGwgbm8gbG9uZ2VyIG1lZXQgdGhlIGNyaXRlcmlhIGZvciBhIFwic2ltcGxlXCJcbiAgICAgICAgLy8gQ09SUyByZXF1ZXN0OlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVFRQL0NPUlMjU2ltcGxlX3JlcXVlc3RzXG4gICAgICAgIC8vIFRoZXJlZm9yZSB0byBhdm9pZCB0aGUgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdCAoYW4gZXh0cmEgbmV0d29ya1xuICAgICAgICAvLyByb3VuZHRyaXApLCB3ZSB1c2UgdGhlIGh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0gb3B0aW9uIHRvIHNwZWNpZnkgdGhhdFxuICAgICAgICAvLyB0aGUgaGVhZGVycyBzaG91bGQgaW5zdGVhZCBiZSBlbmNvZGVkIGludG8gYSBzcGVjaWFsIFwiJGh0dHBIZWFkZXJzXCIgcXVlcnlcbiAgICAgICAgLy8gcGFyYW1ldGVyLCB3aGljaCBpcyByZWNvZ25pemVkIGJ5IHRoZSB3ZWJjaGFubmVsIGJhY2tlbmQuIFRoaXMgaXNcbiAgICAgICAgLy8gZm9ybWFsbHkgZGVmaW5lZCBoZXJlOlxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2Nsb3N1cmUtbGlicmFyeS9ibG9iL2IwZTE4MTViMTNmYjkyYTQ2ZDdjOWIzYzMwZGU1ZDZhMzk2YTMyNDUvY2xvc3VyZS9nb29nL25ldC9ycGMvaHR0cGNvcnMuanMjTDMyXG4gICAgICAgIC8vIFRPRE8oYi8xNDU2MjQ3NTYpOiBUaGVyZSBpcyBhIGJhY2tlbmQgYnVnIHdoZXJlICRodHRwSGVhZGVycyBpc24ndCByZXNwZWN0ZWQgaWYgdGhlIHJlcXVlc3RcbiAgICAgICAgLy8gZG9lc24ndCBoYXZlIGFuIE9yaWdpbiBoZWFkZXIuIFNvIHdlIGhhdmUgdG8gZXhjbHVkZSBhIGZldyBicm93c2VyIGVudmlyb25tZW50cyB0aGF0IGFyZVxuICAgICAgICAvLyBrbm93biB0byAoc29tZXRpbWVzKSBub3QgaW5jbHVkZSBhbiBPcmlnaW4uIFNlZVxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy8xNDkxLlxuICAgICAgICBpc01vYmlsZUNvcmRvdmEoKSB8fCBpc1JlYWN0TmF0aXZlKCkgfHwgaXNFbGVjdHJvbigpIHx8IGlzSUUoKSB8fCBpc1VXUCgpIHx8IGlzQnJvd3NlckV4dGVuc2lvbigpIHx8IChvLmh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0gPSBcIiRodHRwSGVhZGVyc1wiKTtcbiAgICAgICAgY29uc3QgdSA9IHMuam9pbihcIlwiKTtcbiAgICAgICAgTyhcIkNvbm5lY3Rpb25cIiwgXCJDcmVhdGluZyBXZWJDaGFubmVsOiBcIiArIHUsIG8pO1xuICAgICAgICBjb25zdCBhID0gaS5jcmVhdGVXZWJDaGFubmVsKHUsIG8pO1xuICAgICAgICAvLyBXZWJDaGFubmVsIHN1cHBvcnRzIHNlbmRpbmcgdGhlIGZpcnN0IG1lc3NhZ2Ugd2l0aCB0aGUgaGFuZHNoYWtlIC0gc2F2aW5nXG4gICAgICAgIC8vIGEgbmV0d29yayByb3VuZCB0cmlwLiBIb3dldmVyLCBpdCB3aWxsIGhhdmUgdG8gY2FsbCBzZW5kIGluIHRoZSBzYW1lXG4gICAgICAgIC8vIEpTIGV2ZW50IGxvb3AgYXMgb3Blbi4gSW4gb3JkZXIgdG8gZW5mb3JjZSB0aGlzLCB3ZSBkZWxheSBhY3R1YWxseVxuICAgICAgICAvLyBvcGVuaW5nIHRoZSBXZWJDaGFubmVsIHVudGlsIHNlbmQgaXMgY2FsbGVkLiBXaGV0aGVyIHdlIGhhdmUgY2FsbGVkXG4gICAgICAgIC8vIG9wZW4gaXMgdHJhY2tlZCB3aXRoIHRoaXMgdmFyaWFibGUuXG4gICAgICAgICAgICAgICAgbGV0IGMgPSAhMSwgaCA9ICExO1xuICAgICAgICAvLyBBIGZsYWcgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHN0cmVhbSB3YXMgY2xvc2VkIChieSB1cyBvciB0aHJvdWdoIGFuXG4gICAgICAgIC8vIGVycm9yL2Nsb3NlIGV2ZW50KSB0byBhdm9pZCBkZWxpdmVyaW5nIG11bHRpcGxlIGNsb3NlIGV2ZW50cyBvciBzZW5kaW5nXG4gICAgICAgIC8vIG9uIGEgY2xvc2VkIHN0cmVhbVxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBuZXcgcW8oe1xuICAgICAgICAgICAgSnI6IHQgPT4ge1xuICAgICAgICAgICAgICAgIGggPyBPKFwiQ29ubmVjdGlvblwiLCBcIk5vdCBzZW5kaW5nIGJlY2F1c2UgV2ViQ2hhbm5lbCBpcyBjbG9zZWQ6XCIsIHQpIDogKGMgfHwgKE8oXCJDb25uZWN0aW9uXCIsIFwiT3BlbmluZyBXZWJDaGFubmVsIHRyYW5zcG9ydC5cIiksIFxuICAgICAgICAgICAgICAgIGEub3BlbigpLCBjID0gITApLCBPKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgc2VuZGluZzpcIiwgdCksIGEuc2VuZCh0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgWXI6ICgpID0+IGEuY2xvc2UoKVxuICAgICAgICB9KSwgeSA9ICh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IGNsb3N1cmUgdHlwaW5nIHNlZW1zIGJyb2tlbiBiZWNhdXNlIFdlYkNoYW5uZWwgZG9lc1xuICAgICAgICAgICAgLy8gbm90IGltcGxlbWVudCBnb29nLmV2ZW50cy5MaXN0ZW5hYmxlXG4gICAgICAgICAgICB0Lmxpc3RlbihlLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbih0KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgICAgICAgICAgICAgIH0pLCAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIC8vIENsb3N1cmUgZXZlbnRzIGFyZSBndWFyZGVkIGFuZCBleGNlcHRpb25zIGFyZSBzd2FsbG93ZWQsIHNvIGNhdGNoIGFueVxuICAgICAgICAvLyBleGNlcHRpb24gYW5kIHJldGhyb3cgdXNpbmcgYSBzZXRUaW1lb3V0IHNvIHRoZXkgYmVjb21lIHZpc2libGUgYWdhaW4uXG4gICAgICAgIC8vIE5vdGUgdGhhdCBldmVudHVhbGx5IHRoaXMgZnVuY3Rpb24gY291bGQgZ28gYXdheSBpZiB3ZSBhcmUgY29uZmlkZW50XG4gICAgICAgIC8vIGVub3VnaCB0aGUgY29kZSBpcyBleGNlcHRpb24gZnJlZS5cbiAgICAgICAgICAgICAgICByZXR1cm4geShhLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5PUEVOLCAoKCkgPT4ge1xuICAgICAgICAgICAgaCB8fCBPKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IG9wZW5lZC5cIik7XG4gICAgICAgIH0pKSwgeShhLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5DTE9TRSwgKCgpID0+IHtcbiAgICAgICAgICAgIGggfHwgKGggPSAhMCwgTyhcIkNvbm5lY3Rpb25cIiwgXCJXZWJDaGFubmVsIHRyYW5zcG9ydCBjbG9zZWRcIiksIGwucm8oKSk7XG4gICAgICAgIH0pKSwgeShhLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5FUlJPUiwgKHQgPT4ge1xuICAgICAgICAgICAgaCB8fCAoaCA9ICEwLCAkKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IGVycm9yZWQ6XCIsIHQpLCBsLnJvKG5ldyBRKEcuVU5BVkFJTEFCTEUsIFwiVGhlIG9wZXJhdGlvbiBjb3VsZCBub3QgYmUgY29tcGxldGVkXCIpKSk7XG4gICAgICAgIH0pKSwgeShhLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5NRVNTQUdFLCAodCA9PiB7XG4gICAgICAgICAgICB2YXIgZTtcbiAgICAgICAgICAgIGlmICghaCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmRhdGFbMF07XG4gICAgICAgICAgICAgICAgVSghIW4pO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8zNTE0Mzg5MSk6IFRoZXJlIGlzIGEgYnVnIGluIE9uZSBQbGF0Zm9ybSB0aGF0IGNhdXNlZCBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyAoYW5kIG9ubHkgZXJyb3JzKSB0byBiZSB3cmFwcGVkIGluIGFuIGV4dHJhIGFycmF5LiBUbyBiZSBmb3J3YXJkXG4gICAgICAgICAgICAgICAgLy8gY29tcGF0aWJsZSB3aXRoIHRoZSBidWcgd2UgbmVlZCB0byBjaGVjayBlaXRoZXIgY29uZGl0aW9uLiBUaGUgbGF0dGVyXG4gICAgICAgICAgICAgICAgLy8gY2FuIGJlIHJlbW92ZWQgb25jZSB0aGUgZml4IGhhcyBiZWVuIHJvbGxlZCBvdXQuXG4gICAgICAgICAgICAgICAgLy8gVXNlIGFueSBiZWNhdXNlIG1zZ0RhdGEuZXJyb3IgaXMgbm90IHR5cGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLCBpID0gcy5lcnJvciB8fCAobnVsbCA9PT0gKGUgPSBzWzBdKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmVycm9yKTtcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgICAgICBPKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgcmVjZWl2ZWQgZXJyb3I6XCIsIGkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvci5zdGF0dXMgd2lsbCBiZSBhIHN0cmluZyBsaWtlICdPSycgb3IgJ05PVF9GT1VORCcuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSBcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBhIEdSUEMgc3RhdHVzIGlkZW50aWZpZXIgbGlrZSAnTk9UX0ZPVU5EJy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBzdGF0dXMgc3RyaW5nIG9yIHVuZGVmaW5lZCBpZlxuICogICAgIHRoZXJlIGlzIG5vIG1hdGNoLlxuICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvb2t1cCBieSBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gQm5bdF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSBlKSByZXR1cm4gcW4oZSk7XG4gICAgICAgICAgICAgICAgICAgIH0odCksIG4gPSBpLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IEcuSU5URVJOQUwsIG4gPSBcIlVua25vd24gZXJyb3Igc3RhdHVzOiBcIiArIHQgKyBcIiB3aXRoIG1lc3NhZ2UgXCIgKyBpLm1lc3NhZ2UpLCBcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBjbG9zZWQgc28gbm8gZnVydGhlciBldmVudHMgYXJlIHByb3BhZ2F0ZWRcbiAgICAgICAgICAgICAgICAgICAgaCA9ICEwLCBsLnJvKG5ldyBRKGUsIG4pKSwgYS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBPKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgcmVjZWl2ZWQ6XCIsIG4pLCBsLm9vKG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHkociwgRXZlbnQuU1RBVF9FVkVOVCwgKHQgPT4ge1xuICAgICAgICAgICAgdC5zdGF0ID09PSBTdGF0LlBST1hZID8gTyhcIkNvbm5lY3Rpb25cIiwgXCJEZXRlY3RlZCBidWZmZXJpbmcgcHJveHlcIikgOiB0LnN0YXQgPT09IFN0YXQuTk9QUk9YWSAmJiBPKFwiQ29ubmVjdGlvblwiLCBcIkRldGVjdGVkIG5vIGJ1ZmZlcmluZyBwcm94eVwiKTtcbiAgICAgICAgfSkpLCBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBUZWNobmljYWxseSB3ZSBjb3VsZC9zaG91bGQgd2FpdCBmb3IgdGhlIFdlYkNoYW5uZWwgb3BlbmVkIGV2ZW50LFxuICAgICAgICAgICAgLy8gYnV0IGJlY2F1c2Ugd2Ugd2FudCB0byBzZW5kIHRoZSBmaXJzdCBtZXNzYWdlIHdpdGggdGhlIFdlYkNoYW5uZWxcbiAgICAgICAgICAgIC8vIGhhbmRzaGFrZSB3ZSBwcmV0ZW5kIHRoZSBjaGFubmVsIG9wZW5lZCBoZXJlIChhc3luY2hyb25vdXNseSksIGFuZFxuICAgICAgICAgICAgLy8gdGhlbiBkZWxheSB0aGUgYWN0dWFsIG9wZW4gdW50aWwgdGhlIGZpcnN0IG1lc3NhZ2UgaXMgc2VudC5cbiAgICAgICAgICAgIGwuaW8oKTtcbiAgICAgICAgfSksIDApLCBsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBJbml0aWFsaXplcyB0aGUgV2ViQ2hhbm5lbENvbm5lY3Rpb24gZm9yIHRoZSBicm93c2VyLiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBUaGUgUGxhdGZvcm0ncyAnd2luZG93JyBpbXBsZW1lbnRhdGlvbiBvciBudWxsIGlmIG5vdCBhdmFpbGFibGUuICovXG5mdW5jdGlvbiBHbygpIHtcbiAgICAvLyBgd2luZG93YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IG51bGw7XG59XG5cbi8qKiBUaGUgUGxhdGZvcm0ncyAnZG9jdW1lbnQnIGltcGxlbWVudGF0aW9uIG9yIG51bGwgaWYgbm90IGF2YWlsYWJsZS4gKi8gZnVuY3Rpb24gUW8oKSB7XG4gICAgLy8gYGRvY3VtZW50YCBpcyBub3QgYWx3YXlzIGF2YWlsYWJsZSwgZS5nLiBpbiBSZWFjdE5hdGl2ZSBhbmQgV2ViV29ya2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzXG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGRvY3VtZW50ID8gZG9jdW1lbnQgOiBudWxsO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBqbyh0KSB7XG4gICAgcmV0dXJuIG5ldyBscyh0LCAvKiB1c2VQcm90bzNKc29uPSAqLyAhMCk7XG59XG5cbi8qKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhlIFBsYXRmb3JtJ3MgJ1RleHRFbmNvZGVyJyBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuLyoqXG4gKiBBIGhlbHBlciBmb3IgcnVubmluZyBkZWxheWVkIHRhc2tzIGZvbGxvd2luZyBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIGN1cnZlXG4gKiBiZXR3ZWVuIGF0dGVtcHRzLlxuICpcbiAqIEVhY2ggZGVsYXkgaXMgbWFkZSB1cCBvZiBhIFwiYmFzZVwiIGRlbGF5IHdoaWNoIGZvbGxvd3MgdGhlIGV4cG9uZW50aWFsXG4gKiBiYWNrb2ZmIGN1cnZlLCBhbmQgYSArLy0gNTAlIFwiaml0dGVyXCIgdGhhdCBpcyBjYWxjdWxhdGVkIGFuZCBhZGRlZCB0byB0aGVcbiAqIGJhc2UgZGVsYXkuIFRoaXMgcHJldmVudHMgY2xpZW50cyBmcm9tIGFjY2lkZW50YWxseSBzeW5jaHJvbml6aW5nIHRoZWlyXG4gKiBkZWxheXMgY2F1c2luZyBzcGlrZXMgb2YgbG9hZCB0byB0aGUgYmFja2VuZC5cbiAqL1xuY2xhc3MgV28ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBBc3luY1F1ZXVlIHRvIHJ1biBiYWNrb2ZmIG9wZXJhdGlvbnMgb24uXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIElEIHRvIHVzZSB3aGVuIHNjaGVkdWxpbmcgYmFja29mZiBvcGVyYXRpb25zIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBpbml0aWFsIGRlbGF5ICh1c2VkIGFzIHRoZSBiYXNlIGRlbGF5IG9uIHRoZSBmaXJzdCByZXRyeSBhdHRlbXB0KS5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIGxpdHRsZSBhcyAwLjUqaW5pdGlhbERlbGF5TXMuXG4gICAgICovXG4gICAgbiA9IDFlM1xuICAgIC8qKlxuICAgICAqIFRoZSBtdWx0aXBsaWVyIHRvIHVzZSB0byBkZXRlcm1pbmUgdGhlIGV4dGVuZGVkIGJhc2UgZGVsYXkgYWZ0ZXIgZWFjaFxuICAgICAqIGF0dGVtcHQuXG4gICAgICovICwgcyA9IDEuNVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIGJhc2UgZGVsYXkgYWZ0ZXIgd2hpY2ggbm8gZnVydGhlciBiYWNrb2ZmIGlzIHBlcmZvcm1lZC5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIG11Y2ggYXMgMS41Km1heERlbGF5TXMuXG4gICAgICovICwgaSA9IDZlNCkge1xuICAgICAgICB0aGlzLlluID0gdCwgdGhpcy50aW1lcklkID0gZSwgdGhpcy5tbyA9IG4sIHRoaXMueW8gPSBzLCB0aGlzLnBvID0gaSwgdGhpcy5JbyA9IDAsIFxuICAgICAgICB0aGlzLlRvID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCBiYWNrb2ZmIGF0dGVtcHQsIGFzIGVwb2NoIG1pbGxpc2Vjb25kcy4gKi9cbiAgICAgICAgdGhpcy5FbyA9IERhdGUubm93KCksIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5LlxuICAgICAqXG4gICAgICogVGhlIHZlcnkgbmV4dCBiYWNrb2ZmQW5kV2FpdCgpIHdpbGwgaGF2ZSBubyBkZWxheS4gSWYgaXQgaXMgY2FsbGVkIGFnYWluXG4gICAgICogKGkuZS4gZHVlIHRvIGFuIGVycm9yKSwgaW5pdGlhbERlbGF5TXMgKHBsdXMgaml0dGVyKSB3aWxsIGJlIHVzZWQsIGFuZFxuICAgICAqIHN1YnNlcXVlbnQgb25lcyB3aWxsIGluY3JlYXNlIGFjY29yZGluZyB0byB0aGUgYmFja29mZkZhY3Rvci5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuSW8gPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkgdG8gdGhlIG1heGltdW0gZGVsYXkgKGUuZy4gZm9yIHVzZSBhZnRlciBhXG4gICAgICogUkVTT1VSQ0VfRVhIQVVTVEVEIGVycm9yKS5cbiAgICAgKi8gICAgQW8oKSB7XG4gICAgICAgIHRoaXMuSW8gPSB0aGlzLnBvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGN1cnJlbnREZWxheU1zLCBhbmQgaW5jcmVhc2VzIHRoZVxuICAgICAqIGRlbGF5IGZvciBhbnkgc3Vic2VxdWVudCBhdHRlbXB0cy4gSWYgdGhlcmUgd2FzIGEgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvblxuICAgICAqIGFscmVhZHksIGl0IHdpbGwgYmUgY2FuY2VsZWQuXG4gICAgICovICAgIFJvKHQpIHtcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uLlxuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICAvLyBGaXJzdCBzY2hlZHVsZSB1c2luZyB0aGUgY3VycmVudCBiYXNlICh3aGljaCBtYXkgYmUgMCBhbmQgc2hvdWxkIGJlXG4gICAgICAgIC8vIGhvbm9yZWQgYXMgc3VjaCkuXG4gICAgICAgIGNvbnN0IGUgPSBNYXRoLmZsb29yKHRoaXMuSW8gKyB0aGlzLmJvKCkpLCBuID0gTWF0aC5tYXgoMCwgRGF0ZS5ub3coKSAtIHRoaXMuRW8pLCBzID0gTWF0aC5tYXgoMCwgZSAtIG4pO1xuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IGxhc3RBdHRlbXB0VGltZSBiZWluZyBpbiB0aGUgZnV0dXJlIGR1ZSB0byBhIGNsb2NrIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBzID4gMCAmJiBPKFwiRXhwb25lbnRpYWxCYWNrb2ZmXCIsIGBCYWNraW5nIG9mZiBmb3IgJHtzfSBtcyAoYmFzZSBkZWxheTogJHt0aGlzLklvfSBtcywgZGVsYXkgd2l0aCBqaXR0ZXI6ICR7ZX0gbXMsIGxhc3QgYXR0ZW1wdDogJHtufSBtcyBhZ28pYCksIFxuICAgICAgICB0aGlzLlRvID0gdGhpcy5Zbi5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLnRpbWVySWQsIHMsICgoKSA9PiAodGhpcy5FbyA9IERhdGUubm93KCksIFxuICAgICAgICB0KCkpKSksIFxuICAgICAgICAvLyBBcHBseSBiYWNrb2ZmIGZhY3RvciB0byBkZXRlcm1pbmUgbmV4dCBkZWxheSBhbmQgZW5zdXJlIGl0IGlzIHdpdGhpblxuICAgICAgICAvLyBib3VuZHMuXG4gICAgICAgIHRoaXMuSW8gKj0gdGhpcy55bywgdGhpcy5JbyA8IHRoaXMubW8gJiYgKHRoaXMuSW8gPSB0aGlzLm1vKSwgdGhpcy5JbyA+IHRoaXMucG8gJiYgKHRoaXMuSW8gPSB0aGlzLnBvKTtcbiAgICB9XG4gICAgUG8oKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuVG8gJiYgKHRoaXMuVG8uc2tpcERlbGF5KCksIHRoaXMuVG8gPSBudWxsKTtcbiAgICB9XG4gICAgY2FuY2VsKCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLlRvICYmICh0aGlzLlRvLmNhbmNlbCgpLCB0aGlzLlRvID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgcmFuZG9tIHZhbHVlIGluIHRoZSByYW5nZSBbLWN1cnJlbnRCYXNlTXMvMiwgY3VycmVudEJhc2VNcy8yXSAqLyAgICBibygpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJhbmRvbSgpIC0gLjUpICogdGhpcy5JbztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBpcyBhbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIHN0cmVhbWluZyBSUENcbiAqIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZC4gSXQncyBidWlsdCBvbiB0b3Agb2YgdGhlIGNvbm5lY3Rpb25zIG93biBzdXBwb3J0XG4gKiBmb3Igc3RyZWFtaW5nIFJQQ3MsIGFuZCBhZGRzIHNldmVyYWwgY3JpdGljYWwgZmVhdHVyZXMgZm9yIG91ciBjbGllbnRzOlxuICpcbiAqICAgLSBFeHBvbmVudGlhbCBiYWNrb2ZmIG9uIGZhaWx1cmVcbiAqICAgLSBBdXRoZW50aWNhdGlvbiB2aWEgQ3JlZGVudGlhbHNQcm92aWRlclxuICogICAtIERpc3BhdGNoaW5nIGFsbCBjYWxsYmFja3MgaW50byB0aGUgc2hhcmVkIHdvcmtlciBxdWV1ZVxuICogICAtIENsb3NpbmcgaWRsZSBzdHJlYW1zIGFmdGVyIDYwIHNlY29uZHMgb2YgaW5hY3Rpdml0eVxuICpcbiAqIFN1YmNsYXNzZXMgb2YgUGVyc2lzdGVudFN0cmVhbSBpbXBsZW1lbnQgc2VyaWFsaXphdGlvbiBvZiBtb2RlbHMgdG8gYW5kXG4gKiBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm90b2NvbCBidWZmZXJzIGZvciBhIHNwZWNpZmljXG4gKiBzdHJlYW1pbmcgUlBDLlxuICpcbiAqICMjIFN0YXJ0aW5nIGFuZCBTdG9wcGluZ1xuICpcbiAqIFN0cmVhbWluZyBSUENzIGFyZSBzdGF0ZWZ1bCBhbmQgbmVlZCB0byBiZSBzdGFydCgpZWQgYmVmb3JlIG1lc3NhZ2VzIGNhblxuICogYmUgc2VudCBhbmQgcmVjZWl2ZWQuIFRoZSBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgb25PcGVuKCkgZnVuY3Rpb25cbiAqIG9mIHRoZSBsaXN0ZW5lciBvbmNlIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IHJlcXVlc3RzLlxuICpcbiAqIFNob3VsZCBhIHN0YXJ0KCkgZmFpbCwgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIHJlZ2lzdGVyZWQgb25DbG9zZSgpXG4gKiBsaXN0ZW5lciB3aXRoIGEgRmlyZXN0b3JlRXJyb3IgaW5kaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcuXG4gKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBzdGFydGVkIGFuZCBzdG9wcGVkIHJlcGVhdGVkbHkuXG4gKlxuICogR2VuZXJpYyB0eXBlczpcbiAqICBTZW5kVHlwZTogVGhlIHR5cGUgb2YgdGhlIG91dGdvaW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXG4gKiAgUmVjZWl2ZVR5cGU6IFRoZSB0eXBlIG9mIHRoZSBpbmNvbWluZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIExpc3RlbmVyVHlwZTogVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBjYWxsYmFja3NcbiAqL1xuY2xhc3Mgem8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpIHtcbiAgICAgICAgdGhpcy5ZbiA9IHQsIHRoaXMuVm8gPSBuLCB0aGlzLnZvID0gcywgdGhpcy5TbyA9IGksIHRoaXMuYXV0aENyZWRlbnRpYWxzUHJvdmlkZXIgPSByLCBcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzUHJvdmlkZXIgPSBvLCB0aGlzLmxpc3RlbmVyID0gdSwgdGhpcy5zdGF0ZSA9IDAgLyogSW5pdGlhbCAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcbiAgICAgICAgICogY2xvc2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkRvID0gMCwgdGhpcy5DbyA9IG51bGwsIHRoaXMueG8gPSBudWxsLCB0aGlzLnN0cmVhbSA9IG51bGwsIHRoaXMuTm8gPSBuZXcgV28odCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBzdGFydCgpIGhhcyBiZWVuIGNhbGxlZCBhbmQgbm8gZXJyb3IgaGFzIG9jY3VycmVkLiBUcnVlXG4gICAgICogaW5kaWNhdGVzIHRoZSBzdHJlYW0gaXMgb3BlbiBvciBpbiB0aGUgcHJvY2VzcyBvZiBvcGVuaW5nICh3aGljaFxuICAgICAqIGVuY29tcGFzc2VzIHJlc3BlY3RpbmcgYmFja29mZiwgZ2V0dGluZyBhdXRoIHRva2VucywgYW5kIHN0YXJ0aW5nIHRoZVxuICAgICAqIGFjdHVhbCBSUEMpLiBVc2UgaXNPcGVuKCkgdG8gZGV0ZXJtaW5lIGlmIHRoZSBzdHJlYW0gaXMgb3BlbiBhbmQgcmVhZHkgZm9yXG4gICAgICogb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIGtvKCkge1xuICAgICAgICByZXR1cm4gMSAvKiBTdGFydGluZyAqLyA9PT0gdGhpcy5zdGF0ZSB8fCA1IC8qIEJhY2tvZmYgKi8gPT09IHRoaXMuc3RhdGUgfHwgdGhpcy5NbygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHVuZGVybHlpbmcgUlBDIGlzIG9wZW4gKHRoZSBvbk9wZW4oKSBsaXN0ZW5lciBoYXMgYmVlblxuICAgICAqIGNhbGxlZCkgYW5kIHRoZSBzdHJlYW0gaXMgcmVhZHkgZm9yIG91dGJvdW5kIHJlcXVlc3RzLlxuICAgICAqLyAgICBNbygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogT3BlbiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCAzIC8qIEhlYWx0aHkgKi8gPT09IHRoaXMuc3RhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgUlBDLiBPbmx5IGFsbG93ZWQgaWYgaXNTdGFydGVkKCkgcmV0dXJucyBmYWxzZS4gVGhlIHN0cmVhbSBpc1xuICAgICAqIG5vdCBpbW1lZGlhdGVseSByZWFkeSBmb3IgdXNlOiBvbk9wZW4oKSB3aWxsIGJlIGludm9rZWQgd2hlbiB0aGUgUlBDIGlzXG4gICAgICogcmVhZHkgZm9yIG91dGJvdW5kIHJlcXVlc3RzLCBhdCB3aGljaCBwb2ludCBpc09wZW4oKSB3aWxsIHJldHVybiB0cnVlLlxuICAgICAqXG4gICAgICogV2hlbiBzdGFydCByZXR1cm5zLCBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiB0cnVlLlxuICAgICAqLyAgICBzdGFydCgpIHtcbiAgICAgICAgNCAvKiBFcnJvciAqLyAhPT0gdGhpcy5zdGF0ZSA/IHRoaXMuYXV0aCgpIDogdGhpcy5PbygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdG9wcyB0aGUgUlBDLiBUaGlzIGNhbGwgaXMgaWRlbXBvdGVudCBhbmQgYWxsb3dlZCByZWdhcmRsZXNzIG9mIHRoZVxuICAgICAqIGN1cnJlbnQgaXNTdGFydGVkKCkgc3RhdGUuXG4gICAgICpcbiAgICAgKiBXaGVuIHN0b3AgcmV0dXJucywgaXNTdGFydGVkKCkgYW5kIGlzT3BlbigpIHdpbGwgYm90aCByZXR1cm4gZmFsc2UuXG4gICAgICovICAgIGFzeW5jIHN0b3AoKSB7XG4gICAgICAgIHRoaXMua28oKSAmJiBhd2FpdCB0aGlzLmNsb3NlKDAgLyogSW5pdGlhbCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFmdGVyIGFuIGVycm9yIHRoZSBzdHJlYW0gd2lsbCB1c3VhbGx5IGJhY2sgb2ZmIG9uIHRoZSBuZXh0IGF0dGVtcHQgdG9cbiAgICAgKiBzdGFydCBpdC4gSWYgdGhlIGVycm9yIHdhcnJhbnRzIGFuIGltbWVkaWF0ZSByZXN0YXJ0IG9mIHRoZSBzdHJlYW0sIHRoZVxuICAgICAqIHNlbmRlciBjYW4gdXNlIHRoaXMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgcmVjZWl2ZXIgc2hvdWxkIG5vdCBiYWNrIG9mZi5cbiAgICAgKlxuICAgICAqIEVhY2ggZXJyb3Igd2lsbCBjYWxsIHRoZSBvbkNsb3NlKCkgbGlzdGVuZXIuIFRoYXQgZnVuY3Rpb24gY2FuIGRlY2lkZSB0b1xuICAgICAqIGluaGliaXQgYmFja29mZiBpZiByZXF1aXJlZC5cbiAgICAgKi8gICAgRm8oKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSAwIC8qIEluaXRpYWwgKi8gLCB0aGlzLk5vLnJlc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1hcmtzIHRoaXMgc3RyZWFtIGFzIGlkbGUuIElmIG5vIGZ1cnRoZXIgYWN0aW9ucyBhcmUgcGVyZm9ybWVkIG9uIHRoZVxuICAgICAqIHN0cmVhbSBmb3Igb25lIG1pbnV0ZSwgdGhlIHN0cmVhbSB3aWxsIGF1dG9tYXRpY2FsbHkgY2xvc2UgaXRzZWxmIGFuZFxuICAgICAqIG5vdGlmeSB0aGUgc3RyZWFtJ3Mgb25DbG9zZSgpIGhhbmRsZXIgd2l0aCBTdGF0dXMuT0suIFRoZSBzdHJlYW0gd2lsbCB0aGVuXG4gICAgICogYmUgaW4gYSAhaXNTdGFydGVkKCkgc3RhdGUsIHJlcXVpcmluZyB0aGUgY2FsbGVyIHRvIHN0YXJ0IHRoZSBzdHJlYW0gYWdhaW5cbiAgICAgKiBiZWZvcmUgZnVydGhlciB1c2UuXG4gICAgICpcbiAgICAgKiBPbmx5IHN0cmVhbXMgdGhhdCBhcmUgaW4gc3RhdGUgJ09wZW4nIGNhbiBiZSBtYXJrZWQgaWRsZSwgYXMgYWxsIG90aGVyXG4gICAgICogc3RhdGVzIGltcGx5IHBlbmRpbmcgbmV0d29yayBvcGVyYXRpb25zLlxuICAgICAqLyAgICAkbygpIHtcbiAgICAgICAgLy8gU3RhcnRzIHRoZSBpZGxlIHRpbWUgaWYgd2UgYXJlIGluIHN0YXRlICdPcGVuJyBhbmQgYXJlIG5vdCB5ZXQgYWxyZWFkeVxuICAgICAgICAvLyBydW5uaW5nIGEgdGltZXIgKGluIHdoaWNoIGNhc2UgdGhlIHByZXZpb3VzIGlkbGUgdGltZW91dCBzdGlsbCBhcHBsaWVzKS5cbiAgICAgICAgdGhpcy5NbygpICYmIG51bGwgPT09IHRoaXMuQ28gJiYgKHRoaXMuQ28gPSB0aGlzLlluLmVucXVldWVBZnRlckRlbGF5KHRoaXMuVm8sIDZlNCwgKCgpID0+IHRoaXMuQm8oKSkpKTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgbWVzc2FnZSB0byB0aGUgdW5kZXJseWluZyBzdHJlYW0uICovICAgIExvKHQpIHtcbiAgICAgICAgdGhpcy5VbygpLCB0aGlzLnN0cmVhbS5zZW5kKHQpO1xuICAgIH1cbiAgICAvKiogQ2FsbGVkIGJ5IHRoZSBpZGxlIHRpbWVyIHdoZW4gdGhlIHN0cmVhbSBzaG91bGQgY2xvc2UgZHVlIHRvIGluYWN0aXZpdHkuICovICAgIGFzeW5jIEJvKCkge1xuICAgICAgICBpZiAodGhpcy5NbygpKSBcbiAgICAgICAgLy8gV2hlbiB0aW1pbmcgb3V0IGFuIGlkbGUgc3RyZWFtIHRoZXJlJ3Mgbm8gcmVhc29uIHRvIGZvcmNlIHRoZSBzdHJlYW0gaW50byBiYWNrb2ZmIHdoZW5cbiAgICAgICAgLy8gaXQgcmVzdGFydHMgc28gc2V0IHRoZSBzdHJlYW0gc3RhdGUgdG8gSW5pdGlhbCBpbnN0ZWFkIG9mIEVycm9yLlxuICAgICAgICByZXR1cm4gdGhpcy5jbG9zZSgwIC8qIEluaXRpYWwgKi8pO1xuICAgIH1cbiAgICAvKiogTWFya3MgdGhlIHN0cmVhbSBhcyBhY3RpdmUgYWdhaW4uICovICAgIFVvKCkge1xuICAgICAgICB0aGlzLkNvICYmICh0aGlzLkNvLmNhbmNlbCgpLCB0aGlzLkNvID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKiBDYW5jZWxzIHRoZSBoZWFsdGggY2hlY2sgZGVsYXllZCBvcGVyYXRpb24uICovICAgIHFvKCkge1xuICAgICAgICB0aGlzLnhvICYmICh0aGlzLnhvLmNhbmNlbCgpLCB0aGlzLnhvID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgc3RyZWFtIGFuZCBjbGVhbnMgdXAgYXMgbmVjZXNzYXJ5OlxuICAgICAqXG4gICAgICogKiBjbG9zZXMgdGhlIHVuZGVybHlpbmcgR1JQQyBzdHJlYW07XG4gICAgICogKiBjYWxscyB0aGUgb25DbG9zZSBoYW5kbGVyIHdpdGggdGhlIGdpdmVuICdlcnJvcic7XG4gICAgICogKiBzZXRzIGludGVybmFsIHN0cmVhbSBzdGF0ZSB0byAnZmluYWxTdGF0ZSc7XG4gICAgICogKiBhZGp1c3RzIHRoZSBiYWNrb2ZmIHRpbWVyIGJhc2VkIG9uIHRoZSBlcnJvclxuICAgICAqXG4gICAgICogQSBuZXcgc3RyZWFtIGNhbiBiZSBvcGVuZWQgYnkgY2FsbGluZyBzdGFydCgpLlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpbmFsU3RhdGUgLSB0aGUgaW50ZW5kZWQgc3RhdGUgb2YgdGhlIHN0cmVhbSBhZnRlciBjbG9zaW5nLlxuICAgICAqIEBwYXJhbSBlcnJvciAtIHRoZSBlcnJvciB0aGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIHdpdGguXG4gICAgICovICAgIGFzeW5jIGNsb3NlKHQsIGUpIHtcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBvdXRzdGFuZGluZyB0aW1lcnMgKHRoZXkncmUgZ3VhcmFudGVlZCBub3QgdG8gZXhlY3V0ZSkuXG4gICAgICAgIHRoaXMuVW8oKSwgdGhpcy5xbygpLCB0aGlzLk5vLmNhbmNlbCgpLCBcbiAgICAgICAgLy8gSW52YWxpZGF0ZXMgYW55IHN0cmVhbS1yZWxhdGVkIGNhbGxiYWNrcyAoZS5nLiBmcm9tIGF1dGggb3IgdGhlXG4gICAgICAgIC8vIHVuZGVybHlpbmcgc3RyZWFtKSwgZ3VhcmFudGVlaW5nIHRoZXkgd29uJ3QgZXhlY3V0ZS5cbiAgICAgICAgdGhpcy5EbysrLCA0IC8qIEVycm9yICovICE9PSB0ID8gXG4gICAgICAgIC8vIElmIHRoaXMgaXMgYW4gaW50ZW50aW9uYWwgY2xvc2UgZW5zdXJlIHdlIGRvbid0IGRlbGF5IG91ciBuZXh0IGNvbm5lY3Rpb24gYXR0ZW1wdC5cbiAgICAgICAgdGhpcy5Oby5yZXNldCgpIDogZSAmJiBlLmNvZGUgPT09IEcuUkVTT1VSQ0VfRVhIQVVTVEVEID8gKFxuICAgICAgICAvLyBMb2cgdGhlIGVycm9yLiAoUHJvYmFibHkgZWl0aGVyICdxdW90YSBleGNlZWRlZCcgb3IgJ21heCBxdWV1ZSBsZW5ndGggcmVhY2hlZCcuKVxuICAgICAgICBGKGUudG9TdHJpbmcoKSksIEYoXCJVc2luZyBtYXhpbXVtIGJhY2tvZmYgZGVsYXkgdG8gcHJldmVudCBvdmVybG9hZGluZyB0aGUgYmFja2VuZC5cIiksIFxuICAgICAgICB0aGlzLk5vLkFvKCkpIDogZSAmJiBlLmNvZGUgPT09IEcuVU5BVVRIRU5USUNBVEVEICYmIDMgLyogSGVhbHRoeSAqLyAhPT0gdGhpcy5zdGF0ZSAmJiAoXG4gICAgICAgIC8vIFwidW5hdXRoZW50aWNhdGVkXCIgZXJyb3IgbWVhbnMgdGhlIHRva2VuIHdhcyByZWplY3RlZC4gVGhpcyBzaG91bGQgcmFyZWx5XG4gICAgICAgIC8vIGhhcHBlbiBzaW5jZSBib3RoIEF1dGggYW5kIEFwcENoZWNrIGVuc3VyZSBhIHN1ZmZpY2llbnQgVFRMIHdoZW4gd2VcbiAgICAgICAgLy8gcmVxdWVzdCBhIHRva2VuLiBJZiBhIHVzZXIgbWFudWFsbHkgcmVzZXRzIHRoZWlyIHN5c3RlbSBjbG9jayB0aGlzIGNhblxuICAgICAgICAvLyBmYWlsLCBob3dldmVyLiBJbiB0aGlzIGNhc2UsIHdlIHNob3VsZCBnZXQgYSBDb2RlLlVOQVVUSEVOVElDQVRFRCBlcnJvclxuICAgICAgICAvLyBiZWZvcmUgd2UgcmVjZWl2ZWQgdGhlIGZpcnN0IG1lc3NhZ2UgYW5kIHdlIG5lZWQgdG8gaW52YWxpZGF0ZSB0aGUgdG9rZW5cbiAgICAgICAgLy8gdG8gZW5zdXJlIHRoYXQgd2UgZmV0Y2ggYSBuZXcgdG9rZW4uXG4gICAgICAgIHRoaXMuYXV0aENyZWRlbnRpYWxzUHJvdmlkZXIuaW52YWxpZGF0ZVRva2VuKCksIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFsc1Byb3ZpZGVyLmludmFsaWRhdGVUb2tlbigpKSwgXG4gICAgICAgIC8vIENsZWFuIHVwIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBiZWNhdXNlIHdlIGFyZSBubyBsb25nZXIgaW50ZXJlc3RlZCBpbiBldmVudHMuXG4gICAgICAgIG51bGwgIT09IHRoaXMuc3RyZWFtICYmICh0aGlzLktvKCksIHRoaXMuc3RyZWFtLmNsb3NlKCksIHRoaXMuc3RyZWFtID0gbnVsbCksIFxuICAgICAgICAvLyBUaGlzIHN0YXRlIG11c3QgYmUgYXNzaWduZWQgYmVmb3JlIGNhbGxpbmcgb25DbG9zZSgpIHRvIGFsbG93IHRoZSBjYWxsYmFjayB0b1xuICAgICAgICAvLyBpbmhpYml0IGJhY2tvZmYgb3Igb3RoZXJ3aXNlIG1hbmlwdWxhdGUgdGhlIHN0YXRlIGluIGl0cyBub24tc3RhcnRlZCBzdGF0ZS5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIFxuICAgICAgICAvLyBOb3RpZnkgdGhlIGxpc3RlbmVyIHRoYXQgdGhlIHN0cmVhbSBjbG9zZWQuXG4gICAgICAgIGF3YWl0IHRoaXMubGlzdGVuZXIuZW8oZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbiBiZSBvdmVycmlkZGVuIHRvIHBlcmZvcm0gYWRkaXRpb25hbCBjbGVhbnVwIGJlZm9yZSB0aGUgc3RyZWFtIGlzIGNsb3NlZC5cbiAgICAgKiBDYWxsaW5nIHN1cGVyLnRlYXJEb3duKCkgaXMgbm90IHJlcXVpcmVkLlxuICAgICAqLyAgICBLbygpIHt9XG4gICAgYXV0aCgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDEgLyogU3RhcnRpbmcgKi87XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLkdvKHRoaXMuRG8pLCBlID0gdGhpcy5EbztcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBKdXN0IHVzZSBkaXNwYXRjaElmTm90Q2xvc2VkLCBidXQgc2VlIFRPRE8gYmVsb3cuXG4gICAgICAgICAgICAgICAgUHJvbWlzZS5hbGwoWyB0aGlzLmF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyLmdldFRva2VuKCksIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFsc1Byb3ZpZGVyLmdldFRva2VuKCkgXSkudGhlbigoKFt0LCBuXSkgPT4ge1xuICAgICAgICAgICAgLy8gU3RyZWFtIGNhbiBiZSBzdG9wcGVkIHdoaWxlIHdhaXRpbmcgZm9yIGF1dGhlbnRpY2F0aW9uLlxuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBXZSByZWFsbHkgc2hvdWxkIGp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWRcbiAgICAgICAgICAgIC8vIGFuZCBsZXQgdGhpcyBkaXNwYXRjaCBvbnRvIHRoZSBxdWV1ZSwgYnV0IHRoYXQgb3BlbmVkIGEgc3BlYyB0ZXN0IGNhblxuICAgICAgICAgICAgLy8gb2Ygd29ybXMgdGhhdCBJIGRvbid0IHdhbnQgdG8gZGVhbCB3aXRoIGluIHRoaXMgUFIuXG4gICAgICAgICAgICB0aGlzLkRvID09PSBlICYmIFxuICAgICAgICAgICAgLy8gTm9ybWFsbHkgd2UnZCBoYXZlIHRvIHNjaGVkdWxlIHRoZSBjYWxsYmFjayBvbiB0aGUgQXN5bmNRdWV1ZS5cbiAgICAgICAgICAgIC8vIEhvd2V2ZXIsIHRoZSBmb2xsb3dpbmcgY2FsbHMgYXJlIHNhZmUgdG8gYmUgY2FsbGVkIG91dHNpZGUgdGhlXG4gICAgICAgICAgICAvLyBBc3luY1F1ZXVlIHNpbmNlIHRoZXkgZG9uJ3QgY2hhaW4gYXN5bmNocm9ub3VzIGNhbGxzXG4gICAgICAgICAgICB0aGlzLlFvKHQsIG4pO1xuICAgICAgICB9KSwgKGUgPT4ge1xuICAgICAgICAgICAgdCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgUShHLlVOS05PV04sIFwiRmV0Y2hpbmcgYXV0aCB0b2tlbiBmYWlsZWQ6IFwiICsgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5qbyh0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBRbyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLkdvKHRoaXMuRG8pO1xuICAgICAgICB0aGlzLnN0cmVhbSA9IHRoaXMuV28odCwgZSksIHRoaXMuc3RyZWFtLlhyKCgoKSA9PiB7XG4gICAgICAgICAgICBuKCgoKSA9PiAodGhpcy5zdGF0ZSA9IDIgLyogT3BlbiAqLyAsIHRoaXMueG8gPSB0aGlzLlluLmVucXVldWVBZnRlckRlbGF5KHRoaXMudm8sIDFlNCwgKCgpID0+ICh0aGlzLk1vKCkgJiYgKHRoaXMuc3RhdGUgPSAzIC8qIEhlYWx0aHkgKi8pLCBcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpLCB0aGlzLmxpc3RlbmVyLlhyKCkpKSk7XG4gICAgICAgIH0pKSwgdGhpcy5zdHJlYW0uZW8oKHQgPT4ge1xuICAgICAgICAgICAgbigoKCkgPT4gdGhpcy5qbyh0KSkpO1xuICAgICAgICB9KSksIHRoaXMuc3RyZWFtLm9uTWVzc2FnZSgodCA9PiB7XG4gICAgICAgICAgICBuKCgoKSA9PiB0aGlzLm9uTWVzc2FnZSh0KSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIE9vKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gNSAvKiBCYWNrb2ZmICovICwgdGhpcy5Oby5SbygoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IDAgLyogSW5pdGlhbCAqLyAsIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0c1xuICAgIGpvKHQpIHtcbiAgICAgICAgLy8gSW4gdGhlb3J5IHRoZSBzdHJlYW0gY291bGQgY2xvc2UgY2xlYW5seSwgaG93ZXZlciwgaW4gb3VyIGN1cnJlbnQgbW9kZWxcbiAgICAgICAgLy8gd2UgbmV2ZXIgZXhwZWN0IHRoaXMgdG8gaGFwcGVuIGJlY2F1c2UgaWYgd2Ugc3RvcCBhIHN0cmVhbSBvdXJzZWx2ZXMsXG4gICAgICAgIC8vIHRoaXMgY2FsbGJhY2sgd2lsbCBuZXZlciBiZSBjYWxsZWQuIFRvIHByZXZlbnQgY2FzZXMgd2hlcmUgd2UgcmV0cnlcbiAgICAgICAgLy8gd2l0aG91dCBhIGJhY2tvZmYgYWNjaWRlbnRhbGx5LCB3ZSBzZXQgdGhlIHN0cmVhbSB0byBlcnJvciBpbiBhbGwgY2FzZXMuXG4gICAgICAgIHJldHVybiBPKFwiUGVyc2lzdGVudFN0cmVhbVwiLCBgY2xvc2Ugd2l0aCBlcnJvcjogJHt0fWApLCB0aGlzLnN0cmVhbSA9IG51bGwsIHRoaXMuY2xvc2UoNCAvKiBFcnJvciAqLyAsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgXCJkaXNwYXRjaGVyXCIgZnVuY3Rpb24gdGhhdCBkaXNwYXRjaGVzIG9wZXJhdGlvbnMgb250byB0aGVcbiAgICAgKiBBc3luY1F1ZXVlIGJ1dCBvbmx5IHJ1bnMgdGhlbSBpZiBjbG9zZUNvdW50IHJlbWFpbnMgdW5jaGFuZ2VkLiBUaGlzIGFsbG93c1xuICAgICAqIHVzIHRvIHR1cm4gYXV0aCAvIHN0cmVhbSBjYWxsYmFja3MgaW50byBuby1vcHMgaWYgdGhlIHN0cmVhbSBpcyBjbG9zZWQgL1xuICAgICAqIHJlLW9wZW5lZCwgZXRjLlxuICAgICAqLyAgICBHbyh0KSB7XG4gICAgICAgIHJldHVybiBlID0+IHtcbiAgICAgICAgICAgIHRoaXMuWW4uZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gdGhpcy5EbyA9PT0gdCA/IGUoKSA6IChPKFwiUGVyc2lzdGVudFN0cmVhbVwiLCBcInN0cmVhbSBjYWxsYmFjayBza2lwcGVkIGJ5IGdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIuXCIpLCBcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpO1xuICAgICAgICB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gdGhhdCBpbXBsZW1lbnRzIHRoZSBMaXN0ZW4gUlBDLlxuICpcbiAqIE9uY2UgdGhlIExpc3RlbiBzdHJlYW0gaGFzIGNhbGxlZCB0aGUgb25PcGVuKCkgbGlzdGVuZXIsIGFueSBudW1iZXIgb2ZcbiAqIGxpc3RlbigpIGFuZCB1bmxpc3RlbigpIGNhbGxzIGNhbiBiZSBtYWRlIHRvIGNvbnRyb2wgd2hhdCBjaGFuZ2VzIHdpbGwgYmVcbiAqIHNlbnQgZnJvbSB0aGUgc2VydmVyIGZvciBMaXN0ZW5SZXNwb25zZXMuXG4gKi8gY2xhc3MgSG8gZXh0ZW5kcyB6byB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICBzdXBlcih0LCBcImxpc3Rlbl9zdHJlYW1fY29ubmVjdGlvbl9iYWNrb2ZmXCIgLyogTGlzdGVuU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmYgKi8gLCBcImxpc3Rlbl9zdHJlYW1faWRsZVwiIC8qIExpc3RlblN0cmVhbUlkbGUgKi8gLCBcImhlYWx0aF9jaGVja190aW1lb3V0XCIgLyogSGVhbHRoQ2hlY2tUaW1lb3V0ICovICwgZSwgbiwgcywgciksIFxuICAgICAgICB0aGlzLk0gPSBpO1xuICAgIH1cbiAgICBXbyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlNvLndvKFwiTGlzdGVuXCIsIHQsIGUpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5XG4gICAgICAgIHRoaXMuTm8ucmVzZXQoKTtcbiAgICAgICAgY29uc3QgZSA9IFZzKHRoaXMuTSwgdCksIG4gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIHQpKSByZXR1cm4gY3QubWluKCk7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRDaGFuZ2U7XG4gICAgICAgICAgICByZXR1cm4gZS50YXJnZXRJZHMgJiYgZS50YXJnZXRJZHMubGVuZ3RoID8gY3QubWluKCkgOiBlLnJlYWRUaW1lID8gd3MoZS5yZWFkVGltZSkgOiBjdC5taW4oKTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuem8oZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZiB0aGUgdGFyZ2V0XG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcbiAgICAgKiBhZmZlY3QgdGhlIHRhcmdldCB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXG4gICAgICovICAgIEhvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHt9O1xuICAgICAgICBlLmRhdGFiYXNlID0gRXModGhpcy5NKSwgZS5hZGRUYXJnZXQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBsZXQgbjtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHJldHVybiBuID0gQWUocykgPyB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBDcyh0LCBzKVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBxdWVyeTogeHModCwgcylcbiAgICAgICAgICAgIH0sIG4udGFyZ2V0SWQgPSBlLnRhcmdldElkLCBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgPyBuLnJlc3VtZVRva2VuID0gZHModCwgZS5yZXN1bWVUb2tlbikgOiBlLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8oY3QubWluKCkpID4gMCAmJiAoXG4gICAgICAgICAgICAvLyBUT0RPKHd1YW5keSk6IENvbnNpZGVyIHJlbW92aW5nIGFib3ZlIGNoZWNrIGJlY2F1c2UgaXQgaXMgbW9zdCBsaWtlbHkgdHJ1ZS5cbiAgICAgICAgICAgIC8vIFJpZ2h0IG5vdywgbWFueSB0ZXN0cyBkZXBlbmQgb24gdGhpcyBiZWhhdmlvdXIgdGhvdWdoIChsZWF2aW5nIG1pbigpIG91dFxuICAgICAgICAgICAgLy8gb2Ygc2VyaWFsaXphdGlvbikuXG4gICAgICAgICAgICBuLnJlYWRUaW1lID0gZnModCwgZS5zbmFwc2hvdFZlcnNpb24udG9UaW1lc3RhbXAoKSkpLCBuO1xuICAgICAgICB9KHRoaXMuTSwgdCk7XG4gICAgICAgIGNvbnN0IG4gPSBrcyh0aGlzLk0sIHQpO1xuICAgICAgICBuICYmIChlLmxhYmVscyA9IG4pLCB0aGlzLkxvKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aCB0aGVcbiAgICAgKiBnaXZlbiB0YXJnZXRJZC5cbiAgICAgKi8gICAgSm8odCkge1xuICAgICAgICBjb25zdCBlID0ge307XG4gICAgICAgIGUuZGF0YWJhc2UgPSBFcyh0aGlzLk0pLCBlLnJlbW92ZVRhcmdldCA9IHQsIHRoaXMuTG8oZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgU3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgV3JpdGUgUlBDLlxuICpcbiAqIFRoZSBXcml0ZSBSUEMgcmVxdWlyZXMgdGhlIGNhbGxlciB0byBtYWludGFpbiBzcGVjaWFsIHN0cmVhbVRva2VuXG4gKiBzdGF0ZSBpbiBiZXR3ZWVuIGNhbGxzLCB0byBoZWxwIHRoZSBzZXJ2ZXIgdW5kZXJzdGFuZCB3aGljaCByZXNwb25zZXMgdGhlXG4gKiBjbGllbnQgaGFzIHByb2Nlc3NlZCBieSB0aGUgdGltZSB0aGUgbmV4dCByZXF1ZXN0IGlzIG1hZGUuIEV2ZXJ5IHJlc3BvbnNlXG4gKiB3aWxsIGNvbnRhaW4gYSBzdHJlYW1Ub2tlbjsgdGhpcyB2YWx1ZSBtdXN0IGJlIHBhc3NlZCB0byB0aGUgbmV4dFxuICogcmVxdWVzdC5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIHN0YXJ0KCkgb24gdGhpcyBzdHJlYW0sIHRoZSBuZXh0IHJlcXVlc3QgbXVzdCBiZSBhIGhhbmRzaGFrZSxcbiAqIGNvbnRhaW5pbmcgd2hhdGV2ZXIgc3RyZWFtVG9rZW4gaXMgb24gaGFuZC4gT25jZSBhIHJlc3BvbnNlIHRvIHRoaXNcbiAqIHJlcXVlc3QgaXMgcmVjZWl2ZWQsIGFsbCBwZW5kaW5nIG11dGF0aW9ucyBtYXkgYmUgc3VibWl0dGVkLiBXaGVuXG4gKiBzdWJtaXR0aW5nIG11bHRpcGxlIGJhdGNoZXMgb2YgbXV0YXRpb25zIGF0IHRoZSBzYW1lIHRpbWUsIGl0J3NcbiAqIG9rYXkgdG8gdXNlIHRoZSBzYW1lIHN0cmVhbVRva2VuIGZvciB0aGUgY2FsbHMgdG8gd3JpdGVNdXRhdGlvbnMuXG4gKlxuICogVE9ETyhiLzMzMjcxMjM1KTogVXNlIHByb3RvIHR5cGVzXG4gKi8gY2xhc3MgSm8gZXh0ZW5kcyB6byB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICBzdXBlcih0LCBcIndyaXRlX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIiAvKiBXcml0ZVN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmICovICwgXCJ3cml0ZV9zdHJlYW1faWRsZVwiIC8qIFdyaXRlU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBIZWFsdGhDaGVja1RpbWVvdXQgKi8gLCBlLCBuLCBzLCByKSwgXG4gICAgICAgIHRoaXMuTSA9IGksIHRoaXMuWW8gPSAhMTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVHJhY2tzIHdoZXRoZXIgb3Igbm90IGEgaGFuZHNoYWtlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBleGNoYW5nZWQgYW5kXG4gICAgICogdGhlIHN0cmVhbSBpcyByZWFkeSB0byBhY2NlcHQgbXV0YXRpb25zLlxuICAgICAqLyAgICBnZXQgWG8oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLllvO1xuICAgIH1cbiAgICAvLyBPdmVycmlkZSBvZiBQZXJzaXN0ZW50U3RyZWFtLnN0YXJ0XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuWW8gPSAhMSwgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSB2b2lkIDAsIHN1cGVyLnN0YXJ0KCk7XG4gICAgfVxuICAgIEtvKCkge1xuICAgICAgICB0aGlzLllvICYmIHRoaXMuWm8oW10pO1xuICAgIH1cbiAgICBXbyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlNvLndvKFwiV3JpdGVcIiwgdCwgZSk7XG4gICAgfVxuICAgIG9uTWVzc2FnZSh0KSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgLy8gQWx3YXlzIGNhcHR1cmUgdGhlIGxhc3Qgc3RyZWFtIHRva2VuLlxuICAgICAgICBVKCEhdC5zdHJlYW1Ub2tlbiksIHRoaXMubGFzdFN0cmVhbVRva2VuID0gdC5zdHJlYW1Ub2tlbiwgdGhpcy5Zbykge1xuICAgICAgICAgICAgLy8gQSBzdWNjZXNzZnVsIGZpcnN0IHdyaXRlIHJlc3BvbnNlIG1lYW5zIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSxcbiAgICAgICAgICAgIC8vIE5vdGUsIHRoYXQgd2UgY291bGQgY29uc2lkZXIgYSBzdWNjZXNzZnVsIGhhbmRzaGFrZSBoZWFsdGh5LCBob3dldmVyLFxuICAgICAgICAgICAgLy8gdGhlIHdyaXRlIGl0c2VsZiBtaWdodCBiZSBjYXVzaW5nIGFuIGVycm9yIHdlIHdhbnQgdG8gYmFjayBvZmYgZnJvbS5cbiAgICAgICAgICAgIHRoaXMuTm8ucmVzZXQoKTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBEcyh0LndyaXRlUmVzdWx0cywgdC5jb21taXRUaW1lKSwgbiA9IHdzKHQuY29tbWl0VGltZSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci50dShuLCBlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgZmlyc3QgcmVzcG9uc2UgaXMgYWx3YXlzIHRoZSBoYW5kc2hha2UgcmVzcG9uc2VcbiAgICAgICAgcmV0dXJuIFUoIXQud3JpdGVSZXN1bHRzIHx8IDAgPT09IHQud3JpdGVSZXN1bHRzLmxlbmd0aCksIHRoaXMuWW8gPSAhMCwgdGhpcy5saXN0ZW5lci5ldSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhbiBpbml0aWFsIHN0cmVhbVRva2VuIHRvIHRoZSBzZXJ2ZXIsIHBlcmZvcm1pbmcgdGhlIGhhbmRzaGFrZVxuICAgICAqIHJlcXVpcmVkIHRvIG1ha2UgdGhlIFN0cmVhbWluZ1dyaXRlIFJQQyB3b3JrLiBTdWJzZXF1ZW50XG4gICAgICogY2FsbHMgc2hvdWxkIHdhaXQgdW50aWwgb25IYW5kc2hha2VDb21wbGV0ZSB3YXMgY2FsbGVkLlxuICAgICAqLyAgICBudSgpIHtcbiAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBTdXBwb3J0IHN0cmVhbSByZXN1bXB0aW9uLiBXZSBpbnRlbnRpb25hbGx5IGRvIG5vdCBzZXQgdGhlXG4gICAgICAgIC8vIHN0cmVhbSB0b2tlbiBvbiB0aGUgaGFuZHNoYWtlLCBpZ25vcmluZyBhbnkgc3RyZWFtIHRva2VuIHdlIG1pZ2h0IGhhdmUuXG4gICAgICAgIGNvbnN0IHQgPSB7fTtcbiAgICAgICAgdC5kYXRhYmFzZSA9IEVzKHRoaXMuTSksIHRoaXMuTG8odCk7XG4gICAgfVxuICAgIC8qKiBTZW5kcyBhIGdyb3VwIG9mIG11dGF0aW9ucyB0byB0aGUgRmlyZXN0b3JlIGJhY2tlbmQgdG8gYXBwbHkuICovICAgIFpvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIHN0cmVhbVRva2VuOiB0aGlzLmxhc3RTdHJlYW1Ub2tlbixcbiAgICAgICAgICAgIHdyaXRlczogdC5tYXAoKHQgPT4gdnModGhpcy5NLCB0KSkpXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuTG8oZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEYXRhc3RvcmUgYW5kIGl0cyByZWxhdGVkIG1ldGhvZHMgYXJlIGEgd3JhcHBlciBhcm91bmQgdGhlIGV4dGVybmFsIEdvb2dsZVxuICogQ2xvdWQgRGF0YXN0b3JlIGdycGMgQVBJLCB3aGljaCBwcm92aWRlcyBhbiBpbnRlcmZhY2UgdGhhdCBpcyBtb3JlIGNvbnZlbmllbnRcbiAqIGZvciB0aGUgcmVzdCBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUgdG8gY29uc3VtZS5cbiAqL1xuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiBEYXRhc3RvcmUgdGhhdCBleHBvc2VzIGFkZGl0aW9uYWwgc3RhdGUgZm9yIGludGVybmFsXG4gKiBjb25zdW1wdGlvbi5cbiAqL1xuY2xhc3MgWW8gZXh0ZW5kcyBjbGFzcyB7fSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmF1dGhDcmVkZW50aWFscyA9IHQsIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscyA9IGUsIHRoaXMuU28gPSBuLCB0aGlzLk0gPSBzLCBcbiAgICAgICAgdGhpcy5zdSA9ICExO1xuICAgIH1cbiAgICBpdSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3UpIHRocm93IG5ldyBRKEcuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJUaGUgY2xpZW50IGhhcyBhbHJlYWR5IGJlZW4gdGVybWluYXRlZC5cIik7XG4gICAgfVxuICAgIC8qKiBJbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBhdXRoIGFuZCBBcHBDaGVjayB0b2tlbnMuICovICAgIGNvKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXUoKSwgUHJvbWlzZS5hbGwoWyB0aGlzLmF1dGhDcmVkZW50aWFscy5nZXRUb2tlbigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW3MsIGldKSA9PiB0aGlzLlNvLmNvKHQsIGUsIG4sIHMsIGkpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IEcuVU5BVVRIRU5USUNBVEVEICYmICh0aGlzLmF1dGhDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCkpLCB0KSA6IG5ldyBRKEcuVU5LTk9XTiwgdC50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKiogSW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggc3RyZWFtZWQgcmVzdWx0cyB3aXRoIGF1dGggYW5kIEFwcENoZWNrIHRva2Vucy4gKi8gICAgX28odCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5pdSgpLCBQcm9taXNlLmFsbChbIHRoaXMuYXV0aENyZWRlbnRpYWxzLmdldFRva2VuKCksIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5nZXRUb2tlbigpIF0pLnRoZW4oKChbcywgaV0pID0+IHRoaXMuU28uX28odCwgZSwgbiwgcywgaSkpKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICB0aHJvdyBcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lID8gKHQuY29kZSA9PT0gRy5VTkFVVEhFTlRJQ0FURUQgJiYgKHRoaXMuYXV0aENyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpLCBcbiAgICAgICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSksIHQpIDogbmV3IFEoRy5VTktOT1dOLCB0LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgdGhpcy5zdSA9ICEwO1xuICAgIH1cbn1cblxuLy8gVE9ETyhmaXJlc3RvcmV4cCk6IE1ha2Ugc3VyZSB0aGVyZSBpcyBvbmx5IG9uZSBEYXRhc3RvcmUgaW5zdGFuY2UgcGVyXG4vLyBmaXJlc3RvcmUtZXhwIGNsaWVudC5cbi8qKlxuICogQSBjb21wb25lbnQgdXNlZCBieSB0aGUgUmVtb3RlU3RvcmUgdG8gdHJhY2sgdGhlIE9ubGluZVN0YXRlICh0aGF0IGlzLFxuICogd2hldGhlciBvciBub3QgdGhlIGNsaWVudCBhcyBhIHdob2xlIHNob3VsZCBiZSBjb25zaWRlcmVkIHRvIGJlIG9ubGluZSBvclxuICogb2ZmbGluZSksIGltcGxlbWVudGluZyB0aGUgYXBwcm9wcmlhdGUgaGV1cmlzdGljcy5cbiAqXG4gKiBJbiBwYXJ0aWN1bGFyLCB3aGVuIHRoZSBjbGllbnQgaXMgdHJ5aW5nIHRvIGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQsIHdlXG4gKiBhbGxvdyB1cCB0byBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTIHdpdGhpbiBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUyBmb3JcbiAqIGEgY29ubmVjdGlvbiB0byBzdWNjZWVkLiBJZiB3ZSBoYXZlIHRvbyBtYW55IGZhaWx1cmVzIG9yIHRoZSB0aW1lb3V0IGVsYXBzZXMsXG4gKiB0aGVuIHdlIHNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSwgYW5kIHRoZSBjbGllbnQgd2lsbCBiZWhhdmUgYXMgaWZcbiAqIGl0IGlzIG9mZmxpbmUgKGdldCgpcyB3aWxsIHJldHVybiBjYWNoZWQgZGF0YSwgZXRjLikuXG4gKi9cbmNsYXNzIFhvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IHQsIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gZSwgXG4gICAgICAgIC8qKiBUaGUgY3VycmVudCBPbmxpbmVTdGF0ZS4gKi9cbiAgICAgICAgdGhpcy5zdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgY291bnQgb2YgY29uc2VjdXRpdmUgZmFpbHVyZXMgdG8gb3BlbiB0aGUgc3RyZWFtLiBJZiBpdCByZWFjaGVzIHRoZVxuICAgICAgICAgKiBtYXhpbXVtIGRlZmluZWQgYnkgTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUywgd2UnbGwgc2V0IHRoZSBPbmxpbmVTdGF0ZSB0b1xuICAgICAgICAgKiBPZmZsaW5lLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ydSA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSB0aW1lciB0aGF0IGVsYXBzZXMgYWZ0ZXIgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMsIGF0IHdoaWNoIHBvaW50IHdlXG4gICAgICAgICAqIHRyYW5zaXRpb24gZnJvbSBPbmxpbmVTdGF0ZS5Vbmtub3duIHRvIE9ubGluZVN0YXRlLk9mZmxpbmUgd2l0aG91dCB3YWl0aW5nXG4gICAgICAgICAqIGZvciB0aGUgc3RyZWFtIHRvIGFjdHVhbGx5IGZhaWwgKE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgdGltZXMpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vdSA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGUgY2xpZW50IHNob3VsZCBsb2cgYSB3YXJuaW5nIG1lc3NhZ2UgaWYgaXQgZmFpbHMgdG8gY29ubmVjdCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZCAoaW5pdGlhbGx5IHRydWUsIGNsZWFyZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHN0cmVhbSwgb3IgaWYgd2UndmVcbiAgICAgICAgICogbG9nZ2VkIHRoZSBtZXNzYWdlIGFscmVhZHkpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy51dSA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgUmVtb3RlU3RvcmUgd2hlbiBhIHdhdGNoIHN0cmVhbSBpcyBzdGFydGVkIChpbmNsdWRpbmcgb24gZWFjaFxuICAgICAqIGJhY2tvZmYgYXR0ZW1wdCkuXG4gICAgICpcbiAgICAgKiBJZiB0aGlzIGlzIHRoZSBmaXJzdCBhdHRlbXB0LCBpdCBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIGFuZCBzdGFydHNcbiAgICAgKiB0aGUgb25saW5lU3RhdGVUaW1lci5cbiAgICAgKi8gICAgYXUoKSB7XG4gICAgICAgIDAgPT09IHRoaXMucnUgJiYgKHRoaXMuY3UoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIHRoaXMub3UgPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoXCJvbmxpbmVfc3RhdGVfdGltZW91dFwiIC8qIE9ubGluZVN0YXRlVGltZW91dCAqLyAsIDFlNCwgKCgpID0+ICh0aGlzLm91ID0gbnVsbCwgXG4gICAgICAgIHRoaXMuaHUoXCJCYWNrZW5kIGRpZG4ndCByZXNwb25kIHdpdGhpbiAxMCBzZWNvbmRzLlwiKSwgdGhpcy5jdShcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBvdXIgT25saW5lU3RhdGUgYXMgYXBwcm9wcmlhdGUgYWZ0ZXIgdGhlIHdhdGNoIHN0cmVhbSByZXBvcnRzIGFcbiAgICAgKiBmYWlsdXJlLiBUaGUgZmlyc3QgZmFpbHVyZSBtb3ZlcyB1cyB0byB0aGUgJ1Vua25vd24nIHN0YXRlLiBXZSB0aGVuIG1heVxuICAgICAqIGFsbG93IG11bHRpcGxlIGZhaWx1cmVzIChiYXNlZCBvbiBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTKSBiZWZvcmUgd2VcbiAgICAgKiBhY3R1YWxseSB0cmFuc2l0aW9uIHRvIHRoZSAnT2ZmbGluZScgc3RhdGUuXG4gICAgICovICAgIGx1KHQpIHtcbiAgICAgICAgXCJPbmxpbmVcIiAvKiBPbmxpbmUgKi8gPT09IHRoaXMuc3RhdGUgPyB0aGlzLmN1KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pIDogKHRoaXMucnUrKywgXG4gICAgICAgIHRoaXMucnUgPj0gMSAmJiAodGhpcy5mdSgpLCB0aGlzLmh1KGBDb25uZWN0aW9uIGZhaWxlZCAxIHRpbWVzLiBNb3N0IHJlY2VudCBlcnJvcjogJHt0LnRvU3RyaW5nKCl9YCksIFxuICAgICAgICB0aGlzLmN1KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4cGxpY2l0bHkgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gdGhlIHNwZWNpZmllZCBzdGF0ZS5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGlzIHJlc2V0cyBvdXIgdGltZXJzIC8gZmFpbHVyZSBjb3VudGVycywgZXRjLiB1c2VkIGJ5IG91clxuICAgICAqIE9mZmxpbmUgaGV1cmlzdGljcywgc28gbXVzdCBub3QgYmUgdXNlZCBpbiBwbGFjZSBvZlxuICAgICAqIGhhbmRsZVdhdGNoU3RyZWFtU3RhcnQoKSBhbmQgaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlKCkuXG4gICAgICovICAgIHNldCh0KSB7XG4gICAgICAgIHRoaXMuZnUoKSwgdGhpcy5ydSA9IDAsIFwiT25saW5lXCIgLyogT25saW5lICovID09PSB0ICYmIChcbiAgICAgICAgLy8gV2UndmUgY29ubmVjdGVkIHRvIHdhdGNoIGF0IGxlYXN0IG9uY2UuIERvbid0IHdhcm4gdGhlIGRldmVsb3BlclxuICAgICAgICAvLyBhYm91dCBiZWluZyBvZmZsaW5lIGdvaW5nIGZvcndhcmQuXG4gICAgICAgIHRoaXMudXUgPSAhMSksIHRoaXMuY3UodCk7XG4gICAgfVxuICAgIGN1KHQpIHtcbiAgICAgICAgdCAhPT0gdGhpcy5zdGF0ZSAmJiAodGhpcy5zdGF0ZSA9IHQsIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKHQpKTtcbiAgICB9XG4gICAgaHUodCkge1xuICAgICAgICBjb25zdCBlID0gYENvdWxkIG5vdCByZWFjaCBDbG91ZCBGaXJlc3RvcmUgYmFja2VuZC4gJHt0fVxcblRoaXMgdHlwaWNhbGx5IGluZGljYXRlcyB0aGF0IHlvdXIgZGV2aWNlIGRvZXMgbm90IGhhdmUgYSBoZWFsdGh5IEludGVybmV0IGNvbm5lY3Rpb24gYXQgdGhlIG1vbWVudC4gVGhlIGNsaWVudCB3aWxsIG9wZXJhdGUgaW4gb2ZmbGluZSBtb2RlIHVudGlsIGl0IGlzIGFibGUgdG8gc3VjY2Vzc2Z1bGx5IGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQuYDtcbiAgICAgICAgdGhpcy51dSA/IChGKGUpLCB0aGlzLnV1ID0gITEpIDogTyhcIk9ubGluZVN0YXRlVHJhY2tlclwiLCBlKTtcbiAgICB9XG4gICAgZnUoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMub3UgJiYgKHRoaXMub3UuY2FuY2VsKCksIHRoaXMub3UgPSBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFpvIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbG9jYWwgc3RvcmUsIHVzZWQgdG8gZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgd2l0aCBvdXRib3VuZCBtdXRhdGlvbnMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBjbGllbnQtc2lkZSBwcm94eSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgYmFja2VuZC4gKi9cbiAgICBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IHQsIHRoaXMuZGF0YXN0b3JlID0gZSwgdGhpcy5hc3luY1F1ZXVlID0gbiwgdGhpcy5yZW1vdGVTeW5jZXIgPSB7fSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdXAgdG8gTUFYX1BFTkRJTkdfV1JJVEVTIHdyaXRlcyB0aGF0IHdlIGhhdmUgZmV0Y2hlZCBmcm9tIHRoZVxuICAgICAgICAgKiBMb2NhbFN0b3JlIHZpYSBmaWxsV3JpdGVQaXBlbGluZSgpIGFuZCBoYXZlIG9yIHdpbGwgc2VuZCB0byB0aGUgd3JpdGVcbiAgICAgICAgICogc3RyZWFtLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuZXZlciB3cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDAgdGhlIFJlbW90ZVN0b3JlIHdpbGwgYXR0ZW1wdCB0byBzdGFydCBvclxuICAgICAgICAgKiByZXN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0uIFdoZW4gdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZCB0aGUgd3JpdGVzIGluIHRoZVxuICAgICAgICAgKiBwaXBlbGluZSB3aWxsIGJlIHNlbnQgaW4gb3JkZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlcyByZW1haW4gaW4gd3JpdGVQaXBlbGluZSB1bnRpbCB0aGV5IGFyZSBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmRcbiAgICAgICAgICogYW5kIHRodXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHJlLXNlbnQgaWYgdGhlIHN0cmVhbSBpcyBpbnRlcnJ1cHRlZCAvXG4gICAgICAgICAqIHJlc3RhcnRlZCBiZWZvcmUgdGhleSdyZSBhY2tub3dsZWRnZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlIHJlc3BvbnNlcyBmcm9tIHRoZSBiYWNrZW5kIGFyZSBsaW5rZWQgdG8gdGhlaXIgb3JpZ2luYXRpbmcgcmVxdWVzdFxuICAgICAgICAgKiBwdXJlbHkgYmFzZWQgb24gb3JkZXIsIGFuZCBzbyB3ZSBjYW4ganVzdCBzaGlmdCgpIHdyaXRlcyBmcm9tIHRoZSBmcm9udCBvZlxuICAgICAgICAgKiB0aGUgd3JpdGVQaXBlbGluZSBhcyB3ZSByZWNlaXZlIHJlc3BvbnNlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZHUgPSBbXSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcHBpbmcgb2Ygd2F0Y2hlZCB0YXJnZXRzIHRoYXQgdGhlIGNsaWVudCBjYXJlcyBhYm91dCB0cmFja2luZyBhbmQgdGhlXG4gICAgICAgICAqIHVzZXIgaGFzIGV4cGxpY2l0bHkgY2FsbGVkIGEgJ2xpc3RlbicgZm9yIHRoaXMgdGFyZ2V0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGVzZSB0YXJnZXRzIG1heSBvciBtYXkgbm90IGhhdmUgYmVlbiBzZW50IHRvIG9yIGFja25vd2xlZGdlZCBieSB0aGVcbiAgICAgICAgICogc2VydmVyLiBPbiByZS1lc3RhYmxpc2hpbmcgdGhlIGxpc3RlbiBzdHJlYW0sIHRoZXNlIHRhcmdldHMgc2hvdWxkIGJlIHNlbnRcbiAgICAgICAgICogdG8gdGhlIHNlcnZlci4gVGhlIHRhcmdldHMgcmVtb3ZlZCB3aXRoIHVubGlzdGVucyBhcmUgcmVtb3ZlZCBlYWdlcmx5XG4gICAgICAgICAqIHdpdGhvdXQgd2FpdGluZyBmb3IgY29uZmlybWF0aW9uIGZyb20gdGhlIGxpc3RlbiBzdHJlYW0uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl91ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHNldCBvZiByZWFzb25zIGZvciB3aHkgdGhlIFJlbW90ZVN0b3JlIG1heSBiZSBvZmZsaW5lLiBJZiBlbXB0eSwgdGhlXG4gICAgICAgICAqIFJlbW90ZVN0b3JlIG1heSBzdGFydCBpdHMgbmV0d29yayBjb25uZWN0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud3UgPSBuZXcgU2V0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXJzIHRoYXQgZ2V0IGNhbGxlZCB3aGVuIHRoZSBuZXR3b3JrIGlzIGRpc2FibGVkIG9yIGVuYWJsZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogVGhlc2UgZnVuY3Rpb25zIGFyZSB1c2VkIG9uIHRoZSBXZWIgY2xpZW50IHRvIGNyZWF0ZSB0aGVcbiAgICAgICAgICogdW5kZXJseWluZyBzdHJlYW1zICh0byBzdXBwb3J0IHRyZWUtc2hha2VhYmxlIHN0cmVhbXMpLiBPbiBBbmRyb2lkIGFuZCBpT1MsXG4gICAgICAgICAqIHRoZSBzdHJlYW1zIGFyZSBjcmVhdGVkIGR1cmluZyBjb25zdHJ1Y3Rpb24gb2YgUmVtb3RlU3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11ID0gW10sIHRoaXMuZ3UgPSBpLCB0aGlzLmd1LktyKCh0ID0+IHtcbiAgICAgICAgICAgIG4uZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFBvcnRpbmcgTm90ZTogVW5saWtlIGlPUywgYHJlc3RhcnROZXR3b3JrKClgIGlzIGNhbGxlZCBldmVuIHdoZW4gdGhlXG4gICAgICAgICAgICAgICAgLy8gbmV0d29yayBiZWNvbWVzIHVucmVhY2hhYmxlIGFzIHdlIGRvbid0IGhhdmUgYW55IG90aGVyIHdheSB0byB0ZWFyXG4gICAgICAgICAgICAgICAgLy8gZG93biBvdXIgc3RyZWFtcy5cbiAgICAgICAgICAgICAgICBhdSh0aGlzKSAmJiAoTyhcIlJlbW90ZVN0b3JlXCIsIFwiUmVzdGFydGluZyBzdHJlYW1zIGZvciBuZXR3b3JrIHJlYWNoYWJpbGl0eSBjaGFuZ2UuXCIpLCBcbiAgICAgICAgICAgICAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBLKHQpO1xuICAgICAgICAgICAgICAgICAgICBlLnd1LmFkZCg0IC8qIENvbm5lY3Rpdml0eUNoYW5nZSAqLyksIGF3YWl0IGV1KGUpLCBlLnl1LnNldChcIlVua25vd25cIiAvKiBVbmtub3duICovKSwgXG4gICAgICAgICAgICAgICAgICAgIGUud3UuZGVsZXRlKDQgLyogQ29ubmVjdGl2aXR5Q2hhbmdlICovKSwgYXdhaXQgdHUoZSk7XG4gICAgICAgICAgICAgICAgfSh0aGlzKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKSwgdGhpcy55dSA9IG5ldyBYbyhuLCBzKTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHR1KHQpIHtcbiAgICBpZiAoYXUodCkpIGZvciAoY29uc3QgZSBvZiB0Lm11KSBhd2FpdCBlKC8qIGVuYWJsZWQ9ICovICEwKTtcbn1cblxuLyoqXG4gKiBUZW1wb3JhcmlseSBkaXNhYmxlcyB0aGUgbmV0d29yay4gVGhlIG5ldHdvcmsgY2FuIGJlIHJlLWVuYWJsZWQgdXNpbmdcbiAqIGVuYWJsZU5ldHdvcmsoKS5cbiAqLyBhc3luYyBmdW5jdGlvbiBldSh0KSB7XG4gICAgZm9yIChjb25zdCBlIG9mIHQubXUpIGF3YWl0IGUoLyogZW5hYmxlZD0gKi8gITEpO1xufVxuXG4vKipcbiAqIFN0YXJ0cyBuZXcgbGlzdGVuIGZvciB0aGUgZ2l2ZW4gdGFyZ2V0LiBVc2VzIHJlc3VtZSB0b2tlbiBpZiBwcm92aWRlZC4gSXRcbiAqIGlzIGEgbm8tb3AgaWYgdGhlIHRhcmdldCBvZiBnaXZlbiBgVGFyZ2V0RGF0YWAgaXMgYWxyZWFkeSBiZWluZyBsaXN0ZW5lZCB0by5cbiAqL1xuZnVuY3Rpb24gbnUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpO1xuICAgIG4uX3UuaGFzKGUudGFyZ2V0SWQpIHx8IChcbiAgICAvLyBNYXJrIHRoaXMgYXMgc29tZXRoaW5nIHRoZSBjbGllbnQgaXMgY3VycmVudGx5IGxpc3RlbmluZyBmb3IuXG4gICAgbi5fdS5zZXQoZS50YXJnZXRJZCwgZSksIHV1KG4pID8gXG4gICAgLy8gVGhlIGxpc3RlbiB3aWxsIGJlIHNlbnQgaW4gb25XYXRjaFN0cmVhbU9wZW5cbiAgICBvdShuKSA6IFB1KG4pLk1vKCkgJiYgaXUobiwgZSkpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgdGhlIGxpc3RlbiBmcm9tIHNlcnZlci4gSXQgaXMgYSBuby1vcCBpZiB0aGUgZ2l2ZW4gdGFyZ2V0IGlkIGlzXG4gKiBub3QgYmVpbmcgbGlzdGVuZWQgdG8uXG4gKi8gZnVuY3Rpb24gc3UodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpLCBzID0gUHUobik7XG4gICAgbi5fdS5kZWxldGUoZSksIHMuTW8oKSAmJiBydShuLCBlKSwgMCA9PT0gbi5fdS5zaXplICYmIChzLk1vKCkgPyBzLiRvKCkgOiBhdShuKSAmJiBcbiAgICAvLyBSZXZlcnQgdG8gT25saW5lU3RhdGUuVW5rbm93biBpZiB0aGUgd2F0Y2ggc3RyZWFtIGlzIG5vdCBvcGVuIGFuZCB3ZVxuICAgIC8vIGhhdmUgbm8gbGlzdGVuZXJzLCBzaW5jZSB3aXRob3V0IGFueSBsaXN0ZW5zIHRvIHNlbmQgd2UgY2Fubm90XG4gICAgLy8gY29uZmlybSBpZiB0aGUgc3RyZWFtIGlzIGhlYWx0aHkgYW5kIHVwZ3JhZGUgdG8gT25saW5lU3RhdGUuT25saW5lLlxuICAgIG4ueXUuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pKTtcbn1cblxuLyoqXG4gKiBXZSBuZWVkIHRvIGluY3JlbWVudCB0aGUgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcbiAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIGFjayB0byBwcm9jZXNzIGFueSBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxuICovIGZ1bmN0aW9uIGl1KHQsIGUpIHtcbiAgICB0LnB1LlooZS50YXJnZXRJZCksIFB1KHQpLkhvKGUpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXG4gKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSByZW1vdmFsIG9uIHRoZSBzZXJ2ZXIgYmVmb3JlIHdlIHByb2Nlc3MgYW55XG4gKiBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxuICovIGZ1bmN0aW9uIHJ1KHQsIGUpIHtcbiAgICB0LnB1LlooZSksIFB1KHQpLkpvKGUpO1xufVxuXG5mdW5jdGlvbiBvdSh0KSB7XG4gICAgdC5wdSA9IG5ldyBvcyh7XG4gICAgICAgIGdldFJlbW90ZUtleXNGb3JUYXJnZXQ6IGUgPT4gdC5yZW1vdGVTeW5jZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldChlKSxcbiAgICAgICAgRXQ6IGUgPT4gdC5fdS5nZXQoZSkgfHwgbnVsbFxuICAgIH0pLCBQdSh0KS5zdGFydCgpLCB0Lnl1LmF1KCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSB3YXRjaCBzdHJlYW0gc2hvdWxkIGJlIHN0YXJ0ZWQgYmVjYXVzZSBpdCdzIG5lY2Vzc2FyeVxuICogYW5kIGhhcyBub3QgeWV0IGJlZW4gc3RhcnRlZC5cbiAqLyBmdW5jdGlvbiB1dSh0KSB7XG4gICAgcmV0dXJuIGF1KHQpICYmICFQdSh0KS5rbygpICYmIHQuX3Uuc2l6ZSA+IDA7XG59XG5cbmZ1bmN0aW9uIGF1KHQpIHtcbiAgICByZXR1cm4gMCA9PT0gSyh0KS53dS5zaXplO1xufVxuXG5mdW5jdGlvbiBjdSh0KSB7XG4gICAgdC5wdSA9IHZvaWQgMDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaHUodCkge1xuICAgIHQuX3UuZm9yRWFjaCgoKGUsIG4pID0+IHtcbiAgICAgICAgaXUodCwgZSk7XG4gICAgfSkpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBsdSh0LCBlKSB7XG4gICAgY3UodCksIFxuICAgIC8vIElmIHdlIHN0aWxsIG5lZWQgdGhlIHdhdGNoIHN0cmVhbSwgcmV0cnkgdGhlIGNvbm5lY3Rpb24uXG4gICAgdXUodCkgPyAodC55dS5sdShlKSwgb3UodCkpIDogXG4gICAgLy8gTm8gbmVlZCB0byByZXN0YXJ0IHdhdGNoIHN0cmVhbSBiZWNhdXNlIHRoZXJlIGFyZSBubyBhY3RpdmUgdGFyZ2V0cy5cbiAgICAvLyBUaGUgb25saW5lIHN0YXRlIGlzIHNldCB0byB1bmtub3duIGJlY2F1c2UgdGhlcmUgaXMgbm8gYWN0aXZlIGF0dGVtcHRcbiAgICAvLyBhdCBlc3RhYmxpc2hpbmcgYSBjb25uZWN0aW9uXG4gICAgdC55dS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZ1KHQsIGUsIG4pIHtcbiAgICBpZiAoXG4gICAgLy8gTWFyayB0aGUgY2xpZW50IGFzIG9ubGluZSBzaW5jZSB3ZSBnb3QgYSBtZXNzYWdlIGZyb20gdGhlIHNlcnZlclxuICAgIHQueXUuc2V0KFwiT25saW5lXCIgLyogT25saW5lICovKSwgZSBpbnN0YW5jZW9mIGlzICYmIDIgLyogUmVtb3ZlZCAqLyA9PT0gZS5zdGF0ZSAmJiBlLmNhdXNlKSBcbiAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gYSB0YXJnZXQsIGRvbid0IHdhaXQgZm9yIGEgY29uc2lzdGVudCBzbmFwc2hvdFxuICAgIC8vIHRvIHJhaXNlIGV2ZW50c1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IFxuICAgICAgICAvKiogSGFuZGxlcyBhbiBlcnJvciBvbiBhIHRhcmdldCAqL1xuICAgICAgICBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5jYXVzZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBlLnRhcmdldElkcykgXG4gICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICB0Ll91LmhhcyhzKSAmJiAoYXdhaXQgdC5yZW1vdGVTeW5jZXIucmVqZWN0TGlzdGVuKHMsIG4pLCB0Ll91LmRlbGV0ZShzKSwgdC5wdS5yZW1vdmVUYXJnZXQocykpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQXR0ZW1wdHMgdG8gZmlsbCBvdXIgd3JpdGUgcGlwZWxpbmUgd2l0aCB3cml0ZXMgZnJvbSB0aGUgTG9jYWxTdG9yZS5cbiAqXG4gKiBDYWxsZWQgaW50ZXJuYWxseSB0byBib290c3RyYXAgb3IgcmVmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSBhbmQgYnlcbiAqIFN5bmNFbmdpbmUgd2hlbmV2ZXIgdGhlcmUgYXJlIG5ldyBtdXRhdGlvbnMgdG8gcHJvY2Vzcy5cbiAqXG4gKiBTdGFydHMgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXG4gKi8gKHQsIGUpO1xuICAgIH0gY2F0Y2ggKG4pIHtcbiAgICAgICAgTyhcIlJlbW90ZVN0b3JlXCIsIFwiRmFpbGVkIHRvIHJlbW92ZSB0YXJnZXRzICVzOiAlcyBcIiwgZS50YXJnZXRJZHMuam9pbihcIixcIiksIG4pLCBcbiAgICAgICAgYXdhaXQgZHUodCwgbik7XG4gICAgfSBlbHNlIGlmIChlIGluc3RhbmNlb2YgbnMgPyB0LnB1LnV0KGUpIDogZSBpbnN0YW5jZW9mIHNzID8gdC5wdS5fdChlKSA6IHQucHUuaHQoZSksIFxuICAgICFuLmlzRXF1YWwoY3QubWluKCkpKSB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgcm8odC5sb2NhbFN0b3JlKTtcbiAgICAgICAgbi5jb21wYXJlVG8oZSkgPj0gMCAmJiBcbiAgICAgICAgLy8gV2UgaGF2ZSByZWNlaXZlZCBhIHRhcmdldCBjaGFuZ2Ugd2l0aCBhIGdsb2JhbCBzbmFwc2hvdCBpZiB0aGUgc25hcHNob3RcbiAgICAgICAgLy8gdmVyc2lvbiBpcyBub3QgZXF1YWwgdG8gU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICAgICAgICBhd2FpdCBcbiAgICAgICAgLyoqXG4gKiBUYWtlcyBhIGJhdGNoIG9mIGNoYW5nZXMgZnJvbSB0aGUgRGF0YXN0b3JlLCByZXBhY2thZ2VzIHRoZW0gYXMgYVxuICogUmVtb3RlRXZlbnQsIGFuZCBwYXNzZXMgdGhhdCBvbiB0byB0aGUgbGlzdGVuZXIsIHdoaWNoIGlzIHR5cGljYWxseSB0aGVcbiAqIFN5bmNFbmdpbmUuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQucHUueXQoZSk7XG4gICAgICAgICAgICAvLyBVcGRhdGUgaW4tbWVtb3J5IHJlc3VtZSB0b2tlbnMuIExvY2FsU3RvcmUgd2lsbCB1cGRhdGUgdGhlXG4gICAgICAgICAgICAvLyBwZXJzaXN0ZW50IHZpZXcgb2YgdGhlc2Ugd2hlbiBhcHBseWluZyB0aGUgY29tcGxldGVkIFJlbW90ZUV2ZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4udGFyZ2V0Q2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChuLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuX3UuZ2V0KHMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAmJiB0Ll91LnNldChzLCBpLndpdGhSZXN1bWVUb2tlbihuLnJlc3VtZVRva2VuLCBlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLCBcbiAgICAgICAgICAgIC8vIFJlLWVzdGFibGlzaCBsaXN0ZW5zIGZvciB0aGUgdGFyZ2V0cyB0aGF0IGhhdmUgYmVlbiBpbnZhbGlkYXRlZCBieVxuICAgICAgICAgICAgLy8gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAgICAgICAgbi50YXJnZXRNaXNtYXRjaGVzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0Ll91LmdldChlKTtcbiAgICAgICAgICAgICAgICBpZiAoIW4pIFxuICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIHJlc3VtZSB0b2tlbiBmb3IgdGhlIHRhcmdldCwgc2luY2Ugd2UncmUgaW4gYSBrbm93biBtaXNtYXRjaFxuICAgICAgICAgICAgICAgIC8vIHN0YXRlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Ll91LnNldChlLCBuLndpdGhSZXN1bWVUb2tlbihwdC5FTVBUWV9CWVRFX1NUUklORywgbi5zbmFwc2hvdFZlcnNpb24pKSwgXG4gICAgICAgICAgICAgICAgLy8gQ2F1c2UgYSBoYXJkIHJlc2V0IGJ5IHVud2F0Y2hpbmcgYW5kIHJld2F0Y2hpbmcgaW1tZWRpYXRlbHksIGJ1dFxuICAgICAgICAgICAgICAgIC8vIGRlbGliZXJhdGVseSBkb24ndCBzZW5kIGEgcmVzdW1lIHRva2VuIHNvIHRoYXQgd2UgZ2V0IGEgZnVsbCB1cGRhdGUuXG4gICAgICAgICAgICAgICAgcnUodCwgZSk7XG4gICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgdGFyZ2V0IHdlIHNlbmQgYXMgYmVpbmcgb24gYmVoYWxmIG9mIGFuIGV4aXN0ZW5jZSBmaWx0ZXJcbiAgICAgICAgICAgICAgICAvLyBtaXNtYXRjaCwgYnV0IGRvbid0IGFjdHVhbGx5IHJldGFpbiB0aGF0IGluIGxpc3RlblRhcmdldHMuIFRoaXMgZW5zdXJlc1xuICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgZmxhZyB0aGUgZmlyc3QgcmUtbGlzdGVuIHRoaXMgd2F5IHdpdGhvdXQgaW1wYWN0aW5nIGZ1dHVyZVxuICAgICAgICAgICAgICAgIC8vIGxpc3RlbnMgb2YgdGhpcyB0YXJnZXQgKHRoYXQgbWlnaHQgaGFwcGVuIGUuZy4gb24gcmVjb25uZWN0KS5cbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IE5pKG4udGFyZ2V0LCBlLCAxIC8qIEV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovICwgbi5zZXF1ZW5jZU51bWJlcik7XG4gICAgICAgICAgICAgICAgaXUodCwgcyk7XG4gICAgICAgICAgICB9KSksIHQucmVtb3RlU3luY2VyLmFwcGx5UmVtb3RlRXZlbnQobik7XG4gICAgICAgIH0odCwgbik7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBPKFwiUmVtb3RlU3RvcmVcIiwgXCJGYWlsZWQgdG8gcmFpc2Ugc25hcHNob3Q6XCIsIGUpLCBhd2FpdCBkdSh0LCBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb3ZlcnkgbG9naWMgZm9yIEluZGV4ZWREQiBlcnJvcnMgdGhhdCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsXG4gKiBgb3BgIHN1Y2NlZWRzLiBSZXRyaWVzIGFyZSBzY2hlZHVsZWQgd2l0aCBiYWNrb2ZmIHVzaW5nXG4gKiBgZW5xdWV1ZVJldHJ5YWJsZSgpYC4gSWYgYG9wKClgIGlzIG5vdCBwcm92aWRlZCwgSW5kZXhlZERCIGFjY2VzcyBpc1xuICogdmFsaWRhdGVkIHZpYSBhIGdlbmVyaWMgb3BlcmF0aW9uLlxuICpcbiAqIFRoZSByZXR1cm5lZCBQcm9taXNlIGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIGJlZm9yZVxuICogYW55IHJldHJ5IGF0dGVtcHQuXG4gKi8gYXN5bmMgZnVuY3Rpb24gZHUodCwgZSwgbikge1xuICAgIGlmICghQWkoZSkpIHRocm93IGU7XG4gICAgdC53dS5hZGQoMSAvKiBJbmRleGVkRGJGYWlsZWQgKi8pLCBcbiAgICAvLyBEaXNhYmxlIG5ldHdvcmsgYW5kIHJhaXNlIG9mZmxpbmUgc25hcHNob3RzXG4gICAgYXdhaXQgZXUodCksIHQueXUuc2V0KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pLCBuIHx8IChcbiAgICAvLyBVc2UgYSBzaW1wbGUgcmVhZCBvcGVyYXRpb24gdG8gZGV0ZXJtaW5lIGlmIEluZGV4ZWREQiByZWNvdmVyZWQuXG4gICAgLy8gSWRlYWxseSwgd2Ugd291bGQgZXhwb3NlIGEgaGVhbHRoIGNoZWNrIGRpcmVjdGx5IG9uIFNpbXBsZURiLCBidXRcbiAgICAvLyBSZW1vdGVTdG9yZSBvbmx5IGhhcyBhY2Nlc3MgdG8gcGVyc2lzdGVuY2UgdGhyb3VnaCBMb2NhbFN0b3JlLlxuICAgIG4gPSAoKSA9PiBybyh0LmxvY2FsU3RvcmUpKSwgXG4gICAgLy8gUHJvYmUgSW5kZXhlZERCIHBlcmlvZGljYWxseSBhbmQgcmUtZW5hYmxlIG5ldHdvcmtcbiAgICB0LmFzeW5jUXVldWUuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBPKFwiUmVtb3RlU3RvcmVcIiwgXCJSZXRyeWluZyBJbmRleGVkREIgYWNjZXNzXCIpLCBhd2FpdCBuKCksIHQud3UuZGVsZXRlKDEgLyogSW5kZXhlZERiRmFpbGVkICovKSwgXG4gICAgICAgIGF3YWl0IHR1KHQpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyBgb3BgLiBJZiBgb3BgIGZhaWxzLCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsIGBvcGBcbiAqIHN1Y2NlZWRzLiBSZXR1cm5zIGFmdGVyIHRoZSBmaXJzdCBhdHRlbXB0LlxuICovIGZ1bmN0aW9uIF91KHQsIGUpIHtcbiAgICByZXR1cm4gZSgpLmNhdGNoKChuID0+IGR1KHQsIG4sIGUpKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHd1KHQpIHtcbiAgICBjb25zdCBlID0gSyh0KSwgbiA9IFZ1KGUpO1xuICAgIGxldCBzID0gZS5kdS5sZW5ndGggPiAwID8gZS5kdVtlLmR1Lmxlbmd0aCAtIDFdLmJhdGNoSWQgOiAtMTtcbiAgICBmb3IgKDttdShlKTsgKSB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgYW8oZS5sb2NhbFN0b3JlLCBzKTtcbiAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgIDAgPT09IGUuZHUubGVuZ3RoICYmIG4uJG8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHMgPSB0LmJhdGNoSWQsIGd1KGUsIHQpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgZHUoZSwgdCk7XG4gICAgfVxuICAgIHl1KGUpICYmIHB1KGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBjYW4gYWRkIHRvIHRoZSB3cml0ZSBwaXBlbGluZSAoaS5lLiB0aGUgbmV0d29yayBpc1xuICogZW5hYmxlZCBhbmQgdGhlIHdyaXRlIHBpcGVsaW5lIGlzIG5vdCBmdWxsKS5cbiAqLyBmdW5jdGlvbiBtdSh0KSB7XG4gICAgcmV0dXJuIGF1KHQpICYmIHQuZHUubGVuZ3RoIDwgMTA7XG59XG5cbi8qKlxuICogUXVldWVzIGFkZGl0aW9uYWwgd3JpdGVzIHRvIGJlIHNlbnQgdG8gdGhlIHdyaXRlIHN0cmVhbSwgc2VuZGluZyB0aGVtXG4gKiBpbW1lZGlhdGVseSBpZiB0aGUgd3JpdGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkLlxuICovIGZ1bmN0aW9uIGd1KHQsIGUpIHtcbiAgICB0LmR1LnB1c2goZSk7XG4gICAgY29uc3QgbiA9IFZ1KHQpO1xuICAgIG4uTW8oKSAmJiBuLlhvICYmIG4uWm8oZS5tdXRhdGlvbnMpO1xufVxuXG5mdW5jdGlvbiB5dSh0KSB7XG4gICAgcmV0dXJuIGF1KHQpICYmICFWdSh0KS5rbygpICYmIHQuZHUubGVuZ3RoID4gMDtcbn1cblxuZnVuY3Rpb24gcHUodCkge1xuICAgIFZ1KHQpLnN0YXJ0KCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEl1KHQpIHtcbiAgICBWdSh0KS5udSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBUdSh0KSB7XG4gICAgY29uc3QgZSA9IFZ1KHQpO1xuICAgIC8vIFNlbmQgdGhlIHdyaXRlIHBpcGVsaW5lIG5vdyB0aGF0IHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmR1KSBlLlpvKG4ubXV0YXRpb25zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gRXUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LmR1LnNoaWZ0KCksIGkgPSBDaS5mcm9tKHMsIGUsIG4pO1xuICAgIGF3YWl0IF91KHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZShpKSkpLCBcbiAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uIGFub3RoZXJcbiAgICAvLyBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICBhd2FpdCB3dSh0KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gQXUodCwgZSkge1xuICAgIC8vIElmIHRoZSB3cml0ZSBzdHJlYW0gY2xvc2VkIGFmdGVyIHRoZSB3cml0ZSBoYW5kc2hha2UgY29tcGxldGVzLCBhIHdyaXRlXG4gICAgLy8gb3BlcmF0aW9uIGZhaWxlZCBhbmQgd2UgZmFpbCB0aGUgcGVuZGluZyBvcGVyYXRpb24uXG4gICAgZSAmJiBWdSh0KS5YbyAmJiBcbiAgICAvLyBUaGlzIGVycm9yIGFmZmVjdHMgdGhlIGFjdHVhbCB3cml0ZS5cbiAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIE9ubHkgaGFuZGxlIHBlcm1hbmVudCBlcnJvcnMgaGVyZS4gSWYgaXQncyB0cmFuc2llbnQsIGp1c3QgbGV0IHRoZSByZXRyeVxuICAgICAgICAvLyBsb2dpYyBraWNrIGluLlxuICAgICAgICBpZiAobiA9IGUuY29kZSwgVW4obikgJiYgbiAhPT0gRy5BQk9SVEVEKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHdhcyBhIHBlcm1hbmVudCBlcnJvciwgdGhlIHJlcXVlc3QgaXRzZWxmIHdhcyB0aGUgcHJvYmxlbVxuICAgICAgICAgICAgLy8gc28gaXQncyBub3QgZ29pbmcgdG8gc3VjY2VlZCBpZiB3ZSByZXNlbmQgaXQuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5kdS5zaGlmdCgpO1xuICAgICAgICAgICAgLy8gSW4gdGhpcyBjYXNlIGl0J3MgYWxzbyB1bmxpa2VseSB0aGF0IHRoZSBzZXJ2ZXIgaXRzZWxmIGlzIG1lbHRpbmdcbiAgICAgICAgICAgIC8vIGRvd24gLS0gdGhpcyB3YXMganVzdCBhIGJhZCByZXF1ZXN0IHNvIGluaGliaXQgYmFja29mZiBvbiB0aGUgbmV4dFxuICAgICAgICAgICAgLy8gcmVzdGFydC5cbiAgICAgICAgICAgICAgICAgICAgICAgIFZ1KHQpLkZvKCksIGF3YWl0IF91KHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5yZWplY3RGYWlsZWRXcml0ZShuLmJhdGNoSWQsIGUpKSksIFxuICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvblxuICAgICAgICAgICAgLy8gYW5vdGhlciBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICAgICAgICAgIGF3YWl0IHd1KHQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuO1xuICAgIH0odCwgZSksIFxuICAgIC8vIFRoZSB3cml0ZSBzdHJlYW0gbWlnaHQgaGF2ZSBiZWVuIHN0YXJ0ZWQgYnkgcmVmaWxsaW5nIHRoZSB3cml0ZVxuICAgIC8vIHBpcGVsaW5lIGZvciBmYWlsZWQgd3JpdGVzXG4gICAgeXUodCkgJiYgcHUodCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFJ1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICBuLmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBPKFwiUmVtb3RlU3RvcmVcIiwgXCJSZW1vdGVTdG9yZSByZWNlaXZlZCBuZXcgY3JlZGVudGlhbHNcIik7XG4gICAgY29uc3QgcyA9IGF1KG4pO1xuICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAvLyBmcmVzaCBhdXRoIHRva2VuIGZvciB0aGUgbmV3IHVzZXIgYW5kIHJlLWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGhcbiAgICAvLyBuZXcgbXV0YXRpb25zIGZyb20gdGhlIExvY2FsU3RvcmUgKHNpbmNlIG11dGF0aW9ucyBhcmUgcGVyLXVzZXIpLlxuICAgICAgICBuLnd1LmFkZCgzIC8qIENyZWRlbnRpYWxDaGFuZ2UgKi8pLCBhd2FpdCBldShuKSwgcyAmJiBcbiAgICAvLyBEb24ndCBzZXQgdGhlIG5ldHdvcmsgc3RhdHVzIHRvIFVua25vd24gaWYgd2UgYXJlIG9mZmxpbmUuXG4gICAgbi55dS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIGF3YWl0IG4ucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoZSksIFxuICAgIG4ud3UuZGVsZXRlKDMgLyogQ3JlZGVudGlhbENoYW5nZSAqLyksIGF3YWl0IHR1KG4pO1xufVxuXG4vKipcbiAqIFRvZ2dsZXMgdGhlIG5ldHdvcmsgc3RhdGUgd2hlbiB0aGUgY2xpZW50IGdhaW5zIG9yIGxvc2VzIGl0cyBwcmltYXJ5IGxlYXNlLlxuICovIGFzeW5jIGZ1bmN0aW9uIGJ1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICBlID8gKG4ud3UuZGVsZXRlKDIgLyogSXNTZWNvbmRhcnkgKi8pLCBhd2FpdCB0dShuKSkgOiBlIHx8IChuLnd1LmFkZCgyIC8qIElzU2Vjb25kYXJ5ICovKSwgXG4gICAgYXdhaXQgZXUobiksIG4ueXUuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pKTtcbn1cblxuLyoqXG4gKiBJZiBub3QgeWV0IGluaXRpYWxpemVkLCByZWdpc3RlcnMgdGhlIFdhdGNoU3RyZWFtIGFuZCBpdHMgbmV0d29yayBzdGF0ZVxuICogY2FsbGJhY2sgd2l0aCBgcmVtb3RlU3RvcmVJbXBsYC4gUmV0dXJucyB0aGUgZXhpc3Rpbmcgc3RyZWFtIGlmIG9uZSBpc1xuICogYWxyZWFkeSBhdmFpbGFibGUuXG4gKlxuICogUE9SVElORyBOT1RFOiBPbiBpT1MgYW5kIEFuZHJvaWQsIHRoZSBXYXRjaFN0cmVhbSBnZXRzIHJlZ2lzdGVyZWQgb24gc3RhcnR1cC5cbiAqIFRoaXMgaXMgbm90IGRvbmUgb24gV2ViIHRvIGFsbG93IGl0IHRvIGJlIHRyZWUtc2hha2VuLlxuICovIGZ1bmN0aW9uIFB1KHQpIHtcbiAgICByZXR1cm4gdC5JdSB8fCAoXG4gICAgLy8gQ3JlYXRlIHN0cmVhbSAoYnV0IG5vdGUgdGhhdCBpdCBpcyBub3Qgc3RhcnRlZCB5ZXQpLlxuICAgIHQuSXUgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBLKHQpO1xuICAgICAgICByZXR1cm4gcy5pdSgpLCBuZXcgSG8oZSwgcy5Tbywgcy5hdXRoQ3JlZGVudGlhbHMsIHMuYXBwQ2hlY2tDcmVkZW50aWFscywgcy5NLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQuZGF0YXN0b3JlLCB0LmFzeW5jUXVldWUsIHtcbiAgICAgICAgWHI6IGh1LmJpbmQobnVsbCwgdCksXG4gICAgICAgIGVvOiBsdS5iaW5kKG51bGwsIHQpLFxuICAgICAgICB6bzogZnUuYmluZChudWxsLCB0KVxuICAgIH0pLCB0Lm11LnB1c2goKGFzeW5jIGUgPT4ge1xuICAgICAgICBlID8gKHQuSXUuRm8oKSwgdXUodCkgPyBvdSh0KSA6IHQueXUuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pKSA6IChhd2FpdCB0Lkl1LnN0b3AoKSwgXG4gICAgICAgIGN1KHQpKTtcbiAgICB9KSkpLCB0Lkl1O1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV3JpdGVTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdyaXRlU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gVnUodCkge1xuICAgIHJldHVybiB0LlR1IHx8IChcbiAgICAvLyBDcmVhdGUgc3RyZWFtIChidXQgbm90ZSB0aGF0IGl0IGlzIG5vdCBzdGFydGVkIHlldCkuXG4gICAgdC5UdSA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEsodCk7XG4gICAgICAgIHJldHVybiBzLml1KCksIG5ldyBKbyhlLCBzLlNvLCBzLmF1dGhDcmVkZW50aWFscywgcy5hcHBDaGVja0NyZWRlbnRpYWxzLCBzLk0sIG4pO1xuICAgIH0odC5kYXRhc3RvcmUsIHQuYXN5bmNRdWV1ZSwge1xuICAgICAgICBYcjogSXUuYmluZChudWxsLCB0KSxcbiAgICAgICAgZW86IEF1LmJpbmQobnVsbCwgdCksXG4gICAgICAgIGV1OiBUdS5iaW5kKG51bGwsIHQpLFxuICAgICAgICB0dTogRXUuYmluZChudWxsLCB0KVxuICAgIH0pLCB0Lm11LnB1c2goKGFzeW5jIGUgPT4ge1xuICAgICAgICBlID8gKHQuVHUuRm8oKSwgXG4gICAgICAgIC8vIFRoaXMgd2lsbCBzdGFydCB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cbiAgICAgICAgYXdhaXQgd3UodCkpIDogKGF3YWl0IHQuVHUuc3RvcCgpLCB0LmR1Lmxlbmd0aCA+IDAgJiYgKE8oXCJSZW1vdGVTdG9yZVwiLCBgU3RvcHBpbmcgd3JpdGUgc3RyZWFtIHdpdGggJHt0LmR1Lmxlbmd0aH0gcGVuZGluZyB3cml0ZXNgKSwgXG4gICAgICAgIHQuZHUgPSBbXSkpO1xuICAgIH0pKSksIHQuVHU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYW4gb3BlcmF0aW9uIHNjaGVkdWxlZCB0byBiZSBydW4gaW4gdGhlIGZ1dHVyZSBvbiBhbiBBc3luY1F1ZXVlLlxuICpcbiAqIEl0IGlzIGNyZWF0ZWQgdmlhIERlbGF5ZWRPcGVyYXRpb24uY3JlYXRlQW5kU2NoZWR1bGUoKS5cbiAqXG4gKiBTdXBwb3J0cyBjYW5jZWxsYXRpb24gKHZpYSBjYW5jZWwoKSkgYW5kIGVhcmx5IGV4ZWN1dGlvbiAodmlhIHNraXBEZWxheSgpKS5cbiAqXG4gKiBOb3RlOiBXZSBpbXBsZW1lbnQgYFByb21pc2VMaWtlYCBpbnN0ZWFkIG9mIGBQcm9taXNlYCwgYXMgdGhlIGBQcm9taXNlYCB0eXBlXG4gKiBpbiBuZXdlciB2ZXJzaW9ucyBvZiBUeXBlU2NyaXB0IGRlZmluZXMgYGZpbmFsbHlgLCB3aGljaCBpcyBub3QgYXZhaWxhYmxlIGluXG4gKiBJRS5cbiAqL1xuY2xhc3MgdnUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy50aW1lcklkID0gZSwgdGhpcy50YXJnZXRUaW1lTXMgPSBuLCB0aGlzLm9wID0gcywgdGhpcy5yZW1vdmFsQ2FsbGJhY2sgPSBpLCBcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IG5ldyBqLCB0aGlzLnRoZW4gPSB0aGlzLmRlZmVycmVkLnByb21pc2UudGhlbi5iaW5kKHRoaXMuZGVmZXJyZWQucHJvbWlzZSksIFxuICAgICAgICAvLyBJdCdzIG5vcm1hbCBmb3IgdGhlIGRlZmVycmVkIHByb21pc2UgdG8gYmUgY2FuY2VsZWQgKGR1ZSB0byBjYW5jZWxsYXRpb24pXG4gICAgICAgIC8vIGFuZCBzbyB3ZSBhdHRhY2ggYSBkdW1teSBjYXRjaCBjYWxsYmFjayB0byBhdm9pZFxuICAgICAgICAvLyAnVW5oYW5kbGVkUHJvbWlzZVJlamVjdGlvbldhcm5pbmcnIGxvZyBzcGFtLlxuICAgICAgICB0aGlzLmRlZmVycmVkLnByb21pc2UuY2F0Y2goKHQgPT4ge30pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIERlbGF5ZWRPcGVyYXRpb24gdGhhdCBoYXMgYmVlbiBzY2hlZHVsZWQgdG8gYmVcbiAgICAgKiBleGVjdXRlZCBvbiB0aGUgcHJvdmlkZWQgYXN5bmNRdWV1ZSBhZnRlciB0aGUgcHJvdmlkZWQgZGVsYXlNcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhc3luY1F1ZXVlIC0gVGhlIHF1ZXVlIHRvIHNjaGVkdWxlIHRoZSBvcGVyYXRpb24gb24uXG4gICAgICogQHBhcmFtIGlkIC0gQSBUaW1lciBJRCBpZGVudGlmeWluZyB0aGUgdHlwZSBvZiBvcGVyYXRpb24gdGhpcyBpcy5cbiAgICAgKiBAcGFyYW0gZGVsYXlNcyAtIFRoZSBkZWxheSAobXMpIGJlZm9yZSB0aGUgb3BlcmF0aW9uIHNob3VsZCBiZSBzY2hlZHVsZWQuXG4gICAgICogQHBhcmFtIG9wIC0gVGhlIG9wZXJhdGlvbiB0byBydW4uXG4gICAgICogQHBhcmFtIHJlbW92YWxDYWxsYmFjayAtIEEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgb25jZSB0aGVcbiAgICAgKiAgIG9wZXJhdGlvbiBpcyBleGVjdXRlZCBvciBjYW5jZWxlZCwgbm90aWZ5aW5nIHRoZSBBc3luY1F1ZXVlIHRvIHJlbW92ZSBpdFxuICAgICAqICAgZnJvbSBpdHMgZGVsYXllZE9wZXJhdGlvbnMgbGlzdC5cbiAgICAgKiAgIFBPUlRJTkcgTk9URTogVGhpcyBleGlzdHMgdG8gcHJldmVudCBtYWtpbmcgcmVtb3ZlRGVsYXllZE9wZXJhdGlvbigpIGFuZFxuICAgICAqICAgdGhlIERlbGF5ZWRPcGVyYXRpb24gY2xhc3MgcHVibGljLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlQW5kU2NoZWR1bGUodCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gRGF0ZS5ub3coKSArIG4sIG8gPSBuZXcgdnUodCwgZSwgciwgcywgaSk7XG4gICAgICAgIHJldHVybiBvLnN0YXJ0KG4pLCBvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIHRpbWVyLiBUaGlzIGlzIGNhbGxlZCBpbW1lZGlhdGVseSBhZnRlciBjb25zdHJ1Y3Rpb24gYnlcbiAgICAgKiBjcmVhdGVBbmRTY2hlZHVsZSgpLlxuICAgICAqLyAgICBzdGFydCh0KSB7XG4gICAgICAgIHRoaXMudGltZXJIYW5kbGUgPSBzZXRUaW1lb3V0KCgoKSA9PiB0aGlzLmhhbmRsZURlbGF5RWxhcHNlZCgpKSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFF1ZXVlcyB0aGUgb3BlcmF0aW9uIHRvIHJ1biBpbW1lZGlhdGVseSAoaWYgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBydW4gb3JcbiAgICAgKiBjYW5jZWxlZCkuXG4gICAgICovICAgIHNraXBEZWxheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbmNlbHMgdGhlIG9wZXJhdGlvbiBpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLiBUaGVcbiAgICAgKiBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQuXG4gICAgICpcbiAgICAgKiBBcyBsb25nIGFzIHRoZSBvcGVyYXRpb24gaGFzIG5vdCB5ZXQgYmVlbiBydW4sIGNhbGxpbmcgY2FuY2VsKCkgcHJvdmlkZXMgYVxuICAgICAqIGd1YXJhbnRlZSB0aGF0IHRoZSBvcGVyYXRpb24gd2lsbCBub3QgYmUgcnVuLlxuICAgICAqLyAgICBjYW5jZWwodCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlICYmICh0aGlzLmNsZWFyVGltZW91dCgpLCB0aGlzLmRlZmVycmVkLnJlamVjdChuZXcgUShHLkNBTkNFTExFRCwgXCJPcGVyYXRpb24gY2FuY2VsbGVkXCIgKyAodCA/IFwiOiBcIiArIHQgOiBcIlwiKSkpKTtcbiAgICB9XG4gICAgaGFuZGxlRGVsYXlFbGFwc2VkKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gbnVsbCAhPT0gdGhpcy50aW1lckhhbmRsZSA/ICh0aGlzLmNsZWFyVGltZW91dCgpLCBcbiAgICAgICAgdGhpcy5vcCgpLnRoZW4oKHQgPT4gdGhpcy5kZWZlcnJlZC5yZXNvbHZlKHQpKSkpIDogUHJvbWlzZS5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgY2xlYXJUaW1lb3V0KCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlICYmICh0aGlzLnJlbW92YWxDYWxsYmFjayh0aGlzKSwgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJIYW5kbGUpLCBcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgRmlyZXN0b3JlRXJyb3IgdGhhdCBjYW4gYmUgc3VyZmFjZWQgdG8gdGhlIHVzZXIgaWYgdGhlIHByb3ZpZGVkXG4gKiBlcnJvciBpcyBhbiBJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yLiBSZS10aHJvd3MgdGhlIGVycm9yIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBTdSh0LCBlKSB7XG4gICAgaWYgKEYoXCJBc3luY1F1ZXVlXCIsIGAke2V9OiAke3R9YCksIEFpKHQpKSByZXR1cm4gbmV3IFEoRy5VTkFWQUlMQUJMRSwgYCR7ZX06ICR7dH1gKTtcbiAgICB0aHJvdyB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEb2N1bWVudFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBkb2N1bWVudHNcbiAqIGluIG9yZGVyIHNwZWNpZmllZCBieSB0aGUgcHJvdmlkZWQgY29tcGFyYXRvci4gV2UgYWx3YXlzIGFkZCBhIGRvY3VtZW50IGtleVxuICogY29tcGFyYXRvciBvbiB0b3Agb2Ygd2hhdCBpcyBwcm92aWRlZCB0byBndWFyYW50ZWUgZG9jdW1lbnQgZXF1YWxpdHkgYmFzZWQgb25cbiAqIHRoZSBrZXkuXG4gKi8gY2xhc3MgRHUge1xuICAgIC8qKiBUaGUgZGVmYXVsdCBvcmRlcmluZyBpcyBieSBrZXkgaWYgdGhlIGNvbXBhcmF0b3IgaXMgb21pdHRlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgLy8gV2UgYXJlIGFkZGluZyBkb2N1bWVudCBrZXkgY29tcGFyYXRvciB0byB0aGUgZW5kIGFzIGl0J3MgdGhlIG9ubHlcbiAgICAgICAgLy8gZ3VhcmFudGVlZCB1bmlxdWUgcHJvcGVydHkgb2YgYSBkb2N1bWVudC5cbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gdCA/IChlLCBuKSA9PiB0KGUsIG4pIHx8IHh0LmNvbXBhcmF0b3IoZS5rZXksIG4ua2V5KSA6ICh0LCBlKSA9PiB4dC5jb21wYXJhdG9yKHQua2V5LCBlLmtleSksIFxuICAgICAgICB0aGlzLmtleWVkTWFwID0gV24oKSwgdGhpcy5zb3J0ZWRTZXQgPSBuZXcgZmUodGhpcy5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBlbXB0eSBjb3B5IG9mIHRoZSBleGlzdGluZyBEb2N1bWVudFNldCwgdXNpbmcgdGhlIHNhbWVcbiAgICAgKiBjb21wYXJhdG9yLlxuICAgICAqLyAgICBzdGF0aWMgZW1wdHlTZXQodCkge1xuICAgICAgICByZXR1cm4gbmV3IER1KHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9IHRoaXMua2V5ZWRNYXAuZ2V0KHQpO1xuICAgIH1cbiAgICBnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXllZE1hcC5nZXQodCk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQubWluS2V5KCk7XG4gICAgfVxuICAgIGxhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5tYXhLZXkoKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0LmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIHByb3ZpZGVkIGtleSBpbiB0aGUgZG9jdW1lbnQgc2V0LCBvciAtMSBpZiB0aGVcbiAgICAgKiBkb2N1bWVudCBrZXkgaXMgbm90IHByZXNlbnQgaW4gdGhlIHNldDtcbiAgICAgKi8gICAgaW5kZXhPZih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmtleWVkTWFwLmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyB0aGlzLnNvcnRlZFNldC5pbmRleE9mKGUpIDogLTE7XG4gICAgfVxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuc2l6ZTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIGRvY3VtZW50cyBpbiBvcmRlciBkZWZpbmVkIGJ5IFwiY29tcGFyYXRvclwiICovICAgIGZvckVhY2godCkge1xuICAgICAgICB0aGlzLnNvcnRlZFNldC5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4gKHQoZSksICExKSkpO1xuICAgIH1cbiAgICAvKiogSW5zZXJ0cyBvciB1cGRhdGVzIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXkgKi8gICAgYWRkKHQpIHtcbiAgICAgICAgLy8gRmlyc3QgcmVtb3ZlIHRoZSBlbGVtZW50IGlmIHdlIGhhdmUgaXQuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRlbGV0ZSh0LmtleSk7XG4gICAgICAgIHJldHVybiBlLmNvcHkoZS5rZXllZE1hcC5pbnNlcnQodC5rZXksIHQpLCBlLnNvcnRlZFNldC5pbnNlcnQodCwgbnVsbCkpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyBhIGRvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSA/IHRoaXMuY29weSh0aGlzLmtleWVkTWFwLnJlbW92ZSh0KSwgdGhpcy5zb3J0ZWRTZXQucmVtb3ZlKGUpKSA6IHRoaXM7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgRHUpKSByZXR1cm4gITE7XG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IHQuc2l6ZSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKSwgbiA9IHQuc29ydGVkU2V0LmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO2UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldE5leHQoKS5rZXksIHMgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoIXQuaXNFcXVhbChzKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0LnB1c2goZS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpLCAwID09PSB0Lmxlbmd0aCA/IFwiRG9jdW1lbnRTZXQgKClcIiA6IFwiRG9jdW1lbnRTZXQgKFxcbiAgXCIgKyB0LmpvaW4oXCIgIFxcblwiKSArIFwiXFxuKVwiO1xuICAgIH1cbiAgICBjb3B5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBEdTtcbiAgICAgICAgcmV0dXJuIG4uY29tcGFyYXRvciA9IHRoaXMuY29tcGFyYXRvciwgbi5rZXllZE1hcCA9IHQsIG4uc29ydGVkU2V0ID0gZSwgbjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50Q2hhbmdlU2V0IGtlZXBzIHRyYWNrIG9mIGEgc2V0IG9mIGNoYW5nZXMgdG8gZG9jcyBpbiBhIHF1ZXJ5LCBtZXJnaW5nXG4gKiBkdXBsaWNhdGUgZXZlbnRzIGZvciB0aGUgc2FtZSBkb2MuXG4gKi8gY2xhc3MgQ3Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLkV1ID0gbmV3IGZlKHh0LmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICB0cmFjayh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRvYy5rZXksIG4gPSB0aGlzLkV1LmdldChlKTtcbiAgICAgICAgbiA/IFxuICAgICAgICAvLyBNZXJnZSB0aGUgbmV3IGNoYW5nZSB3aXRoIHRoZSBleGlzdGluZyBjaGFuZ2UuXG4gICAgICAgIDAgLyogQWRkZWQgKi8gIT09IHQudHlwZSAmJiAzIC8qIE1ldGFkYXRhICovID09PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5pbnNlcnQoZSwgdCkgOiAzIC8qIE1ldGFkYXRhICovID09PSB0LnR5cGUgJiYgMSAvKiBSZW1vdmVkICovICE9PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogbi50eXBlLFxuICAgICAgICAgICAgZG9jOiB0LmRvY1xuICAgICAgICB9KSA6IDIgLyogTW9kaWZpZWQgKi8gPT09IHQudHlwZSAmJiAyIC8qIE1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogMiAvKiBNb2RpZmllZCAqLyA9PT0gdC50eXBlICYmIDAgLyogQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuRXUgPSB0aGlzLkV1Lmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAwIC8qIEFkZGVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiAxIC8qIFJlbW92ZWQgKi8gPT09IHQudHlwZSAmJiAwIC8qIEFkZGVkICovID09PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5yZW1vdmUoZSkgOiAxIC8qIFJlbW92ZWQgKi8gPT09IHQudHlwZSAmJiAyIC8qIE1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgIGRvYzogbi5kb2NcbiAgICAgICAgfSkgOiAwIC8qIEFkZGVkICovID09PSB0LnR5cGUgJiYgMSAvKiBSZW1vdmVkICovID09PSBuLnR5cGUgPyB0aGlzLkV1ID0gdGhpcy5FdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogXG4gICAgICAgIC8vIFRoaXMgaW5jbHVkZXMgdGhlc2UgY2FzZXMsIHdoaWNoIGRvbid0IG1ha2Ugc2Vuc2U6XG4gICAgICAgIC8vIEFkZGVkLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5SZW1vdmVkXG4gICAgICAgIC8vIE1vZGlmaWVkLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5Nb2RpZmllZFxuICAgICAgICAvLyBNZXRhZGF0YS0+QWRkZWRcbiAgICAgICAgLy8gUmVtb3ZlZC0+TWV0YWRhdGFcbiAgICAgICAgTCgpIDogdGhpcy5FdSA9IHRoaXMuRXUuaW5zZXJ0KGUsIHQpO1xuICAgIH1cbiAgICBBdSgpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5FdS5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgdC5wdXNoKG4pO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxufVxuXG5jbGFzcyB4dSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbywgdSkge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy5kb2NzID0gZSwgdGhpcy5vbGREb2NzID0gbiwgdGhpcy5kb2NDaGFuZ2VzID0gcywgdGhpcy5tdXRhdGVkS2V5cyA9IGksIFxuICAgICAgICB0aGlzLmZyb21DYWNoZSA9IHIsIHRoaXMuc3luY1N0YXRlQ2hhbmdlZCA9IG8sIHRoaXMuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMgPSB1O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHZpZXcgc25hcHNob3QgYXMgaWYgYWxsIGRvY3VtZW50cyBpbiB0aGUgc25hcHNob3Qgd2VyZSBhZGRlZC4gKi8gICAgc3RhdGljIGZyb21Jbml0aWFsRG9jdW1lbnRzKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGkucHVzaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogMCAvKiBBZGRlZCAqLyAsXG4gICAgICAgICAgICAgICAgZG9jOiB0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpLCBuZXcgeHUodCwgZSwgRHUuZW1wdHlTZXQoZSksIGksIG4sIHMsIFxuICAgICAgICAvKiBzeW5jU3RhdGVDaGFuZ2VkPSAqLyAhMCwgXG4gICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyAhMSk7XG4gICAgfVxuICAgIGdldCBoYXNQZW5kaW5nV3JpdGVzKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMubXV0YXRlZEtleXMuaXNFbXB0eSgpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgaWYgKCEodGhpcy5mcm9tQ2FjaGUgPT09IHQuZnJvbUNhY2hlICYmIHRoaXMuc3luY1N0YXRlQ2hhbmdlZCA9PT0gdC5zeW5jU3RhdGVDaGFuZ2VkICYmIHRoaXMubXV0YXRlZEtleXMuaXNFcXVhbCh0Lm11dGF0ZWRLZXlzKSAmJiBZZSh0aGlzLnF1ZXJ5LCB0LnF1ZXJ5KSAmJiB0aGlzLmRvY3MuaXNFcXVhbCh0LmRvY3MpICYmIHRoaXMub2xkRG9jcy5pc0VxdWFsKHQub2xkRG9jcykpKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvY0NoYW5nZXMsIG4gPSB0LmRvY0NoYW5nZXM7XG4gICAgICAgIGlmIChlLmxlbmd0aCAhPT0gbi5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBlLmxlbmd0aDsgdCsrKSBpZiAoZVt0XS50eXBlICE9PSBuW3RdLnR5cGUgfHwgIWVbdF0uZG9jLmlzRXF1YWwoblt0XS5kb2MpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhvbGRzIHRoZSBsaXN0ZW5lcnMgYW5kIHRoZSBsYXN0IHJlY2VpdmVkIFZpZXdTbmFwc2hvdCBmb3IgYSBxdWVyeSBiZWluZ1xuICogdHJhY2tlZCBieSBFdmVudE1hbmFnZXIuXG4gKi8gY2xhc3MgTnUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLlJ1ID0gdm9pZCAwLCB0aGlzLmxpc3RlbmVycyA9IFtdO1xuICAgIH1cbn1cblxuY2xhc3Mga3Uge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBuZXcgS24oKHQgPT4gWGUodCkpLCBZZSksIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBVbmtub3duICovICwgXG4gICAgICAgIHRoaXMuYnUgPSBuZXcgU2V0O1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gTXUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpLCBzID0gZS5xdWVyeTtcbiAgICBsZXQgaSA9ICExLCByID0gbi5xdWVyaWVzLmdldChzKTtcbiAgICBpZiAociB8fCAoaSA9ICEwLCByID0gbmV3IE51KSwgaSkgdHJ5IHtcbiAgICAgICAgci5SdSA9IGF3YWl0IG4ub25MaXN0ZW4ocyk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBjb25zdCBuID0gU3UodCwgYEluaXRpYWxpemF0aW9uIG9mIHF1ZXJ5ICcke1plKGUucXVlcnkpfScgZmFpbGVkYCk7XG4gICAgICAgIHJldHVybiB2b2lkIGUub25FcnJvcihuKTtcbiAgICB9XG4gICAgaWYgKG4ucXVlcmllcy5zZXQocywgciksIHIubGlzdGVuZXJzLnB1c2goZSksIFxuICAgIC8vIFJ1biBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIGlmIGEgY29uc2lzdGVudCBzbmFwc2hvdCBoYXMgYmVlbiBlbWl0dGVkLlxuICAgIGUuUHUobi5vbmxpbmVTdGF0ZSksIHIuUnUpIHtcbiAgICAgICAgZS5WdShyLlJ1KSAmJiBCdShuKTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIE91KHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KSwgcyA9IGUucXVlcnk7XG4gICAgbGV0IGkgPSAhMTtcbiAgICBjb25zdCByID0gbi5xdWVyaWVzLmdldChzKTtcbiAgICBpZiAocikge1xuICAgICAgICBjb25zdCB0ID0gci5saXN0ZW5lcnMuaW5kZXhPZihlKTtcbiAgICAgICAgdCA+PSAwICYmIChyLmxpc3RlbmVycy5zcGxpY2UodCwgMSksIGkgPSAwID09PSByLmxpc3RlbmVycy5sZW5ndGgpO1xuICAgIH1cbiAgICBpZiAoaSkgcmV0dXJuIG4ucXVlcmllcy5kZWxldGUocyksIG4ub25Vbmxpc3RlbihzKTtcbn1cblxuZnVuY3Rpb24gRnUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpO1xuICAgIGxldCBzID0gITE7XG4gICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgY29uc3QgZSA9IHQucXVlcnksIGkgPSBuLnF1ZXJpZXMuZ2V0KGUpO1xuICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkubGlzdGVuZXJzKSBlLlZ1KHQpICYmIChzID0gITApO1xuICAgICAgICAgICAgaS5SdSA9IHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcyAmJiBCdShuKTtcbn1cblxuZnVuY3Rpb24gJHUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBLKHQpLCBpID0gcy5xdWVyaWVzLmdldChlKTtcbiAgICBpZiAoaSkgZm9yIChjb25zdCB0IG9mIGkubGlzdGVuZXJzKSB0Lm9uRXJyb3Iobik7XG4gICAgLy8gUmVtb3ZlIGFsbCBsaXN0ZW5lcnMuIE5PVEU6IFdlIGRvbid0IG5lZWQgdG8gY2FsbCBzeW5jRW5naW5lLnVubGlzdGVuKClcbiAgICAvLyBhZnRlciBhbiBlcnJvci5cbiAgICAgICAgcy5xdWVyaWVzLmRlbGV0ZShlKTtcbn1cblxuLy8gQ2FsbCBhbGwgZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyB0aGF0IGhhdmUgYmVlbiBzZXQuXG5mdW5jdGlvbiBCdSh0KSB7XG4gICAgdC5idS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgdC5uZXh0KCk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFF1ZXJ5TGlzdGVuZXIgdGFrZXMgYSBzZXJpZXMgb2YgaW50ZXJuYWwgdmlldyBzbmFwc2hvdHMgYW5kIGRldGVybWluZXNcbiAqIHdoZW4gdG8gcmFpc2UgdGhlIGV2ZW50LlxuICpcbiAqIEl0IHVzZXMgYW4gT2JzZXJ2ZXIgdG8gZGlzcGF0Y2ggZXZlbnRzLlxuICovIGNsYXNzIEx1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLnZ1ID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0aWFsIHNuYXBzaG90cyAoZS5nLiBmcm9tIGNhY2hlKSBtYXkgbm90IGJlIHByb3BhZ2F0ZWQgdG8gdGhlIHdyYXBwZWRcbiAgICAgICAgICogb2JzZXJ2ZXIuIFRoaXMgZmxhZyBpcyBzZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIGFjdHVhbGx5IHJhaXNlZCBhbiBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuU3UgPSAhMSwgdGhpcy5EdSA9IG51bGwsIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBVbmtub3duICovICwgdGhpcy5vcHRpb25zID0gbiB8fCB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgbmV3IFZpZXdTbmFwc2hvdCB0byB0aGlzIGxpc3RlbmVyLCByYWlzaW5nIGEgdXNlci1mYWNpbmcgZXZlbnRcbiAgICAgKiBpZiBhcHBsaWNhYmxlIChkZXBlbmRpbmcgb24gd2hhdCBjaGFuZ2VkLCB3aGV0aGVyIHRoZSB1c2VyIGhhcyBvcHRlZCBpbnRvXG4gICAgICogbWV0YWRhdGEtb25seSBjaGFuZ2VzLCBldGMuKS4gUmV0dXJucyB0cnVlIGlmIGEgdXNlci1mYWNpbmcgZXZlbnQgd2FzXG4gICAgICogaW5kZWVkIHJhaXNlZC5cbiAgICAgKi8gICAgVnUodCkge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIG1ldGFkYXRhIG9ubHkgY2hhbmdlcy5cbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmRvY0NoYW5nZXMpIDMgLyogTWV0YWRhdGEgKi8gIT09IG4udHlwZSAmJiBlLnB1c2gobik7XG4gICAgICAgICAgICB0ID0gbmV3IHh1KHQucXVlcnksIHQuZG9jcywgdC5vbGREb2NzLCBlLCB0Lm11dGF0ZWRLZXlzLCB0LmZyb21DYWNoZSwgdC5zeW5jU3RhdGVDaGFuZ2VkLCBcbiAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyAhMCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuU3UgPyB0aGlzLkN1KHQpICYmICh0aGlzLnZ1Lm5leHQodCksIGUgPSAhMCkgOiB0aGlzLnh1KHQsIHRoaXMub25saW5lU3RhdGUpICYmICh0aGlzLk51KHQpLCBcbiAgICAgICAgZSA9ICEwKSwgdGhpcy5EdSA9IHQsIGU7XG4gICAgfVxuICAgIG9uRXJyb3IodCkge1xuICAgICAgICB0aGlzLnZ1LmVycm9yKHQpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIGEgc25hcHNob3Qgd2FzIHJhaXNlZC4gKi8gICAgUHUodCkge1xuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gdDtcbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMuRHUgJiYgIXRoaXMuU3UgJiYgdGhpcy54dSh0aGlzLkR1LCB0KSAmJiAodGhpcy5OdSh0aGlzLkR1KSwgZSA9ICEwKSwgXG4gICAgICAgIGU7XG4gICAgfVxuICAgIHh1KHQsIGUpIHtcbiAgICAgICAgLy8gQWx3YXlzIHJhaXNlIHRoZSBmaXJzdCBldmVudCB3aGVuIHdlJ3JlIHN5bmNlZFxuICAgICAgICBpZiAoIXQuZnJvbUNhY2hlKSByZXR1cm4gITA7XG4gICAgICAgIC8vIE5PVEU6IFdlIGNvbnNpZGVyIE9ubGluZVN0YXRlLlVua25vd24gYXMgb25saW5lIChpdCBzaG91bGQgYmVjb21lIE9mZmxpbmVcbiAgICAgICAgLy8gb3IgT25saW5lIGlmIHdlIHdhaXQgbG9uZyBlbm91Z2gpLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovICE9PSBlO1xuICAgICAgICAvLyBEb24ndCByYWlzZSB0aGUgZXZlbnQgaWYgd2UncmUgb25saW5lLCBhcmVuJ3Qgc3luY2VkIHlldCAoY2hlY2tlZFxuICAgICAgICAvLyBhYm92ZSkgYW5kIGFyZSB3YWl0aW5nIGZvciBhIHN5bmMuXG4gICAgICAgICAgICAgICAgcmV0dXJuICghdGhpcy5vcHRpb25zLmt1IHx8ICFuKSAmJiAoIXQuZG9jcy5pc0VtcHR5KCkgfHwgXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyA9PT0gZSk7XG4gICAgICAgIC8vIFJhaXNlIGRhdGEgZnJvbSBjYWNoZSBpZiB3ZSBoYXZlIGFueSBkb2N1bWVudHMgb3Igd2UgYXJlIG9mZmxpbmVcbiAgICAgICAgfVxuICAgIEN1KHQpIHtcbiAgICAgICAgLy8gV2UgZG9uJ3QgbmVlZCB0byBoYW5kbGUgaW5jbHVkZURvY3VtZW50TWV0YWRhdGFDaGFuZ2VzIGhlcmUgYmVjYXVzZVxuICAgICAgICAvLyB0aGUgTWV0YWRhdGEgb25seSBjaGFuZ2VzIGhhdmUgYWxyZWFkeSBiZWVuIHN0cmlwcGVkIG91dCBpZiBuZWVkZWQuXG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgdGhlIG9ubHkgY2hhbmdlcyB3ZSB3aWxsIHNlZSBhcmUgdGhlIG9uZXMgd2Ugc2hvdWxkXG4gICAgICAgIC8vIHByb3BhZ2F0ZS5cbiAgICAgICAgaWYgKHQuZG9jQ2hhbmdlcy5sZW5ndGggPiAwKSByZXR1cm4gITA7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLkR1ICYmIHRoaXMuRHUuaGFzUGVuZGluZ1dyaXRlcyAhPT0gdC5oYXNQZW5kaW5nV3JpdGVzO1xuICAgICAgICByZXR1cm4gISghdC5zeW5jU3RhdGVDaGFuZ2VkICYmICFlKSAmJiAhMCA9PT0gdGhpcy5vcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXM7XG4gICAgICAgIC8vIEdlbmVyYWxseSB3ZSBzaG91bGQgaGF2ZSBoaXQgb25lIG9mIHRoZSBjYXNlcyBhYm92ZSwgYnV0IGl0J3MgcG9zc2libGVcbiAgICAgICAgLy8gdG8gZ2V0IGhlcmUgaWYgdGhlcmUgd2VyZSBvbmx5IG1ldGFkYXRhIGRvY0NoYW5nZXMgYW5kIHRoZXkgZ290XG4gICAgICAgIC8vIHN0cmlwcGVkIG91dC5cbiAgICAgICAgfVxuICAgIE51KHQpIHtcbiAgICAgICAgdCA9IHh1LmZyb21Jbml0aWFsRG9jdW1lbnRzKHQucXVlcnksIHQuZG9jcywgdC5tdXRhdGVkS2V5cywgdC5mcm9tQ2FjaGUpLCB0aGlzLlN1ID0gITAsIFxuICAgICAgICB0aGlzLnZ1Lm5leHQodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGNvbXBsZXRlIGVsZW1lbnQgaW4gdGhlIGJ1bmRsZSBzdHJlYW0sIHRvZ2V0aGVyIHdpdGggdGhlIGJ5dGUgbGVuZ3RoIGl0XG4gKiBvY2N1cGllcyBpbiB0aGUgc3RyZWFtLlxuICovIGNsYXNzIFV1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvLyBIb3cgbWFueSBieXRlcyB0aGlzIGVsZW1lbnQgdGFrZXMgdG8gc3RvcmUgaW4gdGhlIGJ1bmRsZS5cbiAgICBlKSB7XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IHQsIHRoaXMuYnl0ZUxlbmd0aCA9IGU7XG4gICAgfVxuICAgIE11KCkge1xuICAgICAgICByZXR1cm4gXCJtZXRhZGF0YVwiIGluIHRoaXMucGF5bG9hZDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhlbHBlciB0byBjb252ZXJ0IG9iamVjdHMgZnJvbSBidW5kbGVzIHRvIG1vZGVsIG9iamVjdHMgaW4gdGhlIFNESy5cbiAqLyBjbGFzcyBxdSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLk0gPSB0O1xuICAgIH1cbiAgICB3aSh0KSB7XG4gICAgICAgIHJldHVybiBwcyh0aGlzLk0sIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIEJ1bmRsZURvY3VtZW50IHRvIGEgTXV0YWJsZURvY3VtZW50LlxuICAgICAqLyAgICBtaSh0KSB7XG4gICAgICAgIHJldHVybiB0Lm1ldGFkYXRhLmV4aXN0cyA/IGJzKHRoaXMuTSwgdC5kb2N1bWVudCwgITEpIDogbmUubmV3Tm9Eb2N1bWVudCh0aGlzLndpKHQubWV0YWRhdGEubmFtZSksIHRoaXMuZ2kodC5tZXRhZGF0YS5yZWFkVGltZSkpO1xuICAgIH1cbiAgICBnaSh0KSB7XG4gICAgICAgIHJldHVybiB3cyh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBjbGFzcyB0byBwcm9jZXNzIHRoZSBlbGVtZW50cyBmcm9tIGEgYnVuZGxlLCBsb2FkIHRoZW0gaW50byBsb2NhbFxuICogc3RvcmFnZSBhbmQgcHJvdmlkZSBwcm9ncmVzcyB1cGRhdGUgd2hpbGUgbG9hZGluZy5cbiAqLyBjbGFzcyBLdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLk91ID0gdCwgdGhpcy5sb2NhbFN0b3JlID0gZSwgdGhpcy5NID0gbiwgXG4gICAgICAgIC8qKiBCYXRjaGVkIHF1ZXJpZXMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMucXVlcmllcyA9IFtdLCBcbiAgICAgICAgLyoqIEJhdGNoZWQgZG9jdW1lbnRzIHRvIGJlIHNhdmVkIGludG8gc3RvcmFnZSAqL1xuICAgICAgICB0aGlzLmRvY3VtZW50cyA9IFtdLCBcbiAgICAgICAgLyoqIFRoZSBjb2xsZWN0aW9uIGdyb3VwcyBhZmZlY3RlZCBieSB0aGlzIGJ1bmRsZS4gKi9cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uR3JvdXBzID0gbmV3IFNldCwgdGhpcy5wcm9ncmVzcyA9IEd1KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGVsZW1lbnQgZnJvbSB0aGUgYnVuZGxlIHRvIHRoZSBsb2FkZXIuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHByb2dyZXNzIGlmIGFkZGluZyB0aGUgZWxlbWVudCBsZWFkcyB0byBhIG5ldyBwcm9ncmVzcyxcbiAgICAgKiBvdGhlcndpc2UgcmV0dXJucyBudWxsLlxuICAgICAqLyAgICBGdSh0KSB7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3MuYnl0ZXNMb2FkZWQgKz0gdC5ieXRlTGVuZ3RoO1xuICAgICAgICBsZXQgZSA9IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkO1xuICAgICAgICBpZiAodC5wYXlsb2FkLm5hbWVkUXVlcnkpIHRoaXMucXVlcmllcy5wdXNoKHQucGF5bG9hZC5uYW1lZFF1ZXJ5KTsgZWxzZSBpZiAodC5wYXlsb2FkLmRvY3VtZW50TWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB0LnBheWxvYWQuZG9jdW1lbnRNZXRhZGF0YVxuICAgICAgICAgICAgfSksIHQucGF5bG9hZC5kb2N1bWVudE1ldGFkYXRhLmV4aXN0cyB8fCArK2U7XG4gICAgICAgICAgICBjb25zdCBuID0gX3QuZnJvbVN0cmluZyh0LnBheWxvYWQuZG9jdW1lbnRNZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbkdyb3Vwcy5hZGQobi5nZXQobi5sZW5ndGggLSAyKSk7XG4gICAgICAgIH0gZWxzZSB0LnBheWxvYWQuZG9jdW1lbnQgJiYgKHRoaXMuZG9jdW1lbnRzW3RoaXMuZG9jdW1lbnRzLmxlbmd0aCAtIDFdLmRvY3VtZW50ID0gdC5wYXlsb2FkLmRvY3VtZW50LCBcbiAgICAgICAgKytlKTtcbiAgICAgICAgcmV0dXJuIGUgIT09IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID8gKHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID0gZSwgXG4gICAgICAgIE9iamVjdC5hc3NpZ24oe30sIHRoaXMucHJvZ3Jlc3MpKSA6IG51bGw7XG4gICAgfVxuICAgICR1KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBNYXAsIG4gPSBuZXcgcXUodGhpcy5NKTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIGlmIChzLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLndpKHMubWV0YWRhdGEubmFtZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2Ygcy5tZXRhZGF0YS5xdWVyaWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IChlLmdldChuKSB8fCBZbigpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgZS5zZXQobiwgcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgdG8gJ1N1Y2Nlc3MnIGFuZCByZXR1cm4gdGhlIHVwZGF0ZWQgcHJvZ3Jlc3MuXG4gICAgICovICAgIGFzeW5jIGNvbXBsZXRlKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgbW8odGhpcy5sb2NhbFN0b3JlLCBuZXcgcXUodGhpcy5NKSwgdGhpcy5kb2N1bWVudHMsIHRoaXMuT3UuaWQpLCBlID0gdGhpcy4kdSh0aGlzLmRvY3VtZW50cyk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnF1ZXJpZXMpIGF3YWl0IGdvKHRoaXMubG9jYWxTdG9yZSwgdCwgZS5nZXQodC5uYW1lKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2dyZXNzLnRhc2tTdGF0ZSA9IFwiU3VjY2Vzc1wiLCB7XG4gICAgICAgICAgICBwcm9ncmVzczogdGhpcy5wcm9ncmVzcyxcbiAgICAgICAgICAgIEJ1OiB0aGlzLmNvbGxlY3Rpb25Hcm91cHMsXG4gICAgICAgICAgICBMdTogdFxuICAgICAgICB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHJlcHJlc2VudGluZyB0aGUgaW5pdGlhbCBwcm9ncmVzcyBvZlxuICogbG9hZGluZyBhIGJ1bmRsZS5cbiAqLyBmdW5jdGlvbiBHdSh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdGFza1N0YXRlOiBcIlJ1bm5pbmdcIixcbiAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiAwLFxuICAgICAgICBieXRlc0xvYWRlZDogMCxcbiAgICAgICAgdG90YWxEb2N1bWVudHM6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgIHRvdGFsQnl0ZXM6IHQudG90YWxCeXRlc1xuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCByZXByZXNlbnRpbmcgdGhlIHByb2dyZXNzIHRoYXQgdGhlIGxvYWRpbmdcbiAqIGhhcyBzdWNjZWVkZWQuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBRdSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBqdSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIFZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXQgZG9jcyBhcmUgaW5cbiAqIGEgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzIHRvIGRvY3MsIGFuZCBhcHBsaWVzXG4gKiB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0IHBvc3NpYmxlIHJlc3VsdHMuXG4gKi8gY2xhc3MgV3Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKiBEb2N1bWVudHMgaW5jbHVkZWQgaW4gdGhlIHJlbW90ZSB0YXJnZXQgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLlV1ID0gZSwgdGhpcy5xdSA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHdoZXRoZXIgdGhlIHZpZXcgaXMgY3VycmVudCB3aXRoIHRoZSBiYWNrZW5kLiBBIHZpZXcgaXMgY29uc2lkZXJlZFxuICAgICAgICAgKiBjdXJyZW50IGFmdGVyIGl0IGhhcyBzZWVuIHRoZSBjdXJyZW50IGZsYWcgZnJvbSB0aGUgYmFja2VuZCBhbmQgZGlkIG5vdFxuICAgICAgICAgKiBsb3NlIGNvbnNpc3RlbmN5IHdpdGhpbiB0aGUgd2F0Y2ggc3RyZWFtIChlLmcuIGJlY2F1c2Ugb2YgYW4gZXhpc3RlbmNlXG4gICAgICAgICAqIGZpbHRlciBtaXNtYXRjaCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSAhMSwgXG4gICAgICAgIC8qKiBEb2N1bWVudHMgaW4gdGhlIHZpZXcgYnV0IG5vdCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xuICAgICAgICB0aGlzLkt1ID0gWW4oKSwgXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBZbigpLCB0aGlzLkd1ID0gbm4odCksIHRoaXMuUXUgPSBuZXcgRHUodGhpcy5HdSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgcmVtb3RlIGRvY3VtZW50cyB0aGF0IHRoZSBzZXJ2ZXIgaGFzIHRvbGQgdXMgYmVsb25ncyB0byB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aFxuICAgICAqIHRoaXMgdmlldy5cbiAgICAgKi8gICAgZ2V0IGp1KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5VdTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHNldCBvZiBkb2MgY2hhbmdlcywgYXBwbGllcyB0aGUgcXVlcnkgbGltaXQsIGFuZCBjb21wdXRlc1xuICAgICAqIHdoYXQgdGhlIG5ldyByZXN1bHRzIHNob3VsZCBiZSwgd2hhdCB0aGUgY2hhbmdlcyB3ZXJlLCBhbmQgd2hldGhlciB3ZSBtYXlcbiAgICAgKiBuZWVkIHRvIGdvIGJhY2sgdG8gdGhlIGxvY2FsIGNhY2hlIGZvciBtb3JlIHJlc3VsdHMuIERvZXMgbm90IG1ha2UgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgdmlldy5cbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyAtIFRoZSBkb2MgY2hhbmdlcyB0byBhcHBseSB0byB0aGlzIHZpZXcuXG4gICAgICogQHBhcmFtIHByZXZpb3VzQ2hhbmdlcyAtIElmIHRoaXMgaXMgYmVpbmcgY2FsbGVkIHdpdGggYSByZWZpbGwsIHRoZW4gc3RhcnRcbiAgICAgKiAgICAgICAgd2l0aCB0aGlzIHNldCBvZiBkb2NzIGFuZCBjaGFuZ2VzIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgdmlldy5cbiAgICAgKiBAcmV0dXJucyBhIG5ldyBzZXQgb2YgZG9jcywgY2hhbmdlcywgYW5kIHJlZmlsbCBmbGFnLlxuICAgICAqLyAgICBXdSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlID8gZS56dSA6IG5ldyBDdSwgcyA9IGUgPyBlLlF1IDogdGhpcy5RdTtcbiAgICAgICAgbGV0IGkgPSBlID8gZS5tdXRhdGVkS2V5cyA6IHRoaXMubXV0YXRlZEtleXMsIHIgPSBzLCBvID0gITE7XG4gICAgICAgIC8vIFRyYWNrIHRoZSBsYXN0IGRvYyBpbiBhIChmdWxsKSBsaW1pdC4gVGhpcyBpcyBuZWNlc3NhcnksIGJlY2F1c2Ugc29tZVxuICAgICAgICAvLyB1cGRhdGUgKGEgZGVsZXRlLCBvciBhbiB1cGRhdGUgbW92aW5nIGEgZG9jIHBhc3QgdGhlIG9sZCBsaW1pdCkgbWlnaHRcbiAgICAgICAgLy8gbWVhbiB0aGVyZSBpcyBzb21lIG90aGVyIGRvY3VtZW50IGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0IGVpdGhlciBzaG91bGRcbiAgICAgICAgLy8gY29tZSAoMSkgYmV0d2VlbiB0aGUgb2xkIGxhc3QgbGltaXQgZG9jIGFuZCB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZVxuICAgICAgICAvLyBjYXNlIG9mIHVwZGF0ZXMsIG9yICgyKSBhZnRlciB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZSBjYXNlIG9mXG4gICAgICAgIC8vIGRlbGV0ZXMuIFNvIHdlIGtlZXAgdGhpcyBkb2MgYXQgdGhlIG9sZCBsaW1pdCB0byBjb21wYXJlIHRoZSB1cGRhdGVzIHRvLlxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBzaG91bGQgbmV2ZXIgZ2V0IHVzZWQgaW4gYSByZWZpbGwgKHdoZW4gcHJldmlvdXNDaGFuZ2VzIGlzXG4gICAgICAgIC8vIHNldCksIGJlY2F1c2UgdGhlcmUgd2lsbCBvbmx5IGJlIGFkZHMgLS0gbm8gZGVsZXRlcyBvciB1cGRhdGVzLlxuICAgICAgICBjb25zdCB1ID0gXCJGXCIgLyogRmlyc3QgKi8gPT09IHRoaXMucXVlcnkubGltaXRUeXBlICYmIHMuc2l6ZSA9PT0gdGhpcy5xdWVyeS5saW1pdCA/IHMubGFzdCgpIDogbnVsbCwgYSA9IFwiTFwiIC8qIExhc3QgKi8gPT09IHRoaXMucXVlcnkubGltaXRUeXBlICYmIHMuc2l6ZSA9PT0gdGhpcy5xdWVyeS5saW1pdCA/IHMuZmlyc3QoKSA6IG51bGw7XG4gICAgICAgIC8vIERyb3AgZG9jdW1lbnRzIG91dCB0byBtZWV0IGxpbWl0L2xpbWl0VG9MYXN0IHJlcXVpcmVtZW50LlxuICAgICAgICBpZiAodC5pbm9yZGVyVHJhdmVyc2FsKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYyA9IHMuZ2V0KHQpLCBoID0gdG4odGhpcy5xdWVyeSwgZSkgPyBlIDogbnVsbCwgbCA9ICEhYyAmJiB0aGlzLm11dGF0ZWRLZXlzLmhhcyhjLmtleSksIGYgPSAhIWggJiYgKGguaGFzTG9jYWxNdXRhdGlvbnMgfHwgXG4gICAgICAgICAgICAvLyBXZSBvbmx5IGNvbnNpZGVyIGNvbW1pdHRlZCBtdXRhdGlvbnMgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmVcbiAgICAgICAgICAgIC8vIG11dGF0ZWQgZHVyaW5nIHRoZSBsaWZldGltZSBvZiB0aGUgdmlldy5cbiAgICAgICAgICAgIHRoaXMubXV0YXRlZEtleXMuaGFzKGgua2V5KSAmJiBoLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XG4gICAgICAgICAgICBsZXQgZCA9ICExO1xuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMgJiYgaCkge1xuICAgICAgICAgICAgICAgIGMuZGF0YS5pc0VxdWFsKGguZGF0YSkgPyBsICE9PSBmICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMyAvKiBNZXRhZGF0YSAqLyAsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgICAgIH0pLCBkID0gITApIDogdGhpcy5IdShjLCBoKSB8fCAobi50cmFjayh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IDIgLyogTW9kaWZpZWQgKi8gLFxuICAgICAgICAgICAgICAgICAgICBkb2M6IGhcbiAgICAgICAgICAgICAgICB9KSwgZCA9ICEwLCAodSAmJiB0aGlzLkd1KGgsIHUpID4gMCB8fCBhICYmIHRoaXMuR3UoaCwgYSkgPCAwKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBkb2MgbW92ZWQgZnJvbSBpbnNpZGUgdGhlIGxpbWl0IHRvIG91dHNpZGUgdGhlIGxpbWl0LlxuICAgICAgICAgICAgICAgIC8vIFRoYXQgbWVhbnMgdGhlcmUgbWF5IGJlIHNvbWUgb3RoZXIgZG9jIGluIHRoZSBsb2NhbCBjYWNoZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgc2hvdWxkIGJlIGluY2x1ZGVkIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICB9IGVsc2UgIWMgJiYgaCA/IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAwIC8qIEFkZGVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IGhcbiAgICAgICAgICAgIH0pLCBkID0gITApIDogYyAmJiAhaCAmJiAobi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IGNcbiAgICAgICAgICAgIH0pLCBkID0gITAsICh1IHx8IGEpICYmIChcbiAgICAgICAgICAgIC8vIEEgZG9jIHdhcyByZW1vdmVkIGZyb20gYSBmdWxsIGxpbWl0IHF1ZXJ5LiBXZSdsbCBuZWVkIHRvXG4gICAgICAgICAgICAvLyByZXF1ZXJ5IGZyb20gdGhlIGxvY2FsIGNhY2hlIHRvIHNlZSBpZiB3ZSBrbm93IGFib3V0IHNvbWUgb3RoZXJcbiAgICAgICAgICAgIC8vIGRvYyB0aGF0IHNob3VsZCBiZSBpbiB0aGUgcmVzdWx0cy5cbiAgICAgICAgICAgIG8gPSAhMCkpO1xuICAgICAgICAgICAgZCAmJiAoaCA/IChyID0gci5hZGQoaCksIGkgPSBmID8gaS5hZGQodCkgOiBpLmRlbGV0ZSh0KSkgOiAociA9IHIuZGVsZXRlKHQpLCBpID0gaS5kZWxldGUodCkpKTtcbiAgICAgICAgfSkpLCBudWxsICE9PSB0aGlzLnF1ZXJ5LmxpbWl0KSBmb3IgKDtyLnNpemUgPiB0aGlzLnF1ZXJ5LmxpbWl0OyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBcIkZcIiAvKiBGaXJzdCAqLyA9PT0gdGhpcy5xdWVyeS5saW1pdFR5cGUgPyByLmxhc3QoKSA6IHIuZmlyc3QoKTtcbiAgICAgICAgICAgIHIgPSByLmRlbGV0ZSh0LmtleSksIGkgPSBpLmRlbGV0ZSh0LmtleSksIG4udHJhY2soe1xuICAgICAgICAgICAgICAgIHR5cGU6IDEgLyogUmVtb3ZlZCAqLyAsXG4gICAgICAgICAgICAgICAgZG9jOiB0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgUXU6IHIsXG4gICAgICAgICAgICB6dTogbixcbiAgICAgICAgICAgIGlpOiBvLFxuICAgICAgICAgICAgbXV0YXRlZEtleXM6IGlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgSHUodCwgZSkge1xuICAgICAgICAvLyBXZSBzdXBwcmVzcyB0aGUgaW5pdGlhbCBjaGFuZ2UgZXZlbnQgZm9yIGRvY3VtZW50cyB0aGF0IHdlcmUgbW9kaWZpZWQgYXNcbiAgICAgICAgLy8gcGFydCBvZiBhIHdyaXRlIGFja25vd2xlZGdtZW50IChlLmcuIHdoZW4gdGhlIHZhbHVlIG9mIGEgc2VydmVyIHRyYW5zZm9ybVxuICAgICAgICAvLyBpcyBhcHBsaWVkKSBhcyBXYXRjaCB3aWxsIHNlbmQgdXMgdGhlIHNhbWUgZG9jdW1lbnQgYWdhaW4uXG4gICAgICAgIC8vIEJ5IHN1cHByZXNzaW5nIHRoZSBldmVudCwgd2Ugb25seSByYWlzZSB0d28gdXNlciB2aXNpYmxlIGV2ZW50cyAob25lIHdpdGhcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KSBpbnN0ZWFkIG9mIHRocmVlXG4gICAgICAgIC8vIChvbmUgd2l0aCBgaGFzUGVuZGluZ1dyaXRlc2AsIHRoZSBtb2RpZmllZCBkb2N1bWVudCB3aXRoXG4gICAgICAgIC8vIGBoYXNQZW5kaW5nV3JpdGVzYCBhbmQgdGhlIGZpbmFsIHN0YXRlIG9mIHRoZSBkb2N1bWVudCkuXG4gICAgICAgIHJldHVybiB0Lmhhc0xvY2FsTXV0YXRpb25zICYmIGUuaGFzQ29tbWl0dGVkTXV0YXRpb25zICYmICFlLmhhc0xvY2FsTXV0YXRpb25zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSB2aWV3IHdpdGggdGhlIGdpdmVuIFZpZXdEb2N1bWVudENoYW5nZXMgYW5kIG9wdGlvbmFsbHkgdXBkYXRlc1xuICAgICAqIGxpbWJvIGRvY3MgYW5kIHN5bmMgc3RhdGUgZnJvbSB0aGUgcHJvdmlkZWQgdGFyZ2V0IGNoYW5nZS5cbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyAtIFRoZSBzZXQgb2YgY2hhbmdlcyB0byBtYWtlIHRvIHRoZSB2aWV3J3MgZG9jcy5cbiAgICAgKiBAcGFyYW0gdXBkYXRlTGltYm9Eb2N1bWVudHMgLSBXaGV0aGVyIHRvIHVwZGF0ZSBsaW1ibyBkb2N1bWVudHMgYmFzZWQgb25cbiAgICAgKiAgICAgICAgdGhpcyBjaGFuZ2UuXG4gICAgICogQHBhcmFtIHRhcmdldENoYW5nZSAtIEEgdGFyZ2V0IGNoYW5nZSB0byBhcHBseSBmb3IgY29tcHV0aW5nIGxpbWJvIGRvY3MgYW5kXG4gICAgICogICAgICAgIHN5bmMgc3RhdGUuXG4gICAgICogQHJldHVybnMgQSBuZXcgVmlld0NoYW5nZSB3aXRoIHRoZSBnaXZlbiBkb2NzLCBjaGFuZ2VzLCBhbmQgc3luYyBzdGF0ZS5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSBpT1MvQW5kcm9pZCBjbGllbnRzIGFsd2F5cyBjb21wdXRlIGxpbWJvIGRvY3VtZW50IGNoYW5nZXMuXG4gICAgYXBwbHlDaGFuZ2VzKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMuUXU7XG4gICAgICAgIHRoaXMuUXUgPSB0LlF1LCB0aGlzLm11dGF0ZWRLZXlzID0gdC5tdXRhdGVkS2V5cztcbiAgICAgICAgLy8gU29ydCBjaGFuZ2VzIGJhc2VkIG9uIHR5cGUgYW5kIHF1ZXJ5IGNvbXBhcmF0b3JcbiAgICAgICAgY29uc3QgaSA9IHQuenUuQXUoKTtcbiAgICAgICAgaS5zb3J0KCgodCwgZSkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgY2FzZSAwIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG5cbiAgICAgICAgICAgICAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICAgICAgICAgICAgICBjYXNlIDMgLyogTWV0YWRhdGEgKi8gOlxuICAgICAgICAgICAgICAgICAgICAvLyBBIG1ldGFkYXRhIGNoYW5nZSBpcyBjb252ZXJ0ZWQgdG8gYSBtb2RpZmllZCBjaGFuZ2UgYXQgdGhlIHB1YmxpY1xuICAgICAgICAgICAgICAgICAgICAvLyBhcGkgbGF5ZXIuICBTaW5jZSB3ZSBzb3J0IGJ5IGRvY3VtZW50IGtleSBhbmQgdGhlbiBjaGFuZ2UgdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgLy8gbWV0YWRhdGEgYW5kIG1vZGlmaWVkIGNoYW5nZXMgbXVzdCBiZSBzb3J0ZWQgZXF1aXZhbGVudGx5LlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjtcblxuICAgICAgICAgICAgICAgICAgY2FzZSAxIC8qIFJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEwoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG4odCkgLSBuKGUpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0LnR5cGUsIGUudHlwZSkgfHwgdGhpcy5HdSh0LmRvYywgZS5kb2MpKSksIHRoaXMuSnUobik7XG4gICAgICAgIGNvbnN0IHIgPSBlID8gdGhpcy5ZdSgpIDogW10sIG8gPSAwID09PSB0aGlzLkt1LnNpemUgJiYgdGhpcy5jdXJyZW50ID8gMSAvKiBTeW5jZWQgKi8gOiAwIC8qIExvY2FsICovICwgdSA9IG8gIT09IHRoaXMucXU7XG4gICAgICAgIGlmICh0aGlzLnF1ID0gbywgMCAhPT0gaS5sZW5ndGggfHwgdSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzbmFwc2hvdDogbmV3IHh1KHRoaXMucXVlcnksIHQuUXUsIHMsIGksIHQubXV0YXRlZEtleXMsIDAgLyogTG9jYWwgKi8gPT09IG8sIHUsIFxuICAgICAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyAhMSksXG4gICAgICAgICAgICAgICAgWHU6IHJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgLy8gbm8gY2hhbmdlc1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgWHU6IHJcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHZpZXcsIHBvdGVudGlhbGx5IGdlbmVyYXRpbmcgYVxuICAgICAqIFZpZXdDaGFuZ2UgaWYgdGhlIHZpZXcncyBzeW5jU3RhdGUgY2hhbmdlcyBhcyBhIHJlc3VsdC5cbiAgICAgKi8gICAgUHUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50ICYmIFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8gPT09IHQgPyAoXG4gICAgICAgIC8vIElmIHdlJ3JlIG9mZmxpbmUsIHNldCBgY3VycmVudGAgdG8gZmFsc2UgYW5kIHRoZW4gY2FsbCBhcHBseUNoYW5nZXMoKVxuICAgICAgICAvLyB0byByZWZyZXNoIG91ciBzeW5jU3RhdGUgYW5kIGdlbmVyYXRlIGEgVmlld0NoYW5nZSBhcyBhcHByb3ByaWF0ZS4gV2VcbiAgICAgICAgLy8gYXJlIGd1YXJhbnRlZWQgdG8gZ2V0IGEgbmV3IFRhcmdldENoYW5nZSB0aGF0IHNldHMgYGN1cnJlbnRgIGJhY2sgdG9cbiAgICAgICAgLy8gdHJ1ZSBvbmNlIHRoZSBjbGllbnQgaXMgYmFjayBvbmxpbmUuXG4gICAgICAgIHRoaXMuY3VycmVudCA9ICExLCB0aGlzLmFwcGx5Q2hhbmdlcyh7XG4gICAgICAgICAgICBRdTogdGhpcy5RdSxcbiAgICAgICAgICAgIHp1OiBuZXcgQ3UsXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogdGhpcy5tdXRhdGVkS2V5cyxcbiAgICAgICAgICAgIGlpOiAhMVxuICAgICAgICB9LCBcbiAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovICExKSkgOiB7XG4gICAgICAgICAgICBYdTogW11cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBkb2MgZm9yIHRoZSBnaXZlbiBrZXkgc2hvdWxkIGJlIGluIGxpbWJvLlxuICAgICAqLyAgICBadSh0KSB7XG4gICAgICAgIC8vIElmIHRoZSByZW1vdGUgZW5kIHNheXMgaXQncyBwYXJ0IG9mIHRoaXMgcXVlcnksIGl0J3Mgbm90IGluIGxpbWJvLlxuICAgICAgICByZXR1cm4gIXRoaXMuVXUuaGFzKHQpICYmIChcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIGRvZXNuJ3QgdGhpbmsgaXQncyBhIHJlc3VsdCwgc28gaXQgc2hvdWxkbid0IGJlIGluIGxpbWJvLlxuICAgICAgICAhIXRoaXMuUXUuaGFzKHQpICYmICF0aGlzLlF1LmdldCh0KS5oYXNMb2NhbE11dGF0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgc3luY2VkRG9jdW1lbnRzLCBjdXJyZW50LCBhbmQgbGltYm8gZG9jcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gY2hhbmdlLlxuICAgICAqIFJldHVybnMgdGhlIGxpc3Qgb2YgY2hhbmdlcyB0byB3aGljaCBkb2NzIGFyZSBpbiBsaW1iby5cbiAgICAgKi8gICAgSnUodCkge1xuICAgICAgICB0ICYmICh0LmFkZGVkRG9jdW1lbnRzLmZvckVhY2goKHQgPT4gdGhpcy5VdSA9IHRoaXMuVXUuYWRkKHQpKSksIHQubW9kaWZpZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB7fSkpLCBcbiAgICAgICAgdC5yZW1vdmVkRG9jdW1lbnRzLmZvckVhY2goKHQgPT4gdGhpcy5VdSA9IHRoaXMuVXUuZGVsZXRlKHQpKSksIHRoaXMuY3VycmVudCA9IHQuY3VycmVudCk7XG4gICAgfVxuICAgIFl1KCkge1xuICAgICAgICAvLyBXZSBjYW4gb25seSBkZXRlcm1pbmUgbGltYm8gZG9jdW1lbnRzIHdoZW4gd2UncmUgaW4tc3luYyB3aXRoIHRoZSBzZXJ2ZXIuXG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50KSByZXR1cm4gW107XG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBEbyB0aGlzIGluY3JlbWVudGFsbHkgc28gdGhhdCBpdCdzIG5vdCBxdWFkcmF0aWMgd2hlblxuICAgICAgICAvLyB1cGRhdGluZyBtYW55IGRvY3VtZW50cy5cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5LdTtcbiAgICAgICAgdGhpcy5LdSA9IFluKCksIHRoaXMuUXUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLlp1KHQua2V5KSAmJiAodGhpcy5LdSA9IHRoaXMuS3UuYWRkKHQua2V5KSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gRGlmZiB0aGUgbmV3IGxpbWJvIGRvY3Mgd2l0aCB0aGUgb2xkIGxpbWJvIGRvY3MuXG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLkt1Lmhhcyh0KSB8fCBlLnB1c2gobmV3IGp1KHQpKTtcbiAgICAgICAgfSkpLCB0aGlzLkt1LmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgdC5oYXMobikgfHwgZS5wdXNoKG5ldyBRdShuKSk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBpbi1tZW1vcnkgc3RhdGUgb2YgdGhlIGN1cnJlbnQgdmlldyB3aXRoIHRoZSBzdGF0ZSByZWFkIGZyb21cbiAgICAgKiBwZXJzaXN0ZW5jZS5cbiAgICAgKlxuICAgICAqIFdlIHVwZGF0ZSB0aGUgcXVlcnkgdmlldyB3aGVuZXZlciBhIGNsaWVudCdzIHByaW1hcnkgc3RhdHVzIGNoYW5nZXM6XG4gICAgICogLSBXaGVuIGEgY2xpZW50IHRyYW5zaXRpb25zIGZyb20gcHJpbWFyeSB0byBzZWNvbmRhcnksIGl0IGNhbiBtaXNzXG4gICAgICogICBMb2NhbFN0b3JhZ2UgdXBkYXRlcyBhbmQgaXRzIHF1ZXJ5IHZpZXdzIG1heSB0ZW1wb3JhcmlseSBub3QgYmVcbiAgICAgKiAgIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzdGF0ZSBvbiBkaXNrLlxuICAgICAqIC0gRm9yIHNlY29uZGFyeSB0byBwcmltYXJ5IHRyYW5zaXRpb25zLCB0aGUgY2xpZW50IG5lZWRzIHRvIHVwZGF0ZSB0aGUgbGlzdFxuICAgICAqICAgb2YgYHN5bmNlZERvY3VtZW50c2Agc2luY2Ugc2Vjb25kYXJ5IGNsaWVudHMgdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzXG4gICAgICogICBiYXNlZCBwdXJlbHkgb24gc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHF1ZXJ5UmVzdWx0LmRvY3VtZW50cyAtIFRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGUgcXVlcnkgYWNjb3JkaW5nXG4gICAgICogdG8gdGhlIExvY2FsU3RvcmUuXG4gICAgICogQHBhcmFtIHF1ZXJ5UmVzdWx0LnJlbW90ZUtleXMgLSBUaGUga2V5cyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlXG4gICAgICogcXVlcnkgYWNjb3JkaW5nIHRvIHRoZSBiYWNrZW5kLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFZpZXdDaGFuZ2UgdGhhdCByZXN1bHRlZCBmcm9tIHRoaXMgc3luY2hyb25pemF0aW9uLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgdGEodCkge1xuICAgICAgICB0aGlzLlV1ID0gdC5faSwgdGhpcy5LdSA9IFluKCk7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLld1KHQuZG9jdW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlDaGFuZ2VzKGUsIC8qdXBkYXRlTGltYm9Eb2N1bWVudHM9Ki8gITApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiB0aGlzIHF1ZXJ5IHdhcyBqdXN0IGxpc3RlbmVkIHRvLiBDb250YWluc1xuICAgICAqIGEgZG9jdW1lbnQgYWRkIGZvciBldmVyeSBleGlzdGluZyBkb2N1bWVudCBhbmQgdGhlIGBmcm9tQ2FjaGVgIGFuZFxuICAgICAqIGBoYXNQZW5kaW5nV3JpdGVzYCBzdGF0dXMgb2YgdGhlIGFscmVhZHkgZXN0YWJsaXNoZWQgdmlldy5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIGVhKCkge1xuICAgICAgICByZXR1cm4geHUuZnJvbUluaXRpYWxEb2N1bWVudHModGhpcy5xdWVyeSwgdGhpcy5RdSwgdGhpcy5tdXRhdGVkS2V5cywgMCAvKiBMb2NhbCAqLyA9PT0gdGhpcy5xdSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFF1ZXJ5VmlldyBjb250YWlucyBhbGwgb2YgdGhlIGRhdGEgdGhhdCBTeW5jRW5naW5lIG5lZWRzIHRvIGtlZXAgdHJhY2sgb2YgZm9yXG4gKiBhIHBhcnRpY3VsYXIgcXVlcnkuXG4gKi9cbmNsYXNzIHp1IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgcXVlcnkgaXRzZWxmLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSB0YXJnZXQgbnVtYmVyIGNyZWF0ZWQgYnkgdGhlIGNsaWVudCB0aGF0IGlzIHVzZWQgaW4gdGhlIHdhdGNoXG4gICAgICogc3RyZWFtIHRvIGlkZW50aWZ5IHRoaXMgcXVlcnkuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXRcbiAgICAgKiBkb2NzIGFyZSBpbiB0aGUgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzLFxuICAgICAqIGFuZCBhcHBsaWVzIHRoZSBxdWVyeSBmaWx0ZXJzIGFuZCBsaW1pdHMgdG8gZGV0ZXJtaW5lIHRoZSBtb3N0IGNvcnJlY3RcbiAgICAgKiBwb3NzaWJsZSByZXN1bHRzLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMudGFyZ2V0SWQgPSBlLCB0aGlzLnZpZXcgPSBuO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyBhIGxpbWJvIHJlc29sdXRpb24uICovIGNsYXNzIEh1IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIHJlY2VpdmVkIGEgZG9jdW1lbnQuIFRoaXMgaXMgdXNlZCBpblxuICAgICAgICAgKiBnZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KCkgYW5kIHVsdGltYXRlbHkgdXNlZCBieSBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IgdG9cbiAgICAgICAgICogZGVjaWRlIHdoZXRoZXIgaXQgbmVlZHMgdG8gbWFudWZhY3R1cmUgYSBkZWxldGUgZXZlbnQgZm9yIHRoZSB0YXJnZXQgb25jZVxuICAgICAgICAgKiB0aGUgdGFyZ2V0IGlzIENVUlJFTlQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hID0gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIGBTeW5jRW5naW5lYCBjb29yZGluYXRpbmcgd2l0aCBvdGhlciBwYXJ0cyBvZiBTREsuXG4gKlxuICogVGhlIHBhcnRzIG9mIFN5bmNFbmdpbmUgdGhhdCBhY3QgYXMgYSBjYWxsYmFjayB0byBSZW1vdGVTdG9yZSBuZWVkIHRvIGJlXG4gKiByZWdpc3RlcmVkIGluZGl2aWR1YWxseS4gVGhpcyBpcyBkb25lIGluIGBzeW5jRW5naW5lV3JpdGUoKWAgYW5kXG4gKiBgc3luY0VuZ2luZUxpc3RlbigpYCAoYXMgd2VsbCBhcyBgYXBwbHlQcmltYXJ5U3RhdGUoKWApIGFzIHRoZXNlIG1ldGhvZHNcbiAqIHNlcnZlIGFzIGVudHJ5IHBvaW50cyB0byBSZW1vdGVTdG9yZSdzIGZ1bmN0aW9uYWxpdHkuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi8gY2xhc3MgSnUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIFxuICAgIC8vIFBPUlRJTkcgTk9URTogTWFuYWdlcyBzdGF0ZSBzeW5jaHJvbml6YXRpb24gaW4gbXVsdGktdGFiIGVudmlyb25tZW50cy5cbiAgICBzLCBpLCByKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IHQsIHRoaXMucmVtb3RlU3RvcmUgPSBlLCB0aGlzLmV2ZW50TWFuYWdlciA9IG4sIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBzLCBcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IGksIHRoaXMubWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnMgPSByLCB0aGlzLnNhID0ge30sIHRoaXMuaWEgPSBuZXcgS24oKHQgPT4gWGUodCkpLCBZZSksIFxuICAgICAgICB0aGlzLnJhID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUga2V5cyBvZiBkb2N1bWVudHMgdGhhdCBhcmUgaW4gbGltYm8gZm9yIHdoaWNoIHdlIGhhdmVuJ3QgeWV0IHN0YXJ0ZWQgYVxuICAgICAgICAgKiBsaW1ibyByZXNvbHV0aW9uIHF1ZXJ5LiBUaGUgc3RyaW5ncyBpbiB0aGlzIHNldCBhcmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nXG4gICAgICAgICAqIGBrZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKWAgd2hlcmUgYGtleWAgaXMgYSBgRG9jdW1lbnRLZXlgIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGBTZXRgIHR5cGUgd2FzIGNob3NlbiBiZWNhdXNlIGl0IHByb3ZpZGVzIGVmZmljaWVudCBsb29rdXAgYW5kIHJlbW92YWxcbiAgICAgICAgICogb2YgYXJiaXRyYXJ5IGVsZW1lbnRzIGFuZCBpdCBhbHNvIG1haW50YWlucyBpbnNlcnRpb24gb3JkZXIsIHByb3ZpZGluZyB0aGVcbiAgICAgICAgICogZGVzaXJlZCBxdWV1ZS1saWtlIEZJRk8gc2VtYW50aWNzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vYSA9IG5ldyBTZXQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIHRhcmdldCBJRCBmb3IgZWFjaCBkb2N1bWVudCB0aGF0IGlzIGluIGxpbWJvIHdpdGggYW5cbiAgICAgICAgICogYWN0aXZlIHRhcmdldC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudWEgPSBuZXcgZmUoeHQuY29tcGFyYXRvciksIFxuICAgICAgICAvKipcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIGluZm9ybWF0aW9uIGFib3V0IGFuIGFjdGl2ZSBsaW1ibyByZXNvbHV0aW9uIGZvciBlYWNoXG4gICAgICAgICAqIGFjdGl2ZSB0YXJnZXQgSUQgdGhhdCB3YXMgc3RhcnRlZCBmb3IgdGhlIHB1cnBvc2Ugb2YgbGltYm8gcmVzb2x1dGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYWEgPSBuZXcgTWFwLCB0aGlzLmNhID0gbmV3IElvLCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNvbXBsZXRpb24gaGFuZGxlcnMsIGluZGV4ZWQgYnkgVXNlciBhbmQgQmF0Y2hJZC4gKi9cbiAgICAgICAgdGhpcy5oYSA9IHt9LCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNhbGxiYWNrcyB3YWl0aW5nIGZvciBhbGwgcGVuZGluZyB3cml0ZXMgdG8gYmUgYWNrbm93bGVkZ2VkLiAqL1xuICAgICAgICB0aGlzLmxhID0gbmV3IE1hcCwgdGhpcy5mYSA9IGJyLnluKCksIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBVbmtub3duICovICwgXG4gICAgICAgIC8vIFRoZSBwcmltYXJ5IHN0YXRlIGlzIHNldCB0byBgdHJ1ZWAgb3IgYGZhbHNlYCBpbW1lZGlhdGVseSBhZnRlciBGaXJlc3RvcmVcbiAgICAgICAgLy8gc3RhcnR1cC4gSW4gdGhlIGludGVyaW0sIGEgY2xpZW50IHNob3VsZCBvbmx5IGJlIGNvbnNpZGVyZWQgcHJpbWFyeSBpZlxuICAgICAgICAvLyBgaXNQcmltYXJ5YCBpcyB0cnVlLlxuICAgICAgICB0aGlzLmRhID0gdm9pZCAwO1xuICAgIH1cbiAgICBnZXQgaXNQcmltYXJ5Q2xpZW50KCkge1xuICAgICAgICByZXR1cm4gITAgPT09IHRoaXMuZGE7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYXRlcyB0aGUgbmV3IGxpc3RlbiwgcmVzb2x2ZXMgcHJvbWlzZSB3aGVuIGxpc3RlbiBlbnF1ZXVlZCB0byB0aGVcbiAqIHNlcnZlci4gQWxsIHRoZSBzdWJzZXF1ZW50IHZpZXcgc25hcHNob3RzIG9yIGVycm9ycyBhcmUgc2VudCB0byB0aGVcbiAqIHN1YnNjcmliZWQgaGFuZGxlcnMuIFJldHVybnMgdGhlIGluaXRpYWwgc25hcHNob3QuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIFl1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gUGEodCk7XG4gICAgbGV0IHMsIGk7XG4gICAgY29uc3QgciA9IG4uaWEuZ2V0KGUpO1xuICAgIGlmIChyKSBcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdpdGggTXVsdGktVGFiIFdlYiwgaXQgaXMgcG9zc2libGUgdGhhdCBhIHF1ZXJ5IHZpZXdcbiAgICAvLyBhbHJlYWR5IGV4aXN0cyB3aGVuIEV2ZW50TWFuYWdlciBjYWxscyB1cyBmb3IgdGhlIGZpcnN0IHRpbWUuIFRoaXNcbiAgICAvLyBoYXBwZW5zIHdoZW4gdGhlIHByaW1hcnkgdGFiIGlzIGFscmVhZHkgbGlzdGVuaW5nIHRvIHRoaXMgcXVlcnkgb25cbiAgICAvLyBiZWhhbGYgb2YgYW5vdGhlciB0YWIgYW5kIHRoZSB1c2VyIG9mIHRoZSBwcmltYXJ5IGFsc28gc3RhcnRzIGxpc3RlbmluZ1xuICAgIC8vIHRvIHRoZSBxdWVyeS4gRXZlbnRNYW5hZ2VyIHdpbGwgbm90IGhhdmUgYW4gYXNzaWduZWQgdGFyZ2V0IElEIGluIHRoaXNcbiAgICAvLyBjYXNlIGFuZCBjYWxscyBgbGlzdGVuYCB0byBvYnRhaW4gdGhpcyBJRC5cbiAgICBzID0gci50YXJnZXRJZCwgbi5zaGFyZWRDbGllbnRTdGF0ZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0KHMpLCBpID0gci52aWV3LmVhKCk7IGVsc2Uge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgY28obi5sb2NhbFN0b3JlLCBIZShlKSk7XG4gICAgICAgIG4uaXNQcmltYXJ5Q2xpZW50ICYmIG51KG4ucmVtb3RlU3RvcmUsIHQpO1xuICAgICAgICBjb25zdCByID0gbi5zaGFyZWRDbGllbnRTdGF0ZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQudGFyZ2V0SWQpO1xuICAgICAgICBzID0gdC50YXJnZXRJZCwgaSA9IGF3YWl0IFh1KG4sIGUsIHMsIFwiY3VycmVudFwiID09PSByKTtcbiAgICB9XG4gICAgcmV0dXJuIGk7XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgdmlldyBmb3IgYSBwcmV2aW91c2x5IHVua25vd24gcXVlcnkgYW5kIGNvbXB1dGVzIGl0cyBpbml0aWFsXG4gKiBzbmFwc2hvdC5cbiAqLyBhc3luYyBmdW5jdGlvbiBYdSh0LCBlLCBuLCBzKSB7XG4gICAgLy8gUE9SVElORyBOT1RFOiBPbiBXZWIgb25seSwgd2UgaW5qZWN0IHRoZSBjb2RlIHRoYXQgcmVnaXN0ZXJzIG5ldyBMaW1ib1xuICAgIC8vIHRhcmdldHMgYmFzZWQgb24gdmlldyBjaGFuZ2VzLiBUaGlzIGFsbG93cyB1cyB0byBvbmx5IGRlcGVuZCBvbiBMaW1ib1xuICAgIC8vIGNoYW5nZXMgd2hlbiB1c2VyIGNvZGUgaW5jbHVkZXMgcXVlcmllcy5cbiAgICB0Ll9hID0gKGUsIG4sIHMpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgbGV0IGkgPSBlLnZpZXcuV3Uobik7XG4gICAgICAgIGkuaWkgJiYgKFxuICAgICAgICAvLyBUaGUgcXVlcnkgaGFzIGEgbGltaXQgYW5kIHNvbWUgZG9jcyB3ZXJlIHJlbW92ZWQsIHNvIHdlIG5lZWRcbiAgICAgICAgLy8gdG8gcmUtcnVuIHRoZSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSB0byBtYWtlIHN1cmUgd2VcbiAgICAgICAgLy8gZGlkbid0IGxvc2UgYW55IGdvb2QgZG9jcyB0aGF0IGhhZCBiZWVuIHBhc3QgdGhlIGxpbWl0LlxuICAgICAgICBpID0gYXdhaXQgbG8odC5sb2NhbFN0b3JlLCBlLnF1ZXJ5LCBcbiAgICAgICAgLyogdXNlUHJldmlvdXNSZXN1bHRzPSAqLyAhMSkudGhlbigoKHtkb2N1bWVudHM6IHR9KSA9PiBlLnZpZXcuV3UodCwgaSkpKSk7XG4gICAgICAgIGNvbnN0IHIgPSBzICYmIHMudGFyZ2V0Q2hhbmdlcy5nZXQoZS50YXJnZXRJZCksIG8gPSBlLnZpZXcuYXBwbHlDaGFuZ2VzKGksIFxuICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gdC5pc1ByaW1hcnlDbGllbnQsIHIpO1xuICAgICAgICByZXR1cm4gbGEodCwgZS50YXJnZXRJZCwgby5YdSksIG8uc25hcHNob3Q7XG4gICAgfSh0LCBlLCBuLCBzKTtcbiAgICBjb25zdCBpID0gYXdhaXQgbG8odC5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgciA9IG5ldyBXdShlLCBpLl9pKSwgbyA9IHIuV3UoaS5kb2N1bWVudHMpLCB1ID0gZXMuY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKG4sIHMgJiYgXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyAhPT0gdC5vbmxpbmVTdGF0ZSksIGEgPSByLmFwcGx5Q2hhbmdlcyhvLCBcbiAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gdC5pc1ByaW1hcnlDbGllbnQsIHUpO1xuICAgIGxhKHQsIG4sIGEuWHUpO1xuICAgIGNvbnN0IGMgPSBuZXcgenUoZSwgbiwgcik7XG4gICAgcmV0dXJuIHQuaWEuc2V0KGUsIGMpLCB0LnJhLmhhcyhuKSA/IHQucmEuZ2V0KG4pLnB1c2goZSkgOiB0LnJhLnNldChuLCBbIGUgXSksIGEuc25hcHNob3Q7XG59XG5cbi8qKiBTdG9wcyBsaXN0ZW5pbmcgdG8gdGhlIHF1ZXJ5LiAqLyBhc3luYyBmdW5jdGlvbiBadSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCksIHMgPSBuLmlhLmdldChlKSwgaSA9IG4ucmEuZ2V0KHMudGFyZ2V0SWQpO1xuICAgIGlmIChpLmxlbmd0aCA+IDEpIHJldHVybiBuLnJhLnNldChzLnRhcmdldElkLCBpLmZpbHRlcigodCA9PiAhWWUodCwgZSkpKSksIHZvaWQgbi5pYS5kZWxldGUoZSk7XG4gICAgLy8gTm8gb3RoZXIgcXVlcmllcyBhcmUgbWFwcGVkIHRvIHRoZSB0YXJnZXQsIGNsZWFuIHVwIHRoZSBxdWVyeSBhbmQgdGhlIHRhcmdldC5cbiAgICAgICAgaWYgKG4uaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gcmVtb3ZlIHRoZSBsb2NhbCBxdWVyeSB0YXJnZXQgZmlyc3QgdG8gYWxsb3cgdXMgdG8gdmVyaWZ5XG4gICAgICAgIC8vIHdoZXRoZXIgYW55IG90aGVyIGNsaWVudCBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0LlxuICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQocy50YXJnZXRJZCk7XG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaXNBY3RpdmVRdWVyeVRhcmdldChzLnRhcmdldElkKSB8fCBhd2FpdCBobyhuLmxvY2FsU3RvcmUsIHMudGFyZ2V0SWQsIFxuICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICExKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLmNsZWFyUXVlcnlTdGF0ZShzLnRhcmdldElkKSwgc3Uobi5yZW1vdGVTdG9yZSwgcy50YXJnZXRJZCksIFxuICAgICAgICAgICAgY2Eobiwgcy50YXJnZXRJZCk7XG4gICAgICAgIH0pKS5jYXRjaChEcik7XG4gICAgfSBlbHNlIGNhKG4sIHMudGFyZ2V0SWQpLCBhd2FpdCBobyhuLmxvY2FsU3RvcmUsIHMudGFyZ2V0SWQsIFxuICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITApO1xufVxuXG4vKipcbiAqIEluaXRpYXRlcyB0aGUgd3JpdGUgb2YgbG9jYWwgbXV0YXRpb24gYmF0Y2ggd2hpY2ggaW52b2x2ZXMgYWRkaW5nIHRoZVxuICogd3JpdGVzIHRvIHRoZSBtdXRhdGlvbiBxdWV1ZSwgbm90aWZ5aW5nIHRoZSByZW1vdGUgc3RvcmUgYWJvdXQgbmV3XG4gKiBtdXRhdGlvbnMgYW5kIHJhaXNpbmcgZXZlbnRzIGZvciBhbnkgY2hhbmdlcyB0aGlzIHdyaXRlIGNhdXNlZC5cbiAqXG4gKiBUaGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGlzIGNhbGwgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgYWJvdmUgc3RlcHNcbiAqIGhhdmUgY29tcGxldGVkLCAqbm90KiB3aGVuIHRoZSB3cml0ZSB3YXMgYWNrZWQgYnkgdGhlIGJhY2tlbmQuIFRoZVxuICogdXNlckNhbGxiYWNrIGlzIHJlc29sdmVkIG9uY2UgdGhlIHdyaXRlIHdhcyBhY2tlZC9yZWplY3RlZCBieSB0aGVcbiAqIGJhY2tlbmQgKG9yIGZhaWxlZCBsb2NhbGx5IGZvciBhbnkgb3RoZXIgcmVhc29uKS5cbiAqLyBhc3luYyBmdW5jdGlvbiB0YSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFZhKHQpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gSyh0KSwgcyA9IGF0Lm5vdygpLCBpID0gZS5yZWR1Y2UoKCh0LCBlKSA9PiB0LmFkZChlLmtleSkpLCBZbigpKTtcbiAgICAgICAgICAgIGxldCByO1xuICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb2NhbGx5IHdyaXRlIG11dGF0aW9uc1wiLCBcInJlYWR3cml0ZVwiLCAodCA9PiBuLmZpLktzKHQsIGkpLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgICAgIHIgPSBpO1xuICAgICAgICAgICAgICAgIC8vIEZvciBub24taWRlbXBvdGVudCBtdXRhdGlvbnMgKHN1Y2ggYXMgYEZpZWxkVmFsdWUuaW5jcmVtZW50KClgKSxcbiAgICAgICAgICAgICAgICAvLyB3ZSByZWNvcmQgdGhlIGJhc2Ugc3RhdGUgaW4gYSBzZXBhcmF0ZSBwYXRjaCBtdXRhdGlvbi4gVGhpcyBpc1xuICAgICAgICAgICAgICAgIC8vIGxhdGVyIHVzZWQgdG8gZ3VhcmFudGVlIGNvbnNpc3RlbnQgdmFsdWVzIGFuZCBwcmV2ZW50cyBmbGlja2VyXG4gICAgICAgICAgICAgICAgLy8gZXZlbiBpZiB0aGUgYmFja2VuZCBzZW5kcyB1cyBhbiB1cGRhdGUgdGhhdCBhbHJlYWR5IGluY2x1ZGVzIG91clxuICAgICAgICAgICAgICAgIC8vIHRyYW5zZm9ybS5cbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHZuKHQsIHIuZ2V0KHQua2V5KSk7XG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT0gZSAmJiBcbiAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogVGhlIGJhc2Ugc3RhdGUgc2hvdWxkIG9ubHkgYmUgYXBwbGllZCBpZiB0aGVyZSdzIHNvbWVcbiAgICAgICAgICAgICAgICAgICAgLy8gZXhpc3RpbmcgZG9jdW1lbnQgdG8gb3ZlcnJpZGUsIHNvIHVzZSBhIFByZWNvbmRpdGlvbiBvZlxuICAgICAgICAgICAgICAgICAgICAvLyBleGlzdHM9dHJ1ZVxuICAgICAgICAgICAgICAgICAgICBvLnB1c2gobmV3IHhuKHQua2V5LCBlLCBlZShlLnZhbHVlLm1hcFZhbHVlKSwgQW4uZXhpc3RzKCEwKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbi5Ccy5hZGRNdXRhdGlvbkJhdGNoKHQsIHMsIG8sIGUpO1xuICAgICAgICAgICAgfSkpKSkudGhlbigodCA9PiAodC5hcHBseVRvTG9jYWxEb2N1bWVudFNldChyKSwge1xuICAgICAgICAgICAgICAgIGJhdGNoSWQ6IHQuYmF0Y2hJZCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiByXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KHMubG9jYWxTdG9yZSwgZSk7XG4gICAgICAgIHMuc2hhcmVkQ2xpZW50U3RhdGUuYWRkUGVuZGluZ011dGF0aW9uKHQuYmF0Y2hJZCksIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgIGxldCBzID0gdC5oYVt0LmN1cnJlbnRVc2VyLnRvS2V5KCldO1xuICAgICAgICAgICAgcyB8fCAocyA9IG5ldyBmZShydCkpO1xuICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KGUsIG4pLCB0LmhhW3QuY3VycmVudFVzZXIudG9LZXkoKV0gPSBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVzb2x2ZXMgb3IgcmVqZWN0cyB0aGUgdXNlciBjYWxsYmFjayBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCB0aGVuIGRpc2NhcmRzXG4gKiBpdC5cbiAqLyAocywgdC5iYXRjaElkLCBuKSwgYXdhaXQgX2EocywgdC5jaGFuZ2VzKSwgYXdhaXQgd3Uocy5yZW1vdGVTdG9yZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICAvLyBJZiB3ZSBjYW4ndCBwZXJzaXN0IHRoZSBtdXRhdGlvbiwgd2UgcmVqZWN0IHRoZSB1c2VyIGNhbGxiYWNrIGFuZFxuICAgICAgICAvLyBkb24ndCBzZW5kIHRoZSBtdXRhdGlvbi4gVGhlIHVzZXIgY2FuIHRoZW4gcmV0cnkgdGhlIHdyaXRlLlxuICAgICAgICBjb25zdCBlID0gU3UodCwgXCJGYWlsZWQgdG8gcGVyc2lzdCB3cml0ZVwiKTtcbiAgICAgICAgbi5yZWplY3QoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgb25lIHJlbW90ZSBldmVudCB0byB0aGUgc3luYyBlbmdpbmUsIG5vdGlmeWluZyBhbnkgdmlld3Mgb2YgdGhlXG4gKiBjaGFuZ2VzLCBhbmQgcmVsZWFzaW5nIGFueSBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMgdGhhdCB3b3VsZCBiZWNvbWVcbiAqIHZpc2libGUgYmVjYXVzZSBvZiB0aGUgc25hcHNob3QgdmVyc2lvbiB0aGUgcmVtb3RlIGV2ZW50IGNvbnRhaW5zLlxuICovIGFzeW5jIGZ1bmN0aW9uIGVhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgb28obi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVXBkYXRlIGByZWNlaXZlZERvY3VtZW50YCBhcyBhcHByb3ByaWF0ZSBmb3IgYW55IGxpbWJvIHRhcmdldHMuXG4gICAgICAgICAgICAgICAgZS50YXJnZXRDaGFuZ2VzLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5hYS5nZXQoZSk7XG4gICAgICAgICAgICBzICYmIChcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgYSBsaW1ibyByZXNvbHV0aW9uIGxvb2t1cCwgaXQncyBmb3IgYSBzaW5nbGUgZG9jdW1lbnRcbiAgICAgICAgICAgIC8vIGFuZCBpdCBjb3VsZCBiZSBhZGRlZCwgbW9kaWZpZWQsIG9yIHJlbW92ZWQsIGJ1dCBub3QgYSBjb21iaW5hdGlvbi5cbiAgICAgICAgICAgIFUodC5hZGRlZERvY3VtZW50cy5zaXplICsgdC5tb2RpZmllZERvY3VtZW50cy5zaXplICsgdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPD0gMSksIFxuICAgICAgICAgICAgdC5hZGRlZERvY3VtZW50cy5zaXplID4gMCA/IHMubmEgPSAhMCA6IHQubW9kaWZpZWREb2N1bWVudHMuc2l6ZSA+IDAgPyBVKHMubmEpIDogdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwICYmIChVKHMubmEpLCBcbiAgICAgICAgICAgIHMubmEgPSAhMSkpO1xuICAgICAgICB9KSksIGF3YWl0IF9hKG4sIHQsIGUpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgRHIodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSBzeW5jIGVuZ2luZSBhbmQgbm90aWZpZXMgYW55IHZpZXdzIG9mXG4gKiB0aGUgY2hhbmdlLlxuICovIGZ1bmN0aW9uIG5hKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gSyh0KTtcbiAgICAvLyBJZiB3ZSBhcmUgdGhlIHNlY29uZGFyeSBjbGllbnQsIHdlIGV4cGxpY2l0bHkgaWdub3JlIHRoZSByZW1vdGUgc3RvcmUnc1xuICAgIC8vIG9ubGluZSBzdGF0ZSAodGhlIGxvY2FsIGNsaWVudCBtYXkgZ28gb2ZmbGluZSwgZXZlbiB0aG91Z2ggdGhlIHByaW1hcnlcbiAgICAvLyB0YWIgcmVtYWlucyBvbmxpbmUpIGFuZCBvbmx5IGFwcGx5IHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZSBmcm9tXG4gICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXG4gICAgICAgIGlmIChzLmlzUHJpbWFyeUNsaWVudCAmJiAwIC8qIFJlbW90ZVN0b3JlICovID09PSBuIHx8ICFzLmlzUHJpbWFyeUNsaWVudCAmJiAxIC8qIFNoYXJlZENsaWVudFN0YXRlICovID09PSBuKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcy5pYS5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHMudmlldy5QdShlKTtcbiAgICAgICAgICAgIGkuc25hcHNob3QgJiYgdC5wdXNoKGkuc25hcHNob3QpO1xuICAgICAgICB9KSksIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBLKHQpO1xuICAgICAgICAgICAgbi5vbmxpbmVTdGF0ZSA9IGU7XG4gICAgICAgICAgICBsZXQgcyA9ICExO1xuICAgICAgICAgICAgbi5xdWVyaWVzLmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4ubGlzdGVuZXJzKSBcbiAgICAgICAgICAgICAgICAvLyBSdW4gZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyBpZiBhIGNvbnNpc3RlbnQgc25hcHNob3QgaGFzIGJlZW4gZW1pdHRlZC5cbiAgICAgICAgICAgICAgICB0LlB1KGUpICYmIChzID0gITApO1xuICAgICAgICAgICAgfSkpLCBzICYmIEJ1KG4pO1xuICAgICAgICB9KHMuZXZlbnRNYW5hZ2VyLCBlKSwgdC5sZW5ndGggJiYgcy5zYS56byh0KSwgcy5vbmxpbmVTdGF0ZSA9IGUsIHMuaXNQcmltYXJ5Q2xpZW50ICYmIHMuc2hhcmVkQ2xpZW50U3RhdGUuc2V0T25saW5lU3RhdGUoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlamVjdHMgdGhlIGxpc3RlbiBmb3IgdGhlIGdpdmVuIHRhcmdldElELiBUaGlzIGNhbiBiZSB0cmlnZ2VyZWQgYnkgdGhlXG4gKiBiYWNrZW5kIGZvciBhbnkgYWN0aXZlIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0gc3luY0VuZ2luZSAtIFRoZSBzeW5jIGVuZ2luZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB0YXJnZXRJZCAtIFRoZSB0YXJnZXRJRCBjb3JyZXNwb25kcyB0byBvbmUgcHJldmlvdXNseSBpbml0aWF0ZWQgYnkgdGhlXG4gKiB1c2VyIGFzIHBhcnQgb2YgVGFyZ2V0RGF0YSBwYXNzZWQgdG8gbGlzdGVuKCkgb24gUmVtb3RlU3RvcmUuXG4gKiBAcGFyYW0gZXJyIC0gQSBkZXNjcmlwdGlvbiBvZiB0aGUgY29uZGl0aW9uIHRoYXQgaGFzIGZvcmNlZCB0aGUgcmVqZWN0aW9uLlxuICogTmVhcmx5IGFsd2F5cyB0aGlzIHdpbGwgYmUgYW4gaW5kaWNhdGlvbiB0aGF0IHRoZSB1c2VyIGlzIG5vIGxvbmdlclxuICogYXV0aG9yaXplZCB0byBzZWUgdGhlIGRhdGEgbWF0Y2hpbmcgdGhlIHRhcmdldC5cbiAqLyBhc3luYyBmdW5jdGlvbiBzYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEsodCk7XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbik7XG4gICAgY29uc3QgaSA9IHMuYWEuZ2V0KGUpLCByID0gaSAmJiBpLmtleTtcbiAgICBpZiAocikge1xuICAgICAgICAvLyBUT0RPKGtsaW10KTogV2UgcmVhbGx5IG9ubHkgc2hvdWxkIGRvIHRoZSBmb2xsb3dpbmcgb24gcGVybWlzc2lvblxuICAgICAgICAvLyBkZW5pZWQgZXJyb3JzLCBidXQgd2UgZG9uJ3QgaGF2ZSB0aGUgY2F1c2UgY29kZSBoZXJlLlxuICAgICAgICAvLyBJdCdzIGEgbGltYm8gZG9jLiBDcmVhdGUgYSBzeW50aGV0aWMgZXZlbnQgc2F5aW5nIGl0IHdhcyBkZWxldGVkLlxuICAgICAgICAvLyBUaGlzIGlzIGtpbmQgb2YgYSBoYWNrLiBJZGVhbGx5LCB3ZSB3b3VsZCBoYXZlIGEgbWV0aG9kIGluIHRoZSBsb2NhbFxuICAgICAgICAvLyBzdG9yZSB0byBwdXJnZSBhIGRvY3VtZW50LiBIb3dldmVyLCBpdCB3b3VsZCBiZSB0cmlja3kgdG8ga2VlcCBhbGwgb2ZcbiAgICAgICAgLy8gdGhlIGxvY2FsIHN0b3JlJ3MgaW52YXJpYW50cyB3aXRoIGFub3RoZXIgbWV0aG9kLlxuICAgICAgICBsZXQgdCA9IG5ldyBmZSh4dC5jb21wYXJhdG9yKTtcbiAgICAgICAgLy8gVE9ETyhiLzIxNzE4OTIxNik6IFRoaXMgbGltYm8gZG9jdW1lbnQgc2hvdWxkIGlkZWFsbHkgaGF2ZSBhIHJlYWQgdGltZSxcbiAgICAgICAgLy8gc28gdGhhdCBpdCBpcyBwaWNrZWQgdXAgYnkgYW55IHJlYWQtdGltZSBiYXNlZCBzY2Fucy4gVGhlIGJhY2tlbmQsXG4gICAgICAgIC8vIGhvd2V2ZXIsIGRvZXMgbm90IHNlbmQgYSByZWFkIHRpbWUgZm9yIHRhcmdldCByZW1vdmFscy5cbiAgICAgICAgICAgICAgICB0ID0gdC5pbnNlcnQociwgbmUubmV3Tm9Eb2N1bWVudChyLCBjdC5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gWW4oKS5hZGQociksIGkgPSBuZXcgdHMoY3QubWluKCksIFxuICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyBuZXcgTWFwLCBcbiAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IHdlKHJ0KSwgdCwgbik7XG4gICAgICAgIGF3YWl0IGVhKHMsIGkpLCBcbiAgICAgICAgLy8gU2luY2UgdGhpcyBxdWVyeSBmYWlsZWQsIHdlIHdvbid0IHdhbnQgdG8gbWFudWFsbHkgdW5saXN0ZW4gdG8gaXQuXG4gICAgICAgIC8vIFdlIG9ubHkgcmVtb3ZlIGl0IGZyb20gYm9va2tlZXBpbmcgYWZ0ZXIgd2Ugc3VjY2Vzc2Z1bGx5IGFwcGxpZWQgdGhlXG4gICAgICAgIC8vIFJlbW90ZUV2ZW50LiBJZiBgYXBwbHlSZW1vdGVFdmVudCgpYCB0aHJvd3MsIHdlIHdhbnQgdG8gcmUtbGlzdGVuIHRvXG4gICAgICAgIC8vIHRoaXMgcXVlcnkgd2hlbiB0aGUgUmVtb3RlU3RvcmUgcmVzdGFydHMgdGhlIFdhdGNoIHN0cmVhbSwgd2hpY2ggc2hvdWxkXG4gICAgICAgIC8vIHJlLXRyaWdnZXIgdGhlIHRhcmdldCBmYWlsdXJlLlxuICAgICAgICBzLnVhID0gcy51YS5yZW1vdmUociksIHMuYWEuZGVsZXRlKGUpLCBkYShzKTtcbiAgICB9IGVsc2UgYXdhaXQgaG8ocy5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4gY2EocywgZSwgbikpKS5jYXRjaChEcik7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGlhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KSwgcyA9IGUuYmF0Y2guYmF0Y2hJZDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgaW8obi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHRcbiAgICAgICAgLy8gdXApLCBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlblxuICAgICAgICAvLyBiZWZvcmUgbGlzdGVuIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBhYShuLCBzLCAvKmVycm9yPSovIG51bGwpLCB1YShuLCBzKSwgbi5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKHMsIFwiYWNrbm93bGVkZ2VkXCIpLCBcbiAgICAgICAgYXdhaXQgX2EobiwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBEcih0KTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gSyh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IEsodCk7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlamVjdCBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcztcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5Ccy5sb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpLm5leHQoKGUgPT4gKFUobnVsbCAhPT0gZSksIHMgPSBlLmtleXMoKSwgbi5Ccy5yZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpKSkpLm5leHQoKCgpID0+IG4uQnMucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLmZpLktzKHQsIHMpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXJnZXN0IChsYXRlc3QpIGJhdGNoIGlkIGluIG11dGF0aW9uIHF1ZXVlIHRoYXQgaXMgcGVuZGluZ1xuICogc2VydmVyIHJlc3BvbnNlLlxuICpcbiAqIFJldHVybnMgYEJBVENISURfVU5LTk9XTmAgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICovIChzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIGFhKHMsIGUsIG4pLCB1YShzLCBlKSwgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbiksIFxuICAgICAgICBhd2FpdCBfYShzLCB0KTtcbiAgICB9IGNhdGNoIChuKSB7XG4gICAgICAgIGF3YWl0IERyKG4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB1c2VyIGNhbGxiYWNrIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgcGVuZGluZyBtdXRhdGlvbnMgYXQgdGhlIG1vbWVudCBvZiBjYWxsaW5nXG4gKiBhcmUgYWNrbm93bGVkZ2VkIC5cbiAqLyBhc3luYyBmdW5jdGlvbiBvYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCk7XG4gICAgYXUobi5yZW1vdGVTdG9yZSkgfHwgTyhcIlN5bmNFbmdpbmVcIiwgXCJUaGUgbmV0d29yayBpcyBkaXNhYmxlZC4gVGhlIHRhc2sgcmV0dXJuZWQgYnkgJ2F3YWl0UGVuZGluZ1dyaXRlcygpJyB3aWxsIG5vdCBjb21wbGV0ZSB1bnRpbCB0aGUgbmV0d29yayBpcyBlbmFibGVkLlwiKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IEsodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBoaWdoZXN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGlkXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5Ccy5nZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKHQpKSk7XG4gICAgICAgIH0obi5sb2NhbFN0b3JlKTtcbiAgICAgICAgaWYgKC0xID09PSB0KSBcbiAgICAgICAgLy8gVHJpZ2dlciB0aGUgY2FsbGJhY2sgcmlnaHQgYXdheSBpZiB0aGVyZSBpcyBubyBwZW5kaW5nIHdyaXRlcyBhdCB0aGUgbW9tZW50LlxuICAgICAgICByZXR1cm4gdm9pZCBlLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IG4ubGEuZ2V0KHQpIHx8IFtdO1xuICAgICAgICBzLnB1c2goZSksIG4ubGEuc2V0KHQsIHMpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgY29uc3QgbiA9IFN1KHQsIFwiSW5pdGlhbGl6YXRpb24gb2Ygd2FpdEZvclBlbmRpbmdXcml0ZXMoKSBvcGVyYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICBlLnJlamVjdChuKTtcbiAgICB9XG59XG5cbi8qKlxuICogVHJpZ2dlcnMgdGhlIGNhbGxiYWNrcyB0aGF0IGFyZSB3YWl0aW5nIGZvciB0aGlzIGJhdGNoIGlkIHRvIGdldCBhY2tub3dsZWRnZWQgYnkgc2VydmVyLFxuICogaWYgdGhlcmUgYXJlIGFueS5cbiAqLyBmdW5jdGlvbiB1YSh0LCBlKSB7XG4gICAgKHQubGEuZ2V0KGUpIHx8IFtdKS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgdC5yZXNvbHZlKCk7XG4gICAgfSkpLCB0LmxhLmRlbGV0ZShlKTtcbn1cblxuLyoqIFJlamVjdCBhbGwgb3V0c3RhbmRpbmcgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHRvIGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBhYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEsodCk7XG4gICAgbGV0IGkgPSBzLmhhW3MuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgLy8gTk9URTogTXV0YXRpb25zIHJlc3RvcmVkIGZyb20gcGVyc2lzdGVuY2Ugd29uJ3QgaGF2ZSBjYWxsYmFja3MsIHNvIGl0J3NcbiAgICAvLyBva2F5IGZvciB0aGVyZSB0byBiZSBubyBjYWxsYmFjayBmb3IgdGhpcyBJRC5cbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgY29uc3QgdCA9IGkuZ2V0KGUpO1xuICAgICAgICB0ICYmIChuID8gdC5yZWplY3QobikgOiB0LnJlc29sdmUoKSwgaSA9IGkucmVtb3ZlKGUpKSwgcy5oYVtzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gaTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNhKHQsIGUsIG4gPSBudWxsKSB7XG4gICAgdC5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KGUpO1xuICAgIGZvciAoY29uc3QgcyBvZiB0LnJhLmdldChlKSkgdC5pYS5kZWxldGUocyksIG4gJiYgdC5zYS53YShzLCBuKTtcbiAgICBpZiAodC5yYS5kZWxldGUoZSksIHQuaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIHQuY2EudmkoZSkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0LmNhLmNvbnRhaW5zS2V5KGUpIHx8IFxuICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XG4gICAgICAgICAgICBoYSh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaGEodCwgZSkge1xuICAgIHQub2EuZGVsZXRlKGUucGF0aC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHRoZSB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuIEluIHRoYXQgY2FzZSxcbiAgICAvLyB0aGUga2V5IHdvbid0IGV4aXN0IGluIGBsaW1ib1RhcmdldHNCeUtleWAuIE9ubHkgZG8gdGhlIGNsZWFudXAgaWYgd2Ugc3RpbGwgaGF2ZSB0aGUgdGFyZ2V0LlxuICAgIGNvbnN0IG4gPSB0LnVhLmdldChlKTtcbiAgICBudWxsICE9PSBuICYmIChzdSh0LnJlbW90ZVN0b3JlLCBuKSwgdC51YSA9IHQudWEucmVtb3ZlKGUpLCB0LmFhLmRlbGV0ZShuKSwgZGEodCkpO1xufVxuXG5mdW5jdGlvbiBsYSh0LCBlLCBuKSB7XG4gICAgZm9yIChjb25zdCBzIG9mIG4pIGlmIChzIGluc3RhbmNlb2YgUXUpIHQuY2EuYWRkUmVmZXJlbmNlKHMua2V5LCBlKSwgZmEodCwgcyk7IGVsc2UgaWYgKHMgaW5zdGFuY2VvZiBqdSkge1xuICAgICAgICBPKFwiU3luY0VuZ2luZVwiLCBcIkRvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogXCIgKyBzLmtleSksIHQuY2EucmVtb3ZlUmVmZXJlbmNlKHMua2V5LCBlKTtcbiAgICAgICAgdC5jYS5jb250YWluc0tleShzLmtleSkgfHwgXG4gICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxuICAgICAgICBoYSh0LCBzLmtleSk7XG4gICAgfSBlbHNlIEwoKTtcbn1cblxuZnVuY3Rpb24gZmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IG4ucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB0LnVhLmdldChuKSB8fCB0Lm9hLmhhcyhzKSB8fCAoTyhcIlN5bmNFbmdpbmVcIiwgXCJOZXcgZG9jdW1lbnQgaW4gbGltYm86IFwiICsgbiksIHQub2EuYWRkKHMpLCBcbiAgICBkYSh0KSk7XG59XG5cbi8qKlxuICogU3RhcnRzIGxpc3RlbnMgZm9yIGRvY3VtZW50cyBpbiBsaW1ibyB0aGF0IGFyZSBlbnF1ZXVlZCBmb3IgcmVzb2x1dGlvbixcbiAqIHN1YmplY3QgdG8gYSBtYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLlxuICpcbiAqIFdpdGhvdXQgYm91bmRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLCB0aGUgc2VydmVyIGNhbiBmYWlsXG4gKiB3aXRoIFwicmVzb3VyY2UgZXhoYXVzdGVkXCIgZXJyb3JzIHdoaWNoIGNhbiBsZWFkIHRvIHBhdGhvbG9naWNhbCBjbGllbnRcbiAqIGJlaGF2aW9yIGFzIHNlZW4gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMjY4My5cbiAqLyBmdW5jdGlvbiBkYSh0KSB7XG4gICAgZm9yICg7dC5vYS5zaXplID4gMCAmJiB0LnVhLnNpemUgPCB0Lm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOyApIHtcbiAgICAgICAgY29uc3QgZSA9IHQub2EudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuICAgICAgICB0Lm9hLmRlbGV0ZShlKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyB4dChfdC5mcm9tU3RyaW5nKGUpKSwgcyA9IHQuZmEubmV4dCgpO1xuICAgICAgICB0LmFhLnNldChzLCBuZXcgSHUobikpLCB0LnVhID0gdC51YS5pbnNlcnQobiwgcyksIG51KHQucmVtb3RlU3RvcmUsIG5ldyBOaShIZShLZShuLnBhdGgpKSwgcywgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gLCBudC5BKSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBfYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEsodCksIGkgPSBbXSwgciA9IFtdLCBvID0gW107XG4gICAgcy5pYS5pc0VtcHR5KCkgfHwgKHMuaWEuZm9yRWFjaCgoKHQsIHUpID0+IHtcbiAgICAgICAgby5wdXNoKHMuX2EodSwgZSwgbikudGhlbigodCA9PiB7XG4gICAgICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgICAgIHMuaXNQcmltYXJ5Q2xpZW50ICYmIHMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlUXVlcnlTdGF0ZSh1LnRhcmdldElkLCB0LmZyb21DYWNoZSA/IFwibm90LWN1cnJlbnRcIiA6IFwiY3VycmVudFwiKSwgXG4gICAgICAgICAgICAgICAgaS5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBaci5Zcyh1LnRhcmdldElkLCB0KTtcbiAgICAgICAgICAgICAgICByLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSk7XG4gICAgfSkpLCBhd2FpdCBQcm9taXNlLmFsbChvKSwgcy5zYS56byhpKSwgYXdhaXQgYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSyh0KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJub3RpZnlMb2NhbFZpZXdDaGFuZ2VzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHlpLmZvckVhY2goZSwgKGUgPT4geWkuZm9yRWFjaChlLkhzLCAocyA9PiBuLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLmFkZFJlZmVyZW5jZSh0LCBlLnRhcmdldElkLCBzKSkpLm5leHQoKCgpID0+IHlpLmZvckVhY2goZS5KcywgKHMgPT4gbi5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodCwgZS50YXJnZXRJZCwgcykpKSkpKSkpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgaWYgKCFBaSh0KSkgdGhyb3cgdDtcbiAgICAgICAgICAgIC8vIElmIGBub3RpZnlMb2NhbFZpZXdDaGFuZ2VzYCBmYWlscywgd2UgZGlkIG5vdCBhZHZhbmNlIHRoZSBzZXF1ZW5jZVxuICAgICAgICAgICAgLy8gbnVtYmVyIGZvciB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBpbmNsdWRlZCBpbiB0aGlzIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBtaWdodCB0cmlnZ2VyIHRoZW0gdG8gYmUgZGVsZXRlZCBlYXJsaWVyIHRoYW4gdGhleSBvdGhlcndpc2VcbiAgICAgICAgICAgIC8vIHdvdWxkIGhhdmUsIGJ1dCBpdCBzaG91bGQgbm90IGludmFsaWRhdGUgdGhlIGludGVncml0eSBvZiB0aGUgZGF0YS5cbiAgICAgICAgICAgIE8oXCJMb2NhbFN0b3JlXCIsIFwiRmFpbGVkIHRvIHVwZGF0ZSBzZXF1ZW5jZSBudW1iZXJzOiBcIiArIHQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRJZDtcbiAgICAgICAgICAgIGlmICghdC5mcm9tQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi51aS5nZXQoZSksIHMgPSB0LnNuYXBzaG90VmVyc2lvbiwgaSA9IHQud2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24ocyk7XG4gICAgICAgICAgICAgICAgLy8gQWR2YW5jZSB0aGUgbGFzdCBsaW1ibyBmcmVlIHNuYXBzaG90IHZlcnNpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi51aSA9IG4udWkuaW5zZXJ0KGUsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfShzLmxvY2FsU3RvcmUsIHIpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gd2EodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpO1xuICAgIGlmICghbi5jdXJyZW50VXNlci5pc0VxdWFsKGUpKSB7XG4gICAgICAgIE8oXCJTeW5jRW5naW5lXCIsIFwiVXNlciBjaGFuZ2UuIE5ldyB1c2VyOlwiLCBlLnRvS2V5KCkpO1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgc28obi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgbi5jdXJyZW50VXNlciA9IGUsIFxuICAgICAgICAvLyBGYWlscyB0YXNrcyB3YWl0aW5nIGZvciBwZW5kaW5nIHdyaXRlcyByZXF1ZXN0ZWQgYnkgcHJldmlvdXMgdXNlci5cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgdC5sYS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0LnJlamVjdChuZXcgUShHLkNBTkNFTExFRCwgZSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKSwgdC5sYS5jbGVhcigpO1xuICAgICAgICB9KG4sIFwiJ3dhaXRGb3JQZW5kaW5nV3JpdGVzJyBwcm9taXNlIGlzIHJlamVjdGVkIGR1ZSB0byBhIHVzZXIgY2hhbmdlLlwiKSwgXG4gICAgICAgIC8vIFRPRE8oYi8xMTQyMjY0MTcpOiBDb25zaWRlciBjYWxsaW5nIHRoaXMgb25seSBpbiB0aGUgcHJpbWFyeSB0YWIuXG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaGFuZGxlVXNlckNoYW5nZShlLCB0LnJlbW92ZWRCYXRjaElkcywgdC5hZGRlZEJhdGNoSWRzKSwgYXdhaXQgX2EobiwgdC5kaSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBtYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEsodCksIHMgPSBuLmFhLmdldChlKTtcbiAgICBpZiAocyAmJiBzLm5hKSByZXR1cm4gWW4oKS5hZGQocy5rZXkpO1xuICAgIHtcbiAgICAgICAgbGV0IHQgPSBZbigpO1xuICAgICAgICBjb25zdCBzID0gbi5yYS5nZXQoZSk7XG4gICAgICAgIGlmICghcykgcmV0dXJuIHQ7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBzKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5pYS5nZXQoZSk7XG4gICAgICAgICAgICB0ID0gdC51bmlvbldpdGgocy52aWV3Lmp1KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG59XG5cbi8qKlxuICogUmVjb25jaWxlIHRoZSBsaXN0IG9mIHN5bmNlZCBkb2N1bWVudHMgaW4gYW4gZXhpc3RpbmcgdmlldyB3aXRoIHRob3NlXG4gKiBmcm9tIHBlcnNpc3RlbmNlLlxuICovIGFzeW5jIGZ1bmN0aW9uIGdhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KSwgcyA9IGF3YWl0IGxvKG4ubG9jYWxTdG9yZSwgZS5xdWVyeSwgXG4gICAgLyogdXNlUHJldmlvdXNSZXN1bHRzPSAqLyAhMCksIGkgPSBlLnZpZXcudGEocyk7XG4gICAgcmV0dXJuIG4uaXNQcmltYXJ5Q2xpZW50ICYmIGxhKG4sIGUudGFyZ2V0SWQsIGkuWHUpLCBpO1xufVxuXG4vKipcbiAqIFJldHJpZXZlcyBuZXdseSBjaGFuZ2VkIGRvY3VtZW50cyBmcm9tIHJlbW90ZSBkb2N1bWVudCBjYWNoZSBhbmQgcmFpc2VzXG4gKiBzbmFwc2hvdHMgaWYgbmVlZGVkLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24geWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBLKHQpO1xuICAgIHJldHVybiBfbyhuLmxvY2FsU3RvcmUsIGUpLnRoZW4oKHQgPT4gX2EobiwgdCkpKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBtdXRhdGlvbiBzdGF0ZSB0byBhbiBleGlzdGluZyBiYXRjaC4gICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gcGEodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSBLKHQpLCByID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSyh0KSwgcyA9IEsobi5Ccyk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiTG9va3VwIG11dGF0aW9uIGRvY3VtZW50c1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IHMuZm4odCwgZSkubmV4dCgoZSA9PiBlID8gbi5maS5Lcyh0LCBlKSA6IHlpLnJlc29sdmUobnVsbCkpKSkpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgIChpLmxvY2FsU3RvcmUsIGUpO1xuICAgIG51bGwgIT09IHIgPyAoXCJwZW5kaW5nXCIgPT09IG4gPyBcbiAgICAvLyBJZiB3ZSBhcmUgdGhlIHByaW1hcnkgY2xpZW50LCB3ZSBuZWVkIHRvIHNlbmQgdGhpcyB3cml0ZSB0byB0aGVcbiAgICAvLyBiYWNrZW5kLiBTZWNvbmRhcnkgY2xpZW50cyB3aWxsIGlnbm9yZSB0aGVzZSB3cml0ZXMgc2luY2UgdGhlaXIgcmVtb3RlXG4gICAgLy8gY29ubmVjdGlvbiBpcyBkaXNhYmxlZC5cbiAgICBhd2FpdCB3dShpLnJlbW90ZVN0b3JlKSA6IFwiYWNrbm93bGVkZ2VkXCIgPT09IG4gfHwgXCJyZWplY3RlZFwiID09PSBuID8gKFxuICAgIC8vIE5PVEU6IEJvdGggdGhlc2UgbWV0aG9kcyBhcmUgbm8tb3BzIGZvciBiYXRjaGVzIHRoYXQgb3JpZ2luYXRlZCBmcm9tXG4gICAgLy8gb3RoZXIgY2xpZW50cy5cbiAgICBhYShpLCBlLCBzIHx8IG51bGwpLCB1YShpLCBlKSwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBLKEsodCkuQnMpLl9uKGUpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgIChpLmxvY2FsU3RvcmUsIGUpKSA6IEwoKSwgYXdhaXQgX2EoaSwgcikpIDogXG4gICAgLy8gQSB0aHJvdHRsZWQgdGFiIG1heSBub3QgaGF2ZSBzZWVuIHRoZSBtdXRhdGlvbiBiZWZvcmUgaXQgd2FzIGNvbXBsZXRlZFxuICAgIC8vIGFuZCByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLCBpbiB3aGljaCBjYXNlIHdlIHdvbid0IGhhdmUgY2FjaGVkXG4gICAgLy8gdGhlIGFmZmVjdGVkIGRvY3VtZW50cy4gSW4gdGhpcyBjYXNlIHdlIGNhbiBzYWZlbHkgaWdub3JlIHRoZSB1cGRhdGVcbiAgICAvLyBzaW5jZSB0aGF0IG1lYW5zIHdlIGRpZG4ndCBhcHBseSB0aGUgbXV0YXRpb24gbG9jYWxseSBhdCBhbGwgKGlmIHdlXG4gICAgLy8gaGFkLCB3ZSB3b3VsZCBoYXZlIGNhY2hlZCB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzKSwgYW5kIHNvIHdlIHdpbGwganVzdFxuICAgIC8vIHNlZSBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMgdmlhIG5vcm1hbCByZW1vdGUgZG9jdW1lbnQgdXBkYXRlc1xuICAgIC8vIGFzIGFwcGxpY2FibGUuXG4gICAgTyhcIlN5bmNFbmdpbmVcIiwgXCJDYW5ub3QgYXBwbHkgbXV0YXRpb24gYmF0Y2ggd2l0aCBpZDogXCIgKyBlKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBxdWVyeSB0YXJnZXQgY2hhbmdlIGZyb20gYSBkaWZmZXJlbnQgdGFiLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIElhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gSyh0KTtcbiAgICBpZiAoUGEobiksIFZhKG4pLCAhMCA9PT0gZSAmJiAhMCAhPT0gbi5kYSkge1xuICAgICAgICAvLyBTZWNvbmRhcnkgdGFicyBvbmx5IG1haW50YWluIFZpZXdzIGZvciB0aGVpciBsb2NhbCBsaXN0ZW5lcnMgYW5kIHRoZVxuICAgICAgICAvLyBWaWV3cyBpbnRlcm5hbCBzdGF0ZSBtYXkgbm90IGJlIDEwMCUgcG9wdWxhdGVkIChpbiBwYXJ0aWN1bGFyXG4gICAgICAgIC8vIHNlY29uZGFyeSB0YWJzIGRvbid0IHRyYWNrIHN5bmNlZERvY3VtZW50cywgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhlXG4gICAgICAgIC8vIHNlcnZlciBjb25zaWRlcnMgdG8gYmUgaW4gdGhlIHRhcmdldCkuIFNvIHdoZW4gYSBzZWNvbmRhcnkgYmVjb21lc1xuICAgICAgICAvLyBwcmltYXJ5LCB3ZSBuZWVkIHRvIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYWxsIHZpZXdzIGZvciBhbGwgdGFyZ2V0c1xuICAgICAgICAvLyBtYXRjaCB0aGUgc3RhdGUgb24gZGlzay5cbiAgICAgICAgY29uc3QgdCA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCksIGUgPSBhd2FpdCBUYShuLCB0LnRvQXJyYXkoKSk7XG4gICAgICAgIG4uZGEgPSAhMCwgYXdhaXQgYnUobi5yZW1vdGVTdG9yZSwgITApO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkgbnUobi5yZW1vdGVTdG9yZSwgdCk7XG4gICAgfSBlbHNlIGlmICghMSA9PT0gZSAmJiAhMSAhPT0gbi5kYSkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIGxldCBlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIG4ucmEuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaXNMb2NhbFF1ZXJ5VGFyZ2V0KGkpID8gdC5wdXNoKGkpIDogZSA9IGUudGhlbigoKCkgPT4gKGNhKG4sIGkpLCBcbiAgICAgICAgICAgIGhvKG4ubG9jYWxTdG9yZSwgaSwgXG4gICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICEwKSkpKSwgc3Uobi5yZW1vdGVTdG9yZSwgaSk7XG4gICAgICAgIH0pKSwgYXdhaXQgZSwgYXdhaXQgVGEobiwgdCksIFxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gSyh0KTtcbiAgICAgICAgICAgIGUuYWEuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBzdShlLnJlbW90ZVN0b3JlLCBuKTtcbiAgICAgICAgICAgIH0pKSwgZS5jYS5TaSgpLCBlLmFhID0gbmV3IE1hcCwgZS51YSA9IG5ldyBmZSh4dC5jb21wYXJhdG9yKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJlY29uY2lsZSB0aGUgcXVlcnkgdmlld3Mgb2YgdGhlIHByb3ZpZGVkIHF1ZXJ5IHRhcmdldHMgd2l0aCB0aGUgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuIFJhaXNlcyBzbmFwc2hvdHMgZm9yIGFueSBjaGFuZ2VzIHRoYXQgYWZmZWN0IHRoZSBsb2NhbFxuICogY2xpZW50IGFuZCByZXR1cm5zIHRoZSB1cGRhdGVkIHN0YXRlIG9mIGFsbCB0YXJnZXQncyBxdWVyeSBkYXRhLlxuICpcbiAqIEBwYXJhbSBzeW5jRW5naW5lIC0gVGhlIHN5bmMgZW5naW5lIGltcGxlbWVudGF0aW9uXG4gKiBAcGFyYW0gdGFyZ2V0cyAtIHRoZSBsaXN0IG9mIHRhcmdldHMgd2l0aCB2aWV3cyB0aGF0IG5lZWQgdG8gYmUgcmVjb21wdXRlZFxuICogQHBhcmFtIHRyYW5zaXRpb25Ub1ByaW1hcnkgLSBgdHJ1ZWAgaWZmIHRoZSB0YWIgdHJhbnNpdGlvbnMgZnJvbSBhIHNlY29uZGFyeVxuICogdGFiIHRvIGEgcHJpbWFyeSB0YWJcbiAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICAobiksIG4uZGEgPSAhMSwgYXdhaXQgYnUobi5yZW1vdGVTdG9yZSwgITEpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gVGEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBLKHQpLCBpID0gW10sIHIgPSBbXTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICBsZXQgZTtcbiAgICAgICAgY29uc3QgbiA9IHMucmEuZ2V0KHQpO1xuICAgICAgICBpZiAobiAmJiAwICE9PSBuLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBoYXZlIGEgbG9jYWwgVmlldywgd2UgZmV0Y2ggdGhlaXIgY3VycmVudCBzdGF0ZVxuICAgICAgICAgICAgLy8gZnJvbSBMb2NhbFN0b3JlIChhcyB0aGUgcmVzdW1lIHRva2VuIGFuZCB0aGUgc25hcHNob3QgdmVyc2lvblxuICAgICAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkKSBhbmQgcmVjb25jaWxlIHRoZWlyIHZpZXdzIHdpdGggdGhlIHBlcnNpc3RlZFxuICAgICAgICAgICAgLy8gc3RhdGUgKHRoZSBsaXN0IG9mIHN5bmNlZERvY3VtZW50cyBtYXkgaGF2ZSBnb3R0ZW4gb3V0IG9mIHN5bmMpLlxuICAgICAgICAgICAgZSA9IGF3YWl0IGNvKHMubG9jYWxTdG9yZSwgSGUoblswXSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gcy5pYS5nZXQodCksIG4gPSBhd2FpdCBnYShzLCBlKTtcbiAgICAgICAgICAgICAgICBuLnNuYXBzaG90ICYmIHIucHVzaChuLnNuYXBzaG90KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZvciBxdWVyaWVzIHRoYXQgbmV2ZXIgZXhlY3V0ZWQgb24gdGhpcyBjbGllbnQsIHdlIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIGFsbG9jYXRlIHRoZSB0YXJnZXQgaW4gTG9jYWxTdG9yZSBhbmQgaW5pdGlhbGl6ZSBhIG5ldyBWaWV3LlxuICAgICAgICAgICAgY29uc3QgbiA9IGF3YWl0IGZvKHMubG9jYWxTdG9yZSwgdCk7XG4gICAgICAgICAgICBlID0gYXdhaXQgY28ocy5sb2NhbFN0b3JlLCBuKSwgYXdhaXQgWHUocywgRWEobiksIHQsIFxuICAgICAgICAgICAgLypjdXJyZW50PSovICExKTtcbiAgICAgICAgfVxuICAgICAgICBpLnB1c2goZSk7XG4gICAgfVxuICAgIHJldHVybiBzLnNhLnpvKHIpLCBpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBgUXVlcnlgIG9iamVjdCBmcm9tIHRoZSBzcGVjaWZpZWQgYFRhcmdldGAuIFRoZXJlIGlzIG5vIHdheSB0b1xuICogb2J0YWluIHRoZSBvcmlnaW5hbCBgUXVlcnlgLCBzbyB3ZSBzeW50aGVzaXplIGEgYFF1ZXJ5YCBmcm9tIHRoZSBgVGFyZ2V0YFxuICogb2JqZWN0LlxuICpcbiAqIFRoZSBzeW50aGVzaXplZCByZXN1bHQgbWlnaHQgYmUgZGlmZmVyZW50IGZyb20gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIGJ1dFxuICogc2luY2UgdGhlIHN5bnRoZXNpemVkIGBRdWVyeWAgc2hvdWxkIHJldHVybiB0aGUgc2FtZSByZXN1bHRzIGFzIHRoZVxuICogb3JpZ2luYWwgb25lIChvbmx5IHRoZSBwcmVzZW50YXRpb24gb2YgcmVzdWx0cyBtaWdodCBkaWZmZXIpLCB0aGUgcG90ZW50aWFsXG4gKiBkaWZmZXJlbmNlIHdpbGwgbm90IGNhdXNlIGlzc3Vlcy5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIEVhKHQpIHtcbiAgICByZXR1cm4gcWUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5vcmRlckJ5LCB0LmZpbHRlcnMsIHQubGltaXQsIFwiRlwiIC8qIEZpcnN0ICovICwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbn1cblxuLyoqIFJldHVybnMgdGhlIElEcyBvZiB0aGUgY2xpZW50cyB0aGF0IGFyZSBjdXJyZW50bHkgYWN0aXZlLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIEFhKHQpIHtcbiAgICBjb25zdCBlID0gSyh0KTtcbiAgICByZXR1cm4gSyhLKGUubG9jYWxTdG9yZSkucGVyc2lzdGVuY2UpLkZzKCk7XG59XG5cbi8qKiBBcHBsaWVzIGEgcXVlcnkgdGFyZ2V0IGNoYW5nZSBmcm9tIGEgZGlmZmVyZW50IHRhYi4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBSYSh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IEsodCk7XG4gICAgaWYgKGkuZGEpIFxuICAgIC8vIElmIHdlIHJlY2VpdmUgYSB0YXJnZXQgc3RhdGUgbm90aWZpY2F0aW9uIHZpYSBXZWJTdG9yYWdlLCB3ZSBhcmVcbiAgICAvLyBlaXRoZXIgYWxyZWFkeSBzZWNvbmRhcnkgb3IgYW5vdGhlciB0YWIgaGFzIHRha2VuIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgIHJldHVybiB2b2lkIE8oXCJTeW5jRW5naW5lXCIsIFwiSWdub3JpbmcgdW5leHBlY3RlZCBxdWVyeSBzdGF0ZSBub3RpZmljYXRpb24uXCIpO1xuICAgIGNvbnN0IHIgPSBpLnJhLmdldChlKTtcbiAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHN3aXRjaCAobikge1xuICAgICAgY2FzZSBcImN1cnJlbnRcIjpcbiAgICAgIGNhc2UgXCJub3QtY3VycmVudFwiOlxuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgX28oaS5sb2NhbFN0b3JlLCBlbihyWzBdKSksIHMgPSB0cy5jcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZShlLCBcImN1cnJlbnRcIiA9PT0gbik7XG4gICAgICAgICAgICBhd2FpdCBfYShpLCB0LCBzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgIGNhc2UgXCJyZWplY3RlZFwiOlxuICAgICAgICBhd2FpdCBobyhpLmxvY2FsU3RvcmUsIGUsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMCksIGNhKGksIGUsIHMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgTCgpO1xuICAgIH1cbn1cblxuLyoqIEFkZHMgb3IgcmVtb3ZlcyBXYXRjaCB0YXJnZXRzIGZvciBxdWVyaWVzIGZyb20gZGlmZmVyZW50IHRhYnMuICovIGFzeW5jIGZ1bmN0aW9uIGJhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gUGEodCk7XG4gICAgaWYgKHMuZGEpIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGlmIChzLnJhLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgIC8vIEEgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiBhZGRlZCBpbiBhIHByZXZpb3VzIGF0dGVtcHRcbiAgICAgICAgICAgICAgICBPKFwiU3luY0VuZ2luZVwiLCBcIkFkZGluZyBhbiBhbHJlYWR5IGFjdGl2ZSB0YXJnZXQgXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGUgPSBhd2FpdCBmbyhzLmxvY2FsU3RvcmUsIHQpLCBuID0gYXdhaXQgY28ocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgICAgIGF3YWl0IFh1KHMsIEVhKGUpLCBuLnRhcmdldElkLCBcbiAgICAgICAgICAgIC8qY3VycmVudD0qLyAhMSksIG51KHMucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSBcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzIHN0aWxsIGFjdGl2ZSBzaW5jZSB0aGUgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlblxuICAgICAgICAvLyByZW1vdmVkIGlmIGl0IGhhcyBiZWVuIHJlamVjdGVkIGJ5IHRoZSBiYWNrZW5kLlxuICAgICAgICBzLnJhLmhhcyh0KSAmJiBcbiAgICAgICAgLy8gUmVsZWFzZSBxdWVyaWVzIHRoYXQgYXJlIHN0aWxsIGFjdGl2ZS5cbiAgICAgICAgYXdhaXQgaG8ocy5sb2NhbFN0b3JlLCB0LCBcbiAgICAgICAgLyoga2VlcFBlcnNpc3RlZFRhcmdldERhdGEgKi8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHN1KHMucmVtb3RlU3RvcmUsIHQpLCBjYShzLCB0KTtcbiAgICAgICAgfSkpLmNhdGNoKERyKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFBhKHQpIHtcbiAgICBjb25zdCBlID0gSyh0KTtcbiAgICByZXR1cm4gZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudCA9IGVhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBtYS5iaW5kKG51bGwsIGUpLCBcbiAgICBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4gPSBzYS5iaW5kKG51bGwsIGUpLCBlLnNhLnpvID0gRnUuYmluZChudWxsLCBlLmV2ZW50TWFuYWdlciksIFxuICAgIGUuc2Eud2EgPSAkdS5iaW5kKG51bGwsIGUuZXZlbnRNYW5hZ2VyKSwgZTtcbn1cblxuZnVuY3Rpb24gVmEodCkge1xuICAgIGNvbnN0IGUgPSBLKHQpO1xuICAgIHJldHVybiBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZSA9IGlhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlID0gcmEuYmluZChudWxsLCBlKSwgXG4gICAgZTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgU0RLLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgYnVuZGxlIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBTeW5jRW5naW5lIHRvIHVzZS5cbiAqIEBwYXJhbSBidW5kbGVSZWFkZXIgLSBCdW5kbGUgdG8gbG9hZCBpbnRvIHRoZSBTREsuXG4gKiBAcGFyYW0gdGFzayAtIExvYWRCdW5kbGVUYXNrIHVzZWQgdG8gdXBkYXRlIHRoZSBsb2FkaW5nIHByb2dyZXNzIHRvIHB1YmxpYyBBUEkuXG4gKi8gZnVuY3Rpb24gdmEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBLKHQpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgKFxuICAgIC8qKiBMb2FkcyBhIGJ1bmRsZSBhbmQgcmV0dXJucyB0aGUgbGlzdCBvZiBhZmZlY3RlZCBjb2xsZWN0aW9uIGdyb3Vwcy4gKi9cbiAgICBhc3luYyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzID0gYXdhaXQgZS5nZXRNZXRhZGF0YSgpO1xuICAgICAgICAgICAgaWYgKGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gSyh0KSwgcyA9IHdzKGUuY3JlYXRlVGltZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJoYXNOZXdlckJ1bmRsZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IG4uX3MuZ2V0QnVuZGxlTWV0YWRhdGEodCwgZS5pZCkpKS50aGVuKCh0ID0+ICEhdCAmJiB0LmNyZWF0ZVRpbWUuY29tcGFyZVRvKHMpID49IDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogU2F2ZXMgdGhlIGdpdmVuIGBCdW5kbGVNZXRhZGF0YWAgdG8gbG9jYWwgcGVyc2lzdGVuY2UuXG4gKi8gKHQubG9jYWxTdG9yZSwgcykpIHJldHVybiBhd2FpdCBlLmNsb3NlKCksIG4uX2NvbXBsZXRlV2l0aChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdGFza1N0YXRlOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiB0LnRvdGFsRG9jdW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICBieXRlc0xvYWRlZDogdC50b3RhbEJ5dGVzLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbERvY3VtZW50czogdC50b3RhbERvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxCeXRlczogdC50b3RhbEJ5dGVzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0ocykpLCBQcm9taXNlLnJlc29sdmUobmV3IFNldCk7XG4gICAgICAgICAgICBuLl91cGRhdGVQcm9ncmVzcyhHdShzKSk7XG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IEt1KHMsIHQubG9jYWxTdG9yZSwgZS5NKTtcbiAgICAgICAgICAgIGxldCByID0gYXdhaXQgZS5tYSgpO1xuICAgICAgICAgICAgZm9yICg7cjsgKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IGkuRnUocik7XG4gICAgICAgICAgICAgICAgdCAmJiBuLl91cGRhdGVQcm9ncmVzcyh0KSwgciA9IGF3YWl0IGUubWEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG8gPSBhd2FpdCBpLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgX2EodCwgby5MdSwgXG4gICAgICAgICAgICAvKiByZW1vdGVFdmVudCAqLyB2b2lkIDApLCBcbiAgICAgICAgICAgIC8vIFNhdmUgbWV0YWRhdGEsIHNvIGxvYWRpbmcgdGhlIHNhbWUgYnVuZGxlIHdpbGwgc2tpcC5cbiAgICAgICAgICAgIGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gSyh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlNhdmUgYnVuZGxlXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IG4uX3Muc2F2ZUJ1bmRsZU1ldGFkYXRhKHQsIGUpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIFJldHVybnMgYSBwcm9taXNlIG9mIGEgYE5hbWVkUXVlcnlgIGFzc29jaWF0ZWQgd2l0aCBnaXZlbiBxdWVyeSBuYW1lLiBQcm9taXNlXG4gKiByZXNvbHZlcyB0byB1bmRlZmluZWQgaWYgbm8gcGVyc2lzdGVkIGRhdGEgY2FuIGJlIGZvdW5kLlxuICovICh0LmxvY2FsU3RvcmUsIHMpLCBuLl9jb21wbGV0ZVdpdGgoby5wcm9ncmVzcyksIFByb21pc2UucmVzb2x2ZShvLkJ1KTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgcmV0dXJuICQoXCJTeW5jRW5naW5lXCIsIGBMb2FkaW5nIGJ1bmRsZSBmYWlsZWQgd2l0aCAke3R9YCksIG4uX2ZhaWxXaXRoKHQpLCBQcm9taXNlLnJlc29sdmUobmV3IFNldCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxuICogVXNlcyBFYWdlckdDIGdhcmJhZ2UgY29sbGVjdGlvbi5cbiAqLykocywgZSwgbikudGhlbigodCA9PiB7XG4gICAgICAgIHMuc2hhcmVkQ2xpZW50U3RhdGUubm90aWZ5QnVuZGxlTG9hZGVkKHQpO1xuICAgIH0pKTtcbn1cblxuY2xhc3MgU2Ege1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN5bmNocm9uaXplVGFicyA9ICExO1xuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplKHQpIHtcbiAgICAgICAgdGhpcy5NID0gam8odC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSB0aGlzLmdhKHQpLCB0aGlzLnBlcnNpc3RlbmNlID0gdGhpcy55YSh0KSwgXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uuc3RhcnQoKSwgdGhpcy5nY1NjaGVkdWxlciA9IHRoaXMucGEodCksIHRoaXMubG9jYWxTdG9yZSA9IHRoaXMuSWEodCk7XG4gICAgfVxuICAgIHBhKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIElhKHQpIHtcbiAgICAgICAgcmV0dXJuIG5vKHRoaXMucGVyc2lzdGVuY2UsIG5ldyB0bywgdC5pbml0aWFsVXNlciwgdGhpcy5NKTtcbiAgICB9XG4gICAgeWEodCkge1xuICAgICAgICByZXR1cm4gbmV3IFBvKHZvLllpLCB0aGlzLk0pO1xuICAgIH1cbiAgICBnYSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgJG87XG4gICAgfVxuICAgIGFzeW5jIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgdGhpcy5nY1NjaGVkdWxlciAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zaHV0ZG93bigpLCBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zaHV0ZG93bigpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBEYSBleHRlbmRzIFNhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuVGEgPSB0LCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZSwgdGhpcy5mb3JjZU93bmVyc2hpcCA9IG4sIHRoaXMuc3luY2hyb25pemVUYWJzID0gITE7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpLCBhd2FpdCB0aGlzLlRhLmluaXRpYWxpemUodGhpcywgdCksIFxuICAgICAgICAvLyBFbnF1ZXVlIHdyaXRlcyBmcm9tIGEgcHJldmlvdXMgc2Vzc2lvblxuICAgICAgICBhd2FpdCBWYSh0aGlzLlRhLnN5bmNFbmdpbmUpLCBhd2FpdCB3dSh0aGlzLlRhLnJlbW90ZVN0b3JlKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2UuVHMoKCgpID0+ICh0aGlzLmdjU2NoZWR1bGVyICYmICF0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0ZWQgJiYgdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgfVxuICAgIElhKHQpIHtcbiAgICAgICAgcmV0dXJuIG5vKHRoaXMucGVyc2lzdGVuY2UsIG5ldyB0bywgdC5pbml0aWFsVXNlciwgdGhpcy5NKTtcbiAgICB9XG4gICAgcGEodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5nYXJiYWdlQ29sbGVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IE5yKGUsIHQuYXN5bmNRdWV1ZSk7XG4gICAgfVxuICAgIHlhKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFlyKHQuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHQuZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5KSwgbiA9IHZvaWQgMCAhPT0gdGhpcy5jYWNoZVNpemVCeXRlcyA/IGdyLndpdGhDYWNoZVNpemUodGhpcy5jYWNoZVNpemVCeXRlcykgOiBnci5ERUZBVUxUO1xuICAgICAgICByZXR1cm4gbmV3IHpyKHRoaXMuc3luY2hyb25pemVUYWJzLCBlLCB0LmNsaWVudElkLCBuLCB0LmFzeW5jUXVldWUsIEdvKCksIFFvKCksIHRoaXMuTSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgISF0aGlzLmZvcmNlT3duZXJzaGlwKTtcbiAgICB9XG4gICAgZ2EodCkge1xuICAgICAgICByZXR1cm4gbmV3ICRvO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIG11bHRpLXRhYiBJbmRleGVkREJcbiAqIHBlcnNpc3RlbmNlLlxuICpcbiAqIEluIHRoZSBsZWdhY3kgY2xpZW50LCB0aGlzIHByb3ZpZGVyIGlzIHVzZWQgdG8gcHJvdmlkZSBib3RoIG11bHRpLXRhYiBhbmRcbiAqIG5vbi1tdWx0aS10YWIgcGVyc2lzdGVuY2Ugc2luY2Ugd2UgY2Fubm90IHRlbGwgYXQgYnVpbGQgdGltZSB3aGV0aGVyXG4gKiBgc3luY2hyb25pemVUYWJzYCB3aWxsIGJlIGVuYWJsZWQuXG4gKi8gY2xhc3MgQ2EgZXh0ZW5kcyBEYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlLCAvKiBmb3JjZU93bmVyc2hpcD0gKi8gITEpLCB0aGlzLlRhID0gdCwgdGhpcy5jYWNoZVNpemVCeXRlcyA9IGUsIHRoaXMuc3luY2hyb25pemVUYWJzID0gITA7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5UYS5zeW5jRW5naW5lO1xuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlIGluc3RhbmNlb2YgRm8gJiYgKHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3luY0VuZ2luZSA9IHtcbiAgICAgICAgICAgICRyOiBwYS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgQnI6IFJhLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBMcjogYmEuYmluZChudWxsLCBlKSxcbiAgICAgICAgICAgIEZzOiBBYS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgRnI6IHlhLmJpbmQobnVsbCwgZSlcbiAgICAgICAgfSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zdGFydCgpKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2UuVHMoKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgYXdhaXQgSWEodGhpcy5UYS5zeW5jRW5naW5lLCB0KSwgdGhpcy5nY1NjaGVkdWxlciAmJiAodCAmJiAhdGhpcy5nY1NjaGVkdWxlci5zdGFydGVkID8gdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpIDogdCB8fCB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2EodCkge1xuICAgICAgICBjb25zdCBlID0gR28oKTtcbiAgICAgICAgaWYgKCFGby52dChlKSkgdGhyb3cgbmV3IFEoRy5VTklNUExFTUVOVEVELCBcIkluZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS5cIik7XG4gICAgICAgIGNvbnN0IG4gPSBZcih0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB0LmRhdGFiYXNlSW5mby5wZXJzaXN0ZW5jZUtleSk7XG4gICAgICAgIHJldHVybiBuZXcgRm8oZSwgdC5hc3luY1F1ZXVlLCBuLCB0LmNsaWVudElkLCB0LmluaXRpYWxVc2VyKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYW5kIHdpcmVzIHRoZSBjb21wb25lbnRzIHRoYXQgYXJlIG5lZWRlZCB0byBpbnRlcmZhY2Ugd2l0aCB0aGVcbiAqIG5ldHdvcmsuXG4gKi8gY2xhc3MgeGEge1xuICAgIGFzeW5jIGluaXRpYWxpemUodCwgZSkge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgfHwgKHRoaXMubG9jYWxTdG9yZSA9IHQubG9jYWxTdG9yZSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHQuc2hhcmVkQ2xpZW50U3RhdGUsIFxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHRoaXMuY3JlYXRlRGF0YXN0b3JlKGUpLCB0aGlzLnJlbW90ZVN0b3JlID0gdGhpcy5jcmVhdGVSZW1vdGVTdG9yZShlKSwgXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gdGhpcy5jcmVhdGVFdmVudE1hbmFnZXIoZSksIHRoaXMuc3luY0VuZ2luZSA9IHRoaXMuY3JlYXRlU3luY0VuZ2luZShlLCBcbiAgICAgICAgLyogc3RhcnRBc1ByaW1hcnk9Ki8gIXQuc3luY2hyb25pemVUYWJzKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5vbmxpbmVTdGF0ZUhhbmRsZXIgPSB0ID0+IG5hKHRoaXMuc3luY0VuZ2luZSwgdCwgMSAvKiBTaGFyZWRDbGllbnRTdGF0ZSAqLyksIFxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gd2EuYmluZChudWxsLCB0aGlzLnN5bmNFbmdpbmUpLCBcbiAgICAgICAgYXdhaXQgYnUodGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zeW5jRW5naW5lLmlzUHJpbWFyeUNsaWVudCkpO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IGt1O1xuICAgIH1cbiAgICBjcmVhdGVEYXRhc3RvcmUodCkge1xuICAgICAgICBjb25zdCBlID0gam8odC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIG4gPSAocyA9IHQuZGF0YWJhc2VJbmZvLCBuZXcgS28ocykpO1xuICAgICAgICB2YXIgcztcbiAgICAgICAgLyoqIFJldHVybiB0aGUgUGxhdGZvcm0tc3BlY2lmaWMgY29ubmVjdGl2aXR5IG1vbml0b3IuICovICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBZbyh0LCBlLCBuLCBzKTtcbiAgICAgICAgfSh0LmF1dGhDcmVkZW50aWFscywgdC5hcHBDaGVja0NyZWRlbnRpYWxzLCBuLCBlKTtcbiAgICB9XG4gICAgY3JlYXRlUmVtb3RlU3RvcmUodCkge1xuICAgICAgICByZXR1cm4gZSA9IHRoaXMubG9jYWxTdG9yZSwgbiA9IHRoaXMuZGF0YXN0b3JlLCBzID0gdC5hc3luY1F1ZXVlLCBpID0gdCA9PiBuYSh0aGlzLnN5bmNFbmdpbmUsIHQsIDAgLyogUmVtb3RlU3RvcmUgKi8pLCBcbiAgICAgICAgciA9IExvLnZ0KCkgPyBuZXcgTG8gOiBuZXcgQm8sIG5ldyBabyhlLCBuLCBzLCBpLCByKTtcbiAgICAgICAgdmFyIGUsIG4sIHMsIGksIHI7XG4gICAgICAgIC8qKiBSZS1lbmFibGVzIHRoZSBuZXR3b3JrLiBJZGVtcG90ZW50LiAqLyAgICB9XG4gICAgY3JlYXRlU3luY0VuZ2luZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxuICAgICAgICBzLCBpLCByLCBvKSB7XG4gICAgICAgICAgICBjb25zdCB1ID0gbmV3IEp1KHQsIGUsIG4sIHMsIGksIHIpO1xuICAgICAgICAgICAgcmV0dXJuIG8gJiYgKHUuZGEgPSAhMCksIHU7XG4gICAgICAgIH0odGhpcy5sb2NhbFN0b3JlLCB0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLmV2ZW50TWFuYWdlciwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgdC5pbml0aWFsVXNlciwgdC5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucywgZSk7XG4gICAgfVxuICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBLKHQpO1xuICAgICAgICAgICAgTyhcIlJlbW90ZVN0b3JlXCIsIFwiUmVtb3RlU3RvcmUgc2h1dHRpbmcgZG93bi5cIiksIGUud3UuYWRkKDUgLyogU2h1dGRvd24gKi8pLCBhd2FpdCBldShlKSwgXG4gICAgICAgICAgICBlLmd1LnNodXRkb3duKCksIFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIChyYXRoZXIgdGhhbiBPZmZsaW5lKSB0byBhdm9pZCBwb3RlbnRpYWxseVxuICAgICAgICAgICAgLy8gdHJpZ2dlcmluZyBzcHVyaW91cyBsaXN0ZW5lciBldmVudHMgd2l0aCBjYWNoZWQgZGF0YSwgZXRjLlxuICAgICAgICAgICAgZS55dS5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyk7XG4gICAgICAgIH0odGhpcy5yZW1vdGVTdG9yZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIb3cgbWFueSBieXRlcyB0byByZWFkIGVhY2ggdGltZSB3aGVuIGBSZWFkYWJsZVN0cmVhbVJlYWRlci5yZWFkKClgIGlzXG4gKiBjYWxsZWQuIE9ubHkgYXBwbGljYWJsZSBmb3IgYnl0ZSBzdHJlYW1zIHRoYXQgd2UgY29udHJvbCAoZS5nLiB0aG9zZSBiYWNrZWRcbiAqIGJ5IGFuIFVJbnQ4QXJyYXkpLlxuICovXG4vKipcbiAqIEJ1aWxkcyBhIGBCeXRlU3RyZWFtUmVhZGVyYCBmcm9tIGEgVUludDhBcnJheS5cbiAqIEBwYXJhbSBzb3VyY2UgLSBUaGUgZGF0YSBzb3VyY2UgdG8gdXNlLlxuICogQHBhcmFtIGJ5dGVzUGVyUmVhZCAtIEhvdyBtYW55IGJ5dGVzIGVhY2ggYHJlYWQoKWAgZnJvbSB0aGUgcmV0dXJuZWQgcmVhZGVyXG4gKiAgICAgICAgd2lsbCByZWFkLlxuICovXG5mdW5jdGlvbiBOYSh0LCBlID0gMTAyNDApIHtcbiAgICBsZXQgbiA9IDA7XG4gICAgLy8gVGhlIFR5cGVTY3JpcHQgZGVmaW5pdGlvbiBmb3IgUmVhZGFibGVTdHJlYW1SZWFkZXIgY2hhbmdlZC4gV2UgdXNlXG4gICAgLy8gYGFueWAgaGVyZSB0byBhbGxvdyB0aGlzIGNvZGUgdG8gY29tcGlsZSB3aXRoIGRpZmZlcmVudCB2ZXJzaW9ucy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy80Mjk3MFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGFzeW5jIHJlYWQoKSB7XG4gICAgICAgICAgICBpZiAobiA8IHQuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnNsaWNlKG4sIG4gKyBlKSxcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogITFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBuICs9IGUsIHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjYW5jZWwoKSB7fSxcbiAgICAgICAgcmVsZWFzZUxvY2soKSB7fSxcbiAgICAgICAgY2xvc2VkOiBQcm9taXNlLnJlamVjdChcInVuaW1wbGVtZW50ZWRcIilcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBPbiB3ZWIsIGEgYFJlYWRhYmxlU3RyZWFtYCBpcyB3cmFwcGVkIGFyb3VuZCBieSBhIGBCeXRlU3RyZWFtUmVhZGVyYC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxuICovXG5jbGFzcyBrYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGVkID0gITE7XG4gICAgfVxuICAgIG5leHQodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm5leHQgJiYgdGhpcy5FYSh0aGlzLm9ic2VydmVyLm5leHQsIHQpO1xuICAgIH1cbiAgICBlcnJvcih0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIuZXJyb3IgPyB0aGlzLkVhKHRoaXMub2JzZXJ2ZXIuZXJyb3IsIHQpIDogY29uc29sZS5lcnJvcihcIlVuY2F1Z2h0IEVycm9yIGluIHNuYXBzaG90IGxpc3RlbmVyOlwiLCB0KTtcbiAgICB9XG4gICAgQWEoKSB7XG4gICAgICAgIHRoaXMubXV0ZWQgPSAhMDtcbiAgICB9XG4gICAgRWEodCwgZSkge1xuICAgICAgICB0aGlzLm11dGVkIHx8IHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubXV0ZWQgfHwgdChlKTtcbiAgICAgICAgfSksIDApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYSBidW5kbGUuXG4gKlxuICogVGFrZXMgYSBidW5kbGUgc3RyZWFtIG9yIGJ1ZmZlciwgYW5kIHByZXNlbnRzIGFic3RyYWN0aW9ucyB0byByZWFkIGJ1bmRsZWRcbiAqIGVsZW1lbnRzIG91dCBvZiB0aGUgdW5kZXJseWluZyBjb250ZW50LlxuICovIGNsYXNzIE1hIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHJlYWRlciB0byByZWFkIGZyb20gdW5kZXJseWluZyBiaW5hcnkgYnVuZGxlIGRhdGEgc291cmNlLiAqL1xuICAgIHQsIGUpIHtcbiAgICAgICAgdGhpcy5SYSA9IHQsIHRoaXMuTSA9IGUsIFxuICAgICAgICAvKiogQ2FjaGVkIGJ1bmRsZSBtZXRhZGF0YS4gKi9cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBqLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGJ1ZmZlciB0byBob2xkIGJ1bmRsZSBjb250ZW50LCBhY2N1bXVsYXRpbmcgaW5jb21wbGV0ZSBlbGVtZW50XG4gICAgICAgICAqIGNvbnRlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5LCB0aGlzLmJhID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIiksIFxuICAgICAgICAvLyBSZWFkIHRoZSBtZXRhZGF0YSAod2hpY2ggaXMgdGhlIGZpcnN0IGVsZW1lbnQpLlxuICAgICAgICB0aGlzLlBhKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0ICYmIHQuTXUoKSA/IHRoaXMubWV0YWRhdGEucmVzb2x2ZSh0LnBheWxvYWQubWV0YWRhdGEpIDogdGhpcy5tZXRhZGF0YS5yZWplY3QobmV3IEVycm9yKGBUaGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgYnVuZGxlIGlzIG5vdCBhIG1ldGFkYXRhLCBpdCBpc1xcbiAgICAgICAgICAgICAke0pTT04uc3RyaW5naWZ5KG51bGwgPT0gdCA/IHZvaWQgMCA6IHQucGF5bG9hZCl9YCkpO1xuICAgICAgICB9KSwgKHQgPT4gdGhpcy5tZXRhZGF0YS5yZWplY3QodCkpKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlJhLmNhbmNlbCgpO1xuICAgIH1cbiAgICBhc3luYyBnZXRNZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGEucHJvbWlzZTtcbiAgICB9XG4gICAgYXN5bmMgbWEoKSB7XG4gICAgICAgIC8vIE1ha2VzIHN1cmUgbWV0YWRhdGEgaXMgcmVhZCBiZWZvcmUgcHJvY2VlZGluZy5cbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TWV0YWRhdGEoKSwgdGhpcy5QYSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIHRoZSBoZWFkIG9mIGludGVybmFsIGJ1ZmZlciwgYW5kIHB1bGxpbmcgbW9yZSBkYXRhIGZyb21cbiAgICAgKiB1bmRlcmx5aW5nIHN0cmVhbSBpZiBhIGNvbXBsZXRlIGVsZW1lbnQgY2Fubm90IGJlIGZvdW5kLCB1bnRpbCBhblxuICAgICAqIGVsZW1lbnQoaW5jbHVkaW5nIHRoZSBwcmVmaXhlZCBsZW5ndGggYW5kIHRoZSBKU09OIHN0cmluZykgaXMgZm91bmQuXG4gICAgICpcbiAgICAgKiBPbmNlIGEgY29tcGxldGUgZWxlbWVudCBpcyByZWFkLCBpdCBpcyBkcm9wcGVkIGZyb20gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBlaXRoZXIgdGhlIGJ1bmRsZWQgZWxlbWVudCwgb3IgbnVsbCBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBvZlxuICAgICAqIHRoZSBzdHJlYW0uXG4gICAgICovICAgIGFzeW5jIFBhKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5WYSgpO1xuICAgICAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmJhLmRlY29kZSh0KSwgbiA9IE51bWJlcihlKTtcbiAgICAgICAgaXNOYU4obikgJiYgdGhpcy52YShgbGVuZ3RoIHN0cmluZyAoJHtlfSkgaXMgbm90IHZhbGlkIG51bWJlcmApO1xuICAgICAgICBjb25zdCBzID0gYXdhaXQgdGhpcy5TYShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBVdShKU09OLnBhcnNlKHMpLCB0Lmxlbmd0aCArIG4pO1xuICAgIH1cbiAgICAvKiogRmlyc3QgaW5kZXggb2YgJ3snIGZyb20gdGhlIHVuZGVybHlpbmcgYnVmZmVyLiAqLyAgICBEYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmZpbmRJbmRleCgodCA9PiB0ID09PSBcIntcIi5jaGFyQ29kZUF0KDApKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVyLCB1bnRpbCB0aGUgZmlyc3QgJ3snLCBhbmRcbiAgICAgKiByZXR1cm4gdGhlIGNvbnRlbnQuXG4gICAgICpcbiAgICAgKiBJZiByZWFjaGVkIGVuZCBvZiB0aGUgc3RyZWFtLCByZXR1cm5zIGEgbnVsbC5cbiAgICAgKi8gICAgYXN5bmMgVmEoKSB7XG4gICAgICAgIGZvciAoO3RoaXMuRGEoKSA8IDA7ICkge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMuQ2EoKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBhbmQgdGhlcmVcbiAgICAgICAgLy8gaGFwcGVucyB0byBiZSBubyBtb3JlIGRhdGEgdG8gcHJvY2Vzcy5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5idWZmZXIubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuRGEoKTtcbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBidXQgc3RpbGxcbiAgICAgICAgLy8gY2Fubm90IGZpbmQgYW4gb3BlbiBicmFja2V0LlxuICAgICAgICAgICAgICAgIHQgPCAwICYmIHRoaXMudmEoXCJSZWFjaGVkIHRoZSBlbmQgb2YgYnVuZGxlIHdoZW4gYSBsZW5ndGggc3RyaW5nIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuYnVmZmVyLnNsaWNlKDAsIHQpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGxlbmd0aC5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5zbGljZSh0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSBhIHNwZWNpZmllZCBwb3NpdGlvbiBmcm9tIHRoZSBpbnRlcm5hbCBidWZmZXIsIGZvciBhIHNwZWNpZmllZFxuICAgICAqIG51bWJlciBvZiBieXRlcywgcHVsbGluZyBtb3JlIGRhdGEgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0gaWYgbmVlZGVkLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBkZWNvZGVkIGZyb20gdGhlIHJlYWQgYnl0ZXMuXG4gICAgICovICAgIGFzeW5jIFNhKHQpIHtcbiAgICAgICAgZm9yICg7dGhpcy5idWZmZXIubGVuZ3RoIDwgdDsgKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLkNhKCkgJiYgdGhpcy52YShcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBtb3JlIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlID0gdGhpcy5iYS5kZWNvZGUodGhpcy5idWZmZXIuc2xpY2UoMCwgdCkpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGpzb24gc3RyaW5nLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKHQpLCBlO1xuICAgIH1cbiAgICB2YSh0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhyb3cgdGhpcy5SYS5jYW5jZWwoKSwgbmV3IEVycm9yKGBJbnZhbGlkIGJ1bmRsZSBmb3JtYXQ6ICR7dH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVsbHMgbW9yZSBkYXRhIGZyb20gdW5kZXJseWluZyBzdHJlYW0gdG8gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgc3RyZWFtIGlzIGZpbmlzaGVkLlxuICAgICAqLyAgICBhc3luYyBDYSgpIHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IHRoaXMuUmEucmVhZCgpO1xuICAgICAgICBpZiAoIXQuZG9uZSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyLmxlbmd0aCArIHQudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgICAgIGUuc2V0KHRoaXMuYnVmZmVyKSwgZS5zZXQodC52YWx1ZSwgdGhpcy5idWZmZXIubGVuZ3RoKSwgdGhpcy5idWZmZXIgPSBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0LmRvbmU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcm5hbCB0cmFuc2FjdGlvbiBvYmplY3QgcmVzcG9uc2libGUgZm9yIGFjY3VtdWxhdGluZyB0aGUgbXV0YXRpb25zIHRvXG4gKiBwZXJmb3JtIGFuZCB0aGUgYmFzZSB2ZXJzaW9ucyBmb3IgYW55IGRvY3VtZW50cyByZWFkLlxuICovXG5jbGFzcyBPYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHQsIFxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBvZiBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgZHVyaW5nIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gbmV3IE1hcCwgdGhpcy5tdXRhdGlvbnMgPSBbXSwgdGhpcy5jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGRlZmVycmVkIHVzYWdlIGVycm9yIHRoYXQgb2NjdXJyZWQgcHJldmlvdXNseSBpbiB0aGlzIHRyYW5zYWN0aW9uIHRoYXRcbiAgICAgICAgICogd2lsbCBjYXVzZSB0aGUgdHJhbnNhY3Rpb24gdG8gZmFpbCBvbmNlIGl0IGFjdHVhbGx5IGNvbW1pdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHdyaXR0ZW4gaW4gdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuIHRoZXJlJ3MgbW9yZSB0aGFuIG9uZSB3cml0ZSB0byB0aGUgc2FtZSBrZXkgaW4gYSB0cmFuc2FjdGlvbiwgYW55XG4gICAgICAgICAqIHdyaXRlcyBhZnRlciB0aGUgZmlyc3QgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzID0gbmV3IFNldDtcbiAgICB9XG4gICAgYXN5bmMgbG9va3VwKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCksIHRoaXMubXV0YXRpb25zLmxlbmd0aCA+IDApIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJGaXJlc3RvcmUgdHJhbnNhY3Rpb25zIHJlcXVpcmUgYWxsIHJlYWRzIHRvIGJlIGV4ZWN1dGVkIGJlZm9yZSBhbGwgd3JpdGVzLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBLKHQpLCBzID0gRXMobi5NKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50czogZS5tYXAoKHQgPT4geXMobi5NLCB0KSkpXG4gICAgICAgICAgICB9LCByID0gYXdhaXQgbi5fbyhcIkJhdGNoR2V0RG9jdW1lbnRzXCIsIHMsIGkpLCBvID0gbmV3IE1hcDtcbiAgICAgICAgICAgIHIuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFBzKG4uTSwgdCk7XG4gICAgICAgICAgICAgICAgby5zZXQoZS5rZXkudG9TdHJpbmcoKSwgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCB1ID0gW107XG4gICAgICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXQodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBVKCEhZSksIHUucHVzaChlKTtcbiAgICAgICAgICAgIH0pKSwgdTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4gdGhpcy5yZWNvcmRWZXJzaW9uKHQpKSksIGU7XG4gICAgfVxuICAgIHNldCh0LCBlKSB7XG4gICAgICAgIHRoaXMud3JpdGUoZS50b011dGF0aW9uKHQsIHRoaXMucHJlY29uZGl0aW9uKHQpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlKGUudG9NdXRhdGlvbih0LCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZSh0KSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLndyaXRlKG5ldyBPbih0LCB0aGlzLnByZWNvbmRpdGlvbih0KSkpLCB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBhc3luYyBjb21taXQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLmxhc3RXcml0ZUVycm9yKSB0aHJvdyB0aGlzLmxhc3RXcml0ZUVycm9yO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5yZWFkVmVyc2lvbnM7XG4gICAgICAgIC8vIEZvciBlYWNoIG11dGF0aW9uLCBub3RlIHRoYXQgdGhlIGRvYyB3YXMgd3JpdHRlbi5cbiAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQuZGVsZXRlKGUua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIFxuICAgICAgICAvLyBGb3IgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGJ1dCBub3Qgd3JpdHRlbiB0bywgd2Ugd2FudCB0byBwZXJmb3JtXG4gICAgICAgIC8vIGEgYHZlcmlmeWAgb3BlcmF0aW9uLlxuICAgICAgICB0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0geHQuZnJvbVBhdGgoZSk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5wdXNoKG5ldyBGbihuLCB0aGlzLnByZWNvbmRpdGlvbihuKSkpO1xuICAgICAgICB9KSksIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBLKHQpLCBzID0gRXMobi5NKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIHdyaXRlczogZS5tYXAoKHQgPT4gdnMobi5NLCB0KSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgbi5jbyhcIkNvbW1pdFwiLCBzLCBpKTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5tdXRhdGlvbnMpLCB0aGlzLmNvbW1pdHRlZCA9ICEwO1xuICAgIH1cbiAgICByZWNvcmRWZXJzaW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIGlmICh0LmlzRm91bmREb2N1bWVudCgpKSBlID0gdC52ZXJzaW9uOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdC5pc05vRG9jdW1lbnQoKSkgdGhyb3cgTCgpO1xuICAgICAgICAgICAgLy8gRm9yIGRlbGV0ZWQgZG9jcywgd2UgbXVzdCB1c2UgYmFzZVZlcnNpb24gMCB3aGVuIHdlIG92ZXJ3cml0ZSB0aGVtLlxuICAgICAgICAgICAgZSA9IGN0Lm1pbigpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQodC5rZXkudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBpZiAoIWUuaXNFcXVhbChuKSkgXG4gICAgICAgICAgICAvLyBUaGlzIHRyYW5zYWN0aW9uIHdpbGwgZmFpbCBubyBtYXR0ZXIgd2hhdC5cbiAgICAgICAgICAgIHRocm93IG5ldyBRKEcuQUJPUlRFRCwgXCJEb2N1bWVudCB2ZXJzaW9uIGNoYW5nZWQgYmV0d2VlbiB0d28gcmVhZHMuXCIpO1xuICAgICAgICB9IGVsc2UgdGhpcy5yZWFkVmVyc2lvbnMuc2V0KHQua2V5LnRvU3RyaW5nKCksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgd2hlbiBpdCB3YXMgcmVhZCBpbiB0aGlzIHRyYW5zYWN0aW9uLFxuICAgICAqIGFzIGEgcHJlY29uZGl0aW9uLCBvciBubyBwcmVjb25kaXRpb24gaWYgaXQgd2FzIG5vdCByZWFkLlxuICAgICAqLyAgICBwcmVjb25kaXRpb24odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAhdGhpcy53cml0dGVuRG9jcy5oYXModC50b1N0cmluZygpKSAmJiBlID8gQW4udXBkYXRlVGltZShlKSA6IEFuLm5vbmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJlY29uZGl0aW9uIGZvciBhIGRvY3VtZW50IGlmIHRoZSBvcGVyYXRpb24gaXMgYW4gdXBkYXRlLlxuICAgICAqLyAgICBwcmVjb25kaXRpb25Gb3JVcGRhdGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIC8vIFRoZSBmaXJzdCB0aW1lIGEgZG9jdW1lbnQgaXMgd3JpdHRlbiwgd2Ugd2FudCB0byB0YWtlIGludG8gYWNjb3VudCB0aGVcbiAgICAgICAgLy8gcmVhZCB0aW1lIGFuZCBleGlzdGVuY2VcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud3JpdHRlbkRvY3MuaGFzKHQudG9TdHJpbmcoKSkgJiYgZSkge1xuICAgICAgICAgICAgaWYgKGUuaXNFcXVhbChjdC5taW4oKSkpIFxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgdmFsaWRhdGVkIGxvY2FsbHkgYmVjYXVzZSB5b3UgY2FuJ3Qgc2VuZCBhXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb24gdGhhdCBhIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IHdpdGhvdXQgY2hhbmdpbmcgdGhlXG4gICAgICAgICAgICAvLyBzZW1hbnRpY3Mgb2YgdGhlIGJhY2tlbmQgd3JpdGUgdG8gYmUgYW4gaW5zZXJ0LiBUaGlzIGlzIHRoZSByZXZlcnNlXG4gICAgICAgICAgICAvLyBvZiB3aGF0IHdlIHdhbnQsIHNpbmNlIHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgIC8vIGV4aXN0IGJ1dCB0aGVuIHNlbmQgdGhlIHVwZGF0ZSBhbmQgaGF2ZSBpdCBmYWlsLiBTaW5jZSB3ZSBjYW4ndFxuICAgICAgICAgICAgLy8gZXhwcmVzcyB0aGF0IHRvIHRoZSBiYWNrZW5kLCB3ZSBoYXZlIHRvIHZhbGlkYXRlIGxvY2FsbHkuXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGlzIGNhbiBjaGFuZ2Ugb25jZSB3ZSBjYW4gc2VuZCBzZXBhcmF0ZSB2ZXJpZnkgd3JpdGVzIGluIHRoZVxuICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgdXBkYXRlIGEgZG9jdW1lbnQgdGhhdCBkb2Vzbid0IGV4aXN0LlwiKTtcbiAgICAgICAgICAgIC8vIERvY3VtZW50IGV4aXN0cywgYmFzZSBwcmVjb25kaXRpb24gb24gZG9jdW1lbnQgdXBkYXRlIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQW4udXBkYXRlVGltZShlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb2N1bWVudCB3YXMgbm90IHJlYWQsIHNvIHdlIGp1c3QgdXNlIHRoZSBwcmVjb25kaXRpb25zIGZvciBhIGJsaW5kXG4gICAgICAgIC8vIHVwZGF0ZS5cbiAgICAgICAgcmV0dXJuIEFuLmV4aXN0cyghMCk7XG4gICAgfVxuICAgIHdyaXRlKHQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMucHVzaCh0KTtcbiAgICB9XG4gICAgZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVHJhbnNhY3Rpb25SdW5uZXIgZW5jYXBzdWxhdGVzIHRoZSBsb2dpYyBuZWVkZWQgdG8gcnVuIGFuZCByZXRyeSB0cmFuc2FjdGlvbnNcbiAqIHdpdGggYmFja29mZi5cbiAqLyBjbGFzcyBGYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLmRhdGFzdG9yZSA9IGUsIHRoaXMub3B0aW9ucyA9IG4sIHRoaXMudXBkYXRlRnVuY3Rpb24gPSBzLCBcbiAgICAgICAgdGhpcy5kZWZlcnJlZCA9IGksIHRoaXMueGEgPSBuLm1heEF0dGVtcHRzLCB0aGlzLk5vID0gbmV3IFdvKHRoaXMuYXN5bmNRdWV1ZSwgXCJ0cmFuc2FjdGlvbl9yZXRyeVwiIC8qIFRyYW5zYWN0aW9uUmV0cnkgKi8pO1xuICAgIH1cbiAgICAvKiogUnVucyB0aGUgdHJhbnNhY3Rpb24gYW5kIHNldHMgdGhlIHJlc3VsdCBvbiBkZWZlcnJlZC4gKi8gICAgcnVuKCkge1xuICAgICAgICB0aGlzLnhhIC09IDEsIHRoaXMuTmEoKTtcbiAgICB9XG4gICAgTmEoKSB7XG4gICAgICAgIHRoaXMuTm8uUm8oKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgT2EodGhpcy5kYXRhc3RvcmUpLCBlID0gdGhpcy5rYSh0KTtcbiAgICAgICAgICAgIGUgJiYgZS50aGVuKChlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gdC5jb21taXQoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmZXJyZWQucmVzb2x2ZShlKTtcbiAgICAgICAgICAgICAgICB9KSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLk1hKHQpO1xuICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgfSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLk1hKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGthKHQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnVwZGF0ZUZ1bmN0aW9uKHQpO1xuICAgICAgICAgICAgcmV0dXJuICFTdChlKSAmJiBlLmNhdGNoICYmIGUudGhlbiA/IGUgOiAodGhpcy5kZWZlcnJlZC5yZWplY3QoRXJyb3IoXCJUcmFuc2FjdGlvbiBjYWxsYmFjayBtdXN0IHJldHVybiBhIFByb21pc2VcIikpLCBcbiAgICAgICAgICAgIG51bGwpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBEbyBub3QgcmV0cnkgZXJyb3JzIHRocm93biBieSB1c2VyIHByb3ZpZGVkIHVwZGF0ZUZ1bmN0aW9uLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmZXJyZWQucmVqZWN0KHQpLCBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIE1hKHQpIHtcbiAgICAgICAgdGhpcy54YSA+IDAgJiYgdGhpcy5PYSh0KSA/ICh0aGlzLnhhIC09IDEsIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiAodGhpcy5OYSgpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSkpIDogdGhpcy5kZWZlcnJlZC5yZWplY3QodCk7XG4gICAgfVxuICAgIE9hKHQpIHtcbiAgICAgICAgaWYgKFwiRmlyZWJhc2VFcnJvclwiID09PSB0Lm5hbWUpIHtcbiAgICAgICAgICAgIC8vIEluIHRyYW5zYWN0aW9ucywgdGhlIGJhY2tlbmQgd2lsbCBmYWlsIG91dGRhdGVkIHJlYWRzIHdpdGggRkFJTEVEX1BSRUNPTkRJVElPTiBhbmRcbiAgICAgICAgICAgIC8vIG5vbi1tYXRjaGluZyBkb2N1bWVudCB2ZXJzaW9ucyB3aXRoIEFCT1JURUQuIFRoZXNlIGVycm9ycyBzaG91bGQgYmUgcmV0cmllZC5cbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvZGU7XG4gICAgICAgICAgICByZXR1cm4gXCJhYm9ydGVkXCIgPT09IGUgfHwgXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIgPT09IGUgfHwgIVVuKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEZpcmVzdG9yZUNsaWVudCBpcyBhIHRvcC1sZXZlbCBjbGFzcyB0aGF0IGNvbnN0cnVjdHMgYW5kIG93bnMgYWxsIG9mIHRoZVxuICogcGllY2VzIG9mIHRoZSBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZS4gSXQgaXMgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIHRoZVxuICogYXN5bmMgcXVldWUgdGhhdCBpcyBzaGFyZWQgYnkgYWxsIG9mIHRoZSBvdGhlciBjb21wb25lbnRzIGluIHRoZSBzeXN0ZW0uXG4gKi9cbmNsYXNzICRhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBcbiAgICAvKipcbiAgICAgKiBBc3luY2hyb25vdXMgcXVldWUgcmVzcG9uc2libGUgZm9yIGFsbCBvZiBvdXIgaW50ZXJuYWwgcHJvY2Vzc2luZy4gV2hlblxuICAgICAqIHdlIGdldCBpbmNvbWluZyB3b3JrIGZyb20gdGhlIHVzZXIgKHZpYSBwdWJsaWMgQVBJKSBvciB0aGUgbmV0d29ya1xuICAgICAqIChpbmNvbWluZyBHUlBDIG1lc3NhZ2VzKSwgd2Ugc2hvdWxkIGFsd2F5cyBzY2hlZHVsZSBvbnRvIHRoaXMgcXVldWUuXG4gICAgICogVGhpcyBlbnN1cmVzIGFsbCBvZiBvdXIgd29yayBpcyBwcm9wZXJseSBzZXJpYWxpemVkIChlLmcuIHdlIGRvbid0XG4gICAgICogc3RhcnQgcHJvY2Vzc2luZyBhIG5ldyBvcGVyYXRpb24gd2hpbGUgdGhlIHByZXZpb3VzIG9uZSBpcyB3YWl0aW5nIGZvclxuICAgICAqIGFuIGFzeW5jIEkvTyB0byBjb21wbGV0ZSkuXG4gICAgICovXG4gICAgbiwgcykge1xuICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFscyA9IHQsIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscyA9IGUsIHRoaXMuYXN5bmNRdWV1ZSA9IG4sIHRoaXMuZGF0YWJhc2VJbmZvID0gcywgXG4gICAgICAgIHRoaXMudXNlciA9IEMuVU5BVVRIRU5USUNBVEVELCB0aGlzLmNsaWVudElkID0gaXQuUigpLCB0aGlzLmF1dGhDcmVkZW50aWFsTGlzdGVuZXIgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoKSwgXG4gICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFsTGlzdGVuZXIgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoKSwgdGhpcy5hdXRoQ3JlZGVudGlhbHMuc3RhcnQobiwgKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgTyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlJlY2VpdmVkIHVzZXI9XCIsIHQudWlkKSwgYXdhaXQgdGhpcy5hdXRoQ3JlZGVudGlhbExpc3RlbmVyKHQpLCBcbiAgICAgICAgICAgIHRoaXMudXNlciA9IHQ7XG4gICAgICAgIH0pKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLnN0YXJ0KG4sICh0ID0+IChPKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiUmVjZWl2ZWQgbmV3IGFwcCBjaGVjayB0b2tlbj1cIiwgdCksIFxuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbExpc3RlbmVyKHQsIHRoaXMudXNlcikpKSk7XG4gICAgfVxuICAgIGFzeW5jIGdldENvbmZpZ3VyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhc3luY1F1ZXVlOiB0aGlzLmFzeW5jUXVldWUsXG4gICAgICAgICAgICBkYXRhYmFzZUluZm86IHRoaXMuZGF0YWJhc2VJbmZvLFxuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgICBhdXRoQ3JlZGVudGlhbHM6IHRoaXMuYXV0aENyZWRlbnRpYWxzLFxuICAgICAgICAgICAgYXBwQ2hlY2tDcmVkZW50aWFsczogdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLFxuICAgICAgICAgICAgaW5pdGlhbFVzZXI6IHRoaXMudXNlcixcbiAgICAgICAgICAgIG1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOiAxMDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc2V0Q3JlZGVudGlhbENoYW5nZUxpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5hdXRoQ3JlZGVudGlhbExpc3RlbmVyID0gdDtcbiAgICB9XG4gICAgc2V0QXBwQ2hlY2tUb2tlbkNoYW5nZUxpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGF0IHRoZSBjbGllbnQgaGFzIG5vdCBiZWVuIHRlcm1pbmF0ZWQuIEVuc3VyZXMgdGhhdCBvdGhlciBtZXRob2RzIG9uXG4gICAgICogdGhpcyBjbGFzcyBjYW5ub3QgYmUgY2FsbGVkIGFmdGVyIHRoZSBjbGllbnQgaXMgdGVybWluYXRlZC5cbiAgICAgKi8gICAgdmVyaWZ5Tm90VGVybWluYXRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXN5bmNRdWV1ZS5pc1NodXR0aW5nRG93bikgdGhyb3cgbmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlRoZSBjbGllbnQgaGFzIGFscmVhZHkgYmVlbiB0ZXJtaW5hdGVkLlwiKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW50ZXJSZXN0cmljdGVkTW9kZSgpO1xuICAgICAgICBjb25zdCB0ID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMub25saW5lQ29tcG9uZW50cy50ZXJtaW5hdGUoKSwgdGhpcy5vZmZsaW5lQ29tcG9uZW50cyAmJiBhd2FpdCB0aGlzLm9mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFscy5zaHV0ZG93bigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuc2h1dGRvd24oKSwgdC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFN1KGUsIFwiRmFpbGVkIHRvIHNodXRkb3duIHBlcnNpc3RlbmNlXCIpO1xuICAgICAgICAgICAgICAgIHQucmVqZWN0KG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHQucHJvbWlzZTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEJhKHQsIGUpIHtcbiAgICB0LmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBPKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiSW5pdGlhbGl6aW5nIE9mZmxpbmVDb21wb25lbnRQcm92aWRlclwiKTtcbiAgICBjb25zdCBuID0gYXdhaXQgdC5nZXRDb25maWd1cmF0aW9uKCk7XG4gICAgYXdhaXQgZS5pbml0aWFsaXplKG4pO1xuICAgIGxldCBzID0gbi5pbml0aWFsVXNlcjtcbiAgICB0LnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigoYXN5bmMgdCA9PiB7XG4gICAgICAgIHMuaXNFcXVhbCh0KSB8fCAoYXdhaXQgc28oZS5sb2NhbFN0b3JlLCB0KSwgcyA9IHQpO1xuICAgIH0pKSwgXG4gICAgLy8gV2hlbiBhIHVzZXIgY2FsbHMgY2xlYXJQZXJzaXN0ZW5jZSgpIGluIG9uZSBjbGllbnQsIGFsbCBvdGhlciBjbGllbnRzXG4gICAgLy8gbmVlZCB0byBiZSB0ZXJtaW5hdGVkIHRvIGFsbG93IHRoZSBkZWxldGUgdG8gc3VjY2VlZC5cbiAgICBlLnBlcnNpc3RlbmNlLnNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCgoKSA9PiB0LnRlcm1pbmF0ZSgpKSksIHQub2ZmbGluZUNvbXBvbmVudHMgPSBlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBMYSh0LCBlKSB7XG4gICAgdC5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKTtcbiAgICBjb25zdCBuID0gYXdhaXQgVWEodCk7XG4gICAgTyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIkluaXRpYWxpemluZyBPbmxpbmVDb21wb25lbnRQcm92aWRlclwiKTtcbiAgICBjb25zdCBzID0gYXdhaXQgdC5nZXRDb25maWd1cmF0aW9uKCk7XG4gICAgYXdhaXQgZS5pbml0aWFsaXplKG4sIHMpLCBcbiAgICAvLyBUaGUgQ3JlZGVudGlhbENoYW5nZUxpc3RlbmVyIG9mIHRoZSBvbmxpbmUgY29tcG9uZW50IHByb3ZpZGVyIHRha2VzXG4gICAgLy8gcHJlY2VkZW5jZSBvdmVyIHRoZSBvZmZsaW5lIGNvbXBvbmVudCBwcm92aWRlci5cbiAgICB0LnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigodCA9PiBSdShlLnJlbW90ZVN0b3JlLCB0KSkpLCB0LnNldEFwcENoZWNrVG9rZW5DaGFuZ2VMaXN0ZW5lcigoKHQsIG4pID0+IFJ1KGUucmVtb3RlU3RvcmUsIG4pKSksIFxuICAgIHQub25saW5lQ29tcG9uZW50cyA9IGU7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFVhKHQpIHtcbiAgICByZXR1cm4gdC5vZmZsaW5lQ29tcG9uZW50cyB8fCAoTyhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBCYSh0LCBuZXcgU2EpKSwgdC5vZmZsaW5lQ29tcG9uZW50cztcbn1cblxuYXN5bmMgZnVuY3Rpb24gcWEodCkge1xuICAgIHJldHVybiB0Lm9ubGluZUNvbXBvbmVudHMgfHwgKE8oXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJVc2luZyBkZWZhdWx0IE9ubGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBMYSh0LCBuZXcgeGEpKSwgdC5vbmxpbmVDb21wb25lbnRzO1xufVxuXG5mdW5jdGlvbiBLYSh0KSB7XG4gICAgcmV0dXJuIFVhKHQpLnRoZW4oKHQgPT4gdC5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiBHYSh0KSB7XG4gICAgcmV0dXJuIFVhKHQpLnRoZW4oKHQgPT4gdC5sb2NhbFN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIFFhKHQpIHtcbiAgICByZXR1cm4gcWEodCkudGhlbigodCA9PiB0LnJlbW90ZVN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIGphKHQpIHtcbiAgICByZXR1cm4gcWEodCkudGhlbigodCA9PiB0LnN5bmNFbmdpbmUpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gV2EodCkge1xuICAgIGNvbnN0IGUgPSBhd2FpdCBxYSh0KSwgbiA9IGUuZXZlbnRNYW5hZ2VyO1xuICAgIHJldHVybiBuLm9uTGlzdGVuID0gWXUuYmluZChudWxsLCBlLnN5bmNFbmdpbmUpLCBuLm9uVW5saXN0ZW4gPSBadS5iaW5kKG51bGwsIGUuc3luY0VuZ2luZSksIFxuICAgIG47XG59XG5cbi8qKiBFbmFibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHJlLWVucXVldWVzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMuICovIGZ1bmN0aW9uIHphKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEthKHQpLCBuID0gYXdhaXQgUWEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCEwKSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IEsodCk7XG4gICAgICAgICAgICByZXR1cm4gZS53dS5kZWxldGUoMCAvKiBVc2VyRGlzYWJsZWQgKi8pLCB0dShlKTtcbiAgICAgICAgfShuKTtcbiAgICB9KSk7XG59XG5cbi8qKiBEaXNhYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uLiBQZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBub3QgY29tcGxldGUuICovIGZ1bmN0aW9uIEhhKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEthKHQpLCBuID0gYXdhaXQgUWEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCExKSwgYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IEsodCk7XG4gICAgICAgICAgICBlLnd1LmFkZCgwIC8qIFVzZXJEaXNhYmxlZCAqLyksIGF3YWl0IGV1KGUpLCBcbiAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSBzbyBnZXQoKXMgcmV0dXJuIGZyb20gY2FjaGUsIGV0Yy5cbiAgICAgICAgICAgIGUueXUuc2V0KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pO1xuICAgICAgICB9KG4pO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHdyaXRlcyB0aGF0IHdlcmUgcGVuZGluZyBhdCB0aGUgdGltZVxuICogdGhpcyBtZXRob2Qgd2FzIGNhbGxlZCByZWNlaXZlZCBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LiBBbiBhY2tub3dsZWRnZW1lbnRcbiAqIGNhbiBiZSBlaXRoZXIgYWNjZXB0YW5jZSBvciByZWplY3Rpb24uXG4gKi8gZnVuY3Rpb24gSmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEsodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJyZWFkIGRvY3VtZW50XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5maS5Mcyh0LCBlKSkpO1xuICAgICAgICAgICAgfSh0LCBlKTtcbiAgICAgICAgICAgIHMuaXNGb3VuZERvY3VtZW50KCkgPyBuLnJlc29sdmUocykgOiBzLmlzTm9Eb2N1bWVudCgpID8gbi5yZXNvbHZlKG51bGwpIDogbi5yZWplY3QobmV3IFEoRy5VTkFWQUlMQUJMRSwgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gY2FjaGUuIChIb3dldmVyLCB0aGlzIGRvY3VtZW50IG1heSBleGlzdCBvbiB0aGUgc2VydmVyLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nICdzb3VyY2UnIGluIHRoZSBHZXRPcHRpb25zIHRvIGF0dGVtcHQgdG8gcmV0cmlldmUgdGhlIGRvY3VtZW50IGZyb20gdGhlIHNlcnZlci4pXCIpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IFN1KHQsIGBGYWlsZWQgdG8gZ2V0IGRvY3VtZW50ICcke2V9IGZyb20gY2FjaGVgKTtcbiAgICAgICAgICAgIG4ucmVqZWN0KHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogUmV0cmlldmVzIGEgbGF0ZW5jeS1jb21wZW5zYXRlZCBkb2N1bWVudCBmcm9tIHRoZSBiYWNrZW5kIHZpYSBhXG4gKiBTbmFwc2hvdExpc3RlbmVyLlxuICovIChhd2FpdCBHYSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBZYSh0LCBlLCBuID0ge30pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcga2Eoe1xuICAgICAgICAgICAgbmV4dDogciA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBPdSh0LCBvKSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSByLmRvY3MuaGFzKG4pO1xuICAgICAgICAgICAgICAgICF1ICYmIHIuZnJvbUNhY2hlID8gXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZiB3ZSdyZSBvbmxpbmUgYW5kIHRoZSBkb2N1bWVudCBkb2Vzbid0XG4gICAgICAgICAgICAgICAgLy8gZXhpc3QgdGhlbiB3ZSByZXNvbHZlIHdpdGggYSBkb2MuZXhpc3RzIHNldCB0byBmYWxzZS4gSWZcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBvZmZsaW5lIGhvd2V2ZXIsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGlzXG4gICAgICAgICAgICAgICAgLy8gY2FzZS4gVHdvIG9wdGlvbnM6IDEpIENhY2hlIHRoZSBuZWdhdGl2ZSByZXNwb25zZSBmcm9tXG4gICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlciBzbyB3ZSBjYW4gZGVsaXZlciB0aGF0IGV2ZW4gd2hlbiB5b3UncmVcbiAgICAgICAgICAgICAgICAvLyBvZmZsaW5lIDIpIEFjdHVhbGx5IHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGUgb25saW5lIGNhc2VcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgICAgICAgICAgICBpLnJlamVjdChuZXcgUShHLlVOQVZBSUxBQkxFLCBcIkZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKSA6IHUgJiYgci5mcm9tQ2FjaGUgJiYgcyAmJiBcInNlcnZlclwiID09PSBzLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBRKEcuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBkb2VzIGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50LiknKSkgOiBpLnJlc29sdmUocik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHQgPT4gaS5yZWplY3QodClcbiAgICAgICAgfSksIG8gPSBuZXcgTHUoS2Uobi5wYXRoKSwgciwge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICBrdTogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBNdSh0LCBvKTtcbiAgICB9KGF3YWl0IFdhKHQpLCB0LmFzeW5jUXVldWUsIGUsIG4sIHMpKSksIHMucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gWGEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBsbyh0LCBlLCBcbiAgICAgICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gbmV3IFd1KGUsIHMuX2kpLCByID0gaS5XdShzLmRvY3VtZW50cyksIG8gPSBpLmFwcGx5Q2hhbmdlcyhyLCBcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyAhMSk7XG4gICAgICAgICAgICBuLnJlc29sdmUoby5zbmFwc2hvdCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBTdSh0LCBgRmFpbGVkIHRvIGV4ZWN1dGUgcXVlcnkgJyR7ZX0gYWdhaW5zdCBjYWNoZWApO1xuICAgICAgICAgICAgbi5yZWplY3Qocyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBSZXRyaWV2ZXMgYSBsYXRlbmN5LWNvbXBlbnNhdGVkIHF1ZXJ5IHNuYXBzaG90IGZyb20gdGhlIGJhY2tlbmQgdmlhIGFcbiAqIFNuYXBzaG90TGlzdGVuZXIuXG4gKi8gKGF3YWl0IEdhKHQpLCBlLCBuKSkpLCBuLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIFphKHQsIGUsIG4gPSB7fSkge1xuICAgIGNvbnN0IHMgPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBrYSh7XG4gICAgICAgICAgICBuZXh0OiBuID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IE91KHQsIG8pKSksIG4uZnJvbUNhY2hlICYmIFwic2VydmVyXCIgPT09IHMuc291cmNlID8gaS5yZWplY3QobmV3IFEoRy5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnRzIGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhlc2UgZG9jdW1lbnRzIG1heSBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudHMuKScpKSA6IGkucmVzb2x2ZShuKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogdCA9PiBpLnJlamVjdCh0KVxuICAgICAgICB9KSwgbyA9IG5ldyBMdShuLCByLCB7XG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMCxcbiAgICAgICAgICAgIGt1OiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE11KHQsIG8pO1xuICAgIH0oYXdhaXQgV2EodCksIHQuYXN5bmNRdWV1ZSwgZSwgbiwgcykpKSwgcy5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiB0Yyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IG5ldyBrYShlKTtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgSyh0KS5idS5hZGQoZSksIFxuICAgICAgICAvLyBJbW1lZGlhdGVseSBmaXJlIGFuIGluaXRpYWwgZXZlbnQsIGluZGljYXRpbmcgYWxsIGV4aXN0aW5nIGxpc3RlbmVyc1xuICAgICAgICAvLyBhcmUgaW4tc3luYy5cbiAgICAgICAgZS5uZXh0KCk7XG4gICAgfShhd2FpdCBXYSh0KSwgbikpKSwgKCkgPT4ge1xuICAgICAgICBuLkFhKCksIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBLKHQpLmJ1LmRlbGV0ZShlKTtcbiAgICAgICAgfShhd2FpdCBXYSh0KSwgbikpKTtcbiAgICB9O1xufVxuXG4vKipcbiAqIFRha2VzIGFuIHVwZGF0ZUZ1bmN0aW9uIGluIHdoaWNoIGEgc2V0IG9mIHJlYWRzIGFuZCB3cml0ZXMgY2FuIGJlIHBlcmZvcm1lZFxuICogYXRvbWljYWxseS4gSW4gdGhlIHVwZGF0ZUZ1bmN0aW9uLCB0aGUgY2xpZW50IGNhbiByZWFkIGFuZCB3cml0ZSB2YWx1ZXNcbiAqIHVzaW5nIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbiBvYmplY3QuIEFmdGVyIHRoZSB1cGRhdGVGdW5jdGlvbiwgYWxsXG4gKiBjaGFuZ2VzIHdpbGwgYmUgY29tbWl0dGVkLiBJZiBhIHJldHJ5YWJsZSBlcnJvciBvY2N1cnMgKGV4OiBzb21lIG90aGVyXG4gKiBjbGllbnQgaGFzIGNoYW5nZWQgYW55IG9mIHRoZSBkYXRhIHJlZmVyZW5jZWQpLCB0aGVuIHRoZSB1cGRhdGVGdW5jdGlvblxuICogd2lsbCBiZSBjYWxsZWQgYWdhaW4gYWZ0ZXIgYSBiYWNrb2ZmLiBJZiB0aGUgdXBkYXRlRnVuY3Rpb24gc3RpbGwgZmFpbHNcbiAqIGFmdGVyIGFsbCByZXRyaWVzLCB0aGVuIHRoZSB0cmFuc2FjdGlvbiB3aWxsIGJlIHJlamVjdGVkLlxuICpcbiAqIFRoZSB0cmFuc2FjdGlvbiBvYmplY3QgcGFzc2VkIHRvIHRoZSB1cGRhdGVGdW5jdGlvbiBjb250YWlucyBtZXRob2RzIGZvclxuICogYWNjZXNzaW5nIGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMuIFVubGlrZSBvdGhlciBkYXRhc3RvcmUgYWNjZXNzLCBkYXRhXG4gKiBhY2Nlc3NlZCB3aXRoIHRoZSB0cmFuc2FjdGlvbiB3aWxsIG5vdCByZWZsZWN0IGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdFxuICogYmVlbiBjb21taXR0ZWQuIEZvciB0aGlzIHJlYXNvbiwgaXQgaXMgcmVxdWlyZWQgdGhhdCBhbGwgcmVhZHMgYXJlXG4gKiBwZXJmb3JtZWQgYmVmb3JlIGFueSB3cml0ZXMuIFRyYW5zYWN0aW9ucyBtdXN0IGJlIHBlcmZvcm1lZCB3aGlsZSBvbmxpbmUuXG4gKi8gZnVuY3Rpb24gZWModCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaSA9IGF3YWl0IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBxYSh0KS50aGVuKCh0ID0+IHQuZGF0YXN0b3JlKSk7XG4gICAgICAgIH0odCk7XG4gICAgICAgIG5ldyBGYSh0LmFzeW5jUXVldWUsIGksIG4sIGUsIHMpLnJ1bigpO1xuICAgIH0pKSwgcy5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBuYyh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIG4gPSBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gKG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHQpIDogdDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTWEodCwgZSk7XG4gICAgICAgIH0oZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSByZXR1cm4gTmEodCwgZSk7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSByZXR1cm4gTmEobmV3IFVpbnQ4QXJyYXkodCksIGUpO1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSZWFkYWJsZVN0cmVhbSkgcmV0dXJuIHQuZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb3VyY2Ugb2YgYHRvQnl0ZVN0cmVhbVJlYWRlcmAgaGFzIHRvIGJlIGEgQXJyYXlCdWZmZXIgb3IgUmVhZGFibGVTdHJlYW1cIik7XG4gICAgICAgIH0obiksIGUpO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAobiwgam8oZSkpO1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgIHZhKGF3YWl0IGphKHQpLCBpLCBzKTtcbiAgICB9KSk7XG59XG5cbmZ1bmN0aW9uIHNjKHQsIGUpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEsodCk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5hbWVkIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5fcy5nZXROYW1lZFF1ZXJ5KHQsIGUpKSk7XG4gICAgfShhd2FpdCBHYSh0KSwgZSkpKTtcbn1cblxuY29uc3QgaWMgPSBuZXcgTWFwO1xuXG4vKipcbiAqIEFuIGluc3RhbmNlIG1hcCB0aGF0IGVuc3VyZXMgb25seSBvbmUgRGF0YXN0b3JlIGV4aXN0cyBwZXIgRmlyZXN0b3JlXG4gKiBpbnN0YW5jZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIHJjKHQsIGUsIG4pIHtcbiAgICBpZiAoIW4pIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSBjYW5ub3QgYmUgY2FsbGVkIHdpdGggYW4gZW1wdHkgJHtlfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0d28gYm9vbGVhbiBvcHRpb25zIGFyZSBub3Qgc2V0IGF0IHRoZSBzYW1lIHRpbWUuXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBvYyh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKCEwID09PSBlICYmICEwID09PSBzKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGAke3R9IGFuZCAke259IGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyLmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBkb2N1bWVudCAoaW5kaWNhdGVkIGJ5IHRoZSBmYWN0IGl0IGNvbnRhaW5zXG4gKiBhbiBldmVuIG51bWJlcnMgb2Ygc2VnbWVudHMpLlxuICovIGZ1bmN0aW9uIHVjKHQpIHtcbiAgICBpZiAoIXh0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgZG9jdW1lbnQgcmVmZXJlbmNlLiBEb2N1bWVudCByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBjb2xsZWN0aW9uIChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXRcbiAqIGNvbnRhaW5zIGFuIG9kZCBudW1iZXJzIG9mIHNlZ21lbnRzKS5cbiAqLyBmdW5jdGlvbiBhYyh0KSB7XG4gICAgaWYgKHh0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiByZWZlcmVuY2UuIENvbGxlY3Rpb24gcmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCdzIGEgbm9uLW51bGwgb2JqZWN0IHdpdGhvdXQgYSBjdXN0b20gcHJvdG90eXBlXG4gKiAoaS5lLiBleGNsdWRlcyBBcnJheSwgRGF0ZSwgZXRjLikuXG4gKi9cbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovXG5mdW5jdGlvbiBjYyh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgcmV0dXJuIFwidW5kZWZpbmVkXCI7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBcIm51bGxcIjtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHQubGVuZ3RoID4gMjAgJiYgKHQgPSBgJHt0LnN1YnN0cmluZygwLCAyMCl9Li4uYCksIFxuICAgIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0IHx8IFwiYm9vbGVhblwiID09IHR5cGVvZiB0KSByZXR1cm4gXCJcIiArIHQ7XG4gICAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIHQpIHtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBBcnJheSkgcmV0dXJuIFwiYW4gYXJyYXlcIjtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAgICAgLyoqIHRyeSB0byBnZXQgdGhlIGNvbnN0cnVjdG9yIG5hbWUgZm9yIGFuIG9iamVjdC4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAodC5jb25zdHJ1Y3RvcikgcmV0dXJuIHQuY29uc3RydWN0b3IubmFtZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQ2FzdHMgYG9iamAgdG8gYFRgLCBvcHRpb25hbGx5IHVud3JhcHBpbmcgQ29tcGF0IHR5cGVzIHRvIGV4cG9zZSB0aGVcbiAqIHVuZGVybHlpbmcgaW5zdGFuY2UuIFRocm93cyBpZiAgYG9iamAgaXMgbm90IGFuIGluc3RhbmNlIG9mIGBUYC5cbiAqXG4gKiBUaGlzIGNhc3QgaXMgdXNlZCBpbiB0aGUgTGl0ZSBhbmQgRnVsbCBTREsgdG8gdmVyaWZ5IGluc3RhbmNlIHR5cGVzIGZvclxuICogYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgcHVibGljIEFQSS5cbiAqIEBpbnRlcm5hbFxuICovICh0KTtcbiAgICAgICAgICAgIHJldHVybiBlID8gYGEgY3VzdG9tICR7ZX0gb2JqZWN0YCA6IFwiYW4gb2JqZWN0XCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCA/IFwiYSBmdW5jdGlvblwiIDogTCgpO1xufVxuXG5mdW5jdGlvbiBoYyh0LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5lKSB7XG4gICAgaWYgKFwiX2RlbGVnYXRlXCIgaW4gdCAmJiAoXG4gICAgLy8gVW53cmFwIENvbXBhdCB0eXBlc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCA9IHQuX2RlbGVnYXRlKSwgISh0IGluc3RhbmNlb2YgZSkpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gdC5jb25zdHJ1Y3Rvci5uYW1lKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiVHlwZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgaW5zdGFuY2UuIERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBTREs/XCIpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBuID0gY2ModCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBFeHBlY3RlZCB0eXBlICcke2UubmFtZX0nLCBidXQgaXQgd2FzOiAke259YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbmZ1bmN0aW9uIGxjKHQsIGUpIHtcbiAgICBpZiAoZSA8PSAwKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke3R9KCkgcmVxdWlyZXMgYSBwb3NpdGl2ZSBudW1iZXIsIGJ1dCBpdCB3YXM6ICR7ZX0uYCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBzZXR0aW5ncygpIGRlZmF1bHRzOlxuLyoqXG4gKiBBIGNvbmNyZXRlIHR5cGUgZGVzY3JpYmluZyBhbGwgdGhlIHZhbHVlcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHZpYSBhXG4gKiB1c2VyLXN1cHBsaWVkIGBGaXJlc3RvcmVTZXR0aW5nc2Agb2JqZWN0LiBUaGlzIGlzIGEgc2VwYXJhdGUgdHlwZSBzbyB0aGF0XG4gKiBkZWZhdWx0cyBjYW4gYmUgc3VwcGxpZWQgYW5kIHRoZSB2YWx1ZSBjYW4gYmUgY2hlY2tlZCBmb3IgZXF1YWxpdHkuXG4gKi9cbmNsYXNzIGZjIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHZhciBlO1xuICAgICAgICBpZiAodm9pZCAwID09PSB0Lmhvc3QpIHtcbiAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHQuc3NsKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgcHJvdmlkZSBzc2wgb3B0aW9uIGlmIGhvc3Qgb3B0aW9uIGlzIG5vdCBzZXRcIik7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiLCB0aGlzLnNzbCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB0aGlzLmhvc3QgPSB0Lmhvc3QsIHRoaXMuc3NsID0gbnVsbCA9PT0gKGUgPSB0LnNzbCkgfHwgdm9pZCAwID09PSBlIHx8IGU7XG4gICAgICAgIGlmICh0aGlzLmNyZWRlbnRpYWxzID0gdC5jcmVkZW50aWFscywgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gISF0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIFxuICAgICAgICB2b2lkIDAgPT09IHQuY2FjaGVTaXplQnl0ZXMpIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSA0MTk0MzA0MDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoLTEgIT09IHQuY2FjaGVTaXplQnl0ZXMgJiYgdC5jYWNoZVNpemVCeXRlcyA8IDEwNDg1NzYpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZVNpemVCeXRlcyBtdXN0IGJlIGF0IGxlYXN0IDEwNDg1NzZcIik7XG4gICAgICAgICAgICB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdC5jYWNoZVNpemVCeXRlcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSAhIXQudXNlRmV0Y2hTdHJlYW1zLCBvYyhcImV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmdcIiwgdC5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCBcImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZ1wiLCB0LmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ob3N0ID09PSB0Lmhvc3QgJiYgdGhpcy5zc2wgPT09IHQuc3NsICYmIHRoaXMuY3JlZGVudGlhbHMgPT09IHQuY3JlZGVudGlhbHMgJiYgdGhpcy5jYWNoZVNpemVCeXRlcyA9PT0gdC5jYWNoZVNpemVCeXRlcyAmJiB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPT09IHQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyAmJiB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9PT0gdC5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgJiYgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID09PSB0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgJiYgdGhpcy51c2VGZXRjaFN0cmVhbXMgPT09IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi8gY2xhc3MgZGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLl9hdXRoQ3JlZGVudGlhbHMgPSBlLCB0aGlzLl9hcHBDaGVja0NyZWRlbnRpYWxzID0gbiwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSBGaXJlc3RvcmUgb3IgRmlyZXN0b3JlIExpdGUgaW5zdGFuY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImZpcmVzdG9yZS1saXRlXCIsIHRoaXMuX3BlcnNpc3RlbmNlS2V5ID0gXCIobGl0ZSlcIiwgdGhpcy5fc2V0dGluZ3MgPSBuZXcgZmMoe30pLCBcbiAgICAgICAgdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMSwgdCBpbnN0YW5jZW9mIHZ0ID8gdGhpcy5fZGF0YWJhc2VJZCA9IHQgOiAodGhpcy5fYXBwID0gdCwgXG4gICAgICAgIHRoaXMuX2RhdGFiYXNlSWQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuYXBwbHkodC5vcHRpb25zLCBbIFwicHJvamVjdElkXCIgXSkpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgJ1wicHJvamVjdElkXCIgbm90IHByb3ZpZGVkIGluIGZpcmViYXNlLmluaXRpYWxpemVBcHAuJyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHZ0KHQub3B0aW9ucy5wcm9qZWN0SWQpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogTW9kaWZ5IHRoaXMgaW5zdGFuY2UgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgQ2xvdWQgRmlyZXN0b3JlIGVtdWxhdG9yLlxuICpcbiAqIE5vdGU6IFRoaXMgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIHRoaXMgaW5zdGFuY2UgaGFzIGJlZW4gdXNlZCB0byBkbyBhbnlcbiAqIG9wZXJhdGlvbnMuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSBgRmlyZXN0b3JlYCBpbnN0YW5jZSB0byBjb25maWd1cmUgdG8gY29ubmVjdCB0byB0aGVcbiAqIGVtdWxhdG9yLlxuICogQHBhcmFtIGhvc3QgLSB0aGUgZW11bGF0b3IgaG9zdCAoZXg6IGxvY2FsaG9zdCkuXG4gKiBAcGFyYW0gcG9ydCAtIHRoZSBlbXVsYXRvciBwb3J0IChleDogOTAwMCkuXG4gKiBAcGFyYW0gb3B0aW9ucy5tb2NrVXNlclRva2VuIC0gdGhlIG1vY2sgYXV0aCB0b2tlbiB0byB1c2UgZm9yIHVuaXQgdGVzdGluZ1xuICogU2VjdXJpdHkgUnVsZXMuXG4gKi8gKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBhc3NvY2lhdGVkIHdpdGggdGhpcyBgRmlyZXN0b3JlYCBzZXJ2aWNlXG4gICAgICogaW5zdGFuY2UuXG4gICAgICovICAgIGdldCBhcHAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fYXBwKSB0aHJvdyBuZXcgUShHLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIHdhcyBub3QgaW5pdGlhbGl6ZWQgdXNpbmcgdGhlIEZpcmViYXNlIFNESy4gJ2FwcCcgaXMgbm90IGF2YWlsYWJsZVwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcDtcbiAgICB9XG4gICAgZ2V0IF9pbml0aWFsaXplZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzRnJvemVuO1xuICAgIH1cbiAgICBnZXQgX3Rlcm1pbmF0ZWQoKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuX3Rlcm1pbmF0ZVRhc2s7XG4gICAgfVxuICAgIF9zZXRTZXR0aW5ncyh0KSB7XG4gICAgICAgIGlmICh0aGlzLl9zZXR0aW5nc0Zyb3plbikgdGhyb3cgbmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQgYW5kIGl0cyBzZXR0aW5ncyBjYW4gbm8gbG9uZ2VyIGJlIGNoYW5nZWQuIFlvdSBjYW4gb25seSBtb2RpZnkgc2V0dGluZ3MgYmVmb3JlIGNhbGxpbmcgYW55IG90aGVyIG1ldGhvZHMgb24gYSBGaXJlc3RvcmUgb2JqZWN0LlwiKTtcbiAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBuZXcgZmModCksIHZvaWQgMCAhPT0gdC5jcmVkZW50aWFscyAmJiAodGhpcy5fYXV0aENyZWRlbnRpYWxzID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKCF0KSByZXR1cm4gbmV3IHo7XG4gICAgICAgICAgICBzd2l0Y2ggKHQudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiZ2FwaVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNsaWVudDtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyByZWFsbHkgaXMgYSBHYXBpIGNsaWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFUoIShcIm9iamVjdFwiICE9IHR5cGVvZiBlIHx8IG51bGwgPT09IGUgfHwgIWUuYXV0aCB8fCAhZS5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkpKSwgXG4gICAgICAgICAgICAgICAgbmV3IFgoZSwgdC5zZXNzaW9uSW5kZXggfHwgXCIwXCIsIHQuaWFtVG9rZW4gfHwgbnVsbCk7XG5cbiAgICAgICAgICAgICAgY2FzZSBcInByb3ZpZGVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuY2xpZW50O1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIm1ha2VBdXRoQ3JlZGVudGlhbHNQcm92aWRlciBmYWlsZWQgZHVlIHRvIGludmFsaWQgY3JlZGVudGlhbCB0eXBlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHQuY3JlZGVudGlhbHMpKTtcbiAgICB9XG4gICAgX2dldFNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3M7XG4gICAgfVxuICAgIF9mcmVlemVTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzRnJvemVuID0gITAsIHRoaXMuX3NldHRpbmdzO1xuICAgIH1cbiAgICBfZGVsZXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGVybWluYXRlVGFzayB8fCAodGhpcy5fdGVybWluYXRlVGFzayA9IHRoaXMuX3Rlcm1pbmF0ZSgpKSwgdGhpcy5fdGVybWluYXRlVGFzaztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBGaXJlc3RvcmVgIGluc3RhbmNlLiAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhcHA6IHRoaXMuX2FwcCxcbiAgICAgICAgICAgIGRhdGFiYXNlSWQ6IHRoaXMuX2RhdGFiYXNlSWQsXG4gICAgICAgICAgICBzZXR0aW5nczogdGhpcy5fc2V0dGluZ3NcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGVybWluYXRlcyBhbGwgY29tcG9uZW50cyB1c2VkIGJ5IHRoaXMgY2xpZW50LiBTdWJjbGFzc2VzIGNhbiBvdmVycmlkZVxuICAgICAqIHRoaXMgbWV0aG9kIHRvIGNsZWFuIHVwIHRoZWlyIG93biBkZXBlbmRlbmNpZXMsIGJ1dCBtdXN0IGFsc28gY2FsbCB0aGlzXG4gICAgICogbWV0aG9kLlxuICAgICAqXG4gICAgICogT25seSBldmVyIGNhbGxlZCBvbmNlLlxuICAgICAqLyAgICBfdGVybWluYXRlKCkge1xuICAgICAgICAvKipcbiAqIFJlbW92ZXMgYWxsIGNvbXBvbmVudHMgYXNzb2NpYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBpbnN0YW5jZS4gTXVzdCBiZSBjYWxsZWRcbiAqIHdoZW4gdGhlIGBGaXJlc3RvcmVgIGluc3RhbmNlIGlzIHRlcm1pbmF0ZWQuXG4gKi9cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBpYy5nZXQodCk7XG4gICAgICAgICAgICBlICYmIChPKFwiQ29tcG9uZW50UHJvdmlkZXJcIiwgXCJSZW1vdmluZyBEYXRhc3RvcmVcIiksIGljLmRlbGV0ZSh0KSwgZS50ZXJtaW5hdGUoKSk7XG4gICAgICAgIH0odGhpcyksIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gX2ModCwgZSwgbiwgcyA9IHt9KSB7XG4gICAgdmFyIGk7XG4gICAgY29uc3QgciA9ICh0ID0gaGModCwgZGMpKS5fZ2V0U2V0dGluZ3MoKTtcbiAgICBpZiAoXCJmaXJlc3RvcmUuZ29vZ2xlYXBpcy5jb21cIiAhPT0gci5ob3N0ICYmIHIuaG9zdCAhPT0gZSAmJiAkKFwiSG9zdCBoYXMgYmVlbiBzZXQgaW4gYm90aCBzZXR0aW5ncygpIGFuZCB1c2VFbXVsYXRvcigpLCBlbXVsYXRvciBob3N0IHdpbGwgYmUgdXNlZFwiKSwgXG4gICAgdC5fc2V0U2V0dGluZ3MoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCByKSwge1xuICAgICAgICBob3N0OiBgJHtlfToke259YCxcbiAgICAgICAgc3NsOiAhMVxuICAgIH0pKSwgcy5tb2NrVXNlclRva2VuKSB7XG4gICAgICAgIGxldCBlLCBuO1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5tb2NrVXNlclRva2VuKSBlID0gcy5tb2NrVXNlclRva2VuLCBuID0gQy5NT0NLX1VTRVI7IGVsc2Uge1xuICAgICAgICAgICAgLy8gTGV0IGNyZWF0ZU1vY2tVc2VyVG9rZW4gdmFsaWRhdGUgZmlyc3QgKGNhdGNoZXMgY29tbW9uIG1pc3Rha2VzIGxpa2VcbiAgICAgICAgICAgIC8vIGludmFsaWQgZmllbGQgXCJ1aWRcIiBhbmQgbWlzc2luZyBmaWVsZCBcInN1YlwiIC8gXCJ1c2VyX2lkXCIuKVxuICAgICAgICAgICAgZSA9IGNyZWF0ZU1vY2tVc2VyVG9rZW4ocy5tb2NrVXNlclRva2VuLCBudWxsID09PSAoaSA9IHQuX2FwcCkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5vcHRpb25zLnByb2plY3RJZCk7XG4gICAgICAgICAgICBjb25zdCByID0gcy5tb2NrVXNlclRva2VuLnN1YiB8fCBzLm1vY2tVc2VyVG9rZW4udXNlcl9pZDtcbiAgICAgICAgICAgIGlmICghcikgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIm1vY2tVc2VyVG9rZW4gbXVzdCBjb250YWluICdzdWInIG9yICd1c2VyX2lkJyBmaWVsZCFcIik7XG4gICAgICAgICAgICBuID0gbmV3IEMocik7XG4gICAgICAgIH1cbiAgICAgICAgdC5fYXV0aENyZWRlbnRpYWxzID0gbmV3IEgobmV3IFcoZSwgbikpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBgRG9jdW1lbnRSZWZlcmVuY2VgIHJlZmVycyB0byBhIGRvY3VtZW50IGxvY2F0aW9uIGluIGEgRmlyZXN0b3JlIGRhdGFiYXNlXG4gKiBhbmQgY2FuIGJlIHVzZWQgdG8gd3JpdGUsIHJlYWQsIG9yIGxpc3RlbiB0byB0aGUgbG9jYXRpb24uIFRoZSBkb2N1bWVudCBhdFxuICogdGhlIHJlZmVyZW5jZWQgbG9jYXRpb24gbWF5IG9yIG1heSBub3QgZXhpc3QuXG4gKi8gY2xhc3Mgd2Mge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogSWYgcHJvdmlkZWQsIHRoZSBgRmlyZXN0b3JlRGF0YUNvbnZlcnRlcmAgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmNvbnZlcnRlciA9IGUsIHRoaXMuX2tleSA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImRvY3VtZW50XCIsIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgZ2V0IF9wYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBkb2N1bWVudCdzIGlkZW50aWZpZXIgd2l0aGluIGl0cyBjb2xsZWN0aW9uLlxuICAgICAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgZG9jdW1lbnQgKHJlbGF0aXZlXG4gICAgICogdG8gdGhlIHJvb3Qgb2YgdGhlIGRhdGFiYXNlKS5cbiAgICAgKi8gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGJlbG9uZ3MgdG8uXG4gICAgICovICAgIGdldCBwYXJlbnQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgZ2ModGhpcy5maXJlc3RvcmUsIHRoaXMuY29udmVydGVyLCB0aGlzLl9rZXkucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB3Yyh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fa2V5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlgIHJlZmVycyB0byBhIHF1ZXJ5IHdoaWNoIHlvdSBjYW4gcmVhZCBvciBsaXN0ZW4gdG8uIFlvdSBjYW4gYWxzb1xuICogY29uc3RydWN0IHJlZmluZWQgYFF1ZXJ5YCBvYmplY3RzIGJ5IGFkZGluZyBmaWx0ZXJzIGFuZCBvcmRlcmluZy5cbiAqLyBjbGFzcyBtYyB7XG4gICAgLy8gVGhpcyBpcyB0aGUgbGl0ZSB2ZXJzaW9uIG9mIHRoZSBRdWVyeSBjbGFzcyBpbiB0aGUgbWFpbiBTREsuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogSWYgcHJvdmlkZWQsIHRoZSBgRmlyZXN0b3JlRGF0YUNvbnZlcnRlcmAgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmNvbnZlcnRlciA9IGUsIHRoaXMuX3F1ZXJ5ID0gbiwgXG4gICAgICAgIC8qKiBUaGUgdHlwZSBvZiB0aGlzIEZpcmVzdG9yZSByZWZlcmVuY2UuICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwicXVlcnlcIiwgdGhpcy5maXJlc3RvcmUgPSB0O1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBtYyh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcXVlcnkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGBDb2xsZWN0aW9uUmVmZXJlbmNlYCBvYmplY3QgY2FuIGJlIHVzZWQgZm9yIGFkZGluZyBkb2N1bWVudHMsIGdldHRpbmdcbiAqIGRvY3VtZW50IHJlZmVyZW5jZXMsIGFuZCBxdWVyeWluZyBmb3IgZG9jdW1lbnRzICh1c2luZyB7QGxpbmsgcXVlcnl9KS5cbiAqLyBjbGFzcyBnYyBleHRlbmRzIG1jIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIodCwgZSwgS2UobikpLCB0aGlzLl9wYXRoID0gbiwgXG4gICAgICAgIC8qKiBUaGUgdHlwZSBvZiB0aGlzIEZpcmVzdG9yZSByZWZlcmVuY2UuICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiY29sbGVjdGlvblwiO1xuICAgIH1cbiAgICAvKiogVGhlIGNvbGxlY3Rpb24ncyBpZGVudGlmaWVyLiAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9xdWVyeS5wYXRoLmxhc3RTZWdtZW50KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgcGF0aCBvZiB0aGUgcmVmZXJlbmNlZCBjb2xsZWN0aW9uIChyZWxhdGl2ZVxuICAgICAqIHRvIHRoZSByb290IG9mIHRoZSBkYXRhYmFzZSkuXG4gICAgICovICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIGNvbnRhaW5pbmcgYERvY3VtZW50UmVmZXJlbmNlYCBpZiB0aGlzIGlzIGFcbiAgICAgKiBzdWJjb2xsZWN0aW9uLiBJZiB0aGlzIGlzbid0IGEgc3ViY29sbGVjdGlvbiwgdGhlIHJlZmVyZW5jZSBpcyBudWxsLlxuICAgICAqLyAgICBnZXQgcGFyZW50KCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5fcGF0aC5wb3BMYXN0KCk7XG4gICAgICAgIHJldHVybiB0LmlzRW1wdHkoKSA/IG51bGwgOiBuZXcgd2ModGhpcy5maXJlc3RvcmUsIFxuICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIG5ldyB4dCh0KSk7XG4gICAgfVxuICAgIHdpdGhDb252ZXJ0ZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IGdjKHRoaXMuZmlyZXN0b3JlLCB0LCB0aGlzLl9wYXRoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHljKHQsIGUsIC4uLm4pIHtcbiAgICBpZiAodCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgcmMoXCJjb2xsZWN0aW9uXCIsIFwicGF0aFwiLCBlKSwgdCBpbnN0YW5jZW9mIGRjKSB7XG4gICAgICAgIGNvbnN0IHMgPSBfdC5mcm9tU3RyaW5nKGUsIC4uLm4pO1xuICAgICAgICByZXR1cm4gYWMocyksIG5ldyBnYyh0LCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIHMpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiB3YyB8fCB0IGluc3RhbmNlb2YgZ2MpKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiRXhwZWN0ZWQgZmlyc3QgYXJndW1lbnQgdG8gY29sbGVjdGlvbigpIHRvIGJlIGEgQ29sbGVjdGlvblJlZmVyZW5jZSwgYSBEb2N1bWVudFJlZmVyZW5jZSBvciBGaXJlYmFzZUZpcmVzdG9yZVwiKTtcbiAgICAgICAgY29uc3QgcyA9IHQuX3BhdGguY2hpbGQoX3QuZnJvbVN0cmluZyhlLCAuLi5uKSk7XG4gICAgICAgIHJldHVybiBhYyhzKSwgbmV3IGdjKHQuZmlyZXN0b3JlLCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBzKTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JlbGl0ZSk6IENvbnNpZGVyIHVzaW5nIEVycm9yRmFjdG9yeSAtXG4vLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2Jsb2IvMDEzMWUxZi9wYWNrYWdlcy91dGlsL3NyYy9lcnJvcnMudHMjTDEwNlxuLyoqXG4gKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGBRdWVyeWAgaW5zdGFuY2UgdGhhdCBpbmNsdWRlcyBhbGwgZG9jdW1lbnRzIGluIHRoZVxuICogZGF0YWJhc2UgdGhhdCBhcmUgY29udGFpbmVkIGluIGEgY29sbGVjdGlvbiBvciBzdWJjb2xsZWN0aW9uIHdpdGggdGhlXG4gKiBnaXZlbiBgY29sbGVjdGlvbklkYC5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gQSByZWZlcmVuY2UgdG8gdGhlIHJvb3QgYEZpcmVzdG9yZWAgaW5zdGFuY2UuXG4gKiBAcGFyYW0gY29sbGVjdGlvbklkIC0gSWRlbnRpZmllcyB0aGUgY29sbGVjdGlvbnMgdG8gcXVlcnkgb3Zlci4gRXZlcnlcbiAqIGNvbGxlY3Rpb24gb3Igc3ViY29sbGVjdGlvbiB3aXRoIHRoaXMgSUQgYXMgdGhlIGxhc3Qgc2VnbWVudCBvZiBpdHMgcGF0aFxuICogd2lsbCBiZSBpbmNsdWRlZC4gQ2Fubm90IGNvbnRhaW4gYSBzbGFzaC5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIGBRdWVyeWAuXG4gKi8gZnVuY3Rpb24gcGModCwgZSkge1xuICAgIGlmICh0ID0gaGModCwgZGMpLCByYyhcImNvbGxlY3Rpb25Hcm91cFwiLCBcImNvbGxlY3Rpb24gaWRcIiwgZSksIGUuaW5kZXhPZihcIi9cIikgPj0gMCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBjb2xsZWN0aW9uIElEICcke2V9JyBwYXNzZWQgdG8gZnVuY3Rpb24gY29sbGVjdGlvbkdyb3VwKCkuIENvbGxlY3Rpb24gSURzIG11c3Qgbm90IGNvbnRhaW4gJy8nLmApO1xuICAgIHJldHVybiBuZXcgbWModCwgXG4gICAgLyogY29udmVydGVyPSAqLyBudWxsLCBcbiAgICAvKipcbiAqIENyZWF0ZXMgYSBuZXcgUXVlcnkgZm9yIGEgY29sbGVjdGlvbiBncm91cCBxdWVyeSB0aGF0IG1hdGNoZXMgYWxsIGRvY3VtZW50c1xuICogd2l0aGluIHRoZSBwcm92aWRlZCBjb2xsZWN0aW9uIGdyb3VwLlxuICovXG4gICAgZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IFVlKF90LmVtcHR5UGF0aCgpLCB0KTtcbiAgICB9KGUpKTtcbn1cblxuZnVuY3Rpb24gSWModCwgZSwgLi4ubikge1xuICAgIGlmICh0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBcbiAgICAvLyBXZSBhbGxvdyBvbWlzc2lvbiBvZiAncGF0aFN0cmluZycgYnV0IGV4cGxpY2l0bHkgcHJvaGliaXQgcGFzc2luZyBpbiBib3RoXG4gICAgLy8gJ3VuZGVmaW5lZCcgYW5kICdudWxsJy5cbiAgICAxID09PSBhcmd1bWVudHMubGVuZ3RoICYmIChlID0gaXQuUigpKSwgcmMoXCJkb2NcIiwgXCJwYXRoXCIsIGUpLCB0IGluc3RhbmNlb2YgZGMpIHtcbiAgICAgICAgY29uc3QgcyA9IF90LmZyb21TdHJpbmcoZSwgLi4ubik7XG4gICAgICAgIHJldHVybiB1YyhzKSwgbmV3IHdjKHQsIFxuICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIG5ldyB4dChzKSk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIHdjIHx8IHQgaW5zdGFuY2VvZiBnYykpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCBzID0gdC5fcGF0aC5jaGlsZChfdC5mcm9tU3RyaW5nKGUsIC4uLm4pKTtcbiAgICAgICAgcmV0dXJuIHVjKHMpLCBuZXcgd2ModC5maXJlc3RvcmUsIHQgaW5zdGFuY2VvZiBnYyA/IHQuY29udmVydGVyIDogbnVsbCwgbmV3IHh0KHMpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCByZWZlcmVuY2VzIGFyZSBlcXVhbC5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgcmVmZXJlbmNlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlcyBwb2ludCB0byB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgc2FtZVxuICogRmlyZXN0b3JlIGRhdGFiYXNlLlxuICovIGZ1bmN0aW9uIFRjKHQsIGUpIHtcbiAgICByZXR1cm4gdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgKHQgaW5zdGFuY2VvZiB3YyB8fCB0IGluc3RhbmNlb2YgZ2MpICYmIChlIGluc3RhbmNlb2Ygd2MgfHwgZSBpbnN0YW5jZW9mIGdjKSAmJiAodC5maXJlc3RvcmUgPT09IGUuZmlyZXN0b3JlICYmIHQucGF0aCA9PT0gZS5wYXRoICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBxdWVyaWVzIHBvaW50IHRvIHRoZSBzYW1lIGNvbGxlY3Rpb24gYW5kIGFwcGx5XG4gKiB0aGUgc2FtZSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBgUXVlcnlgIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2VzIHBvaW50IHRvIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBzYW1lXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UuXG4gKi8gZnVuY3Rpb24gRWModCwgZSkge1xuICAgIHJldHVybiB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpLCB0IGluc3RhbmNlb2YgbWMgJiYgZSBpbnN0YW5jZW9mIG1jICYmICh0LmZpcmVzdG9yZSA9PT0gZS5maXJlc3RvcmUgJiYgWWUodC5fcXVlcnksIGUuX3F1ZXJ5KSAmJiB0LmNvbnZlcnRlciA9PT0gZS5jb252ZXJ0ZXIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBBYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHByb21pc2UgaW4gdGhlIHF1ZXVlLlxuICAgICAgICB0aGlzLkZhID0gUHJvbWlzZS5yZXNvbHZlKCksIFxuICAgICAgICAvLyBBIGxpc3Qgb2YgcmV0cnlhYmxlIG9wZXJhdGlvbnMuIFJldHJ5YWJsZSBvcGVyYXRpb25zIGFyZSBydW4gaW4gb3JkZXIgYW5kXG4gICAgICAgIC8vIHJldHJpZWQgd2l0aCBiYWNrb2ZmLlxuICAgICAgICB0aGlzLiRhID0gW10sIFxuICAgICAgICAvLyBJcyB0aGlzIEFzeW5jUXVldWUgYmVpbmcgc2h1dCBkb3duPyBPbmNlIGl0IGlzIHNldCB0byB0cnVlLCBpdCB3aWxsIG5vdFxuICAgICAgICAvLyBiZSBjaGFuZ2VkIGFnYWluLlxuICAgICAgICB0aGlzLkJhID0gITEsIFxuICAgICAgICAvLyBPcGVyYXRpb25zIHNjaGVkdWxlZCB0byBiZSBxdWV1ZWQgaW4gdGhlIGZ1dHVyZS4gT3BlcmF0aW9ucyBhcmVcbiAgICAgICAgLy8gYXV0b21hdGljYWxseSByZW1vdmVkIGFmdGVyIHRoZXkgYXJlIHJ1biBvciBjYW5jZWxlZC5cbiAgICAgICAgdGhpcy5MYSA9IFtdLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICB0aGlzLlVhID0gbnVsbCwgXG4gICAgICAgIC8vIEZsYWcgc2V0IHdoaWxlIHRoZXJlJ3MgYW4gb3V0c3RhbmRpbmcgQXN5bmNRdWV1ZSBvcGVyYXRpb24sIHVzZWQgZm9yXG4gICAgICAgIC8vIGFzc2VydGlvbiBzYW5pdHktY2hlY2tzLlxuICAgICAgICB0aGlzLnFhID0gITEsIFxuICAgICAgICAvLyBFbmFibGVkIGR1cmluZyBzaHV0ZG93biBvbiBTYWZhcmkgdG8gcHJldmVudCBmdXR1cmUgYWNjZXNzIHRvIEluZGV4ZWREQi5cbiAgICAgICAgdGhpcy5LYSA9ICExLCBcbiAgICAgICAgLy8gTGlzdCBvZiBUaW1lcklkcyB0byBmYXN0LWZvcndhcmQgZGVsYXlzIGZvci5cbiAgICAgICAgdGhpcy5HYSA9IFtdLCBcbiAgICAgICAgLy8gQmFja29mZiB0aW1lciB1c2VkIHRvIHNjaGVkdWxlIHJldHJpZXMgZm9yIHJldHJ5YWJsZSBvcGVyYXRpb25zXG4gICAgICAgIHRoaXMuTm8gPSBuZXcgV28odGhpcywgXCJhc3luY19xdWV1ZV9yZXRyeVwiIC8qIEFzeW5jUXVldWVSZXRyeSAqLyksIFxuICAgICAgICAvLyBWaXNpYmlsaXR5IGhhbmRsZXIgdGhhdCB0cmlnZ2VycyBhbiBpbW1lZGlhdGUgcmV0cnkgb2YgYWxsIHJldHJ5YWJsZVxuICAgICAgICAvLyBvcGVyYXRpb25zLiBNZWFudCB0byBzcGVlZCB1cCByZWNvdmVyeSB3aGVuIHdlIHJlZ2FpbiBmaWxlIHN5c3RlbSBhY2Nlc3NcbiAgICAgICAgLy8gYWZ0ZXIgcGFnZSBjb21lcyBpbnRvIGZvcmVncm91bmQuXG4gICAgICAgIHRoaXMuUWEgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gUW8oKTtcbiAgICAgICAgICAgIHQgJiYgTyhcIkFzeW5jUXVldWVcIiwgXCJWaXNpYmlsaXR5IHN0YXRlIGNoYW5nZWQgdG8gXCIgKyB0LnZpc2liaWxpdHlTdGF0ZSksIHRoaXMuTm8uUG8oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdCA9IFFvKCk7XG4gICAgICAgIHQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0LmFkZEV2ZW50TGlzdGVuZXIgJiYgdC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLlFhKTtcbiAgICB9XG4gICAgZ2V0IGlzU2h1dHRpbmdEb3duKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5CYTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyBvcGVyYXRpb24gdG8gdGhlIHF1ZXVlIHdpdGhvdXQgd2FpdGluZyBmb3IgaXQgdG8gY29tcGxldGUgKGkuZS5cbiAgICAgKiB3ZSBpZ25vcmUgdGhlIFByb21pc2UgcmVzdWx0KS5cbiAgICAgKi8gICAgZW5xdWV1ZUFuZEZvcmdldCh0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhpcy5lbnF1ZXVlKHQpO1xuICAgIH1cbiAgICBlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCh0KSB7XG4gICAgICAgIHRoaXMuamEoKSwgXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhpcy5XYSh0KTtcbiAgICB9XG4gICAgZW50ZXJSZXN0cmljdGVkTW9kZSh0KSB7XG4gICAgICAgIGlmICghdGhpcy5CYSkge1xuICAgICAgICAgICAgdGhpcy5CYSA9ICEwLCB0aGlzLkthID0gdCB8fCAhMTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBRbygpO1xuICAgICAgICAgICAgZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiBlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIHRoaXMuUWEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVucXVldWUodCkge1xuICAgICAgICBpZiAodGhpcy5qYSgpLCB0aGlzLkJhKSBcbiAgICAgICAgLy8gUmV0dXJuIGEgUHJvbWlzZSB3aGljaCBuZXZlciByZXNvbHZlcy5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCgoKSA9PiB7fSkpO1xuICAgICAgICAvLyBDcmVhdGUgYSBkZWZlcnJlZCBQcm9taXNlIHRoYXQgd2UgY2FuIHJldHVybiB0byB0aGUgY2FsbGVlLiBUaGlzXG4gICAgICAgIC8vIGFsbG93cyB1cyB0byByZXR1cm4gYSBcImhhbmdpbmcgUHJvbWlzZVwiIG9ubHkgdG8gdGhlIGNhbGxlZSBhbmQgc3RpbGxcbiAgICAgICAgLy8gYWR2YW5jZSB0aGUgcXVldWUgZXZlbiB3aGVuIHRoZSBvcGVyYXRpb24gaXMgbm90IHJ1bi5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0aGlzLldhKCgoKSA9PiB0aGlzLkJhICYmIHRoaXMuS2EgPyBQcm9taXNlLnJlc29sdmUoKSA6ICh0KCkudGhlbihlLnJlc29sdmUsIGUucmVqZWN0KSwgXG4gICAgICAgIGUucHJvbWlzZSkpKS50aGVuKCgoKSA9PiBlLnByb21pc2UpKTtcbiAgICB9XG4gICAgZW5xdWV1ZVJldHJ5YWJsZSh0KSB7XG4gICAgICAgIHRoaXMuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuJGEucHVzaCh0KSwgdGhpcy56YSgpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSdW5zIHRoZSBuZXh0IG9wZXJhdGlvbiBmcm9tIHRoZSByZXRyeWFibGUgcXVldWUuIElmIHRoZSBvcGVyYXRpb24gZmFpbHMsXG4gICAgICogcmVzY2hlZHVsZXMgd2l0aCBiYWNrb2ZmLlxuICAgICAqLyAgICBhc3luYyB6YSgpIHtcbiAgICAgICAgaWYgKDAgIT09IHRoaXMuJGEubGVuZ3RoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuJGFbMF0oKSwgdGhpcy4kYS5zaGlmdCgpLCB0aGlzLk5vLnJlc2V0KCk7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFBaSh0KSkgdGhyb3cgdDtcbiAvLyBGYWlsdXJlIHdpbGwgYmUgaGFuZGxlZCBieSBBc3luY1F1ZXVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE8oXCJBc3luY1F1ZXVlXCIsIFwiT3BlcmF0aW9uIGZhaWxlZCB3aXRoIHJldHJ5YWJsZSBlcnJvcjogXCIgKyB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuJGEubGVuZ3RoID4gMCAmJiBcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBhZGRpdGlvbmFsIG9wZXJhdGlvbnMsIHdlIHJlLXNjaGVkdWxlIGByZXRyeU5leHRPcCgpYC5cbiAgICAgICAgICAgIC8vIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIHJ1biByZXRyeWFibGUgb3BlcmF0aW9ucyB0aGF0IGZhaWxlZCBkdXJpbmdcbiAgICAgICAgICAgIC8vIHRoZWlyIGluaXRpYWwgYXR0ZW1wdCBzaW5jZSB3ZSBkb24ndCBrbm93IHdoZXRoZXIgdGhleSBhcmUgYWxyZWFkeVxuICAgICAgICAgICAgLy8gZW5xdWV1ZWQuIElmLCBmb3IgZXhhbXBsZSwgYG9wMWAsIGBvcDJgLCBgb3AzYCBhcmUgZW5xdWV1ZWQgYW5kIGBvcDFgXG4gICAgICAgICAgICAvLyBuZWVkcyB0byAgYmUgcmUtcnVuLCB3ZSB3aWxsIHJ1biBgb3AxYCwgYG9wMWAsIGBvcDJgIHVzaW5nIHRoZVxuICAgICAgICAgICAgLy8gYWxyZWFkeSBlbnF1ZXVlZCBjYWxscyB0byBgcmV0cnlOZXh0T3AoKWAuIGBvcDMoKWAgd2lsbCB0aGVuIHJ1biBpbiB0aGVcbiAgICAgICAgICAgIC8vIGNhbGwgc2NoZWR1bGVkIGhlcmUuXG4gICAgICAgICAgICAvLyBTaW5jZSBgYmFja29mZkFuZFJ1bigpYCBjYW5jZWxzIGFuIGV4aXN0aW5nIGJhY2tvZmYgYW5kIHNjaGVkdWxlcyBhXG4gICAgICAgICAgICAvLyBuZXcgYmFja29mZiBvbiBldmVyeSBjYWxsLCB0aGVyZSBpcyBvbmx5IGV2ZXIgYSBzaW5nbGUgYWRkaXRpb25hbFxuICAgICAgICAgICAgLy8gb3BlcmF0aW9uIGluIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgIHRoaXMuTm8uUm8oKCgpID0+IHRoaXMuemEoKSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFdhKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuRmEudGhlbigoKCkgPT4gKHRoaXMucWEgPSAhMCwgdCgpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuVWEgPSB0LCB0aGlzLnFhID0gITE7XG4gICAgICAgICAgICBjb25zdCBlID0gXG4gICAgICAgICAgICAvKipcbiAqIENocm9tZSBpbmNsdWRlcyBFcnJvci5tZXNzYWdlIGluIEVycm9yLnN0YWNrLiBPdGhlciBicm93c2VycyBkbyBub3QuXG4gKiBUaGlzIHJldHVybnMgZXhwZWN0ZWQgb3V0cHV0IG9mIG1lc3NhZ2UgKyBzdGFjayB3aGVuIGF2YWlsYWJsZS5cbiAqIEBwYXJhbSBlcnJvciAtIEVycm9yIG9yIEZpcmVzdG9yZUVycm9yXG4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQubWVzc2FnZSB8fCBcIlwiO1xuICAgICAgICAgICAgICAgIHQuc3RhY2sgJiYgKGUgPSB0LnN0YWNrLmluY2x1ZGVzKHQubWVzc2FnZSkgPyB0LnN0YWNrIDogdC5tZXNzYWdlICsgXCJcXG5cIiArIHQuc3RhY2spO1xuICAgICAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQpO1xuICAgICAgICAgICAgLy8gUmUtdGhyb3cgdGhlIGVycm9yIHNvIHRoYXQgdGhpcy50YWlsIGJlY29tZXMgYSByZWplY3RlZCBQcm9taXNlIGFuZFxuICAgICAgICAgICAgLy8gYWxsIGZ1cnRoZXIgYXR0ZW1wdHMgdG8gY2hhaW4gKHZpYSAudGhlbikgd2lsbCBqdXN0IHNob3J0LWNpcmN1aXRcbiAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gdGhlIHJlamVjdGVkIFByb21pc2UuXG4gICAgICAgICAgICB0aHJvdyBGKFwiSU5URVJOQUwgVU5IQU5ETEVEIEVSUk9SOiBcIiwgZSksIHQ7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+ICh0aGlzLnFhID0gITEsIHQpKSkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLkZhID0gZSwgZTtcbiAgICB9XG4gICAgZW5xdWV1ZUFmdGVyRGVsYXkodCwgZSwgbikge1xuICAgICAgICB0aGlzLmphKCksIFxuICAgICAgICAvLyBGYXN0LWZvcndhcmQgZGVsYXlzIGZvciB0aW1lcklkcyB0aGF0IGhhdmUgYmVlbiBvdmVycmlkZW4uXG4gICAgICAgIHRoaXMuR2EuaW5kZXhPZih0KSA+IC0xICYmIChlID0gMCk7XG4gICAgICAgIGNvbnN0IHMgPSB2dS5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCB0LCBlLCBuLCAodCA9PiB0aGlzLkhhKHQpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLkxhLnB1c2gocyksIHM7XG4gICAgfVxuICAgIGphKCkge1xuICAgICAgICB0aGlzLlVhICYmIEwoKTtcbiAgICB9XG4gICAgdmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpIHt9XG4gICAgLyoqXG4gICAgICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBxdWV1ZWQgdGFza3MgYXJlIGZpbmlzaGVkIGV4ZWN1dGluZy4gRGVsYXllZFxuICAgICAqIG9wZXJhdGlvbnMgYXJlIG5vdCBydW4uXG4gICAgICovICAgIGFzeW5jIEphKCkge1xuICAgICAgICAvLyBPcGVyYXRpb25zIGluIHRoZSBxdWV1ZSBwcmlvciB0byBkcmFpbmluZyBtYXkgaGF2ZSBlbnF1ZXVlZCBhZGRpdGlvbmFsXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIEtlZXAgZHJhaW5pbmcgdGhlIHF1ZXVlIHVudGlsIHRoZSB0YWlsIGlzIG5vIGxvbmdlciBhZHZhbmNlZCxcbiAgICAgICAgLy8gd2hpY2ggaW5kaWNhdGVzIHRoYXQgbm8gbW9yZSBuZXcgb3BlcmF0aW9ucyB3ZXJlIGVucXVldWVkIGFuZCB0aGF0IGFsbFxuICAgICAgICAvLyBvcGVyYXRpb25zIHdlcmUgZXhlY3V0ZWQuXG4gICAgICAgIGxldCB0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB0ID0gdGhpcy5GYSwgYXdhaXQgdDtcbiAgICAgICAgfSB3aGlsZSAodCAhPT0gdGhpcy5GYSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogRGV0ZXJtaW5lIGlmIGEgZGVsYXllZCBvcGVyYXRpb24gd2l0aCBhIHBhcnRpY3VsYXIgVGltZXJJZFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi8gICAgWWEodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5MYSkgaWYgKGUudGltZXJJZCA9PT0gdCkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogUnVucyBzb21lIG9yIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMgZWFybHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGFzdFRpbWVySWQgLSBEZWxheWVkIG9wZXJhdGlvbnMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGlzIFRpbWVySWRcbiAgICAgKiB3aWxsIGJlIGRyYWluZWQuIFBhc3MgVGltZXJJZC5BbGwgdG8gcnVuIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMuXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgb25jZSBhbGwgb3BlcmF0aW9ucyBoYXZlIGJlZW4gcnVuLlxuICAgICAqLyAgICBYYSh0KSB7XG4gICAgICAgIC8vIE5vdGUgdGhhdCBkcmFpbmluZyBtYXkgZ2VuZXJhdGUgbW9yZSBkZWxheWVkIG9wcywgc28gd2UgZG8gdGhhdCBmaXJzdC5cbiAgICAgICAgcmV0dXJuIHRoaXMuSmEoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBSdW4gb3BzIGluIHRoZSBzYW1lIG9yZGVyIHRoZXknZCBydW4gaWYgdGhleSByYW4gbmF0dXJhbGx5LlxuICAgICAgICAgICAgdGhpcy5MYS5zb3J0KCgodCwgZSkgPT4gdC50YXJnZXRUaW1lTXMgLSBlLnRhcmdldFRpbWVNcykpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuTGEpIGlmIChlLnNraXBEZWxheSgpLCBcImFsbFwiIC8qIEFsbCAqLyAhPT0gdCAmJiBlLnRpbWVySWQgPT09IHQpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuSmEoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFNraXAgYWxsIHN1YnNlcXVlbnQgZGVsYXlzIGZvciBhIHRpbWVyIGlkLlxuICAgICAqLyAgICBaYSh0KSB7XG4gICAgICAgIHRoaXMuR2EucHVzaCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovICAgIEhhKHQpIHtcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLkxhLmluZGV4T2YodCk7XG4gICAgICAgIHRoaXMuTGEuc3BsaWNlKGUsIDEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUmModCkge1xuICAgIC8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgYW5kIGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBvZiB0aGUgc3BlY2lmaWVkXG4gKiBtZXRob2RzLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIHQgfHwgbnVsbCA9PT0gdCkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gdDtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIGlmICh0IGluIG4gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBuW3RdKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFJlcHJlc2VudHMgdGhlIHRhc2sgb2YgbG9hZGluZyBhIEZpcmVzdG9yZSBidW5kbGUuIEl0IHByb3ZpZGVzIHByb2dyZXNzIG9mIGJ1bmRsZVxuICogbG9hZGluZywgYXMgd2VsbCBhcyB0YXNrIGNvbXBsZXRpb24gYW5kIGVycm9yIGV2ZW50cy5cbiAqXG4gKiBUaGUgQVBJIGlzIGNvbXBhdGlibGUgd2l0aCBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gKHQsIFsgXCJuZXh0XCIsIFwiZXJyb3JcIiwgXCJjb21wbGV0ZVwiIF0pO1xufVxuXG5jbGFzcyBiYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIgPSB7fSwgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlciA9IG5ldyBqLCB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB7XG4gICAgICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICAgICAgdG90YWxCeXRlczogMCxcbiAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiAwLFxuICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGZ1bmN0aW9ucyB0byBsaXN0ZW4gdG8gYnVuZGxlIGxvYWRpbmcgcHJvZ3Jlc3MgZXZlbnRzLlxuICAgICAqIEBwYXJhbSBuZXh0IC0gQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBwcm9ncmVzcyB1cGRhdGUgZnJvbSBidW5kbGUgbG9hZGluZy4gVHlwaWNhbGx5IGBuZXh0YCBjYWxscyBvY2N1clxuICAgICAqICAgZWFjaCB0aW1lIGEgRmlyZXN0b3JlIGRvY3VtZW50IGlzIGxvYWRlZCBmcm9tIHRoZSBidW5kbGUuXG4gICAgICogQHBhcmFtIGVycm9yIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy4gVGhlIHRhc2sgYWJvcnRzIGFmdGVyIHJlcG9ydGluZyB0aGVcbiAgICAgKiAgIGVycm9yLCBhbmQgdGhlcmUgc2hvdWxkIGJlIG5vIG1vcmUgdXBkYXRlcyBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSBjb21wbGV0ZSAtIENhbGxlZCB3aGVuIHRoZSBsb2FkaW5nIHRhc2sgaXMgY29tcGxldGUuXG4gICAgICovICAgIG9uUHJvZ3Jlc3ModCwgZSwgbikge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge1xuICAgICAgICAgICAgbmV4dDogdCxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgICAgY29tcGxldGU6IG5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4uY2F0Y2hgIGludGVyZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5wcm9taXNlLmNhdGNoKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPi50aGVuYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBDYWxsZWQgb24gdGhlIGNvbXBsZXRpb24gb2YgdGhlIGxvYWRpbmcgdGFzayB3aXRoIGEgZmluYWwgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHVwZGF0ZS5cbiAgICAgKiAgIFRoZSB1cGRhdGUgd2lsbCBhbHdheXMgaGF2ZSBpdHMgYHRhc2tTdGF0ZWAgc2V0IHRvIGBcIlN1Y2Nlc3NcImAuXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBDYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGJ1bmRsZSBsb2FkaW5nLlxuICAgICAqLyAgICB0aGVuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS50aGVuKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGNvbXBsZXRlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovICAgIF9jb21wbGV0ZVdpdGgodCkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyh0KSwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmNvbXBsZXRlKCksIFxuICAgICAgICB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlc29sdmUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIGFsbCBvYnNlcnZlcnMgdGhhdCBidW5kbGUgbG9hZGluZyBoYXMgZmFpbGVkLCB3aXRoIGEgcHJvdmlkZWRcbiAgICAgKiBgRXJyb3JgIGFzIHRoZSByZWFzb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfZmFpbFdpdGgodCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MudGFza1N0YXRlID0gXCJFcnJvclwiLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHRoaXMuX2xhc3RQcm9ncmVzcyksIFxuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuZXJyb3IodCksIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucmVqZWN0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhIHByb2dyZXNzIHVwZGF0ZSBvZiBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBwcm9ncmVzcyAtIFRoZSBuZXcgcHJvZ3Jlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfdXBkYXRlUHJvZ3Jlc3ModCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB0LCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBET01FeGNlcHRpb24gZXJyb3IgY29kZSBjb25zdGFudHMuICovIGNvbnN0IFBjID0gLTE7XG5cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi9cbmNsYXNzIFZjIGV4dGVuZHMgZGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcih0LCBlLCBuKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSB7QGxpbmsgRmlyZXN0b3JlfSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlXCIsIHRoaXMuX3F1ZXVlID0gbmV3IEFjLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwibmFtZVwiIGluIHQgPyB0Lm5hbWUgOiBcIltERUZBVUxUXVwiO1xuICAgIH1cbiAgICBfdGVybWluYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50IHx8IFxuICAgICAgICAvLyBUaGUgY2xpZW50IG11c3QgYmUgaW5pdGlhbGl6ZWQgdG8gZW5zdXJlIHRoYXQgYWxsIHN1YnNlcXVlbnQgQVBJXG4gICAgICAgIC8vIHVzYWdlIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICAgIENjKHRoaXMpLCB0aGlzLl9maXJlc3RvcmVDbGllbnQudGVybWluYXRlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHtAbGluayBGaXJlc3RvcmV9IHdpdGggdGhlIHByb3ZpZGVkIHNldHRpbmdzLlxuICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb24sIGluY2x1ZGluZ1xuICoge0BsaW5rIGdldEZpcmVzdG9yZX0uIElmIHRoZSBjdXN0b20gc2V0dGluZ3MgYXJlIGVtcHR5LCB0aGlzIGZ1bmN0aW9uIGlzXG4gKiBlcXVpdmFsZW50IHRvIGNhbGxpbmcge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gd2l0aCB3aGljaCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogYmUgYXNzb2NpYXRlZC5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIEEgc2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKiBAcmV0dXJucyBBIG5ld2x5IGluaXRpYWxpemVkIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICovIGZ1bmN0aW9uIHZjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gX2dldFByb3ZpZGVyKHQsIFwiZmlyZXN0b3JlXCIpO1xuICAgIGlmIChuLmlzSW5pdGlhbGl6ZWQoKSkge1xuICAgICAgICBjb25zdCB0ID0gbi5nZXRJbW1lZGlhdGUoKSwgcyA9IG4uZ2V0T3B0aW9ucygpO1xuICAgICAgICBpZiAoZGVlcEVxdWFsKHMsIGUpKSByZXR1cm4gdDtcbiAgICAgICAgdGhyb3cgbmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBcImluaXRpYWxpemVGaXJlc3RvcmUoKSBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZCB3aXRoIGRpZmZlcmVudCBvcHRpb25zLiBUbyBhdm9pZCB0aGlzIGVycm9yLCBjYWxsIGluaXRpYWxpemVGaXJlc3RvcmUoKSB3aXRoIHRoZSBzYW1lIG9wdGlvbnMgYXMgd2hlbiBpdCB3YXMgb3JpZ2luYWxseSBjYWxsZWQsIG9yIGNhbGwgZ2V0RmlyZXN0b3JlKCkgdG8gcmV0dXJuIHRoZSBhbHJlYWR5IGluaXRpYWxpemVkIGluc3RhbmNlLlwiKTtcbiAgICB9XG4gICAgaWYgKHZvaWQgMCAhPT0gZS5jYWNoZVNpemVCeXRlcyAmJiAtMSAhPT0gZS5jYWNoZVNpemVCeXRlcyAmJiBlLmNhY2hlU2l6ZUJ5dGVzIDwgMTA0ODU3NikgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcImNhY2hlU2l6ZUJ5dGVzIG11c3QgYmUgYXQgbGVhc3QgMTA0ODU3NlwiKTtcbiAgICByZXR1cm4gbi5pbml0aWFsaXplKHtcbiAgICAgICAgb3B0aW9uczogZVxuICAgIH0pO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGV4aXN0aW5nIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRoYXQgaXMgYXNzb2NpYXRlZCB3aXRoIHRoZVxuICogcHJvdmlkZWQge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9LiBJZiBubyBpbnN0YW5jZSBleGlzdHMsIGluaXRpYWxpemVzIGEgbmV3XG4gKiBpbnN0YW5jZSB3aXRoIGRlZmF1bHQgc2V0dGluZ3MuXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gaW5zdGFuY2UgdGhhdCB0aGUgcmV0dXJuZWQge0BsaW5rIEZpcmVzdG9yZX1cbiAqIGluc3RhbmNlIGlzIGFzc29jaWF0ZWQgd2l0aC5cbiAqIEByZXR1cm5zIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSBvZiB0aGUgcHJvdmlkZWQgYXBwLlxuICovIGZ1bmN0aW9uIFNjKGUgPSBnZXRBcHAoKSkge1xuICAgIHJldHVybiBfZ2V0UHJvdmlkZXIoZSwgXCJmaXJlc3RvcmVcIikuZ2V0SW1tZWRpYXRlKCk7XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gRGModCkge1xuICAgIHJldHVybiB0Ll9maXJlc3RvcmVDbGllbnQgfHwgQ2ModCksIHQuX2ZpcmVzdG9yZUNsaWVudC52ZXJpZnlOb3RUZXJtaW5hdGVkKCksIHQuX2ZpcmVzdG9yZUNsaWVudDtcbn1cblxuZnVuY3Rpb24gQ2ModCkge1xuICAgIHZhciBlO1xuICAgIGNvbnN0IG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gbmV3IFZ0KHQsIGUsIG4sIHMuaG9zdCwgcy5zc2wsIHMuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIHMudXNlRmV0Y2hTdHJlYW1zKTtcbiAgICB9KHQuX2RhdGFiYXNlSWQsIChudWxsID09PSAoZSA9IHQuX2FwcCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5vcHRpb25zLmFwcElkKSB8fCBcIlwiLCB0Ll9wZXJzaXN0ZW5jZUtleSwgbik7XG4gICAgdC5fZmlyZXN0b3JlQ2xpZW50ID0gbmV3ICRhKHQuX2F1dGhDcmVkZW50aWFscywgdC5fYXBwQ2hlY2tDcmVkZW50aWFscywgdC5fcXVldWUsIHMpO1xufVxuXG4vKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLlxuICpcbiAqIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb25zIChvdGhlciB0aGFuXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUZpcmVzdG9yZX0sIHtAbGluayBnZXRGaXJlc3RvcmV9IG9yXG4gKiB7QGxpbmsgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZX0uXG4gKlxuICogSWYgdGhpcyBmYWlscywgYGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlIGl0XG4gKiByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIuXG4gKiAgICogdW5pbXBsZW1lbnRlZDogVGhlIGJyb3dzZXIgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIG9mZmxpbmVcbiAqICAgICBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGVuYWJsZSBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyAtIE9wdGlvbmFsIHNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmVcbiAqIHBlcnNpc3RlbmNlLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50IHN0b3JhZ2UuXG4gKi8gZnVuY3Rpb24geGModCwgZSkge1xuICAgIHFjKHQgPSBoYyh0LCBWYykpO1xuICAgIGNvbnN0IG4gPSBEYyh0KSwgcyA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIGkgPSBuZXcgeGE7XG4gICAgcmV0dXJuIGtjKG4sIGksIG5ldyBEYShpLCBzLmNhY2hlU2l6ZUJ5dGVzLCBudWxsID09IGUgPyB2b2lkIDAgOiBlLmZvcmNlT3duZXJzaGlwKSk7XG59XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gZW5hYmxlIG11bHRpLXRhYiBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLiBJZiBlbmFibGVkXG4gKiBhY3Jvc3MgYWxsIHRhYnMsIGFsbCBvcGVyYXRpb25zIHNoYXJlIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZSwgaW5jbHVkaW5nXG4gKiBzaGFyZWQgZXhlY3V0aW9uIG9mIHF1ZXJpZXMgYW5kIGxhdGVuY3ktY29tcGVuc2F0ZWQgbG9jYWwgZG9jdW1lbnQgdXBkYXRlc1xuICogYWNyb3NzIGFsbCBjb25uZWN0ZWQgaW5zdGFuY2VzLlxuICpcbiAqIElmIHRoaXMgZmFpbHMsIGBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlXG4gKiBpdCByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIgYW5kXG4gKiAgICAgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkLlxuICogICAqIHVuaW1wbGVtZW50ZWQ6IFRoZSBicm93c2VyIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBvZmZsaW5lXG4gKiAgICAgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24uXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBlbmFibGUgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50XG4gKiBzdG9yYWdlLlxuICovIGZ1bmN0aW9uIE5jKHQpIHtcbiAgICBxYyh0ID0gaGModCwgVmMpKTtcbiAgICBjb25zdCBlID0gRGModCksIG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gbmV3IHhhO1xuICAgIHJldHVybiBrYyhlLCBzLCBuZXcgQ2Eocywgbi5jYWNoZVNpemVCeXRlcykpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBib3RoIHRoZSBgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyYCBhbmQgYE9ubGluZUNvbXBvbmVudFByb3ZpZGVyYC5cbiAqIElmIHRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhIHJlY292ZXJhYmxlIGVycm9yIChzZWVcbiAqIGBjYW5SZWNvdmVyRnJvbUluZGV4ZWREYkVycm9yKClgIGJlbG93KSwgdGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVqZWN0ZWRcbiAqIGJ1dCB0aGUgY2xpZW50IHJlbWFpbnMgdXNhYmxlLlxuICovIGZ1bmN0aW9uIGtjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBCYSh0LCBuKSwgYXdhaXQgTGEodCwgZSksIHMucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBpZiAoIVxuICAgICAgICAgICAgLyoqXG4gKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcbiAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiRmlyZWJhc2VFcnJvclwiID09PSB0Lm5hbWUpIHJldHVybiB0LmNvZGUgPT09IEcuRkFJTEVEX1BSRUNPTkRJVElPTiB8fCB0LmNvZGUgPT09IEcuVU5JTVBMRU1FTlRFRDtcbiAgICAgICAgICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgRE9NRXhjZXB0aW9uICYmIHQgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIFxuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBhIGZldyBrbm93biBjaXJjdW1zdGFuY2VzIHdoZXJlIHdlIGNhbiBvcGVuIEluZGV4ZWREYiBidXRcbiAgICAgICAgICAgICAgICAvLyB0cnlpbmcgdG8gcmVhZC93cml0ZSB3aWxsIGZhaWwgKGUuZy4gcXVvdGEgZXhjZWVkZWQpLiBGb3JcbiAgICAgICAgICAgICAgICAvLyB3ZWxsLXVuZGVyc3Rvb2QgY2FzZXMsIHdlIGF0dGVtcHQgdG8gZGV0ZWN0IHRoZXNlIGFuZCB0aGVuIGdyYWNlZnVsbHlcbiAgICAgICAgICAgICAgICAvLyBmYWxsIGJhY2sgdG8gbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICAgICAgICAgIC8vIE5PVEU6IFJhdGhlciB0aGFuIGNvbnRpbnVlIHRvIGFkZCB0byB0aGlzIGxpc3QsIHdlIGNvdWxkIGRlY2lkZSB0b1xuICAgICAgICAgICAgICAgIC8vIGFsd2F5cyBmYWxsIGJhY2ssIHdpdGggdGhlIHJpc2sgdGhhdCB3ZSBtaWdodCBhY2NpZGVudGFsbHkgaGlkZSBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyByZXByZXNlbnRpbmcgYWN0dWFsIFNESyBidWdzLlxuICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgaXMgb3V0IG9mIHF1b3RhIHdlIGNvdWxkIGdldCBlaXRoZXIgcXVvdGEgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAvLyBvciBhbiBhYm9ydGVkIGVycm9yIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBlcnJvciBoYXBwZW5lZCBkdXJpbmdcbiAgICAgICAgICAgICAgICAvLyBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICAgICAgICAgIHJldHVybiAyMiA9PT0gdC5jb2RlIHx8IDIwID09PSB0LmNvZGUgfHwgXG4gICAgICAgICAgICAgICAgLy8gRmlyZWZveCBQcml2YXRlIEJyb3dzaW5nIG1vZGUgZGlzYWJsZXMgSW5kZXhlZERiIGFuZCByZXR1cm5zXG4gICAgICAgICAgICAgICAgLy8gSU5WQUxJRF9TVEFURSBmb3IgYW55IHVzYWdlLlxuICAgICAgICAgICAgICAgIDExID09PSB0LmNvZGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBDbGVhcnMgdGhlIHBlcnNpc3RlbnQgc3RvcmFnZS4gVGhpcyBpbmNsdWRlcyBwZW5kaW5nIHdyaXRlcyBhbmQgY2FjaGVkXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgd2hpbGUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGlzIG5vdCBzdGFydGVkIChhZnRlciB0aGUgYXBwIGlzXG4gKiB0ZXJtaW5hdGVkIG9yIHdoZW4gdGhlIGFwcCBpcyBmaXJzdCBpbml0aWFsaXplZCkuIE9uIHN0YXJ0dXAsIHRoaXMgZnVuY3Rpb25cbiAqIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW4ge0BsaW5rXG4gKiBpbml0aWFsaXplRmlyZXN0b3JlfSBvciB7QGxpbmsgZ2V0RmlyZXN0b3JlfSkpLiBJZiB0aGUge0BsaW5rIEZpcmVzdG9yZX1cbiAqIGluc3RhbmNlIGlzIHN0aWxsIHJ1bm5pbmcsIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgZXJyb3IgY29kZVxuICogb2YgYGZhaWxlZC1wcmVjb25kaXRpb25gLlxuICpcbiAqIE5vdGU6IGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIGlzIHByaW1hcmlseSBpbnRlbmRlZCB0byBoZWxwIHdyaXRlXG4gKiByZWxpYWJsZSB0ZXN0cyB0aGF0IHVzZSBDbG91ZCBGaXJlc3RvcmUuIEl0IHVzZXMgYW4gZWZmaWNpZW50IG1lY2hhbmlzbSBmb3JcbiAqIGRyb3BwaW5nIGV4aXN0aW5nIGRhdGEgYnV0IGRvZXMgbm90IGF0dGVtcHQgdG8gc2VjdXJlbHkgb3ZlcndyaXRlIG9yXG4gKiBvdGhlcndpc2UgbWFrZSBjYWNoZWQgZGF0YSB1bnJlY292ZXJhYmxlLiBGb3IgYXBwbGljYXRpb25zIHRoYXQgYXJlIHNlbnNpdGl2ZVxuICogdG8gdGhlIGRpc2Nsb3N1cmUgb2YgY2FjaGVkIGRhdGEgaW4gYmV0d2VlbiB1c2VyIHNlc3Npb25zLCB3ZSBzdHJvbmdseVxuICogcmVjb21tZW5kIG5vdCBlbmFibGluZyBwZXJzaXN0ZW5jZSBhdCBhbGwuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBjbGVhciBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIHBlcnNpc3RlbnQgc3RvcmFnZSBpc1xuICogY2xlYXJlZC4gT3RoZXJ3aXNlLCB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCB3aXRoIGFuIGVycm9yLlxuICovICh0KSkgdGhyb3cgdDtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkVycm9yIGVuYWJsaW5nIG9mZmxpbmUgcGVyc2lzdGVuY2UuIEZhbGxpbmcgYmFjayB0byBwZXJzaXN0ZW5jZSBkaXNhYmxlZDogXCIgKyB0KSwgXG4gICAgICAgICAgICBzLnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH0pKS50aGVuKCgoKSA9PiBzLnByb21pc2UpKTtcbn1cblxuZnVuY3Rpb24gTWModCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCAmJiAhdC5fdGVybWluYXRlZCkgdGhyb3cgbmV3IFEoRy5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlBlcnNpc3RlbmNlIGNhbiBvbmx5IGJlIGNsZWFyZWQgYmVmb3JlIGEgRmlyZXN0b3JlIGluc3RhbmNlIGlzIGluaXRpYWxpemVkIG9yIGFmdGVyIGl0IGlzIHRlcm1pbmF0ZWQuXCIpO1xuICAgIGNvbnN0IGUgPSBuZXcgajtcbiAgICByZXR1cm4gdC5fcXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUlpLnZ0KCkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCArIFwibWFpblwiO1xuICAgICAgICAgICAgICAgIGF3YWl0IElpLmRlbGV0ZShlKTtcbiAgICAgICAgICAgIH0oWXIodC5fZGF0YWJhc2VJZCwgdC5fcGVyc2lzdGVuY2VLZXkpKSwgZS5yZXNvbHZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGUucmVqZWN0KHQpO1xuICAgICAgICB9XG4gICAgfSkpLCBlLnByb21pc2U7XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBmb3IgdGhlIGFjdGl2ZSB1c2VyIGhhdmUgYmVlblxuICogYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kLlxuICpcbiAqIFRoZSByZXR1cm5lZCBwcm9taXNlIHJlc29sdmVzIGltbWVkaWF0ZWx5IGlmIHRoZXJlIGFyZSBubyBvdXRzdGFuZGluZyB3cml0ZXMuXG4gKiBPdGhlcndpc2UsIHRoZSBwcm9taXNlIHdhaXRzIGZvciBhbGwgcHJldmlvdXNseSBpc3N1ZWQgd3JpdGVzIChpbmNsdWRpbmdcbiAqIHRob3NlIHdyaXR0ZW4gaW4gYSBwcmV2aW91cyBhcHAgc2Vzc2lvbiksIGJ1dCBpdCBkb2VzIG5vdCB3YWl0IGZvciB3cml0ZXNcbiAqIHRoYXQgd2VyZSBhZGRlZCBhZnRlciB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byB3YWl0IGZvclxuICogYWRkaXRpb25hbCB3cml0ZXMsIGNhbGwgYHdhaXRGb3JQZW5kaW5nV3JpdGVzKClgIGFnYWluLlxuICpcbiAqIEFueSBvdXRzdGFuZGluZyBgd2FpdEZvclBlbmRpbmdXcml0ZXMoKWAgcHJvbWlzZXMgYXJlIHJlamVjdGVkIGR1cmluZyB1c2VyXG4gKiBjaGFuZ2VzLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHdoaWNoIHJlc29sdmVzIHdoZW4gYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBoYXZlIGJlZW5cbiAqIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZC5cbiAqLyBmdW5jdGlvbiBPYyh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBqO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IG9hKGF3YWl0IGphKHQpLCBlKSkpLCBlLnByb21pc2U7XG4gICAgfShEYyh0ID0gaGModCwgVmMpKSk7XG59XG5cbi8qKlxuICogUmUtZW5hYmxlcyB1c2Ugb2YgdGhlIG5ldHdvcmsgZm9yIHRoaXMge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgYWZ0ZXIgYSBwcmlvclxuICogY2FsbCB0byB7QGxpbmsgZGlzYWJsZU5ldHdvcmt9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBlbmFibGVkLlxuICovIGZ1bmN0aW9uIEZjKHQpIHtcbiAgICByZXR1cm4gemEoRGModCA9IGhjKHQsIFZjKSkpO1xufVxuXG4vKipcbiAqIERpc2FibGVzIG5ldHdvcmsgdXNhZ2UgZm9yIHRoaXMgaW5zdGFuY2UuIEl0IGNhbiBiZSByZS1lbmFibGVkIHZpYSB7QGxpbmtcbiAqIGVuYWJsZU5ldHdvcmt9LiBXaGlsZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCwgYW55IHNuYXBzaG90IGxpc3RlbmVycyxcbiAqIGBnZXREb2MoKWAgb3IgYGdldERvY3MoKWAgY2FsbHMgd2lsbCByZXR1cm4gcmVzdWx0cyBmcm9tIGNhY2hlLCBhbmQgYW55IHdyaXRlXG4gKiBvcGVyYXRpb25zIHdpbGwgYmUgcXVldWVkIHVudGlsIHRoZSBuZXR3b3JrIGlzIHJlc3RvcmVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBkaXNhYmxlZC5cbiAqLyBmdW5jdGlvbiAkYyh0KSB7XG4gICAgcmV0dXJuIEhhKERjKHQgPSBoYyh0LCBWYykpKTtcbn1cblxuLyoqXG4gKiBUZXJtaW5hdGVzIHRoZSBwcm92aWRlZCB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZS5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIGB0ZXJtaW5hdGUoKWAgb25seSB0aGUgYGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgZnVuY3Rpb25cbiAqIG1heSBiZSB1c2VkLiBBbnkgb3RoZXIgZnVuY3Rpb24gd2lsbCB0aHJvdyBhIGBGaXJlc3RvcmVFcnJvcmAuXG4gKlxuICogVG8gcmVzdGFydCBhZnRlciB0ZXJtaW5hdGlvbiwgY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEZpcmViYXNlRmlyZXN0b3JlIHdpdGhcbiAqIHtAbGluayBnZXRGaXJlc3RvcmV9LlxuICpcbiAqIFRlcm1pbmF0aW9uIGRvZXMgbm90IGNhbmNlbCBhbnkgcGVuZGluZyB3cml0ZXMsIGFuZCBhbnkgcHJvbWlzZXMgdGhhdCBhcmVcbiAqIGF3YWl0aW5nIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyIHdpbGwgbm90IGJlIHJlc29sdmVkLiBJZiB5b3UgaGF2ZVxuICogcGVyc2lzdGVuY2UgZW5hYmxlZCwgdGhlIG5leHQgdGltZSB5b3Ugc3RhcnQgdGhpcyBpbnN0YW5jZSwgaXQgd2lsbCByZXN1bWVcbiAqIHNlbmRpbmcgdGhlc2Ugd3JpdGVzIHRvIHRoZSBzZXJ2ZXIuXG4gKlxuICogTm90ZTogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIGNhbGxpbmcgYHRlcm1pbmF0ZSgpYCBpcyBub3QgcmVxdWlyZWQuIFRoaXNcbiAqIGZ1bmN0aW9uIGlzIHVzZWZ1bCBvbmx5IHdoZW4geW91IHdhbnQgdG8gZm9yY2UgdGhpcyBpbnN0YW5jZSB0byByZWxlYXNlIGFsbFxuICogb2YgaXRzIHJlc291cmNlcyBvciBpbiBjb21iaW5hdGlvbiB3aXRoIGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHRvXG4gKiBlbnN1cmUgdGhhdCBhbGwgbG9jYWwgc3RhdGUgaXMgZGVzdHJveWVkIGJldHdlZW4gdGVzdCBydW5zLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgaW5zdGFuY2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5XG4gKiB0ZXJtaW5hdGVkLlxuICovIGZ1bmN0aW9uIEJjKHQpIHtcbiAgICByZXR1cm4gX3JlbW92ZVNlcnZpY2VJbnN0YW5jZSh0LmFwcCwgXCJmaXJlc3RvcmVcIiksIHQuX2RlbGV0ZSgpO1xufVxuXG4vKipcbiAqIExvYWRzIGEgRmlyZXN0b3JlIGJ1bmRsZSBpbnRvIHRoZSBsb2NhbCBjYWNoZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGxvYWQgYnVuZGxlcyBmb3IuXG4gKiBAcGFyYW0gYnVuZGxlRGF0YSAtIEFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGJ1bmRsZSB0byBiZSBsb2FkZWQuIFZhbGlkXG4gKiBvYmplY3RzIGFyZSBgQXJyYXlCdWZmZXJgLCBgUmVhZGFibGVTdHJlYW08VWludDhBcnJheT5gIG9yIGBzdHJpbmdgLlxuICpcbiAqIEByZXR1cm5zIEEgYExvYWRCdW5kbGVUYXNrYCBvYmplY3QsIHdoaWNoIG5vdGlmaWVzIGNhbGxlcnMgd2l0aCBwcm9ncmVzc1xuICogdXBkYXRlcywgYW5kIGNvbXBsZXRpb24gb3IgZXJyb3IgZXZlbnRzLiBJdCBjYW4gYmUgdXNlZCBhcyBhXG4gKiBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gZnVuY3Rpb24gTGModCwgZSkge1xuICAgIGNvbnN0IG4gPSBEYyh0ID0gaGModCwgVmMpKSwgcyA9IG5ldyBiYztcbiAgICByZXR1cm4gbmMobiwgdC5fZGF0YWJhc2VJZCwgZSwgcyksIHM7XG59XG5cbi8qKlxuICogUmVhZHMgYSBGaXJlc3RvcmUge0BsaW5rIFF1ZXJ5fSBmcm9tIGxvY2FsIGNhY2hlLCBpZGVudGlmaWVkIGJ5IHRoZSBnaXZlblxuICogbmFtZS5cbiAqXG4gKiBUaGUgbmFtZWQgcXVlcmllcyBhcmUgcGFja2FnZWQgIGludG8gYnVuZGxlcyBvbiB0aGUgc2VydmVyIHNpZGUgKGFsb25nXG4gKiB3aXRoIHJlc3VsdGluZyBkb2N1bWVudHMpLCBhbmQgbG9hZGVkIHRvIGxvY2FsIGNhY2hlIHVzaW5nIGBsb2FkQnVuZGxlYC4gT25jZVxuICogaW4gbG9jYWwgY2FjaGUsIHVzZSB0aGlzIG1ldGhvZCB0byBleHRyYWN0IGEge0BsaW5rIFF1ZXJ5fSBieSBuYW1lLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gcmVhZCB0aGUgcXVlcnkgZnJvbS5cbiAqIEBwYXJhbSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHF1ZXJ5LlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCB3aXRoIHRoZSBRdWVyeSBvciBgbnVsbGAuXG4gKi8gZnVuY3Rpb24gVWModCwgZSkge1xuICAgIHJldHVybiBzYyhEYyh0ID0gaGModCwgVmMpKSwgZSkudGhlbigoZSA9PiBlID8gbmV3IG1jKHQsIG51bGwsIGUucXVlcnkpIDogbnVsbCkpO1xufVxuXG5mdW5jdGlvbiBxYyh0KSB7XG4gICAgaWYgKHQuX2luaXRpYWxpemVkIHx8IHQuX3Rlcm1pbmF0ZWQpIHRocm93IG5ldyBRKEcuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBwZXJzaXN0ZW5jZSBjYW4gbm8gbG9uZ2VyIGJlIGVuYWJsZWQuIFlvdSBjYW4gb25seSBlbmFibGUgcGVyc2lzdGVuY2UgYmVmb3JlIGNhbGxpbmcgYW55IG90aGVyIG1ldGhvZHMgb24gYSBGaXJlc3RvcmUgb2JqZWN0LlwiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYEZpZWxkUGF0aGAgcmVmZXJzIHRvIGEgZmllbGQgaW4gYSBkb2N1bWVudC4gVGhlIHBhdGggbWF5IGNvbnNpc3Qgb2YgYVxuICogc2luZ2xlIGZpZWxkIG5hbWUgKHJlZmVycmluZyB0byBhIHRvcC1sZXZlbCBmaWVsZCBpbiB0aGUgZG9jdW1lbnQpLCBvciBhXG4gKiBsaXN0IG9mIGZpZWxkIG5hbWVzIChyZWZlcnJpbmcgdG8gYSBuZXN0ZWQgZmllbGQgaW4gdGhlIGRvY3VtZW50KS5cbiAqXG4gKiBDcmVhdGUgYSBgRmllbGRQYXRoYCBieSBwcm92aWRpbmcgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcbiAqIG5hbWUgaXMgcHJvdmlkZWQsIHRoZSBwYXRoIHdpbGwgcG9pbnQgdG8gYSBuZXN0ZWQgZmllbGQgaW4gYSBkb2N1bWVudC5cbiAqL1xuY2xhc3MgS2Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBgRmllbGRQYXRoYCBmcm9tIHRoZSBwcm92aWRlZCBmaWVsZCBuYW1lcy4gSWYgbW9yZSB0aGFuIG9uZSBmaWVsZFxuICAgICAqIG5hbWUgaXMgcHJvdmlkZWQsIHRoZSBwYXRoIHdpbGwgcG9pbnQgdG8gYSBuZXN0ZWQgZmllbGQgaW4gYSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZE5hbWVzIC0gQSBsaXN0IG9mIGZpZWxkIG5hbWVzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKC4uLnQpIHtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgKytlKSBpZiAoMCA9PT0gdFtlXS5sZW5ndGgpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIGZpZWxkIG5hbWUgYXQgYXJndW1lbnQgJChpICsgMSkuIEZpZWxkIG5hbWVzIG11c3Qgbm90IGJlIGVtcHR5LlwiKTtcbiAgICAgICAgdGhpcy5faW50ZXJuYWxQYXRoID0gbmV3IG10KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgRmllbGRQYXRoYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBGaWVsZFBhdGhgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYEZpZWxkUGF0aGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnRlcm5hbFBhdGguaXNFcXVhbCh0Ll9pbnRlcm5hbFBhdGgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCBzZW50aW5lbCBgRmllbGRQYXRoYCB0byByZWZlciB0byB0aGUgSUQgb2YgYSBkb2N1bWVudC5cbiAqIEl0IGNhbiBiZSB1c2VkIGluIHF1ZXJpZXMgdG8gc29ydCBvciBmaWx0ZXIgYnkgdGhlIGRvY3VtZW50IElELlxuICovIGZ1bmN0aW9uIEdjKCkge1xuICAgIHJldHVybiBuZXcgS2MoXCJfX25hbWVfX1wiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIG9iamVjdCByZXByZXNlbnRpbmcgYW4gYXJyYXkgb2YgYnl0ZXMuXG4gKi8gY2xhc3MgUWMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLl9ieXRlU3RyaW5nID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgQnl0ZXNgIG9iamVjdCBmcm9tIHRoZSBnaXZlbiBCYXNlNjQgc3RyaW5nLCBjb252ZXJ0aW5nIGl0IHRvXG4gICAgICogYnl0ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYmFzZTY0IC0gVGhlIEJhc2U2NCBzdHJpbmcgdXNlZCB0byBjcmVhdGUgdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbUJhc2U2NFN0cmluZyh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFFjKHB0LmZyb21CYXNlNjRTdHJpbmcodCkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiRmFpbGVkIHRvIGNvbnN0cnVjdCBkYXRhIGZyb20gQmFzZTY0IHN0cmluZzogXCIgKyB0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGBCeXRlc2Agb2JqZWN0IGZyb20gdGhlIGdpdmVuIFVpbnQ4QXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXJyYXkgLSBUaGUgVWludDhBcnJheSB1c2VkIHRvIGNyZWF0ZSB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgUWMocHQuZnJvbVVpbnQ4QXJyYXkodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB1bmRlcmx5aW5nIGJ5dGVzIGFzIGEgQmFzZTY0LWVuY29kZWQgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIEJhc2U2NC1lbmNvZGVkIHN0cmluZyBjcmVhdGVkIGZyb20gdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICB0b0Jhc2U2NCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcudG9CYXNlNjQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBpbiBhIG5ldyBgVWludDhBcnJheWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgVWludDhBcnJheSBjcmVhdGVkIGZyb20gdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICB0b1VpbnQ4QXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvVWludDhBcnJheSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIkJ5dGVzKGJhc2U2NDogXCIgKyB0aGlzLnRvQmFzZTY0KCkgKyBcIilcIjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEJ5dGVzYCBvYmplY3QgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgQnl0ZXNgIG9iamVjdCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy5pc0VxdWFsKHQuX2J5dGVTdHJpbmcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2VudGluZWwgdmFsdWVzIHRoYXQgY2FuIGJlIHVzZWQgd2hlbiB3cml0aW5nIGRvY3VtZW50IGZpZWxkcyB3aXRoIGBzZXQoKWBcbiAqIG9yIGB1cGRhdGUoKWAuXG4gKi8gY2xhc3MgamMge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBfbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWMgQVBJIGVuZHBvaW50IHRoYXQgcmV0dXJucyB0aGlzIGNsYXNzLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuX21ldGhvZE5hbWUgPSB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIG9iamVjdCByZXByZXNlbnRpbmcgYSBnZW9ncmFwaGljIGxvY2F0aW9uIGluIEZpcmVzdG9yZS4gVGhlXG4gKiBsb2NhdGlvbiBpcyByZXByZXNlbnRlZCBhcyBsYXRpdHVkZS9sb25naXR1ZGUgcGFpci5cbiAqXG4gKiBMYXRpdHVkZSB2YWx1ZXMgYXJlIGluIHRoZSByYW5nZSBvZiBbLTkwLCA5MF0uXG4gKiBMb25naXR1ZGUgdmFsdWVzIGFyZSBpbiB0aGUgcmFuZ2Ugb2YgWy0xODAsIDE4MF0uXG4gKi8gY2xhc3MgV2Mge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgaW1tdXRhYmxlIGBHZW9Qb2ludGAgb2JqZWN0IHdpdGggdGhlIHByb3ZpZGVkIGxhdGl0dWRlIGFuZFxuICAgICAqIGxvbmdpdHVkZSB2YWx1ZXMuXG4gICAgICogQHBhcmFtIGxhdGl0dWRlIC0gVGhlIGxhdGl0dWRlIGFzIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTAuXG4gICAgICogQHBhcmFtIGxvbmdpdHVkZSAtIFRoZSBsb25naXR1ZGUgYXMgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZSh0KSB8fCB0IDwgLTkwIHx8IHQgPiA5MCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIkxhdGl0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLCBidXQgd2FzOiBcIiArIHQpO1xuICAgICAgICBpZiAoIWlzRmluaXRlKGUpIHx8IGUgPCAtMTgwIHx8IGUgPiAxODApIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJMb25naXR1ZGUgbXVzdCBiZSBhIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MCwgYnV0IHdhczogXCIgKyBlKTtcbiAgICAgICAgdGhpcy5fbGF0ID0gdCwgdGhpcy5fbG9uZyA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBsYXRpdHVkZSBvZiB0aGlzIGBHZW9Qb2ludGAgaW5zdGFuY2UuXG4gICAgICovICAgIGdldCBsYXRpdHVkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xhdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGxvbmdpdHVkZSBvZiB0aGlzIGBHZW9Qb2ludGAgaW5zdGFuY2UuXG4gICAgICovICAgIGdldCBsb25naXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sb25nO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgR2VvUG9pbnRgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEdlb1BvaW50YCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBHZW9Qb2ludGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXQgPT09IHQuX2xhdCAmJiB0aGlzLl9sb25nID09PSB0Ll9sb25nO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgR2VvUG9pbnQuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiB0aGlzLl9sYXQsXG4gICAgICAgICAgICBsb25naXR1ZGU6IHRoaXMuX2xvbmdcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWN0dWFsbHkgcHJpdmF0ZSB0byBKUyBjb25zdW1lcnMgb2Ygb3VyIEFQSSwgc28gdGhpcyBmdW5jdGlvbiBpcyBwcmVmaXhlZFxuICAgICAqIHdpdGggYW4gdW5kZXJzY29yZS5cbiAgICAgKi8gICAgX2NvbXBhcmVUbyh0KSB7XG4gICAgICAgIHJldHVybiBydCh0aGlzLl9sYXQsIHQuX2xhdCkgfHwgcnQodGhpcy5fbG9uZywgdC5fbG9uZyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCB6YyA9IC9eX18uKl9fJC87XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgZG9jdW1lbnQgZGF0YSAoZS5nLiBmb3IgYSBzZXREYXRhIGNhbGwpLiAqLyBjbGFzcyBIYyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLmRhdGEgPSB0LCB0aGlzLmZpZWxkTWFzayA9IGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gbjtcbiAgICB9XG4gICAgdG9NdXRhdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLmZpZWxkTWFzayA/IG5ldyB4bih0LCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCBlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcykgOiBuZXcgQ24odCwgdGhpcy5kYXRhLCBlLCB0aGlzLmZpZWxkVHJhbnNmb3Jtcyk7XG4gICAgfVxufVxuXG4vKiogVGhlIHJlc3VsdCBvZiBwYXJzaW5nIFwidXBkYXRlXCIgZGF0YSAoaS5lLiBmb3IgYW4gdXBkYXRlRGF0YSBjYWxsKS4gKi8gY2xhc3MgSmMge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8vIFRoZSBmaWVsZE1hc2sgZG9lcyBub3QgaW5jbHVkZSBkb2N1bWVudCB0cmFuc2Zvcm1zLlxuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhID0gdCwgdGhpcy5maWVsZE1hc2sgPSBlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IG47XG4gICAgfVxuICAgIHRvTXV0YXRpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IHhuKHQsIHRoaXMuZGF0YSwgdGhpcy5maWVsZE1hc2ssIGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFljKHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgMCAvKiBTZXQgKi8gOlxuIC8vIGZhbGwgdGhyb3VnaFxuICAgICAgICAgICAgICBjYXNlIDIgLyogTWVyZ2VTZXQgKi8gOlxuIC8vIGZhbGwgdGhyb3VnaFxuICAgICAgICAgICAgICBjYXNlIDEgLyogVXBkYXRlICovIDpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBjYXNlIDMgLyogQXJndW1lbnQgKi8gOlxuICAgICAgY2FzZSA0IC8qIEFycmF5QXJndW1lbnQgKi8gOlxuICAgICAgICByZXR1cm4gITE7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IEwoKTtcbiAgICB9XG59XG5cbi8qKiBBIFwiY29udGV4dFwiIG9iamVjdCBwYXNzZWQgYXJvdW5kIHdoaWxlIHBhcnNpbmcgdXNlciBkYXRhLiAqLyBjbGFzcyBYYyB7XG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBQYXJzZUNvbnRleHQgd2l0aCB0aGUgZ2l2ZW4gc291cmNlIGFuZCBwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNldHRpbmdzIC0gVGhlIHNldHRpbmdzIGZvciB0aGUgcGFyc2VyLlxuICAgICAqIEBwYXJhbSBkYXRhYmFzZUlkIC0gVGhlIGRhdGFiYXNlIElEIG9mIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UuXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgc2VyaWFsaXplciB0byB1c2UgdG8gZ2VuZXJhdGUgdGhlIFZhbHVlIHByb3RvLlxuICAgICAqIEBwYXJhbSBpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzIC0gV2hldGhlciB0byBpZ25vcmUgdW5kZWZpbmVkIHByb3BlcnRpZXNcbiAgICAgKiByYXRoZXIgdGhhbiB0aHJvdy5cbiAgICAgKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgdHJhbnNmb3JtcyBlbmNvdW50ZXJlZFxuICAgICAqIHdoaWxlIHBhcnNpbmcgdGhlIGRhdGEuXG4gICAgICogQHBhcmFtIGZpZWxkTWFzayAtIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHBhdGhzIGVuY291bnRlcmVkIHdoaWxlIHBhcnNpbmdcbiAgICAgKiB0aGUgZGF0YS5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNDg3MTEzMSk6IFdlIGRvbid0IHN1cHBvcnQgYXJyYXkgcGF0aHMgcmlnaHQgbm93LCBzbyBwYXRoIGNhbiBiZVxuICAgICAqIG51bGwgdG8gaW5kaWNhdGUgdGhlIGNvbnRleHQgcmVwcmVzZW50cyBhbnkgbG9jYXRpb24gd2l0aGluIGFuIGFycmF5IChpblxuICAgICAqIHdoaWNoIGNhc2UgY2VydGFpbiBmZWF0dXJlcyB3aWxsIG5vdCB3b3JrIGFuZCBlcnJvcnMgd2lsbCBiZSBzb21ld2hhdFxuICAgICAqIGNvbXByb21pc2VkKS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB0LCB0aGlzLmRhdGFiYXNlSWQgPSBlLCB0aGlzLk0gPSBuLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSBzLCBcbiAgICAgICAgLy8gTWlub3IgaGFjazogSWYgZmllbGRUcmFuc2Zvcm1zIGlzIHVuZGVmaW5lZCwgd2UgYXNzdW1lIHRoaXMgaXMgYW5cbiAgICAgICAgLy8gZXh0ZXJuYWwgY2FsbCBhbmQgd2UgbmVlZCB0byB2YWxpZGF0ZSB0aGUgZW50aXJlIHBhdGguXG4gICAgICAgIHZvaWQgMCA9PT0gaSAmJiB0aGlzLnRjKCksIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gaSB8fCBbXSwgdGhpcy5maWVsZE1hc2sgPSByIHx8IFtdO1xuICAgIH1cbiAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MucGF0aDtcbiAgICB9XG4gICAgZ2V0IGVjKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5lYztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBuZXcgY29udGV4dCB3aXRoIHRoZSBzcGVjaWZpZWQgc2V0dGluZ3Mgb3ZlcndyaXR0ZW4uICovICAgIG5jKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBYYyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2V0dGluZ3MpLCB0KSwgdGhpcy5kYXRhYmFzZUlkLCB0aGlzLk0sIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcywgdGhpcy5maWVsZFRyYW5zZm9ybXMsIHRoaXMuZmllbGRNYXNrKTtcbiAgICB9XG4gICAgc2ModCkge1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgY29uc3QgbiA9IG51bGwgPT09IChlID0gdGhpcy5wYXRoKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmNoaWxkKHQpLCBzID0gdGhpcy5uYyh7XG4gICAgICAgICAgICBwYXRoOiBuLFxuICAgICAgICAgICAgaWM6ICExXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcy5yYyh0KSwgcztcbiAgICB9XG4gICAgb2ModCkge1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgY29uc3QgbiA9IG51bGwgPT09IChlID0gdGhpcy5wYXRoKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLmNoaWxkKHQpLCBzID0gdGhpcy5uYyh7XG4gICAgICAgICAgICBwYXRoOiBuLFxuICAgICAgICAgICAgaWM6ICExXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcy50YygpLCBzO1xuICAgIH1cbiAgICB1Yyh0KSB7XG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IFdlIGRvbid0IHN1cHBvcnQgYXJyYXkgcGF0aHMgcmlnaHQgbm93OyBzbyBtYWtlIHBhdGhcbiAgICAgICAgLy8gdW5kZWZpbmVkLlxuICAgICAgICByZXR1cm4gdGhpcy5uYyh7XG4gICAgICAgICAgICBwYXRoOiB2b2lkIDAsXG4gICAgICAgICAgICBpYzogITBcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFjKHQpIHtcbiAgICAgICAgcmV0dXJuIHloKHQsIHRoaXMuc2V0dGluZ3MubWV0aG9kTmFtZSwgdGhpcy5zZXR0aW5ncy5jYyB8fCAhMSwgdGhpcy5wYXRoLCB0aGlzLnNldHRpbmdzLmhjKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgJ3RydWUnIGlmICdmaWVsZFBhdGgnIHdhcyB0cmF2ZXJzZWQgd2hlbiBjcmVhdGluZyB0aGlzIGNvbnRleHQuICovICAgIGNvbnRhaW5zKHQpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdGhpcy5maWVsZE1hc2suZmluZCgoZSA9PiB0LmlzUHJlZml4T2YoZSkpKSB8fCB2b2lkIDAgIT09IHRoaXMuZmllbGRUcmFuc2Zvcm1zLmZpbmQoKGUgPT4gdC5pc1ByZWZpeE9mKGUuZmllbGQpKSk7XG4gICAgfVxuICAgIHRjKCkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBSZW1vdmUgbnVsbCBjaGVjayBvbmNlIHdlIGhhdmUgcHJvcGVyIHBhdGhzIGZvciBmaWVsZHNcbiAgICAgICAgLy8gd2l0aGluIGFycmF5cy5cbiAgICAgICAgaWYgKHRoaXMucGF0aCkgZm9yIChsZXQgdCA9IDA7IHQgPCB0aGlzLnBhdGgubGVuZ3RoOyB0KyspIHRoaXMucmModGhpcy5wYXRoLmdldCh0KSk7XG4gICAgfVxuICAgIHJjKHQpIHtcbiAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSB0aHJvdyB0aGlzLmFjKFwiRG9jdW1lbnQgZmllbGRzIG11c3Qgbm90IGJlIGVtcHR5XCIpO1xuICAgICAgICBpZiAoWWModGhpcy5lYykgJiYgemMudGVzdCh0KSkgdGhyb3cgdGhpcy5hYygnRG9jdW1lbnQgZmllbGRzIGNhbm5vdCBiZWdpbiBhbmQgZW5kIHdpdGggXCJfX1wiJyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciBmb3IgcGFyc2luZyByYXcgdXNlciBpbnB1dCAocHJvdmlkZWQgdmlhIHRoZSBBUEkpIGludG8gaW50ZXJuYWwgbW9kZWxcbiAqIGNsYXNzZXMuXG4gKi8gY2xhc3MgWmMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gdCwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gZSwgdGhpcy5NID0gbiB8fCBqbyh0KTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgdG9wLWxldmVsIHBhcnNlIGNvbnRleHQuICovICAgIGxjKHQsIGUsIG4sIHMgPSAhMSkge1xuICAgICAgICByZXR1cm4gbmV3IFhjKHtcbiAgICAgICAgICAgIGVjOiB0LFxuICAgICAgICAgICAgbWV0aG9kTmFtZTogZSxcbiAgICAgICAgICAgIGhjOiBuLFxuICAgICAgICAgICAgcGF0aDogbXQuZW1wdHlQYXRoKCksXG4gICAgICAgICAgICBpYzogITEsXG4gICAgICAgICAgICBjYzogc1xuICAgICAgICB9LCB0aGlzLmRhdGFiYXNlSWQsIHRoaXMuTSwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRoKHQpIHtcbiAgICBjb25zdCBlID0gdC5fZnJlZXplU2V0dGluZ3MoKSwgbiA9IGpvKHQuX2RhdGFiYXNlSWQpO1xuICAgIHJldHVybiBuZXcgWmModC5fZGF0YWJhc2VJZCwgISFlLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIG4pO1xufVxuXG4vKiogUGFyc2UgZG9jdW1lbnQgZGF0YSBmcm9tIGEgc2V0KCkgY2FsbC4gKi8gZnVuY3Rpb24gZWgodCwgZSwgbiwgcywgaSwgciA9IHt9KSB7XG4gICAgY29uc3QgbyA9IHQubGMoci5tZXJnZSB8fCByLm1lcmdlRmllbGRzID8gMiAvKiBNZXJnZVNldCAqLyA6IDAgLyogU2V0ICovICwgZSwgbiwgaSk7XG4gICAgX2goXCJEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOlwiLCBvLCBzKTtcbiAgICBjb25zdCB1ID0gZmgocywgbyk7XG4gICAgbGV0IGEsIGM7XG4gICAgaWYgKHIubWVyZ2UpIGEgPSBuZXcgZ3Qoby5maWVsZE1hc2spLCBjID0gby5maWVsZFRyYW5zZm9ybXM7IGVsc2UgaWYgKHIubWVyZ2VGaWVsZHMpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2Ygci5tZXJnZUZpZWxkcykge1xuICAgICAgICAgICAgY29uc3QgaSA9IHdoKGUsIHMsIG4pO1xuICAgICAgICAgICAgaWYgKCFvLmNvbnRhaW5zKGkpKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBGaWVsZCAnJHtpfScgaXMgc3BlY2lmaWVkIGluIHlvdXIgZmllbGQgbWFzayBidXQgbWlzc2luZyBmcm9tIHlvdXIgaW5wdXQgZGF0YS5gKTtcbiAgICAgICAgICAgIHBoKHQsIGkpIHx8IHQucHVzaChpKTtcbiAgICAgICAgfVxuICAgICAgICBhID0gbmV3IGd0KHQpLCBjID0gby5maWVsZFRyYW5zZm9ybXMuZmlsdGVyKCh0ID0+IGEuY292ZXJzKHQuZmllbGQpKSk7XG4gICAgfSBlbHNlIGEgPSBudWxsLCBjID0gby5maWVsZFRyYW5zZm9ybXM7XG4gICAgcmV0dXJuIG5ldyBIYyhuZXcgdGUodSksIGEsIGMpO1xufVxuXG5jbGFzcyBuaCBleHRlbmRzIGpjIHtcbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIGlmICgyIC8qIE1lcmdlU2V0ICovICE9PSB0LmVjKSB0aHJvdyAxIC8qIFVwZGF0ZSAqLyA9PT0gdC5lYyA/IHQuYWMoYCR7dGhpcy5fbWV0aG9kTmFtZX0oKSBjYW4gb25seSBhcHBlYXIgYXQgdGhlIHRvcCBsZXZlbCBvZiB5b3VyIHVwZGF0ZSBkYXRhYCkgOiB0LmFjKGAke3RoaXMuX21ldGhvZE5hbWV9KCkgY2Fubm90IGJlIHVzZWQgd2l0aCBzZXQoKSB1bmxlc3MgeW91IHBhc3Mge21lcmdlOnRydWV9YCk7XG4gICAgICAgIC8vIE5vIHRyYW5zZm9ybSB0byBhZGQgZm9yIGEgZGVsZXRlLCBidXQgd2UgbmVlZCB0byBhZGQgaXQgdG8gb3VyXG4gICAgICAgIC8vIGZpZWxkTWFzayBzbyBpdCBnZXRzIGRlbGV0ZWQuXG4gICAgICAgIHJldHVybiB0LmZpZWxkTWFzay5wdXNoKHQucGF0aCksIG51bGw7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIG5oO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgY2hpbGQgY29udGV4dCBmb3IgcGFyc2luZyBTZXJpYWxpemFibGVGaWVsZFZhbHVlcy5cbiAqXG4gKiBUaGlzIGlzIGRpZmZlcmVudCB0aGFuIGNhbGxpbmcgYFBhcnNlQ29udGV4dC5jb250ZXh0V2l0aGAgYmVjYXVzZSBpdCBrZWVwc1xuICogdGhlIGZpZWxkVHJhbnNmb3JtcyBhbmQgZmllbGRNYXNrIHNlcGFyYXRlLlxuICpcbiAqIFRoZSBjcmVhdGVkIGNvbnRleHQgaGFzIGl0cyBgZGF0YVNvdXJjZWAgc2V0IHRvIGBVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudGAuXG4gKiBBbHRob3VnaCB0aGVzZSB2YWx1ZXMgYXJlIHVzZWQgd2l0aCB3cml0ZXMsIGFueSBlbGVtZW50cyBpbiB0aGVzZSBGaWVsZFZhbHVlc1xuICogYXJlIG5vdCBjb25zaWRlcmVkIHdyaXRlcyBzaW5jZSB0aGV5IGNhbm5vdCBjb250YWluIGFueSBGaWVsZFZhbHVlIHNlbnRpbmVscyxcbiAqIGV0Yy5cbiAqXG4gKiBAcGFyYW0gZmllbGRWYWx1ZSAtIFRoZSBzZW50aW5lbCBGaWVsZFZhbHVlIGZvciB3aGljaCB0byBjcmVhdGUgYSBjaGlsZFxuICogICAgIGNvbnRleHQuXG4gKiBAcGFyYW0gY29udGV4dCAtIFRoZSBwYXJlbnQgY29udGV4dC5cbiAqIEBwYXJhbSBhcnJheUVsZW1lbnQgLSBXaGV0aGVyIG9yIG5vdCB0aGUgRmllbGRWYWx1ZSBoYXMgYW4gYXJyYXkuXG4gKi8gZnVuY3Rpb24gc2godCwgZSwgbikge1xuICAgIHJldHVybiBuZXcgWGMoe1xuICAgICAgICBlYzogMyAvKiBBcmd1bWVudCAqLyAsXG4gICAgICAgIGhjOiBlLnNldHRpbmdzLmhjLFxuICAgICAgICBtZXRob2ROYW1lOiB0Ll9tZXRob2ROYW1lLFxuICAgICAgICBpYzogblxuICAgIH0sIGUuZGF0YWJhc2VJZCwgZS5NLCBlLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMpO1xufVxuXG5jbGFzcyBpaCBleHRlbmRzIGpjIHtcbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgSW4odC5wYXRoLCBuZXcgZm4pO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBpaDtcbiAgICB9XG59XG5cbmNsYXNzIHJoIGV4dGVuZHMgamMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCksIHRoaXMuZmMgPSBlO1xuICAgIH1cbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBzaCh0aGlzLCB0LCBcbiAgICAgICAgLyphcnJheT0qLyAhMCksIG4gPSB0aGlzLmZjLm1hcCgodCA9PiBsaCh0LCBlKSkpLCBzID0gbmV3IGRuKG4pO1xuICAgICAgICByZXR1cm4gbmV3IEluKHQucGF0aCwgcyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICAvLyBUT0RPKG1yc2NobWlkdCk6IEltcGxlbWVudCBpc0VxdWFsc1xuICAgICAgICByZXR1cm4gdGhpcyA9PT0gdDtcbiAgICB9XG59XG5cbmNsYXNzIG9oIGV4dGVuZHMgamMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCksIHRoaXMuZmMgPSBlO1xuICAgIH1cbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBzaCh0aGlzLCB0LCBcbiAgICAgICAgLyphcnJheT0qLyAhMCksIG4gPSB0aGlzLmZjLm1hcCgodCA9PiBsaCh0LCBlKSkpLCBzID0gbmV3IHduKG4pO1xuICAgICAgICByZXR1cm4gbmV3IEluKHQucGF0aCwgcyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICAvLyBUT0RPKG1yc2NobWlkdCk6IEltcGxlbWVudCBpc0VxdWFsc1xuICAgICAgICByZXR1cm4gdGhpcyA9PT0gdDtcbiAgICB9XG59XG5cbmNsYXNzIHVoIGV4dGVuZHMgamMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCksIHRoaXMuZGMgPSBlO1xuICAgIH1cbiAgICBfdG9GaWVsZFRyYW5zZm9ybSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgZ24odC5NLCB1bih0Lk0sIHRoaXMuZGMpKTtcbiAgICAgICAgcmV0dXJuIG5ldyBJbih0LnBhdGgsIGUpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG4vKiogUGFyc2UgdXBkYXRlIGRhdGEgZnJvbSBhbiB1cGRhdGUoKSBjYWxsLiAqLyBmdW5jdGlvbiBhaCh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IHQubGMoMSAvKiBVcGRhdGUgKi8gLCBlLCBuKTtcbiAgICBfaChcIkRhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6XCIsIGksIHMpO1xuICAgIGNvbnN0IHIgPSBbXSwgbyA9IHRlLmVtcHR5KCk7XG4gICAgbHQocywgKCh0LCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IHUgPSBnaChlLCB0LCBuKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIHMgPSBnZXRNb2R1bGFySW5zdGFuY2Uocyk7XG4gICAgICAgIGNvbnN0IGEgPSBpLm9jKHUpO1xuICAgICAgICBpZiAocyBpbnN0YW5jZW9mIG5oKSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIHIucHVzaCh1KTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbGgocywgYSk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKHIucHVzaCh1KSwgby5zZXQodSwgdCkpO1xuICAgICAgICB9XG4gICAgfSkpO1xuICAgIGNvbnN0IHUgPSBuZXcgZ3Qocik7XG4gICAgcmV0dXJuIG5ldyBKYyhvLCB1LCBpLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKiBQYXJzZSB1cGRhdGUgZGF0YSBmcm9tIGEgbGlzdCBvZiBmaWVsZC92YWx1ZSBhcmd1bWVudHMuICovIGZ1bmN0aW9uIGNoKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICBjb25zdCBvID0gdC5sYygxIC8qIFVwZGF0ZSAqLyAsIGUsIG4pLCB1ID0gWyB3aChlLCBzLCBuKSBdLCBhID0gWyBpIF07XG4gICAgaWYgKHIubGVuZ3RoICUgMiAhPSAwKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke2V9KCkgbmVlZHMgdG8gYmUgY2FsbGVkIHdpdGggYW4gZXZlbiBudW1iZXIgb2YgYXJndW1lbnRzIHRoYXQgYWx0ZXJuYXRlIGJldHdlZW4gZmllbGQgbmFtZXMgYW5kIHZhbHVlcy5gKTtcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHIubGVuZ3RoOyB0ICs9IDIpIHUucHVzaCh3aChlLCByW3RdKSksIGEucHVzaChyW3QgKyAxXSk7XG4gICAgY29uc3QgYyA9IFtdLCBoID0gdGUuZW1wdHkoKTtcbiAgICAvLyBXZSBpdGVyYXRlIGluIHJldmVyc2Ugb3JkZXIgdG8gcGljayB0aGUgbGFzdCB2YWx1ZSBmb3IgYSBmaWVsZCBpZiB0aGVcbiAgICAvLyB1c2VyIHNwZWNpZmllZCB0aGUgZmllbGQgbXVsdGlwbGUgdGltZXMuXG4gICAgZm9yIChsZXQgdCA9IHUubGVuZ3RoIC0gMTsgdCA+PSAwOyAtLXQpIGlmICghcGgoYywgdVt0XSkpIHtcbiAgICAgICAgY29uc3QgZSA9IHVbdF07XG4gICAgICAgIGxldCBuID0gYVt0XTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIG4gPSBnZXRNb2R1bGFySW5zdGFuY2Uobik7XG4gICAgICAgIGNvbnN0IHMgPSBvLm9jKGUpO1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIG5oKSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIGMucHVzaChlKTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbGgobiwgcyk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKGMucHVzaChlKSwgaC5zZXQoZSwgdCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGwgPSBuZXcgZ3QoYyk7XG4gICAgcmV0dXJuIG5ldyBKYyhoLCBsLCBvLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKlxuICogUGFyc2UgYSBcInF1ZXJ5IHZhbHVlXCIgKGUuZy4gdmFsdWUgaW4gYSB3aGVyZSBmaWx0ZXIgb3IgYSB2YWx1ZSBpbiBhIGN1cnNvclxuICogYm91bmQpLlxuICpcbiAqIEBwYXJhbSBhbGxvd0FycmF5cyAtIFdoZXRoZXIgdGhlIHF1ZXJ5IHZhbHVlIGlzIGFuIGFycmF5IHRoYXQgbWF5IGRpcmVjdGx5XG4gKiBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlLmcuIHRoZSBvcGVyYW5kIG9mIGFuIGBpbmAgcXVlcnkpLlxuICovIGZ1bmN0aW9uIGhoKHQsIGUsIG4sIHMgPSAhMSkge1xuICAgIHJldHVybiBsaChuLCB0LmxjKHMgPyA0IC8qIEFycmF5QXJndW1lbnQgKi8gOiAzIC8qIEFyZ3VtZW50ICovICwgZSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB1c2VyIGRhdGEgdG8gUHJvdG9idWYgVmFsdWVzLlxuICpcbiAqIEBwYXJhbSBpbnB1dCAtIERhdGEgdG8gYmUgcGFyc2VkLlxuICogQHBhcmFtIGNvbnRleHQgLSBBIGNvbnRleHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBwYXRoIGJlaW5nIHBhcnNlZCxcbiAqIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgYmVpbmcgcGFyc2VkLCBldGMuXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlLCBvciBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBGaWVsZFZhbHVlIHNlbnRpbmVsXG4gKiB0aGF0IHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdGluZyBwYXJzZWQgZGF0YS5cbiAqLyBmdW5jdGlvbiBsaCh0LCBlKSB7XG4gICAgaWYgKGRoKFxuICAgIC8vIFVud3JhcCB0aGUgQVBJIHR5cGUgZnJvbSB0aGUgQ29tcGF0IFNESy4gVGhpcyB3aWxsIHJldHVybiB0aGUgQVBJIHR5cGVcbiAgICAvLyBmcm9tIGZpcmVzdG9yZS1leHAuXG4gICAgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkpIHJldHVybiBfaChcIlVuc3VwcG9ydGVkIGZpZWxkIHZhbHVlOlwiLCBlLCB0KSwgZmgodCwgZSk7XG4gICAgaWYgKHQgaW5zdGFuY2VvZiBqYykgXG4gICAgLy8gRmllbGRWYWx1ZXMgdXN1YWxseSBwYXJzZSBpbnRvIHRyYW5zZm9ybXMgKGV4Y2VwdCBkZWxldGVGaWVsZCgpKVxuICAgIC8vIGluIHdoaWNoIGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gaW5jbHVkZSB0aGlzIGZpZWxkIGluIG91ciBwYXJzZWQgZGF0YVxuICAgIC8vIChhcyBkb2luZyBzbyB3aWxsIG92ZXJ3cml0ZSB0aGUgZmllbGQgZGlyZWN0bHkgcHJpb3IgdG8gdGhlIHRyYW5zZm9ybVxuICAgIC8vIHRyeWluZyB0byB0cmFuc2Zvcm0gaXQpLiBTbyB3ZSBkb24ndCBhZGQgdGhpcyBsb2NhdGlvbiB0b1xuICAgIC8vIGNvbnRleHQuZmllbGRNYXNrIGFuZCB3ZSByZXR1cm4gbnVsbCBhcyBvdXIgcGFyc2luZyByZXN1bHQuXG4gICAgLyoqXG4gKiBcIlBhcnNlc1wiIHRoZSBwcm92aWRlZCBGaWVsZFZhbHVlSW1wbCwgYWRkaW5nIGFueSBuZWNlc3NhcnkgdHJhbnNmb3JtcyB0b1xuICogY29udGV4dC5maWVsZFRyYW5zZm9ybXMuXG4gKi9cbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBTZW50aW5lbHMgYXJlIG9ubHkgc3VwcG9ydGVkIHdpdGggd3JpdGVzLCBhbmQgbm90IHdpdGhpbiBhcnJheXMuXG4gICAgICAgIGlmICghWWMoZS5lYykpIHRocm93IGUuYWMoYCR7dC5fbWV0aG9kTmFtZX0oKSBjYW4gb25seSBiZSB1c2VkIHdpdGggdXBkYXRlKCkgYW5kIHNldCgpYCk7XG4gICAgICAgIGlmICghZS5wYXRoKSB0aHJvdyBlLmFjKGAke3QuX21ldGhvZE5hbWV9KCkgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgaW5zaWRlIGFycmF5c2ApO1xuICAgICAgICBjb25zdCBuID0gdC5fdG9GaWVsZFRyYW5zZm9ybShlKTtcbiAgICAgICAgbiAmJiBlLmZpZWxkVHJhbnNmb3Jtcy5wdXNoKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEhlbHBlciB0byBwYXJzZSBhIHNjYWxhciB2YWx1ZSAoaS5lLiBub3QgYW4gT2JqZWN0LCBBcnJheSwgb3IgRmllbGRWYWx1ZSlcbiAqXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlXG4gKi8gKHQsIGUpLCBudWxsO1xuICAgIGlmICh2b2lkIDAgPT09IHQgJiYgZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKSBcbiAgICAvLyBJZiB0aGUgaW5wdXQgaXMgdW5kZWZpbmVkIGl0IGNhbiBuZXZlciBwYXJ0aWNpcGF0ZSBpbiB0aGUgZmllbGRNYXNrLCBzb1xuICAgIC8vIGRvbid0IGhhbmRsZSB0aGlzIGJlbG93LiBJZiBgaWdub3JlVW5kZWZpbmVkUHJvcGVydGllc2AgaXMgZmFsc2UsXG4gICAgLy8gYHBhcnNlU2NhbGFyVmFsdWVgIHdpbGwgcmVqZWN0IGFuIHVuZGVmaW5lZCB2YWx1ZS5cbiAgICByZXR1cm4gbnVsbDtcbiAgICBpZiAoXG4gICAgLy8gSWYgY29udGV4dC5wYXRoIGlzIG51bGwgd2UgYXJlIGluc2lkZSBhbiBhcnJheSBhbmQgd2UgZG9uJ3Qgc3VwcG9ydFxuICAgIC8vIGZpZWxkIG1hc2sgcGF0aHMgbW9yZSBncmFudWxhciB0aGFuIHRoZSB0b3AtbGV2ZWwgYXJyYXkuXG4gICAgZS5wYXRoICYmIGUuZmllbGRNYXNrLnB1c2goZS5wYXRoKSwgdCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IEluY2x1ZGUgdGhlIHBhdGggY29udGFpbmluZyB0aGUgYXJyYXkgaW4gdGhlIGVycm9yXG4gICAgICAgIC8vIG1lc3NhZ2UuXG4gICAgICAgIC8vIEluIHRoZSBjYXNlIG9mIElOIHF1ZXJpZXMsIHRoZSBwYXJzZWQgZGF0YSBpcyBhbiBhcnJheSAocmVwcmVzZW50aW5nXG4gICAgICAgIC8vIHRoZSBzZXQgb2YgdmFsdWVzIHRvIGJlIGluY2x1ZGVkIGZvciB0aGUgSU4gcXVlcnkpIHRoYXQgbWF5IGRpcmVjdGx5XG4gICAgICAgIC8vIGNvbnRhaW4gYWRkaXRpb25hbCBhcnJheXMgKGVhY2ggcmVwcmVzZW50aW5nIGFuIGluZGl2aWR1YWwgZmllbGRcbiAgICAgICAgLy8gdmFsdWUpLCBzbyB3ZSBkaXNhYmxlIHRoaXMgdmFsaWRhdGlvbi5cbiAgICAgICAgaWYgKGUuc2V0dGluZ3MuaWMgJiYgNCAvKiBBcnJheUFyZ3VtZW50ICovICE9PSBlLmVjKSB0aHJvdyBlLmFjKFwiTmVzdGVkIGFycmF5cyBhcmUgbm90IHN1cHBvcnRlZFwiKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XG4gICAgICAgICAgICAgICAgbGV0IHQgPSBsaChpLCBlLnVjKHMpKTtcbiAgICAgICAgICAgICAgICBudWxsID09IHQgJiYgKFxuICAgICAgICAgICAgICAgIC8vIEp1c3QgaW5jbHVkZSBudWxscyBpbiB0aGUgYXJyYXkgZm9yIGZpZWxkcyBiZWluZyByZXBsYWNlZCB3aXRoIGFcbiAgICAgICAgICAgICAgICAvLyBzZW50aW5lbC5cbiAgICAgICAgICAgICAgICB0ID0ge1xuICAgICAgICAgICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgICAgICAgICAgfSksIG4ucHVzaCh0KSwgcysrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCwgZSk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGlmIChudWxsID09PSAodCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSkpIHJldHVybiB7XG4gICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0KSByZXR1cm4gdW4oZS5NLCB0KTtcbiAgICAgICAgaWYgKFwiYm9vbGVhblwiID09IHR5cGVvZiB0KSByZXR1cm4ge1xuICAgICAgICAgICAgYm9vbGVhblZhbHVlOiB0XG4gICAgICAgIH07XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4ge1xuICAgICAgICAgICAgc3RyaW5nVmFsdWU6IHRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gYXQuZnJvbURhdGUodCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFZhbHVlOiBmcyhlLk0sIG4pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgYXQpIHtcbiAgICAgICAgICAgIC8vIEZpcmVzdG9yZSBiYWNrZW5kIHRydW5jYXRlcyBwcmVjaXNpb24gZG93biB0byBtaWNyb3NlY29uZHMuIFRvIGVuc3VyZVxuICAgICAgICAgICAgLy8gb2ZmbGluZSBtb2RlIHdvcmtzIHRoZSBzYW1lIHdpdGggcmVnYXJkcyB0byB0cnVuY2F0aW9uLCBwZXJmb3JtIHRoZVxuICAgICAgICAgICAgLy8gdHJ1bmNhdGlvbiBpbW1lZGlhdGVseSB3aXRob3V0IHdhaXRpbmcgZm9yIHRoZSBiYWNrZW5kIHRvIGRvIHRoYXQuXG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IGF0KHQuc2Vjb25kcywgMWUzICogTWF0aC5mbG9vcih0Lm5hbm9zZWNvbmRzIC8gMWUzKSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFZhbHVlOiBmcyhlLk0sIG4pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgV2MpIHJldHVybiB7XG4gICAgICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgbGF0aXR1ZGU6IHQubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiB0LmxvbmdpdHVkZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFFjKSByZXR1cm4ge1xuICAgICAgICAgICAgYnl0ZXNWYWx1ZTogZHMoZS5NLCB0Ll9ieXRlU3RyaW5nKVxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIHdjKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5kYXRhYmFzZUlkLCBzID0gdC5maXJlc3RvcmUuX2RhdGFiYXNlSWQ7XG4gICAgICAgICAgICBpZiAoIXMuaXNFcXVhbChuKSkgdGhyb3cgZS5hYyhgRG9jdW1lbnQgcmVmZXJlbmNlIGlzIGZvciBkYXRhYmFzZSAke3MucHJvamVjdElkfS8ke3MuZGF0YWJhc2V9IGJ1dCBzaG91bGQgYmUgZm9yIGRhdGFiYXNlICR7bi5wcm9qZWN0SWR9LyR7bi5kYXRhYmFzZX1gKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlVmFsdWU6IG1zKHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkIHx8IGUuZGF0YWJhc2VJZCwgdC5fa2V5LnBhdGgpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGUuYWMoYFVuc3VwcG9ydGVkIGZpZWxkIHZhbHVlOiAke2NjKHQpfWApO1xuICAgIH1cbiAgICAvKipcbiAqIENoZWNrcyB3aGV0aGVyIGFuIG9iamVjdCBsb29rcyBsaWtlIGEgSlNPTiBvYmplY3QgdGhhdCBzaG91bGQgYmUgY29udmVydGVkXG4gKiBpbnRvIGEgc3RydWN0LiBOb3JtYWwgY2xhc3MvcHJvdG90eXBlIGluc3RhbmNlcyBhcmUgY29uc2lkZXJlZCB0byBsb29rIGxpa2VcbiAqIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gYSBzdHJ1Y3QgdmFsdWUuIEFycmF5cywgRGF0ZXMsXG4gKiBHZW9Qb2ludHMsIGV0Yy4gYXJlIG5vdCBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZSBKU09OIG9iamVjdHMgc2luY2UgdGhleSBtYXBcbiAqIHRvIHNwZWNpZmljIEZpZWxkVmFsdWUgdHlwZXMgb3RoZXIgdGhhbiBPYmplY3RWYWx1ZS5cbiAqLyAodCwgZSk7XG59XG5cbmZ1bmN0aW9uIGZoKHQsIGUpIHtcbiAgICBjb25zdCBuID0ge307XG4gICAgcmV0dXJuIGZ0KHQpID8gXG4gICAgLy8gSWYgd2UgZW5jb3VudGVyIGFuIGVtcHR5IG9iamVjdCwgd2UgZXhwbGljaXRseSBhZGQgaXQgdG8gdGhlIHVwZGF0ZVxuICAgIC8vIG1hc2sgdG8gZW5zdXJlIHRoYXQgdGhlIHNlcnZlciBjcmVhdGVzIGEgbWFwIGVudHJ5LlxuICAgIGUucGF0aCAmJiBlLnBhdGgubGVuZ3RoID4gMCAmJiBlLmZpZWxkTWFzay5wdXNoKGUucGF0aCkgOiBsdCh0LCAoKHQsIHMpID0+IHtcbiAgICAgICAgY29uc3QgaSA9IGxoKHMsIGUuc2ModCkpO1xuICAgICAgICBudWxsICE9IGkgJiYgKG5bdF0gPSBpKTtcbiAgICB9KSksIHtcbiAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgIGZpZWxkczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gZGgodCkge1xuICAgIHJldHVybiAhKFwib2JqZWN0XCIgIT0gdHlwZW9mIHQgfHwgbnVsbCA9PT0gdCB8fCB0IGluc3RhbmNlb2YgQXJyYXkgfHwgdCBpbnN0YW5jZW9mIERhdGUgfHwgdCBpbnN0YW5jZW9mIGF0IHx8IHQgaW5zdGFuY2VvZiBXYyB8fCB0IGluc3RhbmNlb2YgUWMgfHwgdCBpbnN0YW5jZW9mIHdjIHx8IHQgaW5zdGFuY2VvZiBqYyk7XG59XG5cbmZ1bmN0aW9uIF9oKHQsIGUsIG4pIHtcbiAgICBpZiAoIWRoKG4pIHx8ICFmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBcIm9iamVjdFwiID09IHR5cGVvZiB0ICYmIG51bGwgIT09IHQgJiYgKE9iamVjdC5nZXRQcm90b3R5cGVPZih0KSA9PT0gT2JqZWN0LnByb3RvdHlwZSB8fCBudWxsID09PSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkpO1xuICAgIH0obikpIHtcbiAgICAgICAgY29uc3QgcyA9IGNjKG4pO1xuICAgICAgICB0aHJvdyBcImFuIG9iamVjdFwiID09PSBzID8gZS5hYyh0ICsgXCIgYSBjdXN0b20gb2JqZWN0XCIpIDogZS5hYyh0ICsgXCIgXCIgKyBzKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRoYXQgY2FsbHMgZnJvbURvdFNlcGFyYXRlZFN0cmluZygpIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxuICovIGZ1bmN0aW9uIHdoKHQsIGUsIG4pIHtcbiAgICBpZiAoKFxuICAgIC8vIElmIHJlcXVpcmVkLCByZXBsYWNlIHRoZSBGaWVsZFBhdGggQ29tcGF0IGNsYXNzIHdpdGggd2l0aCB0aGUgZmlyZXN0b3JlLWV4cFxuICAgIC8vIEZpZWxkUGF0aC5cbiAgICBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpKSBpbnN0YW5jZW9mIEtjKSByZXR1cm4gZS5faW50ZXJuYWxQYXRoO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlKSByZXR1cm4gZ2godCwgZSk7XG4gICAgdGhyb3cgeWgoXCJGaWVsZCBwYXRoIGFyZ3VtZW50cyBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nIG9yIFwiLCB0LCBcbiAgICAvKiBoYXNDb252ZXJ0ZXI9ICovICExLCBcbiAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xufVxuXG4vKipcbiAqIE1hdGNoZXMgYW55IGNoYXJhY3RlcnMgaW4gYSBmaWVsZCBwYXRoIHN0cmluZyB0aGF0IGFyZSByZXNlcnZlZC5cbiAqLyBjb25zdCBtaCA9IG5ldyBSZWdFeHAoXCJbflxcXFwqL1xcXFxbXFxcXF1dXCIpO1xuXG4vKipcbiAqIFdyYXBzIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcgd2l0aCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IHRoZSBtZXRob2QgdGhhdFxuICogd2FzIHRocm93bi5cbiAqIEBwYXJhbSBtZXRob2ROYW1lIC0gVGhlIHB1YmxpY2x5IHZpc2libGUgbWV0aG9kIG5hbWVcbiAqIEBwYXJhbSBwYXRoIC0gVGhlIGRvdC1zZXBhcmF0ZWQgc3RyaW5nIGZvcm0gb2YgYSBmaWVsZCBwYXRoIHdoaWNoIHdpbGwgYmVcbiAqIHNwbGl0IG9uIGRvdHMuXG4gKiBAcGFyYW0gdGFyZ2V0RG9jIC0gVGhlIGRvY3VtZW50IGFnYWluc3Qgd2hpY2ggdGhlIGZpZWxkIHBhdGggd2lsbCBiZVxuICogZXZhbHVhdGVkLlxuICovIGZ1bmN0aW9uIGdoKHQsIGUsIG4pIHtcbiAgICBpZiAoZS5zZWFyY2gobWgpID49IDApIHRocm93IHloKGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7ZX0pLiBQYXRocyBtdXN0IG5vdCBjb250YWluICd+JywgJyonLCAnLycsICdbJywgb3IgJ10nYCwgdCwgXG4gICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gbmV3IEtjKC4uLmUuc3BsaXQoXCIuXCIpKS5faW50ZXJuYWxQYXRoO1xuICAgIH0gY2F0Y2ggKHMpIHtcbiAgICAgICAgdGhyb3cgeWgoYEludmFsaWQgZmllbGQgcGF0aCAoJHtlfSkuIFBhdGhzIG11c3Qgbm90IGJlIGVtcHR5LCBiZWdpbiB3aXRoICcuJywgZW5kIHdpdGggJy4nLCBvciBjb250YWluICcuLidgLCB0LCBcbiAgICAgICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgICAgIC8qIHBhdGg9ICovIHZvaWQgMCwgbik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB5aCh0LCBlLCBuLCBzLCBpKSB7XG4gICAgY29uc3QgciA9IHMgJiYgIXMuaXNFbXB0eSgpLCBvID0gdm9pZCAwICE9PSBpO1xuICAgIGxldCB1ID0gYEZ1bmN0aW9uICR7ZX0oKSBjYWxsZWQgd2l0aCBpbnZhbGlkIGRhdGFgO1xuICAgIG4gJiYgKHUgKz0gXCIgKHZpYSBgdG9GaXJlc3RvcmUoKWApXCIpLCB1ICs9IFwiLiBcIjtcbiAgICBsZXQgYSA9IFwiXCI7XG4gICAgcmV0dXJuIChyIHx8IG8pICYmIChhICs9IFwiIChmb3VuZFwiLCByICYmIChhICs9IGAgaW4gZmllbGQgJHtzfWApLCBvICYmIChhICs9IGAgaW4gZG9jdW1lbnQgJHtpfWApLCBcbiAgICBhICs9IFwiKVwiKSwgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCB1ICsgdCArIGEpO1xufVxuXG4vKiogQ2hlY2tzIGBoYXlzdGFja2AgaWYgRmllbGRQYXRoIGBuZWVkbGVgIGlzIHByZXNlbnQuIFJ1bnMgaW4gTyhuKS4gKi8gZnVuY3Rpb24gcGgodCwgZSkge1xuICAgIHJldHVybiB0LnNvbWUoKHQgPT4gdC5pc0VxdWFsKGUpKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91ciBGaXJlc3RvcmVcbiAqIGRhdGFiYXNlLiBUaGUgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0b1xuICogZ2V0IGEgc3BlY2lmaWMgZmllbGQuXG4gKlxuICogRm9yIGEgYERvY3VtZW50U25hcHNob3RgIHRoYXQgcG9pbnRzIHRvIGEgbm9uLWV4aXN0aW5nIGRvY3VtZW50LCBhbnkgZGF0YVxuICogYWNjZXNzIHdpbGwgcmV0dXJuICd1bmRlZmluZWQnLiBZb3UgY2FuIHVzZSB0aGUgYGV4aXN0cygpYCBtZXRob2QgdG9cbiAqIGV4cGxpY2l0bHkgdmVyaWZ5IGEgZG9jdW1lbnQncyBleGlzdGVuY2UuXG4gKi8gY2xhc3MgSWgge1xuICAgIC8vIE5vdGU6IFRoaXMgY2xhc3MgaXMgc3RyaXBwZWQgZG93biB2ZXJzaW9uIG9mIHRoZSBEb2N1bWVudFNuYXBzaG90IGluXG4gICAgLy8gdGhlIGxlZ2FjeSBTREsuIFRoZSBjaGFuZ2VzIGFyZTpcbiAgICAvLyAtIE5vIHN1cHBvcnQgZm9yIFNuYXBzaG90TWV0YWRhdGEuXG4gICAgLy8gLSBObyBzdXBwb3J0IGZvciBTbmFwc2hvdE9wdGlvbnMuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl91c2VyRGF0YVdyaXRlciA9IGUsIHRoaXMuX2tleSA9IG4sIHRoaXMuX2RvY3VtZW50ID0gcywgXG4gICAgICAgIHRoaXMuX2NvbnZlcnRlciA9IGk7XG4gICAgfVxuICAgIC8qKiBQcm9wZXJ0eSBvZiB0aGUgYERvY3VtZW50U25hcHNob3RgIHRoYXQgcHJvdmlkZXMgdGhlIGRvY3VtZW50J3MgSUQuICovICAgIGdldCBpZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoLmxhc3RTZWdtZW50KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBgRG9jdW1lbnRSZWZlcmVuY2VgIGZvciB0aGUgZG9jdW1lbnQgaW5jbHVkZWQgaW4gdGhlIGBEb2N1bWVudFNuYXBzaG90YC5cbiAgICAgKi8gICAgZ2V0IHJlZigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB3Yyh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX2NvbnZlcnRlciwgdGhpcy5fa2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2lnbmFscyB3aGV0aGVyIG9yIG5vdCB0aGUgZG9jdW1lbnQgYXQgdGhlIHNuYXBzaG90J3MgbG9jYXRpb24gZXhpc3RzLlxuICAgICAqXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgZG9jdW1lbnQgZXhpc3RzLlxuICAgICAqLyAgICBleGlzdHMoKSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLl9kb2N1bWVudDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmXG4gICAgICogdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBbiBgT2JqZWN0YCBjb250YWluaW5nIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IG9yIGB1bmRlZmluZWRgXG4gICAgICogaWYgdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICovICAgIGRhdGEoKSB7XG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnZlcnRlcikge1xuICAgICAgICAgICAgICAgIC8vIFdlIG9ubHkgd2FudCB0byB1c2UgdGhlIGNvbnZlcnRlciBhbmQgY3JlYXRlIGEgbmV3IERvY3VtZW50U25hcHNob3RcbiAgICAgICAgICAgICAgICAvLyBpZiBhIGNvbnZlcnRlciBoYXMgYmVlbiBwcm92aWRlZC5cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IFRoKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIsIHRoaXMuX2tleSwgdGhpcy5fZG9jdW1lbnQsIFxuICAgICAgICAgICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRlci5mcm9tRmlyZXN0b3JlKHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZSh0aGlzLl9kb2N1bWVudC5kYXRhLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgdGhlIGZpZWxkIHNwZWNpZmllZCBieSBgZmllbGRQYXRoYC4gUmV0dXJucyBgdW5kZWZpbmVkYCBpZiB0aGVcbiAgICAgKiBkb2N1bWVudCBvciBmaWVsZCBkb2Vzbid0IGV4aXN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIChmb3IgZXhhbXBsZSAnZm9vJyBvciAnZm9vLmJhcicpIHRvIGEgc3BlY2lmaWNcbiAgICAgKiBmaWVsZC5cbiAgICAgKiBAcmV0dXJucyBUaGUgZGF0YSBhdCB0aGUgc3BlY2lmaWVkIGZpZWxkIGxvY2F0aW9uIG9yIHVuZGVmaW5lZCBpZiBubyBzdWNoXG4gICAgICogZmllbGQgZXhpc3RzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICAvLyBXZSBhcmUgdXNpbmcgYGFueWAgaGVyZSB0byBhdm9pZCBhbiBleHBsaWNpdCBjYXN0IGJ5IG91ciB1c2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGdldCh0KSB7XG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX2RvY3VtZW50LmRhdGEuZmllbGQoRWgoXCJEb2N1bWVudFNuYXBzaG90LmdldFwiLCB0KSk7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gZSkgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZShlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91clxuICogRmlyZXN0b3JlIGRhdGFiYXNlIGFzIHBhcnQgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50IGlzIGd1YXJhbnRlZWQgdG8gZXhpc3RcbiAqIGFuZCBpdHMgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0byBnZXQgYVxuICogc3BlY2lmaWMgZmllbGQuXG4gKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBvZmZlcnMgdGhlIHNhbWUgQVBJIHN1cmZhY2UgYXMgYVxuICogYERvY3VtZW50U25hcHNob3RgLiBTaW5jZSBxdWVyeSByZXN1bHRzIGNvbnRhaW4gb25seSBleGlzdGluZyBkb2N1bWVudHMsIHRoZVxuICogYGV4aXN0c2AgcHJvcGVydHkgd2lsbCBhbHdheXMgYmUgdHJ1ZSBhbmQgYGRhdGEoKWAgd2lsbCBuZXZlciByZXR1cm5cbiAqICd1bmRlZmluZWQnLlxuICovIGNsYXNzIFRoIGV4dGVuZHMgSWgge1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBhcyBhbiBgT2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRhdGEoKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRoYXQgY2FsbHMgYGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcoKWAgYnV0IHdyYXBzIGFueSBlcnJvciB0aHJvd24uXG4gKi8gZnVuY3Rpb24gRWgodCwgZSkge1xuICAgIHJldHVybiBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gZ2godCwgZSkgOiBlIGluc3RhbmNlb2YgS2MgPyBlLl9pbnRlcm5hbFBhdGggOiBlLl9kZWxlZ2F0ZS5faW50ZXJuYWxQYXRoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBNZXRhZGF0YSBhYm91dCBhIHNuYXBzaG90LCBkZXNjcmliaW5nIHRoZSBzdGF0ZSBvZiB0aGUgc25hcHNob3QuXG4gKi8gY2xhc3MgQWgge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPSB0LCB0aGlzLmZyb21DYWNoZSA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBTbmFwc2hvdE1ldGFkYXRhYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBTbmFwc2hvdE1ldGFkYXRhYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzUGVuZGluZ1dyaXRlcyA9PT0gdC5oYXNQZW5kaW5nV3JpdGVzICYmIHRoaXMuZnJvbUNhY2hlID09PSB0LmZyb21DYWNoZTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyIEZpcmVzdG9yZVxuICogZGF0YWJhc2UuIFRoZSBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvXG4gKiBnZXQgYSBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBGb3IgYSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwb2ludHMgdG8gYSBub24tZXhpc3RpbmcgZG9jdW1lbnQsIGFueSBkYXRhXG4gKiBhY2Nlc3Mgd2lsbCByZXR1cm4gJ3VuZGVmaW5lZCcuIFlvdSBjYW4gdXNlIHRoZSBgZXhpc3RzKClgIG1ldGhvZCB0b1xuICogZXhwbGljaXRseSB2ZXJpZnkgYSBkb2N1bWVudCdzIGV4aXN0ZW5jZS5cbiAqLyBjbGFzcyBSaCBleHRlbmRzIEloIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4sIHMsIHIpLCB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl9maXJlc3RvcmVJbXBsID0gdCwgdGhpcy5tZXRhZGF0YSA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGRhdGEgZXhpc3RzLiBUcnVlIGlmIHRoZSBkb2N1bWVudCBleGlzdHMuXG4gICAgICovICAgIGV4aXN0cygpIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmV4aXN0cygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgYmgodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgdGhpcy5tZXRhZGF0YSwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUoZSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUsIHQuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGEgYHNlcnZlclRpbWVzdGFtcCgpYCB0aGF0IGhhcyBub3QgeWV0IGJlZW4gc2V0IHRvXG4gICAgICogaXRzIGZpbmFsIHZhbHVlIHdpbGwgYmUgcmV0dXJuZWQgYXMgYG51bGxgLiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgYnlcbiAgICAgKiBwYXNzaW5nIGFuIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIChmb3IgZXhhbXBsZSAnZm9vJyBvciAnZm9vLmJhcicpIHRvIGEgc3BlY2lmaWNcbiAgICAgKiBmaWVsZC5cbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgdGhlIGZpZWxkIGlzIHJldHJpZXZlZFxuICAgICAqIGZyb20gdGhlIHNuYXBzaG90IChmb3IgZXhhbXBsZSB0aGUgZGVzaXJlZCBiZWhhdmlvciBmb3Igc2VydmVyIHRpbWVzdGFtcHNcbiAgICAgKiB0aGF0IGhhdmUgbm90IHlldCBiZWVuIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSkuXG4gICAgICogQHJldHVybnMgVGhlIGRhdGEgYXQgdGhlIHNwZWNpZmllZCBmaWVsZCBsb2NhdGlvbiBvciB1bmRlZmluZWQgaWYgbm8gc3VjaFxuICAgICAqIGZpZWxkIGV4aXN0cyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgLy8gV2UgYXJlIHVzaW5nIGBhbnlgIGhlcmUgdG8gYXZvaWQgYW4gZXhwbGljaXQgY2FzdCBieSBvdXIgdXNlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBnZXQodCwgZSA9IHt9KSB7XG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2RvY3VtZW50LmRhdGEuZmllbGQoRWgoXCJEb2N1bWVudFNuYXBzaG90LmdldFwiLCB0KSk7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gbikgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZShuLCBlLnNlcnZlclRpbWVzdGFtcHMpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UgYXMgcGFydCBvZiBhIHF1ZXJ5LiBUaGUgZG9jdW1lbnQgaXMgZ3VhcmFudGVlZCB0byBleGlzdFxuICogYW5kIGl0cyBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvIGdldCBhXG4gKiBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIG9mZmVycyB0aGUgc2FtZSBBUEkgc3VyZmFjZSBhcyBhXG4gKiBgRG9jdW1lbnRTbmFwc2hvdGAuIFNpbmNlIHF1ZXJ5IHJlc3VsdHMgY29udGFpbiBvbmx5IGV4aXN0aW5nIGRvY3VtZW50cywgdGhlXG4gKiBgZXhpc3RzYCBwcm9wZXJ0eSB3aWxsIGFsd2F5cyBiZSB0cnVlIGFuZCBgZGF0YSgpYCB3aWxsIG5ldmVyIHJldHVyblxuICogJ3VuZGVmaW5lZCcuXG4gKi8gY2xhc3MgYmggZXh0ZW5kcyBSaCB7XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLlxuICAgICAqXG4gICAgICogQnkgZGVmYXVsdCwgYHNlcnZlclRpbWVzdGFtcCgpYCB2YWx1ZXMgdGhhdCBoYXZlIG5vdCB5ZXQgYmVlblxuICAgICAqIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSB3aWxsIGJlIHJldHVybmVkIGFzIGBudWxsYC4gWW91IGNhbiBvdmVycmlkZVxuICAgICAqIHRoaXMgYnkgcGFzc2luZyBhbiBvcHRpb25zIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb3B0aW9ucyBvYmplY3QgdG8gY29uZmlndXJlIGhvdyBkYXRhIGlzIHJldHJpZXZlZCBmcm9tXG4gICAgICogdGhlIHNuYXBzaG90IChmb3IgZXhhbXBsZSB0aGUgZGVzaXJlZCBiZWhhdmlvciBmb3Igc2VydmVyIHRpbWVzdGFtcHMgdGhhdFxuICAgICAqIGhhdmUgbm90IHlldCBiZWVuIHNldCB0byB0aGVpciBmaW5hbCB2YWx1ZSkuXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBkYXRhKHQgPSB7fSkge1xuICAgICAgICByZXR1cm4gc3VwZXIuZGF0YSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlTbmFwc2hvdGAgY29udGFpbnMgemVybyBvciBtb3JlIGBEb2N1bWVudFNuYXBzaG90YCBvYmplY3RzXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdHMgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50cyBjYW4gYmUgYWNjZXNzZWQgYXMgYW5cbiAqIGFycmF5IHZpYSB0aGUgYGRvY3NgIHByb3BlcnR5IG9yIGVudW1lcmF0ZWQgdXNpbmcgdGhlIGBmb3JFYWNoYCBtZXRob2QuIFRoZVxuICogbnVtYmVyIG9mIGRvY3VtZW50cyBjYW4gYmUgZGV0ZXJtaW5lZCB2aWEgdGhlIGBlbXB0eWAgYW5kIGBzaXplYFxuICogcHJvcGVydGllcy5cbiAqLyBjbGFzcyBQaCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX3VzZXJEYXRhV3JpdGVyID0gZSwgdGhpcy5fc25hcHNob3QgPSBzLCB0aGlzLm1ldGFkYXRhID0gbmV3IEFoKHMuaGFzUGVuZGluZ1dyaXRlcywgcy5mcm9tQ2FjaGUpLCBcbiAgICAgICAgdGhpcy5xdWVyeSA9IG47XG4gICAgfVxuICAgIC8qKiBBbiBhcnJheSBvZiBhbGwgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLiAqLyAgICBnZXQgZG9jcygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHQucHVzaChlKSkpLCB0O1xuICAgIH1cbiAgICAvKiogVGhlIG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zbmFwc2hvdC5kb2NzLnNpemU7XG4gICAgfVxuICAgIC8qKiBUcnVlIGlmIHRoZXJlIGFyZSBubyBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gMCA9PT0gdGhpcy5zaXplO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbnVtZXJhdGVzIGFsbCBvZiB0aGUgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBBIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aXRoIGEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgZm9yXG4gICAgICogZWFjaCBkb2N1bWVudCBpbiB0aGUgc25hcHNob3QuXG4gICAgICogQHBhcmFtIHRoaXNBcmcgLSBUaGUgYHRoaXNgIGJpbmRpbmcgZm9yIHRoZSBjYWxsYmFjay5cbiAgICAgKi8gICAgZm9yRWFjaCh0LCBlKSB7XG4gICAgICAgIHRoaXMuX3NuYXBzaG90LmRvY3MuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICB0LmNhbGwoZSwgbmV3IGJoKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIsIG4ua2V5LCBuLCBuZXcgQWgodGhpcy5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKG4ua2V5KSwgdGhpcy5fc25hcHNob3QuZnJvbUNhY2hlKSwgdGhpcy5xdWVyeS5jb252ZXJ0ZXIpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIHRoZSBkb2N1bWVudHMgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCBzbmFwc2hvdC4gSWYgdGhpc1xuICAgICAqIGlzIHRoZSBmaXJzdCBzbmFwc2hvdCwgYWxsIGRvY3VtZW50cyB3aWxsIGJlIGluIHRoZSBsaXN0IGFzICdhZGRlZCdcbiAgICAgKiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBgU25hcHNob3RMaXN0ZW5PcHRpb25zYCB0aGF0IGNvbnRyb2wgd2hldGhlciBtZXRhZGF0YS1vbmx5XG4gICAgICogY2hhbmdlcyAoaS5lLiBvbmx5IGBEb2N1bWVudFNuYXBzaG90Lm1ldGFkYXRhYCBjaGFuZ2VkKSBzaG91bGQgdHJpZ2dlclxuICAgICAqIHNuYXBzaG90IGV2ZW50cy5cbiAgICAgKi8gICAgZG9jQ2hhbmdlcyh0ID0ge30pIHtcbiAgICAgICAgY29uc3QgZSA9ICEhdC5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzO1xuICAgICAgICBpZiAoZSAmJiB0aGlzLl9zbmFwc2hvdC5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcykgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIlRvIGluY2x1ZGUgbWV0YWRhdGEgY2hhbmdlcyB3aXRoIHlvdXIgZG9jdW1lbnQgY2hhbmdlcywgeW91IG11c3QgYWxzbyBwYXNzIHsgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczp0cnVlIH0gdG8gb25TbmFwc2hvdCgpLlwiKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZENoYW5nZXMgJiYgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPT09IGUgfHwgKHRoaXMuX2NhY2hlZENoYW5nZXMgPSBcbiAgICAgICAgLyoqIENhbGN1bGF0ZXMgdGhlIGFycmF5IG9mIGBEb2N1bWVudENoYW5nZWBzIGZvciBhIGdpdmVuIGBWaWV3U25hcHNob3RgLiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAodC5fc25hcHNob3Qub2xkRG9jcy5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuX3NuYXBzaG90LmRvY0NoYW5nZXMubWFwKChuID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYWRkZWRcIixcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBuZXcgYmgodC5fZmlyZXN0b3JlLCB0Ll91c2VyRGF0YVdyaXRlciwgbi5kb2Mua2V5LCBuLmRvYywgbmV3IEFoKHQuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmRvYy5rZXkpLCB0Ll9zbmFwc2hvdC5mcm9tQ2FjaGUpLCB0LnF1ZXJ5LmNvbnZlcnRlciksXG4gICAgICAgICAgICAgICAgICAgIG9sZEluZGV4OiAtMSxcbiAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXg6IGUrK1xuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy8gQSBgRG9jdW1lbnRTZXRgIHRoYXQgaXMgdXBkYXRlZCBpbmNyZW1lbnRhbGx5IGFzIGNoYW5nZXMgYXJlIGFwcGxpZWQgdG8gdXNlXG4gICAgICAgICAgICAgICAgLy8gdG8gbG9va3VwIHRoZSBpbmRleCBvZiBhIGRvY3VtZW50LlxuICAgICAgICAgICAgICAgIGxldCBuID0gdC5fc25hcHNob3Qub2xkRG9jcztcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5fc25hcHNob3QuZG9jQ2hhbmdlcy5maWx0ZXIoKHQgPT4gZSB8fCAzIC8qIE1ldGFkYXRhICovICE9PSB0LnR5cGUpKS5tYXAoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IGJoKHQuX2ZpcmVzdG9yZSwgdC5fdXNlckRhdGFXcml0ZXIsIGUuZG9jLmtleSwgZS5kb2MsIG5ldyBBaCh0Ll9zbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMoZS5kb2Mua2V5KSwgdC5fc25hcHNob3QuZnJvbUNhY2hlKSwgdC5xdWVyeS5jb252ZXJ0ZXIpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IC0xLCByID0gLTE7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwIC8qIEFkZGVkICovICE9PSBlLnR5cGUgJiYgKGkgPSBuLmluZGV4T2YoZS5kb2Mua2V5KSwgbiA9IG4uZGVsZXRlKGUuZG9jLmtleSkpLCBcbiAgICAgICAgICAgICAgICAgICAgMSAvKiBSZW1vdmVkICovICE9PSBlLnR5cGUgJiYgKG4gPSBuLmFkZChlLmRvYyksIHIgPSBuLmluZGV4T2YoZS5kb2Mua2V5KSksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFZoKGUudHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2M6IHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRJbmRleDogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZGV4OiByXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHRoaXMsIGUpLCB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9IGUpLCB0aGlzLl9jYWNoZWRDaGFuZ2VzO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVmgodCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSAwIC8qIEFkZGVkICovIDpcbiAgICAgICAgcmV0dXJuIFwiYWRkZWRcIjtcblxuICAgICAgY2FzZSAyIC8qIE1vZGlmaWVkICovIDpcbiAgICAgIGNhc2UgMyAvKiBNZXRhZGF0YSAqLyA6XG4gICAgICAgIHJldHVybiBcIm1vZGlmaWVkXCI7XG5cbiAgICAgIGNhc2UgMSAvKiBSZW1vdmVkICovIDpcbiAgICAgICAgcmV0dXJuIFwicmVtb3ZlZFwiO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTCgpO1xuICAgIH1cbn1cblxuLy8gVE9ETyhmaXJlc3RvcmVleHApOiBBZGQgdGVzdHMgZm9yIHNuYXBzaG90RXF1YWwgd2l0aCBkaWZmZXJlbnQgc25hcHNob3Rcbi8vIG1ldGFkYXRhXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgc25hcHNob3RzIGFyZSBlcXVhbC5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgc25hcHNob3QgdG8gY29tcGFyZS5cbiAqIEBwYXJhbSByaWdodCAtIEEgc25hcHNob3QgdG8gY29tcGFyZS5cbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHNuYXBzaG90cyBhcmUgZXF1YWwuXG4gKi8gZnVuY3Rpb24gdmgodCwgZSkge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgUmggJiYgZSBpbnN0YW5jZW9mIFJoID8gdC5fZmlyZXN0b3JlID09PSBlLl9maXJlc3RvcmUgJiYgdC5fa2V5LmlzRXF1YWwoZS5fa2V5KSAmJiAobnVsbCA9PT0gdC5fZG9jdW1lbnQgPyBudWxsID09PSBlLl9kb2N1bWVudCA6IHQuX2RvY3VtZW50LmlzRXF1YWwoZS5fZG9jdW1lbnQpKSAmJiB0Ll9jb252ZXJ0ZXIgPT09IGUuX2NvbnZlcnRlciA6IHQgaW5zdGFuY2VvZiBQaCAmJiBlIGluc3RhbmNlb2YgUGggJiYgKHQuX2ZpcmVzdG9yZSA9PT0gZS5fZmlyZXN0b3JlICYmIEVjKHQucXVlcnksIGUucXVlcnkpICYmIHQubWV0YWRhdGEuaXNFcXVhbChlLm1ldGFkYXRhKSAmJiB0Ll9zbmFwc2hvdC5pc0VxdWFsKGUuX3NuYXBzaG90KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIFNoKHQpIHtcbiAgICBpZiAoXCJMXCIgLyogTGFzdCAqLyA9PT0gdC5saW1pdFR5cGUgJiYgMCA9PT0gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoKSB0aHJvdyBuZXcgUShHLlVOSU1QTEVNRU5URUQsIFwibGltaXRUb0xhc3QoKSBxdWVyaWVzIHJlcXVpcmUgc3BlY2lmeWluZyBhdCBsZWFzdCBvbmUgb3JkZXJCeSgpIGNsYXVzZVwiKTtcbn1cblxuLyoqXG4gKiBBIGBRdWVyeUNvbnN0cmFpbnRgIGlzIHVzZWQgdG8gbmFycm93IHRoZSBzZXQgb2YgZG9jdW1lbnRzIHJldHVybmVkIGJ5IGFcbiAqIEZpcmVzdG9yZSBxdWVyeS4gYFF1ZXJ5Q29uc3RyYWludGBzIGFyZSBjcmVhdGVkIGJ5IGludm9raW5nIHtAbGluayB3aGVyZX0sXG4gKiB7QGxpbmsgb3JkZXJCeX0sIHtAbGluayAoc3RhcnRBdDoxKX0sIHtAbGluayAoc3RhcnRBZnRlcjoxKX0sIHtAbGlua1xuICogZW5kQmVmb3JlOjF9LCB7QGxpbmsgKGVuZEF0OjEpfSwge0BsaW5rIGxpbWl0fSBvciB7QGxpbmsgbGltaXRUb0xhc3R9IGFuZFxuICogY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayBxdWVyeX0gdG8gY3JlYXRlIGEgbmV3IHF1ZXJ5IGluc3RhbmNlIHRoYXRcbiAqIGFsc28gY29udGFpbnMgdGhpcyBgUXVlcnlDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBEaCB7fVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgaW1tdXRhYmxlIGluc3RhbmNlIG9mIHtAbGluayBRdWVyeX0gdGhhdCBpcyBleHRlbmRlZCB0byBhbHNvIGluY2x1ZGVcbiAqIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gKlxuICogQHBhcmFtIHF1ZXJ5IC0gVGhlIHtAbGluayBRdWVyeX0gaW5zdGFuY2UgdG8gdXNlIGFzIGEgYmFzZSBmb3IgdGhlIG5ldyBjb25zdHJhaW50cy5cbiAqIEBwYXJhbSBxdWVyeUNvbnN0cmFpbnRzIC0gVGhlIGxpc3Qgb2Yge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH1zIHRvIGFwcGx5LlxuICogQHRocm93cyBpZiBhbnkgb2YgdGhlIHByb3ZpZGVkIHF1ZXJ5IGNvbnN0cmFpbnRzIGNhbm5vdCBiZSBjb21iaW5lZCB3aXRoIHRoZVxuICogZXhpc3Rpbmcgb3IgbmV3IGNvbnN0cmFpbnRzLlxuICovIGZ1bmN0aW9uIENoKHQsIC4uLmUpIHtcbiAgICBmb3IgKGNvbnN0IG4gb2YgZSkgdCA9IG4uX2FwcGx5KHQpO1xuICAgIHJldHVybiB0O1xufVxuXG5jbGFzcyB4aCBleHRlbmRzIERoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuX2MgPSB0LCB0aGlzLndjID0gZSwgdGhpcy5tYyA9IG4sIHRoaXMudHlwZSA9IFwid2hlcmVcIjtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoKHQuZmlyZXN0b3JlKSwgbiA9IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIsIG8pIHtcbiAgICAgICAgICAgIGxldCB1O1xuICAgICAgICAgICAgaWYgKGkuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyA9PT0gciB8fCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gcikgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gWW91IGNhbid0IHBlcmZvcm0gJyR7cn0nIHF1ZXJpZXMgb24gZG9jdW1lbnRJZCgpLmApO1xuICAgICAgICAgICAgICAgIGlmIChcImluXCIgLyogSU4gKi8gPT09IHIgfHwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gPT09IHIpIHtcbiAgICAgICAgICAgICAgICAgICAgV2gobywgcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIG8pIGUucHVzaChqaChzLCB0LCBuKSk7XG4gICAgICAgICAgICAgICAgICAgIHUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHUgPSBqaChzLCB0LCBvKTtcbiAgICAgICAgICAgIH0gZWxzZSBcImluXCIgLyogSU4gKi8gIT09IHIgJiYgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gIT09IHIgJiYgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gIT09IHIgfHwgV2gobywgciksIFxuICAgICAgICAgICAgdSA9IGhoKG4sIGUsIG8sIFxuICAgICAgICAgICAgLyogYWxsb3dBcnJheXM9ICovIFwiaW5cIiAvKiBJTiAqLyA9PT0gciB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gcik7XG4gICAgICAgICAgICBjb25zdCBhID0gVmUuY3JlYXRlKGksIHIsIHUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS5TKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGplKHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gbiAmJiAhbi5pc0VxdWFsKGUuZmllbGQpKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBBbGwgd2hlcmUgZmlsdGVycyB3aXRoIGFuIGluZXF1YWxpdHkgKDwsIDw9LCAhPSwgbm90LWluLCA+LCBvciA+PSkgbXVzdCBiZSBvbiB0aGUgc2FtZSBmaWVsZC4gQnV0IHlvdSBoYXZlIGluZXF1YWxpdHkgZmlsdGVycyBvbiAnJHtuLnRvU3RyaW5nKCl9JyBhbmQgJyR7ZS5maWVsZC50b1N0cmluZygpfSdgKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IFFlKHQpO1xuICAgICAgICAgICAgICAgICAgICBudWxsICE9PSBzICYmIHpoKHQsIGUuZmllbGQsIHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoZS5pbmRleE9mKG4ub3ApID49IDApIHJldHVybiBuLm9wO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9KHQsIFxuICAgICAgICAgICAgICAgIC8qKlxuICogR2l2ZW4gYW4gb3BlcmF0b3IsIHJldHVybnMgdGhlIHNldCBvZiBvcGVyYXRvcnMgdGhhdCBjYW5ub3QgYmUgdXNlZCB3aXRoIGl0LlxuICpcbiAqIE9wZXJhdG9ycyBpbiBhIHF1ZXJ5IG11c3QgYWRoZXJlIHRvIHRoZSBmb2xsb3dpbmcgc2V0IG9mIHJ1bGVzOlxuICogMS4gT25seSBvbmUgYXJyYXkgb3BlcmF0b3IgaXMgYWxsb3dlZC5cbiAqIDIuIE9ubHkgb25lIGRpc2p1bmN0aXZlIG9wZXJhdG9yIGlzIGFsbG93ZWQuXG4gKiAzLiBgTk9UX0VRVUFMYCBjYW5ub3QgYmUgdXNlZCB3aXRoIGFub3RoZXIgYE5PVF9FUVVBTGAgb3BlcmF0b3IuXG4gKiA0LiBgTk9UX0lOYCBjYW5ub3QgYmUgdXNlZCB3aXRoIGFycmF5LCBkaXNqdW5jdGl2ZSwgb3IgYE5PVF9FUVVBTGAgb3BlcmF0b3JzLlxuICpcbiAqIEFycmF5IG9wZXJhdG9yczogYEFSUkFZX0NPTlRBSU5TYCwgYEFSUkFZX0NPTlRBSU5TX0FOWWBcbiAqIERpc2p1bmN0aXZlIG9wZXJhdG9yczogYElOYCwgYEFSUkFZX0NPTlRBSU5TX0FOWWAsIGBOT1RfSU5gXG4gKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcIiE9XCIgLyogTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpblwiIC8qIElOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJpblwiIC8qIElOICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXTtcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovICwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcImluXCIgLyogSU4gKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gLCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAsIFwiaW5cIiAvKiBJTiAqLyAsIFwibm90LWluXCIgLyogTk9UX0lOICovICwgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0oZS5vcCkpO1xuICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBuKSBcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2Ugd2hlbiBpdCdzIGEgZHVwbGljYXRlIG9wIHRvIGdpdmUgYSBzbGlnaHRseSBjbGVhcmVyIGVycm9yIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgdGhyb3cgbiA9PT0gZS5vcCA/IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFlvdSBjYW5ub3QgdXNlIG1vcmUgdGhhbiBvbmUgJyR7ZS5vcC50b1N0cmluZygpfScgZmlsdGVyLmApIDogbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgJyR7ZS5vcC50b1N0cmluZygpfScgZmlsdGVycyB3aXRoICcke24udG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG4gICAgICAgICAgICB9KHQsIGEpLCBhO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBcIndoZXJlXCIsIGUsIHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCB0aGlzLl9jLCB0aGlzLndjLCB0aGlzLm1jKTtcbiAgICAgICAgcmV0dXJuIG5ldyBtYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmZpbHRlcnMuY29uY2F0KFsgZSBdKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVWUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgbiwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG4gICAgICAgIH0odC5fcXVlcnksIG4pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHtAbGluayBRdWVyeUNvbnN0cmFpbnR9IHRoYXQgZW5mb3JjZXMgdGhhdCBkb2N1bWVudHMgbXVzdCBjb250YWluIHRoZVxuICogc3BlY2lmaWVkIGZpZWxkIGFuZCB0aGF0IHRoZSB2YWx1ZSBzaG91bGQgc2F0aXNmeSB0aGUgcmVsYXRpb24gY29uc3RyYWludFxuICogcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIHRvIGNvbXBhcmVcbiAqIEBwYXJhbSBvcFN0ciAtIFRoZSBvcGVyYXRpb24gc3RyaW5nIChlLmcgXCImbHQ7XCIsIFwiJmx0Oz1cIiwgXCI9PVwiLCBcIiZsdDtcIixcbiAqICAgXCImbHQ7PVwiLCBcIiE9XCIpLlxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIGZvciBjb21wYXJpc29uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIE5oKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gZSwgaSA9IEVoKFwid2hlcmVcIiwgdCk7XG4gICAgcmV0dXJuIG5ldyB4aChpLCBzLCBuKTtcbn1cblxuY2xhc3Mga2ggZXh0ZW5kcyBEaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLl9jID0gdCwgdGhpcy5nYyA9IGUsIHRoaXMudHlwZSA9IFwib3JkZXJCeVwiO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQuc3RhcnRBdCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFlvdSBtdXN0IG5vdCBjYWxsIHN0YXJ0QXQoKSBvciBzdGFydEFmdGVyKCkgYmVmb3JlIGNhbGxpbmcgb3JkZXJCeSgpLlwiKTtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSB0LmVuZEF0KSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgZW5kQXQoKSBvciBlbmRCZWZvcmUoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBGZShlLCBuKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgPT09IFFlKHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IG9yZGVyIGJ5LiBJdCBtdXN0IG1hdGNoIGFueSBpbmVxdWFsaXR5LlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gamUodCk7XG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT09IG4gJiYgemgodCwgbiwgZS5maWVsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSh0LCBzKSwgcztcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIENyZWF0ZSBhIGBCb3VuZGAgZnJvbSBhIHF1ZXJ5IGFuZCBhIGRvY3VtZW50LlxuICpcbiAqIE5vdGUgdGhhdCB0aGUgYEJvdW5kYCB3aWxsIGFsd2F5cyBpbmNsdWRlIHRoZSBrZXkgb2YgdGhlIGRvY3VtZW50XG4gKiBhbmQgc28gb25seSB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgd2lsbCBjb21wYXJlIGVxdWFsIHRvIHRoZSByZXR1cm5lZFxuICogcG9zaXRpb24uXG4gKlxuICogV2lsbCB0aHJvdyBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgY29udGFpbiBhbGwgZmllbGRzIG9mIHRoZSBvcmRlciBieVxuICogb2YgdGhlIHF1ZXJ5IG9yIGlmIGFueSBvZiB0aGUgZmllbGRzIGluIHRoZSBvcmRlciBieSBhcmUgYW4gdW5jb21taXR0ZWRcbiAqIHNlcnZlciB0aW1lc3RhbXAuXG4gKi8gKHQuX3F1ZXJ5LCB0aGlzLl9jLCB0aGlzLmdjKTtcbiAgICAgICAgcmV0dXJuIG5ldyBtYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGUgdGhhdCBvcmRlckJ5IGRvZXMgbm90IGxpc3QgdGhlIHNhbWUga2V5IHR3aWNlLlxuICAgICAgICAgICAgY29uc3QgbiA9IHQuZXhwbGljaXRPcmRlckJ5LmNvbmNhdChbIGUgXSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVlKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIG4sIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBzb3J0cyB0aGUgcXVlcnkgcmVzdWx0IGJ5IHRoZVxuICogc3BlY2lmaWVkIGZpZWxkLCBvcHRpb25hbGx5IGluIGRlc2NlbmRpbmcgb3JkZXIgaW5zdGVhZCBvZiBhc2NlbmRpbmcuXG4gKlxuICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBmaWVsZCB0byBzb3J0IGJ5LlxuICogQHBhcmFtIGRpcmVjdGlvblN0ciAtIE9wdGlvbmFsIGRpcmVjdGlvbiB0byBzb3J0IGJ5ICgnYXNjJyBvciAnZGVzYycpLiBJZlxuICogbm90IHNwZWNpZmllZCwgb3JkZXIgd2lsbCBiZSBhc2NlbmRpbmcuXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIE1oKHQsIGUgPSBcImFzY1wiKSB7XG4gICAgY29uc3QgbiA9IGUsIHMgPSBFaChcIm9yZGVyQnlcIiwgdCk7XG4gICAgcmV0dXJuIG5ldyBraChzLCBuKTtcbn1cblxuY2xhc3MgT2ggZXh0ZW5kcyBEaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLnljID0gZSwgdGhpcy5JYyA9IG47XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgbWModC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBKZSh0Ll9xdWVyeSwgdGhpcy55YywgdGhpcy5JYykpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGZpcnN0IG1hdGNoaW5nIGRvY3VtZW50cy5cbiAqXG4gKiBAcGFyYW0gbGltaXQgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5fS5cbiAqLyBmdW5jdGlvbiBGaCh0KSB7XG4gICAgcmV0dXJuIGxjKFwibGltaXRcIiwgdCksIG5ldyBPaChcImxpbWl0XCIsIHQsIFwiRlwiIC8qIEZpcnN0ICovKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGxhc3QgbWF0Y2hpbmcgZG9jdW1lbnRzLlxuICpcbiAqIFlvdSBtdXN0IHNwZWNpZnkgYXQgbGVhc3Qgb25lIGBvcmRlckJ5YCBjbGF1c2UgZm9yIGBsaW1pdFRvTGFzdGAgcXVlcmllcyxcbiAqIG90aGVyd2lzZSBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24gZHVyaW5nIGV4ZWN1dGlvbi5cbiAqXG4gKiBAcGFyYW0gbGltaXQgLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gcmV0dXJuLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5fS5cbiAqLyBmdW5jdGlvbiAkaCh0KSB7XG4gICAgcmV0dXJuIGxjKFwibGltaXRUb0xhc3RcIiwgdCksIG5ldyBPaChcImxpbWl0VG9MYXN0XCIsIHQsIFwiTFwiIC8qIExhc3QgKi8pO1xufVxuXG5jbGFzcyBCaCBleHRlbmRzIERoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMudHlwZSA9IHQsIHRoaXMuVGMgPSBlLCB0aGlzLkVjID0gbjtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFFoKHQsIHRoaXMudHlwZSwgdGhpcy5UYywgdGhpcy5FYyk7XG4gICAgICAgIHJldHVybiBuZXcgbWModC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVlKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgZSwgdC5lbmRBdCk7XG4gICAgICAgIH0odC5fcXVlcnksIGUpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIExoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IEJoKFwic3RhcnRBdFwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMCk7XG59XG5cbmZ1bmN0aW9uIFVoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IEJoKFwic3RhcnRBZnRlclwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbmNsYXNzIHFoIGV4dGVuZHMgRGgge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gdCwgdGhpcy5UYyA9IGUsIHRoaXMuRWMgPSBuO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gUWgodCwgdGhpcy50eXBlLCB0aGlzLlRjLCB0aGlzLkVjKTtcbiAgICAgICAgcmV0dXJuIG5ldyBtYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVWUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIGUpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBlKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBLaCguLi50KSB7XG4gICAgcmV0dXJuIG5ldyBxaChcImVuZEJlZm9yZVwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMSk7XG59XG5cbmZ1bmN0aW9uIEdoKC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IHFoKFwiZW5kQXRcIiwgdCwgLyppbmNsdXNpdmU9Ki8gITApO1xufVxuXG4vKiogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGJvdW5kIGZyb20gYSBkb2N1bWVudCBvciBmaWVsZHMgKi8gZnVuY3Rpb24gUWgodCwgZSwgbiwgcykge1xuICAgIGlmIChuWzBdID0gZ2V0TW9kdWxhckluc3RhbmNlKG5bMF0pLCBuWzBdIGluc3RhbmNlb2YgSWgpIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGlmICghcykgdGhyb3cgbmV3IFEoRy5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHplKHQpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHIucHVzaChxdChlLCBzLmtleSkpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLmRhdGEuZmllbGQobi5maWVsZCk7XG4gICAgICAgICAgICBpZiAoUnQodCkpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIGRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJyR7dH0nICh1c2VkIGFzIHRoZSBvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IE9lKHIsIGkpO1xuICAgIH1cbiAgICAvKipcbiAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBgQm91bmRgIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZSwgblswXS5fZG9jdW1lbnQsIHMpO1xuICAgIHtcbiAgICAgICAgY29uc3QgaSA9IHRoKHQuZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gdC5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvICR7c30oKS4gVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvcmRlckJ5KCkgY2xhdXNlc2ApO1xuICAgICAgICAgICAgY29uc3QgdSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBpLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IGlbcl07XG4gICAgICAgICAgICAgICAgaWYgKG9bcl0uZmllbGQuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBhKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gJHtzfSgpLCBidXQgZ290IGEgJHt0eXBlb2YgYX1gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFXZSh0KSAmJiAtMSAhPT0gYS5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCBiZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7YX0nIGNvbnRhaW5zIGEgc2xhc2guYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnBhdGguY2hpbGQoX3QuZnJvbVN0cmluZyhhKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgheHQuaXNEb2N1bWVudEtleShuKSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7bn0nIGlzIG5vdCBiZWNhdXNlIGl0IGNvbnRhaW5zIGFuIG9kZCBudW1iZXIgb2Ygc2VnbWVudHMuYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgeHQobik7XG4gICAgICAgICAgICAgICAgICAgIHUucHVzaChxdChlLCBpKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGhoKG4sIHMsIGEpO1xuICAgICAgICAgICAgICAgICAgICB1LnB1c2godCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBPZSh1LCByKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGRvY3VtZW50SWRWYWx1ZWAgaW50byBhIGBSZWZlcmVuY2VWYWx1ZWAsIHRocm93aW5nXG4gKiBhcHByb3ByaWF0ZSBlcnJvcnMgaWYgdGhlIHZhbHVlIGlzIGFueXRoaW5nIG90aGVyIHRoYW4gYSBgRG9jdW1lbnRSZWZlcmVuY2VgXG4gKiBvciBgc3RyaW5nYCwgb3IgaWYgdGhlIHN0cmluZyBpcyBtYWxmb3JtZWQuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgaSwgZSwgbiwgcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBqaCh0LCBlLCBuKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIChuID0gZ2V0TW9kdWxhckluc3RhbmNlKG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgd2l0aCBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSB2YWxpZCBkb2N1bWVudCBJRCwgYnV0IGl0IHdhcyBhbiBlbXB0eSBzdHJpbmcuXCIpO1xuICAgICAgICBpZiAoIVdlKGUpICYmIC0xICE9PSBuLmluZGV4T2YoXCIvXCIpKSB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBieSBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSBwbGFpbiBkb2N1bWVudCBJRCwgYnV0ICcke259JyBjb250YWlucyBhICcvJyBjaGFyYWN0ZXIuYCk7XG4gICAgICAgIGNvbnN0IHMgPSBlLnBhdGguY2hpbGQoX3QuZnJvbVN0cmluZyhuKSk7XG4gICAgICAgIGlmICgheHQuaXNEb2N1bWVudEtleShzKSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYnkgZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcHJvdmlkZWQgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7c30nIGlzIG5vdCBiZWNhdXNlIGl0IGhhcyBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzICgke3MubGVuZ3RofSkuYCk7XG4gICAgICAgIHJldHVybiBxdCh0LCBuZXcgeHQocykpO1xuICAgIH1cbiAgICBpZiAobiBpbnN0YW5jZW9mIHdjKSByZXR1cm4gcXQodCwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgUShHLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgc3RyaW5nIG9yIGEgRG9jdW1lbnRSZWZlcmVuY2UsIGJ1dCBpdCB3YXM6ICR7Y2Mobil9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSB2YWx1ZSBwYXNzZWQgaW50byBhIGRpc2p1bmN0aXZlIGZpbHRlciBzYXRpc2ZpZXMgYWxsXG4gKiBhcnJheSByZXF1aXJlbWVudHMuXG4gKi8gZnVuY3Rpb24gV2godCwgZSkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheSh0KSB8fCAwID09PSB0Lmxlbmd0aCkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gQSBub24tZW1wdHkgYXJyYXkgaXMgcmVxdWlyZWQgZm9yICcke2UudG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG4gICAgaWYgKHQubGVuZ3RoID4gMTApIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuICcke2UudG9TdHJpbmcoKX0nIGZpbHRlcnMgc3VwcG9ydCBhIG1heGltdW0gb2YgMTAgZWxlbWVudHMgaW4gdGhlIHZhbHVlIGFycmF5LmApO1xufVxuXG5mdW5jdGlvbiB6aCh0LCBlLCBuKSB7XG4gICAgaWYgKCFuLmlzRXF1YWwoZSkpIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFlvdSBoYXZlIGEgd2hlcmUgZmlsdGVyIHdpdGggYW4gaW5lcXVhbGl0eSAoPCwgPD0sICE9LCBub3QtaW4sID4sIG9yID49KSBvbiBmaWVsZCAnJHtlLnRvU3RyaW5nKCl9JyBhbmQgc28geW91IG11c3QgYWxzbyB1c2UgJyR7ZS50b1N0cmluZygpfScgYXMgeW91ciBmaXJzdCBhcmd1bWVudCB0byBvcmRlckJ5KCksIGJ1dCB5b3VyIGZpcnN0IG9yZGVyQnkoKSBpcyBvbiBmaWVsZCAnJHtuLnRvU3RyaW5nKCl9JyBpbnN0ZWFkLmApO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBIaCA9IHtcbiAgICBtYXhBdHRlbXB0czogNVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgRmlyZXN0b3JlJ3MgaW50ZXJuYWwgdHlwZXMgdG8gdGhlIEphdmFTY3JpcHQgdHlwZXMgdGhhdCB3ZSBleHBvc2VcbiAqIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyBKaCB7XG4gICAgY29udmVydFZhbHVlKHQsIGUgPSBcIm5vbmVcIikge1xuICAgICAgICBzd2l0Y2ggKE10KHQpKSB7XG4gICAgICAgICAgY2FzZSAwIC8qIE51bGxWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcblxuICAgICAgICAgIGNhc2UgMSAvKiBCb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQuYm9vbGVhblZhbHVlO1xuXG4gICAgICAgICAgY2FzZSAyIC8qIE51bWJlclZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiBFdCh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgMyAvKiBUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VGltZXN0YW1wKHQudGltZXN0YW1wVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRTZXJ2ZXJUaW1lc3RhbXAodCwgZSk7XG5cbiAgICAgICAgICBjYXNlIDUgLyogU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQuc3RyaW5nVmFsdWU7XG5cbiAgICAgICAgICBjYXNlIDYgLyogQmxvYlZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRCeXRlcyhBdCh0LmJ5dGVzVmFsdWUpKTtcblxuICAgICAgICAgIGNhc2UgNyAvKiBSZWZWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0UmVmZXJlbmNlKHQucmVmZXJlbmNlVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA4IC8qIEdlb1BvaW50VmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEdlb1BvaW50KHQuZ2VvUG9pbnRWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDkgLyogQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0QXJyYXkodC5hcnJheVZhbHVlLCBlKTtcblxuICAgICAgICAgIGNhc2UgMTAgLyogT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydE9iamVjdCh0Lm1hcFZhbHVlLCBlKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBMKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29udmVydE9iamVjdCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB7fTtcbiAgICAgICAgcmV0dXJuIGx0KHQuZmllbGRzLCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG5bdF0gPSB0aGlzLmNvbnZlcnRWYWx1ZShzLCBlKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICBjb252ZXJ0R2VvUG9pbnQodCkge1xuICAgICAgICByZXR1cm4gbmV3IFdjKEV0KHQubGF0aXR1ZGUpLCBFdCh0LmxvbmdpdHVkZSkpO1xuICAgIH1cbiAgICBjb252ZXJ0QXJyYXkodCwgZSkge1xuICAgICAgICByZXR1cm4gKHQudmFsdWVzIHx8IFtdKS5tYXAoKHQgPT4gdGhpcy5jb252ZXJ0VmFsdWUodCwgZSkpKTtcbiAgICB9XG4gICAgY29udmVydFNlcnZlclRpbWVzdGFtcCh0LCBlKSB7XG4gICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgIGNhc2UgXCJwcmV2aW91c1wiOlxuICAgICAgICAgICAgY29uc3QgbiA9IGJ0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gbiA/IG51bGwgOiB0aGlzLmNvbnZlcnRWYWx1ZShuLCBlKTtcblxuICAgICAgICAgIGNhc2UgXCJlc3RpbWF0ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFRpbWVzdGFtcChQdCh0KSk7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29udmVydFRpbWVzdGFtcCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBUdCh0KTtcbiAgICAgICAgcmV0dXJuIG5ldyBhdChlLnNlY29uZHMsIGUubmFub3MpO1xuICAgIH1cbiAgICBjb252ZXJ0RG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gX3QuZnJvbVN0cmluZyh0KTtcbiAgICAgICAgVShLcyhuKSk7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgdnQobi5nZXQoMSksIG4uZ2V0KDMpKSwgaSA9IG5ldyB4dChuLnBvcEZpcnN0KDUpKTtcbiAgICAgICAgcmV0dXJuIHMuaXNFcXVhbChlKSB8fCBcbiAgICAgICAgLy8gVE9ETyhiLzY0MTMwMjAyKTogU29tZWhvdyBzdXBwb3J0IGZvcmVpZ24gcmVmZXJlbmNlcy5cbiAgICAgICAgRihgRG9jdW1lbnQgJHtpfSBjb250YWlucyBhIGRvY3VtZW50IHJlZmVyZW5jZSB3aXRoaW4gYSBkaWZmZXJlbnQgZGF0YWJhc2UgKCR7cy5wcm9qZWN0SWR9LyR7cy5kYXRhYmFzZX0pIHdoaWNoIGlzIG5vdCBzdXBwb3J0ZWQuIEl0IHdpbGwgYmUgdHJlYXRlZCBhcyBhIHJlZmVyZW5jZSBpbiB0aGUgY3VycmVudCBkYXRhYmFzZSAoJHtlLnByb2plY3RJZH0vJHtlLmRhdGFiYXNlfSkgaW5zdGVhZC5gKSwgXG4gICAgICAgIGk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDb252ZXJ0cyBjdXN0b20gbW9kZWwgb2JqZWN0IG9mIHR5cGUgVCBpbnRvIGBEb2N1bWVudERhdGFgIGJ5IGFwcGx5aW5nIHRoZVxuICogY29udmVydGVyIGlmIGl0IGV4aXN0cy5cbiAqXG4gKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgd2hlbiBjb252ZXJ0aW5nIHVzZXIgb2JqZWN0cyB0byBgRG9jdW1lbnREYXRhYFxuICogYmVjYXVzZSB3ZSB3YW50IHRvIHByb3ZpZGUgdGhlIHVzZXIgd2l0aCBhIG1vcmUgc3BlY2lmaWMgZXJyb3IgbWVzc2FnZSBpZlxuICogdGhlaXIgYHNldCgpYCBvciBmYWlscyBkdWUgdG8gaW52YWxpZCBkYXRhIG9yaWdpbmF0aW5nIGZyb20gYSBgdG9GaXJlc3RvcmUoKWBcbiAqIGNhbGwuXG4gKi8gZnVuY3Rpb24gWWgodCwgZSwgbikge1xuICAgIGxldCBzO1xuICAgIC8vIENhc3QgdG8gYGFueWAgaW4gb3JkZXIgdG8gc2F0aXNmeSB0aGUgdW5pb24gdHlwZSBjb25zdHJhaW50IG9uXG4gICAgLy8gdG9GaXJlc3RvcmUoKS5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIHJldHVybiBzID0gdCA/IG4gJiYgKG4ubWVyZ2UgfHwgbi5tZXJnZUZpZWxkcykgPyB0LnRvRmlyZXN0b3JlKGUsIG4pIDogdC50b0ZpcmVzdG9yZShlKSA6IGUsIFxuICAgIHM7XG59XG5cbmNsYXNzIFhoIGV4dGVuZHMgSmgge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5maXJlc3RvcmUgPSB0O1xuICAgIH1cbiAgICBjb252ZXJ0Qnl0ZXModCkge1xuICAgICAgICByZXR1cm4gbmV3IFFjKHQpO1xuICAgIH1cbiAgICBjb252ZXJ0UmVmZXJlbmNlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuY29udmVydERvY3VtZW50S2V5KHQsIHRoaXMuZmlyZXN0b3JlLl9kYXRhYmFzZUlkKTtcbiAgICAgICAgcmV0dXJuIG5ldyB3Yyh0aGlzLmZpcmVzdG9yZSwgLyogY29udmVydGVyPSAqLyBudWxsLCBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgd3JpdGUgYmF0Y2gsIHVzZWQgdG8gcGVyZm9ybSBtdWx0aXBsZSB3cml0ZXMgYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gKlxuICogQSBgV3JpdGVCYXRjaGAgb2JqZWN0IGNhbiBiZSBhY3F1aXJlZCBieSBjYWxsaW5nIHtAbGluayB3cml0ZUJhdGNofS4gSXRcbiAqIHByb3ZpZGVzIG1ldGhvZHMgZm9yIGFkZGluZyB3cml0ZXMgdG8gdGhlIHdyaXRlIGJhdGNoLiBOb25lIG9mIHRoZSB3cml0ZXNcbiAqIHdpbGwgYmUgY29tbWl0dGVkIChvciB2aXNpYmxlIGxvY2FsbHkpIHVudGlsIHtAbGluayBXcml0ZUJhdGNoLmNvbW1pdH0gaXNcbiAqIGNhbGxlZC5cbiAqLyBjbGFzcyBaaCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX2NvbW1pdEhhbmRsZXIgPSBlLCB0aGlzLl9tdXRhdGlvbnMgPSBbXSwgdGhpcy5fY29tbWl0dGVkID0gITEsIFxuICAgICAgICB0aGlzLl9kYXRhUmVhZGVyID0gdGgodCk7XG4gICAgfVxuICAgIHNldCh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeU5vdENvbW1pdHRlZCgpO1xuICAgICAgICBjb25zdCBzID0gdGwodCwgdGhpcy5fZmlyZXN0b3JlKSwgaSA9IFloKHMuY29udmVydGVyLCBlLCBuKSwgciA9IGVoKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC5zZXRcIiwgcy5fa2V5LCBpLCBudWxsICE9PSBzLmNvbnZlcnRlciwgbik7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMucHVzaChyLnRvTXV0YXRpb24ocy5fa2V5LCBBbi5ub25lKCkpKSwgdGhpcztcbiAgICB9XG4gICAgdXBkYXRlKHQsIGUsIG4sIC4uLnMpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IGkgPSB0bCh0LCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbGV0IHI7XG4gICAgICAgIHJldHVybiByID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIHx8IGUgaW5zdGFuY2VvZiBLYyA/IGNoKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IGFoKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihpLl9rZXksIEFuLmV4aXN0cyghMCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBXcml0ZUJhdGNoYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgZSA9IHRsKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KG5ldyBPbihlLl9rZXksIEFuLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21taXRzIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoaXMgd3JpdGUgYmF0Y2ggYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gICAgICpcbiAgICAgKiBUaGUgcmVzdWx0IG9mIHRoZXNlIHdyaXRlcyB3aWxsIG9ubHkgYmUgcmVmbGVjdGVkIGluIGRvY3VtZW50IHJlYWRzIHRoYXRcbiAgICAgKiBvY2N1ciBhZnRlciB0aGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcy4gSWYgdGhlIGNsaWVudCBpcyBvZmZsaW5lLCB0aGVcbiAgICAgKiB3cml0ZSBmYWlscy4gSWYgeW91IHdvdWxkIGxpa2UgdG8gc2VlIGxvY2FsIG1vZGlmaWNhdGlvbnMgb3IgYnVmZmVyIHdyaXRlc1xuICAgICAqIHVudGlsIHRoZSBjbGllbnQgaXMgb25saW5lLCB1c2UgdGhlIGZ1bGwgRmlyZXN0b3JlIFNESy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIG9uY2UgYWxsIG9mIHRoZSB3cml0ZXMgaW4gdGhlIGJhdGNoIGhhdmUgYmVlblxuICAgICAqIHN1Y2Nlc3NmdWxseSB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIGFzIGFuIGF0b21pYyB1bml0IChub3RlIHRoYXQgaXQgd29uJ3RcbiAgICAgKiByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAgICAgKi8gICAgY29tbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCksIHRoaXMuX2NvbW1pdHRlZCA9ICEwLCB0aGlzLl9tdXRhdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMuX2NvbW1pdEhhbmRsZXIodGhpcy5fbXV0YXRpb25zKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBfdmVyaWZ5Tm90Q29tbWl0dGVkKCkge1xuICAgICAgICBpZiAodGhpcy5fY29tbWl0dGVkKSB0aHJvdyBuZXcgUShHLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSB3cml0ZSBiYXRjaCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgYWZ0ZXIgY29tbWl0KCkgaGFzIGJlZW4gY2FsbGVkLlwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRsKHQsIGUpIHtcbiAgICBpZiAoKHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCkpLmZpcmVzdG9yZSAhPT0gZSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIlByb3ZpZGVkIGRvY3VtZW50IHJlZmVyZW5jZSBpcyBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBpbnN0YW5jZS5cIik7XG4gICAgcmV0dXJuIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBUT0RPKG1yc2NobWlkdCkgQ29uc2lkZXIgdXNpbmcgYEJhc2VUcmFuc2FjdGlvbmAgYXMgdGhlIGJhc2UgY2xhc3MgaW4gdGhlXG4vLyBsZWdhY3kgU0RLLlxuLyoqXG4gKiBBIHJlZmVyZW5jZSB0byBhIHRyYW5zYWN0aW9uLlxuICpcbiAqIFRoZSBgVHJhbnNhY3Rpb25gIG9iamVjdCBwYXNzZWQgdG8gYSB0cmFuc2FjdGlvbidzIGB1cGRhdGVGdW5jdGlvbmAgcHJvdmlkZXNcbiAqIHRoZSBtZXRob2RzIHRvIHJlYWQgYW5kIHdyaXRlIGRhdGEgd2l0aGluIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0LiBTZWVcbiAqIHtAbGluayBydW5UcmFuc2FjdGlvbn0uXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGlzIGBEb2N1bWVudFJlZmVyZW5jZWAuXG4gKlxuICogTm90ZTogYGdldERvYygpYCBhdHRlbXB0cyB0byBwcm92aWRlIHVwLXRvLWRhdGUgZGF0YSB3aGVuIHBvc3NpYmxlIGJ5IHdhaXRpbmdcbiAqIGZvciBkYXRhIGZyb20gdGhlIHNlcnZlciwgYnV0IGl0IG1heSByZXR1cm4gY2FjaGVkIGRhdGEgb3IgZmFpbCBpZiB5b3UgYXJlXG4gKiBvZmZsaW5lIGFuZCB0aGUgc2VydmVyIGNhbm5vdCBiZSByZWFjaGVkLiBUbyBzcGVjaWZ5IHRoaXMgYmVoYXZpb3IsIGludm9rZVxuICoge0BsaW5rIGdldERvY0Zyb21DYWNoZX0gb3Ige0BsaW5rIGdldERvY0Zyb21TZXJ2ZXJ9LlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBUaGUgcmVmZXJlbmNlIG9mIHRoZSBkb2N1bWVudCB0byBmZXRjaC5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovXG5mdW5jdGlvbiBlbCh0KSB7XG4gICAgdCA9IGhjKHQsIHdjKTtcbiAgICBjb25zdCBlID0gaGModC5maXJlc3RvcmUsIFZjKTtcbiAgICByZXR1cm4gWWEoRGMoZSksIHQuX2tleSkudGhlbigobiA9PiB3bChlLCB0LCBuKSkpO1xufVxuXG5jbGFzcyBubCBleHRlbmRzIEpoIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRYyh0KTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleSh0LCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgd2ModGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGlzIGBEb2N1bWVudFJlZmVyZW5jZWAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIGRvY3VtZW50IGlzIG5vdCBjdXJyZW50bHkgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbmluZyB0aGVcbiAqIGN1cnJlbnQgZG9jdW1lbnQgY29udGVudHMuXG4gKi8gZnVuY3Rpb24gc2wodCkge1xuICAgIHQgPSBoYyh0LCB3Yyk7XG4gICAgY29uc3QgZSA9IGhjKHQuZmlyZXN0b3JlLCBWYyksIG4gPSBEYyhlKSwgcyA9IG5ldyBubChlKTtcbiAgICByZXR1cm4gSmEobiwgdC5fa2V5KS50aGVuKChuID0+IG5ldyBSaChlLCBzLCB0Ll9rZXksIG4sIG5ldyBBaChudWxsICE9PSBuICYmIG4uaGFzTG9jYWxNdXRhdGlvbnMsIFxuICAgIC8qIGZyb21DYWNoZT0gKi8gITApLCB0LmNvbnZlcnRlcikpKTtcbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gdGhlIHNlcnZlci5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG5ldHdvcmsgaXMgbm90IGF2YWlsYWJsZS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGlsKHQpIHtcbiAgICB0ID0gaGModCwgd2MpO1xuICAgIGNvbnN0IGUgPSBoYyh0LmZpcmVzdG9yZSwgVmMpO1xuICAgIHJldHVybiBZYShEYyhlKSwgdC5fa2V5LCB7XG4gICAgICAgIHNvdXJjZTogXCJzZXJ2ZXJcIlxuICAgIH0pLnRoZW4oKG4gPT4gd2woZSwgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAuXG4gKlxuICogTm90ZTogYGdldERvY3MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieVxuICogd2FpdGluZyBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWZcbiAqIHlvdSBhcmUgb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLFxuICogaW52b2tlIHtAbGluayBnZXREb2NzRnJvbUNhY2hlfSBvciB7QGxpbmsgZ2V0RG9jc0Zyb21TZXJ2ZXJ9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBybCh0KSB7XG4gICAgdCA9IGhjKHQsIG1jKTtcbiAgICBjb25zdCBlID0gaGModC5maXJlc3RvcmUsIFZjKSwgbiA9IERjKGUpLCBzID0gbmV3IG5sKGUpO1xuICAgIHJldHVybiBTaCh0Ll9xdWVyeSksIFphKG4sIHQuX3F1ZXJ5KS50aGVuKChuID0+IG5ldyBQaChlLCBzLCB0LCBuKSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBxdWVyeSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyBhcyBhIGBRdWVyeVNuYXBzaG90YCBmcm9tIGNhY2hlLlxuICogUmV0dXJucyBhbiBlcnJvciBpZiB0aGUgZG9jdW1lbnQgaXMgbm90IGN1cnJlbnRseSBjYWNoZWQuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5LlxuICovIGZ1bmN0aW9uIG9sKHQpIHtcbiAgICB0ID0gaGModCwgbWMpO1xuICAgIGNvbnN0IGUgPSBoYyh0LmZpcmVzdG9yZSwgVmMpLCBuID0gRGMoZSksIHMgPSBuZXcgbmwoZSk7XG4gICAgcmV0dXJuIFhhKG4sIHQuX3F1ZXJ5KS50aGVuKChuID0+IG5ldyBQaChlLCBzLCB0LCBuKSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBxdWVyeSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyBhcyBhIGBRdWVyeVNuYXBzaG90YCBmcm9tIHRoZVxuICogc2VydmVyLiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBuZXR3b3JrIGlzIG5vdCBhdmFpbGFibGUuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCB3aWxsIGJlIHJlc29sdmVkIHdpdGggdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5LlxuICovIGZ1bmN0aW9uIHVsKHQpIHtcbiAgICB0ID0gaGModCwgbWMpO1xuICAgIGNvbnN0IGUgPSBoYyh0LmZpcmVzdG9yZSwgVmMpLCBuID0gRGMoZSksIHMgPSBuZXcgbmwoZSk7XG4gICAgcmV0dXJuIFphKG4sIHQuX3F1ZXJ5LCB7XG4gICAgICAgIHNvdXJjZTogXCJzZXJ2ZXJcIlxuICAgIH0pLnRoZW4oKG4gPT4gbmV3IFBoKGUsIHMsIHQsIG4pKSk7XG59XG5cbmZ1bmN0aW9uIGFsKHQsIGUsIG4pIHtcbiAgICB0ID0gaGModCwgd2MpO1xuICAgIGNvbnN0IHMgPSBoYyh0LmZpcmVzdG9yZSwgVmMpLCBpID0gWWgodC5jb252ZXJ0ZXIsIGUsIG4pO1xuICAgIHJldHVybiBfbChzLCBbIGVoKHRoKHMpLCBcInNldERvY1wiLCB0Ll9rZXksIGksIG51bGwgIT09IHQuY29udmVydGVyLCBuKS50b011dGF0aW9uKHQuX2tleSwgQW4ubm9uZSgpKSBdKTtcbn1cblxuZnVuY3Rpb24gY2wodCwgZSwgbiwgLi4ucykge1xuICAgIHQgPSBoYyh0LCB3Yyk7XG4gICAgY29uc3QgaSA9IGhjKHQuZmlyZXN0b3JlLCBWYyksIHIgPSB0aChpKTtcbiAgICBsZXQgbztcbiAgICBvID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKFxuICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgIGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIHx8IGUgaW5zdGFuY2VvZiBLYyA/IGNoKHIsIFwidXBkYXRlRG9jXCIsIHQuX2tleSwgZSwgbiwgcykgOiBhaChyLCBcInVwZGF0ZURvY1wiLCB0Ll9rZXksIGUpO1xuICAgIHJldHVybiBfbChpLCBbIG8udG9NdXRhdGlvbih0Ll9rZXksIEFuLmV4aXN0cyghMCkpIF0pO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoZSBzcGVjaWZpZWQgYERvY3VtZW50UmVmZXJlbmNlYC5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGRlbGV0ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSByZXNvbHZlZCBvbmNlIHRoZSBkb2N1bWVudCBoYXMgYmVlbiBzdWNjZXNzZnVsbHlcbiAqIGRlbGV0ZWQgZnJvbSB0aGUgYmFja2VuZCAobm90ZSB0aGF0IGl0IHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIGhsKHQpIHtcbiAgICByZXR1cm4gX2woaGModC5maXJlc3RvcmUsIFZjKSwgWyBuZXcgT24odC5fa2V5LCBBbi5ub25lKCkpIF0pO1xufVxuXG4vKipcbiAqIEFkZCBhIG5ldyBkb2N1bWVudCB0byBzcGVjaWZpZWQgYENvbGxlY3Rpb25SZWZlcmVuY2VgIHdpdGggdGhlIGdpdmVuIGRhdGEsXG4gKiBhc3NpZ25pbmcgaXQgYSBkb2N1bWVudCBJRCBhdXRvbWF0aWNhbGx5LlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBBIHJlZmVyZW5jZSB0byB0aGUgY29sbGVjdGlvbiB0byBhZGQgdGhpcyBkb2N1bWVudCB0by5cbiAqIEBwYXJhbSBkYXRhIC0gQW4gT2JqZWN0IGNvbnRhaW5pbmcgdGhlIGRhdGEgZm9yIHRoZSBuZXcgZG9jdW1lbnQuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50UmVmZXJlbmNlYCBwb2ludGluZyB0byB0aGVcbiAqIG5ld2x5IGNyZWF0ZWQgZG9jdW1lbnQgYWZ0ZXIgaXQgaGFzIGJlZW4gd3JpdHRlbiB0byB0aGUgYmFja2VuZCAoTm90ZSB0aGF0IGl0XG4gKiB3b24ndCByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAqLyBmdW5jdGlvbiBsbCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGhjKHQuZmlyZXN0b3JlLCBWYyksIHMgPSBJYyh0KSwgaSA9IFloKHQuY29udmVydGVyLCBlKTtcbiAgICByZXR1cm4gX2wobiwgWyBlaCh0aCh0LmZpcmVzdG9yZSksIFwiYWRkRG9jXCIsIHMuX2tleSwgaSwgbnVsbCAhPT0gdC5jb252ZXJ0ZXIsIHt9KS50b011dGF0aW9uKHMuX2tleSwgQW4uZXhpc3RzKCExKSkgXSkudGhlbigoKCkgPT4gcykpO1xufVxuXG5mdW5jdGlvbiBmbCh0LCAuLi5lKSB7XG4gICAgdmFyIG4sIHMsIGk7XG4gICAgdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KTtcbiAgICBsZXQgciA9IHtcbiAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITFcbiAgICB9LCBvID0gMDtcbiAgICBcIm9iamVjdFwiICE9IHR5cGVvZiBlW29dIHx8IFJjKGVbb10pIHx8IChyID0gZVtvXSwgbysrKTtcbiAgICBjb25zdCB1ID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiByLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXNcbiAgICB9O1xuICAgIGlmIChSYyhlW29dKSkge1xuICAgICAgICBjb25zdCB0ID0gZVtvXTtcbiAgICAgICAgZVtvXSA9IG51bGwgPT09IChuID0gdC5uZXh0KSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLmJpbmQodCksIGVbbyArIDFdID0gbnVsbCA9PT0gKHMgPSB0LmVycm9yKSB8fCB2b2lkIDAgPT09IHMgPyB2b2lkIDAgOiBzLmJpbmQodCksIFxuICAgICAgICBlW28gKyAyXSA9IG51bGwgPT09IChpID0gdC5jb21wbGV0ZSkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5iaW5kKHQpO1xuICAgIH1cbiAgICBsZXQgYSwgYywgaDtcbiAgICBpZiAodCBpbnN0YW5jZW9mIHdjKSBjID0gaGModC5maXJlc3RvcmUsIFZjKSwgaCA9IEtlKHQuX2tleS5wYXRoKSwgYSA9IHtcbiAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICBlW29dICYmIGVbb10od2woYywgdCwgbikpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZVtvICsgMV0sXG4gICAgICAgIGNvbXBsZXRlOiBlW28gKyAyXVxuICAgIH07IGVsc2Uge1xuICAgICAgICBjb25zdCBuID0gaGModCwgbWMpO1xuICAgICAgICBjID0gaGMobi5maXJlc3RvcmUsIFZjKSwgaCA9IG4uX3F1ZXJ5O1xuICAgICAgICBjb25zdCBzID0gbmV3IG5sKGMpO1xuICAgICAgICBhID0ge1xuICAgICAgICAgICAgbmV4dDogdCA9PiB7XG4gICAgICAgICAgICAgICAgZVtvXSAmJiBlW29dKG5ldyBQaChjLCBzLCBuLCB0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGVbbyArIDFdLFxuICAgICAgICAgICAgY29tcGxldGU6IGVbbyArIDJdXG4gICAgICAgIH0sIFNoKHQuX3F1ZXJ5KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBrYShzKSwgciA9IG5ldyBMdShlLCBpLCBuKTtcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBNdShhd2FpdCBXYSh0KSwgcikpKSwgKCkgPT4ge1xuICAgICAgICAgICAgaS5BYSgpLCB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gT3UoYXdhaXQgV2EodCksIHIpKSk7XG4gICAgICAgIH07XG4gICAgfShEYyhjKSwgaCwgdSwgYSk7XG59XG5cbmZ1bmN0aW9uIGRsKHQsIGUpIHtcbiAgICByZXR1cm4gdGMoRGModCA9IGhjKHQsIFZjKSksIFJjKGUpID8gZSA6IHtcbiAgICAgICAgbmV4dDogZVxuICAgIH0pO1xufVxuXG4vKipcbiAqIExvY2FsbHkgd3JpdGVzIGBtdXRhdGlvbnNgIG9uIHRoZSBhc3luYyBxdWV1ZS5cbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIF9sKHQsIGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gdGEoYXdhaXQgamEodCksIGUsIG4pKSksIG4ucHJvbWlzZTtcbiAgICB9KERjKHQpLCBlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHtAbGluayBWaWV3U25hcHNob3R9IHRoYXQgY29udGFpbnMgdGhlIHNpbmdsZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHJlZmBcbiAqIHRvIGEge0BsaW5rIERvY3VtZW50U25hcHNob3R9LlxuICovIGZ1bmN0aW9uIHdsKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbi5kb2NzLmdldChlLl9rZXkpLCBpID0gbmV3IG5sKHQpO1xuICAgIHJldHVybiBuZXcgUmgodCwgaSwgZS5fa2V5LCBzLCBuZXcgQWgobi5oYXNQZW5kaW5nV3JpdGVzLCBuLmZyb21DYWNoZSksIGUuY29udmVydGVyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovIGNsYXNzIG1sIGV4dGVuZHMgY2xhc3Mge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl90cmFuc2FjdGlvbiA9IGUsIHRoaXMuX2RhdGFSZWFkZXIgPSB0aCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0bCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IFhoKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5sb29rdXAoWyBlLl9rZXkgXSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQgfHwgMSAhPT0gdC5sZW5ndGgpIHJldHVybiBMKCk7XG4gICAgICAgICAgICBjb25zdCBzID0gdFswXTtcbiAgICAgICAgICAgIGlmIChzLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gbmV3IEloKHRoaXMuX2ZpcmVzdG9yZSwgbiwgcy5rZXksIHMsIGUuY29udmVydGVyKTtcbiAgICAgICAgICAgIGlmIChzLmlzTm9Eb2N1bWVudCgpKSByZXR1cm4gbmV3IEloKHRoaXMuX2ZpcmVzdG9yZSwgbiwgZS5fa2V5LCBudWxsLCBlLmNvbnZlcnRlcik7XG4gICAgICAgICAgICB0aHJvdyBMKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IHRsKHQsIHRoaXMuX2ZpcmVzdG9yZSksIGkgPSBZaChzLmNvbnZlcnRlciwgZSwgbiksIHIgPSBlaCh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLnNldChzLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICBjb25zdCBpID0gdGwodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gciA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpKSB8fCBlIGluc3RhbmNlb2YgS2MgPyBjaCh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnVwZGF0ZVwiLCBpLl9rZXksIGUsIG4sIHMpIDogYWgodGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLnVwZGF0ZShpLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIHRoZSBkb2N1bWVudCByZWZlcnJlZCB0byBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSBkZWxldGVkLlxuICAgICAqIEByZXR1cm5zIFRoaXMgYFRyYW5zYWN0aW9uYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGwodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLmRlbGV0ZShlLl9rZXkpLCB0aGlzO1xuICAgIH1cbn0ge1xuICAgIC8vIFRoaXMgY2xhc3MgaW1wbGVtZW50cyB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgVHJhbnNhY3Rpb24gQVBJIGluIHRoZSBMaXRlIFNES1xuICAgIC8vIGJ1dCBpcyBzdWJjbGFzc2VkIGluIG9yZGVyIHRvIHJldHVybiBpdHMgb3duIERvY3VtZW50U25hcHNob3QgdHlwZXMuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIGUpLCB0aGlzLl9maXJlc3RvcmUgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJlbmNlZCBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSByZWFkLlxuICAgICAqIEByZXR1cm5zIEEgYERvY3VtZW50U25hcHNob3RgIHdpdGggdGhlIHJlYWQgZGF0YS5cbiAgICAgKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRsKHQsIHRoaXMuX2ZpcmVzdG9yZSksIG4gPSBuZXcgbmwodGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldCh0KS50aGVuKCh0ID0+IG5ldyBSaCh0aGlzLl9maXJlc3RvcmUsIG4sIGUuX2tleSwgdC5fZG9jdW1lbnQsIG5ldyBBaChcbiAgICAgICAgLyogaGFzUGVuZGluZ1dyaXRlcz0gKi8gITEsIFxuICAgICAgICAvKiBmcm9tQ2FjaGU9ICovICExKSwgZS5jb252ZXJ0ZXIpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEV4ZWN1dGVzIHRoZSBnaXZlbiBgdXBkYXRlRnVuY3Rpb25gIGFuZCB0aGVuIGF0dGVtcHRzIHRvIGNvbW1pdCB0aGUgY2hhbmdlc1xuICogYXBwbGllZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uLiBJZiBhbnkgZG9jdW1lbnQgcmVhZCB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBoYXMgY2hhbmdlZCwgQ2xvdWQgRmlyZXN0b3JlIHJldHJpZXMgdGhlIGB1cGRhdGVGdW5jdGlvbmAuIElmIGl0IGZhaWxzIHRvXG4gKiBjb21taXQgYWZ0ZXIgNSBhdHRlbXB0cywgdGhlIHRyYW5zYWN0aW9uIGZhaWxzLlxuICpcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3cml0ZXMgYWxsb3dlZCBpbiBhIHNpbmdsZSB0cmFuc2FjdGlvbiBpcyA1MDAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBGaXJlc3RvcmUgZGF0YWJhc2UgdG8gcnVuIHRoaXNcbiAqIHRyYW5zYWN0aW9uIGFnYWluc3QuXG4gKiBAcGFyYW0gdXBkYXRlRnVuY3Rpb24gLSBUaGUgZnVuY3Rpb24gdG8gZXhlY3V0ZSB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uXG4gKiBjb250ZXh0LlxuICogQHJldHVybnMgSWYgdGhlIHRyYW5zYWN0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkgb3Igd2FzIGV4cGxpY2l0bHkgYWJvcnRlZFxuICogKHRoZSBgdXBkYXRlRnVuY3Rpb25gIHJldHVybmVkIGEgZmFpbGVkIHByb21pc2UpLCB0aGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGVcbiAqIGB1cGRhdGVGdW5jdGlvbiBgaXMgcmV0dXJuZWQgaGVyZS4gT3RoZXJ3aXNlLCBpZiB0aGUgdHJhbnNhY3Rpb24gZmFpbGVkLCBhXG4gKiByZWplY3RlZCBwcm9taXNlIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgZmFpbHVyZSBlcnJvciBpcyByZXR1cm5lZC5cbiAqLyBmdW5jdGlvbiBnbCh0LCBlLCBuKSB7XG4gICAgdCA9IGhjKHQsIFZjKTtcbiAgICBjb25zdCBzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBIaCksIG4pO1xuICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICh0Lm1heEF0dGVtcHRzIDwgMSkgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIk1heCBhdHRlbXB0cyBtdXN0IGJlIGF0IGxlYXN0IDFcIik7XG4gICAgfShzKTtcbiAgICByZXR1cm4gZWMoRGModCksIChuID0+IGUobmV3IG1sKHQsIG4pKSksIHMpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIGEgc2VudGluZWwgZm9yIHVzZSB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gb3JcbiAqIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gd2l0aCBge21lcmdlOiB0cnVlfWAgdG8gbWFyayBhIGZpZWxkIGZvciBkZWxldGlvbi5cbiAqLyBmdW5jdGlvbiB5bCgpIHtcbiAgICByZXR1cm4gbmV3IG5oKFwiZGVsZXRlRmllbGRcIik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNlbnRpbmVsIHVzZWQgd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IG9yIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdG9cbiAqIGluY2x1ZGUgYSBzZXJ2ZXItZ2VuZXJhdGVkIHRpbWVzdGFtcCBpbiB0aGUgd3JpdHRlbiBkYXRhLlxuICovIGZ1bmN0aW9uIHBsKCkge1xuICAgIHJldHVybiBuZXcgaWgoXCJzZXJ2ZXJUaW1lc3RhbXBcIik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIHVuaW9uIHRoZSBnaXZlbiBlbGVtZW50cyB3aXRoIGFueSBhcnJheVxuICogdmFsdWUgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgc2VydmVyLiBFYWNoIHNwZWNpZmllZCBlbGVtZW50IHRoYXQgZG9lc24ndFxuICogYWxyZWFkeSBleGlzdCBpbiB0aGUgYXJyYXkgd2lsbCBiZSBhZGRlZCB0byB0aGUgZW5kLiBJZiB0aGUgZmllbGQgYmVpbmdcbiAqIG1vZGlmaWVkIGlzIG5vdCBhbHJlYWR5IGFuIGFycmF5IGl0IHdpbGwgYmUgb3ZlcndyaXR0ZW4gd2l0aCBhbiBhcnJheVxuICogY29udGFpbmluZyBleGFjdGx5IHRoZSBzcGVjaWZpZWQgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRzIC0gVGhlIGVsZW1lbnRzIHRvIHVuaW9uIGludG8gdGhlIGFycmF5LlxuICogQHJldHVybnMgVGhlIGBGaWVsZFZhbHVlYCBzZW50aW5lbCBmb3IgdXNlIGluIGEgY2FsbCB0byBgc2V0RG9jKClgIG9yXG4gKiBgdXBkYXRlRG9jKClgLlxuICovIGZ1bmN0aW9uIElsKC4uLnQpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgcmgoXCJhcnJheVVuaW9uXCIsIHQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCB7QGxpbmsgKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiB1cGRhdGVEb2M6MX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIHJlbW92ZSB0aGUgZ2l2ZW4gZWxlbWVudHMgZnJvbSBhbnlcbiAqIGFycmF5IHZhbHVlIHRoYXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIHNlcnZlci4gQWxsIGluc3RhbmNlcyBvZiBlYWNoIGVsZW1lbnRcbiAqIHNwZWNpZmllZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgYXJyYXkuIElmIHRoZSBmaWVsZCBiZWluZyBtb2RpZmllZCBpcyBub3RcbiAqIGFscmVhZHkgYW4gYXJyYXkgaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiB3aXRoIGFuIGVtcHR5IGFycmF5LlxuICpcbiAqIEBwYXJhbSBlbGVtZW50cyAtIFRoZSBlbGVtZW50cyB0byByZW1vdmUgZnJvbSB0aGUgYXJyYXkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWBcbiAqLyBmdW5jdGlvbiBUbCguLi50KSB7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgYWN0dWFsbHkgcGFyc2UgdGhlIGRhdGEgdW50aWwgaXQncyB1c2VkIGluIHNldCgpIG9yXG4gICAgLy8gdXBkYXRlKCkgc2luY2Ugd2UnZCBuZWVkIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UgdG8gZG8gdGhpcy5cbiAgICByZXR1cm4gbmV3IG9oKFwiYXJyYXlSZW1vdmVcIiwgdCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIGluY3JlbWVudCB0aGUgZmllbGQncyBjdXJyZW50IHZhbHVlIGJ5XG4gKiB0aGUgZ2l2ZW4gdmFsdWUuXG4gKlxuICogSWYgZWl0aGVyIHRoZSBvcGVyYW5kIG9yIHRoZSBjdXJyZW50IGZpZWxkIHZhbHVlIHVzZXMgZmxvYXRpbmcgcG9pbnRcbiAqIHByZWNpc2lvbiwgYWxsIGFyaXRobWV0aWMgZm9sbG93cyBJRUVFIDc1NCBzZW1hbnRpY3MuIElmIGJvdGggdmFsdWVzIGFyZVxuICogaW50ZWdlcnMsIHZhbHVlcyBvdXRzaWRlIG9mIEphdmFTY3JpcHQncyBzYWZlIG51bWJlciByYW5nZVxuICogKGBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUmAgdG8gYE51bWJlci5NQVhfU0FGRV9JTlRFR0VSYCkgYXJlIGFsc28gc3ViamVjdCB0b1xuICogcHJlY2lzaW9uIGxvc3MuIEZ1cnRoZXJtb3JlLCBvbmNlIHByb2Nlc3NlZCBieSB0aGUgRmlyZXN0b3JlIGJhY2tlbmQsIGFsbFxuICogaW50ZWdlciBvcGVyYXRpb25zIGFyZSBjYXBwZWQgYmV0d2VlbiAtMl42MyBhbmQgMl42My0xLlxuICpcbiAqIElmIHRoZSBjdXJyZW50IGZpZWxkIHZhbHVlIGlzIG5vdCBvZiB0eXBlIGBudW1iZXJgLCBvciBpZiB0aGUgZmllbGQgZG9lcyBub3RcbiAqIHlldCBleGlzdCwgdGhlIHRyYW5zZm9ybWF0aW9uIHNldHMgdGhlIGZpZWxkIHRvIHRoZSBnaXZlbiB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0gbiAtIFRoZSB2YWx1ZSB0byBpbmNyZW1lbnQgYnkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWBcbiAqLyBmdW5jdGlvbiBFbCh0KSB7XG4gICAgcmV0dXJuIG5ldyB1aChcImluY3JlbWVudFwiLCB0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ3JlYXRlcyBhIHdyaXRlIGJhdGNoLCB1c2VkIGZvciBwZXJmb3JtaW5nIG11bHRpcGxlIHdyaXRlcyBhcyBhIHNpbmdsZVxuICogYXRvbWljIG9wZXJhdGlvbi4gVGhlIG1heGltdW0gbnVtYmVyIG9mIHdyaXRlcyBhbGxvd2VkIGluIGEgc2luZ2xlIHtAbGluayBXcml0ZUJhdGNofVxuICogaXMgNTAwLlxuICpcbiAqIFVubGlrZSB0cmFuc2FjdGlvbnMsIHdyaXRlIGJhdGNoZXMgYXJlIHBlcnNpc3RlZCBvZmZsaW5lIGFuZCB0aGVyZWZvcmUgYXJlXG4gKiBwcmVmZXJhYmxlIHdoZW4geW91IGRvbid0IG5lZWQgdG8gY29uZGl0aW9uIHlvdXIgd3JpdGVzIG9uIHJlYWQgZGF0YS5cbiAqXG4gKiBAcmV0dXJucyBBIHtAbGluayBXcml0ZUJhdGNofSB0aGF0IGNhbiBiZSB1c2VkIHRvIGF0b21pY2FsbHkgZXhlY3V0ZSBtdWx0aXBsZVxuICogd3JpdGVzLlxuICovIGZ1bmN0aW9uIEFsKHQpIHtcbiAgICByZXR1cm4gRGModCA9IGhjKHQsIFZjKSksIG5ldyBaaCh0LCAoZSA9PiBfbCh0LCBlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBSbCh0LCBlKSB7XG4gICAgRGModCA9IGhjKHQsIFZjKSk7XG4gICAgY29uc3QgbiA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFEoRy5JTlZBTElEX0FSR1VNRU5ULCBcIkZhaWxlZCB0byBwYXJzZSBKU09OOlwiICsgdC5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH0oZSkgOiBlLCBzID0gW107XG4gICAgLy8gUE9SVElORyBOT1RFOiBXZSBkb24ndCByZXR1cm4gYW4gZXJyb3IgaWYgdGhlIHVzZXIgaGFzIG5vdCBlbmFibGVkXG4gICAgLy8gcGVyc2lzdGVuY2Ugc2luY2UgYGVuYWJsZUluZGV4ZWRkYlBlcnNpc3RlbmNlKClgIGNhbiBmYWlsIG9uIHRoZSBXZWIuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkobi5pbmRleGVzKSkgZm9yIChjb25zdCB0IG9mIG4uaW5kZXhlcykge1xuICAgICAgICBjb25zdCBlID0gYmwodCwgXCJjb2xsZWN0aW9uR3JvdXBcIiksIG4gPSBbXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodC5maWVsZHMpKSBmb3IgKGNvbnN0IGUgb2YgdC5maWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBnaChcInNldEluZGV4Q29uZmlndXJhdGlvblwiLCBibChlLCBcImZpZWxkUGF0aFwiKSk7XG4gICAgICAgICAgICBcIkNPTlRBSU5TXCIgPT09IGUuYXJyYXlDb25maWcgPyBuLnB1c2gobmV3IG9lKHQsIDIgLyogQ09OVEFJTlMgKi8pKSA6IFwiQVNDRU5ESU5HXCIgPT09IGUub3JkZXIgPyBuLnB1c2gobmV3IG9lKHQsIDAgLyogQVNDRU5ESU5HICovKSkgOiBcIkRFU0NFTkRJTkdcIiA9PT0gZS5vcmRlciAmJiBuLnB1c2gobmV3IG9lKHQsIDEgLyogREVTQ0VORElORyAqLykpO1xuICAgICAgICB9XG4gICAgICAgIHMucHVzaChuZXcgc2Uoc2UuVU5LTk9XTl9JRCwgZSwgbiwgdWUuZW1wdHkoKSkpO1xuICAgIH1cbiAgICAvLyBUT0RPKGluZGV4aW5nKTogQ29uZmlndXJlIGluZGV4ZXNcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufVxuXG5mdW5jdGlvbiBibCh0LCBlKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgIT0gdHlwZW9mIHRbZV0pIHRocm93IG5ldyBRKEcuSU5WQUxJRF9BUkdVTUVOVCwgXCJNaXNzaW5nIHN0cmluZyB2YWx1ZSBmb3I6IFwiICsgZSk7XG4gICAgcmV0dXJuIHRbZV07XG59XG5cbi8qKlxuICogQ2xvdWQgRmlyZXN0b3JlXG4gKlxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKi8gIWZ1bmN0aW9uKHQsIGUgPSAhMCkge1xuICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgIHggPSB0O1xuICAgIH0oU0RLX1ZFUlNJT04pLCBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChcImZpcmVzdG9yZVwiLCAoKHQsIHtvcHRpb25zOiBufSkgPT4ge1xuICAgICAgICBjb25zdCBzID0gdC5nZXRQcm92aWRlcihcImFwcFwiKS5nZXRJbW1lZGlhdGUoKSwgaSA9IG5ldyBWYyhzLCBuZXcgSih0LmdldFByb3ZpZGVyKFwiYXV0aC1pbnRlcm5hbFwiKSksIG5ldyB0dCh0LmdldFByb3ZpZGVyKFwiYXBwLWNoZWNrLWludGVybmFsXCIpKSk7XG4gICAgICAgIHJldHVybiBuID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB1c2VGZXRjaFN0cmVhbXM6IGVcbiAgICAgICAgfSwgbiksIGkuX3NldFNldHRpbmdzKG4pLCBpO1xuICAgIH0pLCBcIlBVQkxJQ1wiKSksIHJlZ2lzdGVyVmVyc2lvbihELCBcIjMuNC45XCIsIHQpLCBcbiAgICAvLyBCVUlMRF9UQVJHRVQgd2lsbCBiZSByZXBsYWNlZCBieSB2YWx1ZXMgbGlrZSBlc201LCBlc20yMDE3LCBjanM1LCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxuICAgIHJlZ2lzdGVyVmVyc2lvbihELCBcIjMuNC45XCIsIFwiZXNtMjAxN1wiKTtcbn0oKTtcblxuZXhwb3J0IHsgSmggYXMgQWJzdHJhY3RVc2VyRGF0YVdyaXRlciwgUWMgYXMgQnl0ZXMsIFBjIGFzIENBQ0hFX1NJWkVfVU5MSU1JVEVELCBnYyBhcyBDb2xsZWN0aW9uUmVmZXJlbmNlLCB3YyBhcyBEb2N1bWVudFJlZmVyZW5jZSwgUmggYXMgRG9jdW1lbnRTbmFwc2hvdCwgS2MgYXMgRmllbGRQYXRoLCBqYyBhcyBGaWVsZFZhbHVlLCBWYyBhcyBGaXJlc3RvcmUsIFEgYXMgRmlyZXN0b3JlRXJyb3IsIFdjIGFzIEdlb1BvaW50LCBiYyBhcyBMb2FkQnVuZGxlVGFzaywgbWMgYXMgUXVlcnksIERoIGFzIFF1ZXJ5Q29uc3RyYWludCwgYmggYXMgUXVlcnlEb2N1bWVudFNuYXBzaG90LCBQaCBhcyBRdWVyeVNuYXBzaG90LCBBaCBhcyBTbmFwc2hvdE1ldGFkYXRhLCBhdCBhcyBUaW1lc3RhbXAsIG1sIGFzIFRyYW5zYWN0aW9uLCBaaCBhcyBXcml0ZUJhdGNoLCB2dCBhcyBfRGF0YWJhc2VJZCwgeHQgYXMgX0RvY3VtZW50S2V5LCBldCBhcyBfRW1wdHlBcHBDaGVja1Rva2VuUHJvdmlkZXIsIHogYXMgX0VtcHR5QXV0aENyZWRlbnRpYWxzUHJvdmlkZXIsIG10IGFzIF9GaWVsZFBhdGgsIGhjIGFzIF9jYXN0LCBxIGFzIF9kZWJ1Z0Fzc2VydCwgeXQgYXMgX2lzQmFzZTY0QXZhaWxhYmxlLCAkIGFzIF9sb2dXYXJuLCBSbCBhcyBfc2V0SW5kZXhDb25maWd1cmF0aW9uLCBvYyBhcyBfdmFsaWRhdGVJc05vdFVzZWRUb2dldGhlciwgbGwgYXMgYWRkRG9jLCBUbCBhcyBhcnJheVJlbW92ZSwgSWwgYXMgYXJyYXlVbmlvbiwgTWMgYXMgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgeWMgYXMgY29sbGVjdGlvbiwgcGMgYXMgY29sbGVjdGlvbkdyb3VwLCBfYyBhcyBjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IsIGhsIGFzIGRlbGV0ZURvYywgeWwgYXMgZGVsZXRlRmllbGQsICRjIGFzIGRpc2FibGVOZXR3b3JrLCBJYyBhcyBkb2MsIEdjIGFzIGRvY3VtZW50SWQsIHhjIGFzIGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlLCBOYyBhcyBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlLCBGYyBhcyBlbmFibGVOZXR3b3JrLCBHaCBhcyBlbmRBdCwgS2ggYXMgZW5kQmVmb3JlLCBEYyBhcyBlbnN1cmVGaXJlc3RvcmVDb25maWd1cmVkLCBfbCBhcyBleGVjdXRlV3JpdGUsIGVsIGFzIGdldERvYywgc2wgYXMgZ2V0RG9jRnJvbUNhY2hlLCBpbCBhcyBnZXREb2NGcm9tU2VydmVyLCBybCBhcyBnZXREb2NzLCBvbCBhcyBnZXREb2NzRnJvbUNhY2hlLCB1bCBhcyBnZXREb2NzRnJvbVNlcnZlciwgU2MgYXMgZ2V0RmlyZXN0b3JlLCBFbCBhcyBpbmNyZW1lbnQsIHZjIGFzIGluaXRpYWxpemVGaXJlc3RvcmUsIEZoIGFzIGxpbWl0LCAkaCBhcyBsaW1pdFRvTGFzdCwgTGMgYXMgbG9hZEJ1bmRsZSwgVWMgYXMgbmFtZWRRdWVyeSwgZmwgYXMgb25TbmFwc2hvdCwgZGwgYXMgb25TbmFwc2hvdHNJblN5bmMsIE1oIGFzIG9yZGVyQnksIENoIGFzIHF1ZXJ5LCBFYyBhcyBxdWVyeUVxdWFsLCBUYyBhcyByZWZFcXVhbCwgZ2wgYXMgcnVuVHJhbnNhY3Rpb24sIHBsIGFzIHNlcnZlclRpbWVzdGFtcCwgYWwgYXMgc2V0RG9jLCBNIGFzIHNldExvZ0xldmVsLCB2aCBhcyBzbmFwc2hvdEVxdWFsLCBVaCBhcyBzdGFydEFmdGVyLCBMaCBhcyBzdGFydEF0LCBCYyBhcyB0ZXJtaW5hdGUsIGNsIGFzIHVwZGF0ZURvYywgT2MgYXMgd2FpdEZvclBlbmRpbmdXcml0ZXMsIE5oIGFzIHdoZXJlLCBBbCBhcyB3cml0ZUJhdGNoIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJmaXJlYmFzZS9hcHBcIjtcbmltcG9ydCB7IGdldEZpcmVzdG9yZSwgY29sbGVjdGlvbiwgYWRkRG9jIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5jb25zdCBwbHVnaW4gPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGZpcmViYXNlQ29uZmlnID0ge1xuICAgIGFwaUtleTogXCJBSXphU3lBZ3FOekpMVzE0Q2lqd3l0SmpUaTBIN3dkb29kUHNER01cIixcbiAgICBhdXRoRG9tYWluOiBcInhheW1haW8uZmlyZWJhc2VhcHAuY29tXCIsXG4gICAgcHJvamVjdElkOiBcInhheW1haW9cIixcbiAgICBzdG9yYWdlQnVja2V0OiBcInhheW1haW8uYXBwc3BvdC5jb21cIixcbiAgICBtZXNzYWdpbmdTZW5kZXJJZDogXCIxNTQyNTI4MDYwNzZcIixcbiAgICBhcHBJZDogXCIxOjE1NDI1MjgwNjA3Njp3ZWI6YWE0OWQyNTUxY2YzYTM0ZTM0Y2RiOVwiLFxuICAgIG1lYXN1cmVtZW50SWQ6IFwiRy1NRjFKNEZFN0IwXCIsXG4gICAgZGF0YWJhc2VVUkw6IFwiaHR0cHM6Ly94YXltYWlvLmZpcmViYXNlaW8uY29tXCIsXG4gIH07XG5cbiAgY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKGFwcCk7XG5cbiAgY29uc3Qgc2F2ZSA9IGFzeW5jIChkYXRhOiBhbnkpID0+IHtcbiAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihkYiwgXCJleHBlcmllbmNlc1wiKSwgZGF0YSk7XG4gICAgY29uc29sZS5sb2coXCJEb2N1bWVudCB3cml0dGVuIHdpdGggSUQ6IFwiLCBkb2NSZWYuaWQpO1xuICAgIHJldHVybiBkb2NSZWY7XG4gIH07XG5cbiAgcmV0dXJuIHsgYXBwLCBkYiwgc2F2ZSB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgcGx1Z2luO1xuIiwiaW1wb3J0IGFwcCBmcm9tIFwiLi9hcHBcIjtcbmltcG9ydCBmaXJlYmFzZSBmcm9tIFwiLi9maXJlYmFzZVwiO1xuaW1wb3J0IHN2Z3MgZnJvbSBcIi4vc3Znc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWGF5bWEge1xuICBmaXJlYmFzZTogYW55O1xuICAkdGV4dGFyZWEhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAkZWwhOiB7XG4gICAgZWw6IEhUTUxEaXZFbGVtZW50O1xuICAgIGNoaWxkcmVuOiB7XG4gICAgICBhY3Rpb25zOiB7XG4gICAgICAgIGVsOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgYnV0dG9uczogTm9kZUxpc3RPZjxIVE1MQnV0dG9uRWxlbWVudD47XG4gICAgICB9O1xuXG4gICAgICBlZGl0b3I6IHtcbiAgICAgICAgZWw6IEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBjaGlsZHJlbjoge1xuICAgICAgICAgIHRleHRhcmVhOiBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgfTtcblxuICAgICAgZW1haWw6IHtcbiAgICAgICAgZWw6IEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBpbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICAgIH07XG5cbiAgICAgIHN1Ym1pdDoge1xuICAgICAgICBlbDogSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIGJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICB9O1xuXG4gICAgICBzYXZpbmc6IEhUTUxEaXZFbGVtZW50O1xuICAgICAgZmluaXNoOiB7XG4gICAgICAgIGVsOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgY2hpbGRyZW46IHtcbiAgICAgICAgICBpY29uOiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICB0ZXh0OiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfTtcbiAgfTtcblxuICBwcml2YXRlIG9uU2F2ZT86ICgpID0+IHZvaWQ7XG4gIHByaXZhdGUgb25SZWFkeT86ICgpID0+IHZvaWQ7XG4gIHBhcmVudCE6IEVsZW1lbnQ7XG5cbiAgZW50cmVwcmlzZSE6IHN0cmluZztcbiAgdGV4dCA9IFwiXCI7XG5cbiAgY29uc3RydWN0b3Ioe1xuICAgIHBhcmVudCxcbiAgICBvblJlYWR5LFxuICAgIGVudHJlcHJpc2UsXG4gICAgb25TYXZlLFxuICAgIGxhbmcgPSBcImZyXCIsXG4gIH06IHtcbiAgICBwYXJlbnQ6IEVsZW1lbnQ7XG4gICAgZW50cmVwcmlzZTogc3RyaW5nO1xuICAgIG9uUmVhZHk/OiAoKSA9PiB2b2lkO1xuICAgIG9uU2F2ZT86ICgpID0+IHZvaWQ7XG4gICAgbGFuZz86IFwiZnJcIiB8IFwiZW5cIjtcbiAgfSkge1xuICAgIHRoaXMuZW50cmVwcmlzZSA9IGVudHJlcHJpc2U7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgdGhpcy5sYW5nID0gbGFuZztcblxuICAgIHRoaXMub25SZWFkeSA9IG9uUmVhZHk7XG4gICAgdGhpcy5vblNhdmUgPSBvblNhdmU7XG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGluaXQoKSB7XG4gICAgYXBwKHRoaXMucGFyZW50KTtcblxuICAgIHRoaXMuZmlyZWJhc2UgPSBhd2FpdCBmaXJlYmFzZSgpO1xuXG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLi0teGF5bWEtbWFpblwiKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIC8vIGFjdGlvbnNcbiAgICBjb25zdCBhY3Rpb25zID0gZWwucXVlcnlTZWxlY3RvcihcIi4tLXhheW1hLWFjdGlvbnNcIikgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgY29uc3QgYnV0dG9ucyA9IGFjdGlvbnMucXVlcnlTZWxlY3RvckFsbChcImJ1dHRvblwiKTtcblxuICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnRuKSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IE51bWJlcihidG4uZ2V0QXR0cmlidXRlKFwiZGF0YS12YWx1ZVwiKSk7XG4gICAgICBpZiAodmFsdWUgJiYgIWlzTmFOKHZhbHVlKSkge1xuICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMub25BY3Rpb25CdG5DbGljayh2YWx1ZSkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gZWRpdG9yXG4gICAgY29uc3QgZWRpdG9yID0gZWwucXVlcnlTZWxlY3RvcihcIi4tLXhheW1hLWVkaXRvclwiKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICBjb25zdCB0ZXh0YXJlYSA9IGVkaXRvci5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWFcIikgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgICAgIHRoaXMudGV4dCA9IHRleHRhcmVhLnZhbHVlO1xuICAgIH0pO1xuXG4gICAgLy8gZW1haWxcbiAgICBjb25zdCBlbWFpbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoXCIuLS14YXltYS1lbWFpbFwiKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICBjb25zdCBlbWFpbElucHV0ID0gZW1haWwucXVlcnlTZWxlY3RvcihcImlucHV0XCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgZW1haWxJbnB1dC52YWx1ZSA9IHRoaXMuZW1haWw7XG4gICAgZW1haWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgICAgIHRoaXMuZW1haWwgPSBlbWFpbElucHV0LnZhbHVlO1xuICAgIH0pO1xuXG4gICAgLy8gc3VibWl0XG4gICAgY29uc3Qgc3VibWl0ID0gZWwucXVlcnlTZWxlY3RvcihcIi4tLXhheW1hLXN1Ym1pdFwiKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICBjb25zdCBzdWJtaXRCdG4gPSBzdWJtaXQucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuc3VibWl0KCkpO1xuXG4gICAgLy8gc2F2aW5nXG4gICAgY29uc3Qgc2F2aW5nID0gZWwucXVlcnlTZWxlY3RvcihcIi4tLXhheW1hLXNhdmluZ1wiKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIC8vIGZpbmlzaFxuICAgIGNvbnN0IGZpbmlzaCA9IGVsLnF1ZXJ5U2VsZWN0b3IoXCIuLS14YXltYS1maW5pc2hcIikgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgY29uc3QgZmluaXNoSWNvbiA9IGZpbmlzaC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuLS14YXltYS1maW5pc2gtaWNvblwiXG4gICAgKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICBjb25zdCBmaW5pc2hUZXh0ID0gZmluaXNoLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi4tLXhheW1hLWZpbmlzaC10ZXh0XCJcbiAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuXG4gICAgdGhpcy4kZWwgPSB7XG4gICAgICBlbCxcbiAgICAgIGNoaWxkcmVuOiB7XG4gICAgICAgIGVkaXRvcjogeyBlbDogZWRpdG9yLCBjaGlsZHJlbjogeyB0ZXh0YXJlYSB9IH0sXG4gICAgICAgIGFjdGlvbnM6IHsgZWw6IGFjdGlvbnMsIGJ1dHRvbnMgfSxcbiAgICAgICAgZW1haWw6IHsgZWw6IGVtYWlsLCBpbnB1dDogZW1haWxJbnB1dCB9LFxuICAgICAgICBzdWJtaXQ6IHsgZWw6IHN1Ym1pdCwgYnV0dG9uOiBzdWJtaXRCdG4gfSxcbiAgICAgICAgc2F2aW5nLFxuICAgICAgICBmaW5pc2g6IHtcbiAgICAgICAgICBlbDogZmluaXNoLFxuICAgICAgICAgIGNoaWxkcmVuOiB7XG4gICAgICAgICAgICBpY29uOiBmaW5pc2hJY29uLFxuICAgICAgICAgICAgdGV4dDogZmluaXNoVGV4dCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgdGhpcy5zdGVwID0gMTtcbiAgICB0aGlzLnRyYW5zbGF0ZSh0aGlzLmxhbmcpO1xuICAgIGlmICh0aGlzLm9uUmVhZHkpIHRoaXMub25SZWFkeSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkFjdGlvbkJ0bkNsaWNrKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLm5vdGUgPSB2YWx1ZTtcbiAgfVxuXG4gIHByaXZhdGUgc3VibWl0KCkge1xuICAgIGNvbnN0IHJlID1cbiAgICAgIC9eKChbXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvZ2ltO1xuXG4gICAgaWYgKHJlLnRlc3QodGhpcy5lbWFpbCkpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIG5vdGU6IHRoaXMubm90ZSxcbiAgICAgICAgZW50cmVwcmlzZTogdGhpcy5lbnRyZXByaXNlLFxuICAgICAgICB0ZXh0OiB0aGlzLnRleHQgfHwgbnVsbCxcbiAgICAgICAgZW1haWw6IHRoaXMuZW1haWwsXG4gICAgICB9O1xuXG4gICAgICB0aGlzLnNhdmluZyA9IHRydWU7XG4gICAgICB0aGlzLmZpcmViYXNlXG4gICAgICAgIC5zYXZlKGRhdGEpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5vblNhdmUpIHRoaXMub25TYXZlKCk7XG5cbiAgICAgICAgICBjb25zdCBub3RlcyA9IHtcbiAgICAgICAgICAgIDE6IHN2Z3MuZnJvd24sXG4gICAgICAgICAgICAyOiBzdmdzLmRpc2xpa2UsXG4gICAgICAgICAgICAzOiBzdmdzLmFjY2VwdGFibGUsXG4gICAgICAgICAgICA0OiBzdmdzLmxpa2UsXG4gICAgICAgICAgICA1OiBzdmdzLmxvdmUsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmZpbmlzaC5jaGlsZHJlbi5pY29uLmlubmVySFRNTCA9XG4gICAgICAgICAgICBub3Rlc1t0aGlzLm5vdGUgYXMgMV07XG4gICAgICAgICAgdGhpcy5zdGVwID0gMTAwO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfSBlbHNlIHRoaXMuc3RlcCA9IDM7XG4gIH1cblxuICBwcml2YXRlIHRyYW5zbGF0ZShsYW5nOiBcImZyXCIgfCBcImVuXCIpIHtcbiAgICBjb25zdCB3b3JkcyA9IHtcbiAgICAgIGZyOiB7XG4gICAgICAgIGFjdGlvbnM6IHtcbiAgICAgICAgICAxOiBcIkhvcnJpYmxlXCIsXG4gICAgICAgICAgMjogXCJKJ2FpbWUgcGFzXCIsXG4gICAgICAgICAgMzogXCJBY2NlcHRhYmxlXCIsXG4gICAgICAgICAgNDogXCJKJ2FpbWVcIixcbiAgICAgICAgICA1OiBcIkonYWRvcmVcIixcbiAgICAgICAgfSxcbiAgICAgICAgZWRpdG9yOiB7XG4gICAgICAgICAgcGxhY2Vob2xkZXI6IFwiUmFjb250ZXotbm91cyB2b3RyZSBleHDDqXJpZW5jZSAoZmFjdWx0YXRpZikuLi5cIixcbiAgICAgICAgfSxcbiAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICBwbGFjZWhvbGRlcjogXCJWb3RyZSBhZHJlc3NlIGVtYWlsXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGZpbmlzaDoge1xuICAgICAgICAgIHRleHQ6IFwiTWVyY2kgZCdhdm9pciBwYXJ0aWNpcGVyIMOgIGFtw6lsaW9yZXIgbGEgcXVhbGl0w6kgZGUgY2Ugc2VydmljZSBlbiBwYXJ0YWdlYW50IHZvdHJlIGV4cMOpcmllbmNlIVwiLFxuICAgICAgICB9LFxuICAgICAgICBzdWJtaXQ6IHtcbiAgICAgICAgICB0ZXh0OiBcIkVudm95ZXJcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBlbjoge1xuICAgICAgICBhY3Rpb25zOiB7XG4gICAgICAgICAgMTogXCJIb3JyaWJsZVwiLFxuICAgICAgICAgIDI6IFwiSSBkb24ndCBsaWtlIGl0XCIsXG4gICAgICAgICAgMzogXCJBY2NlcHRhYmxlXCIsXG4gICAgICAgICAgNDogXCJJIGxpa2UgaXRcIixcbiAgICAgICAgICA1OiBcIkkgbG92ZSBpdFwiLFxuICAgICAgICB9LFxuICAgICAgICBlZGl0b3I6IHtcbiAgICAgICAgICBwbGFjZWhvbGRlcjogXCJUZWxsIHVzIGFib3V0IHlvdXIgZXhww6lyaWVuY2UgKG9wdGlvbmFsKS4uLlwiLFxuICAgICAgICB9LFxuICAgICAgICBlbWFpbDoge1xuICAgICAgICAgIHBsYWNlaG9sZGVyOiBcIllvdXIgZW1haWwgYWRkcmVzc1wiLFxuICAgICAgICB9LFxuICAgICAgICBmaW5pc2g6IHtcbiAgICAgICAgICB0ZXh0OiBcIlRoYW5rIHlvdSBmb3IgcGFydGljaXBhdGluZyBpbiBpbXByb3ZpbmcgdGhlIHF1YWxpdHkgb2YgdGhpcyBzZXJ2aWNlIGJ5IHNoYXJpbmcgeW91ciBleHDDqXJpZW5jZSAhXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHN1Ym1pdDoge1xuICAgICAgICAgIHRleHQ6IFwiU2VuZFwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9O1xuXG4gICAgY29uc3Qgd29yZCA9IHdvcmRzW2xhbmddO1xuXG4gICAgdGhpcy4kZWwuY2hpbGRyZW4uYWN0aW9ucy5idXR0b25zLmZvckVhY2goKGJ0biwgaSkgPT4ge1xuICAgICAgY29uc3QgdGV4dCA9IGJ0bi5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBcIi4tLXhheW1hLWFjdGlvbi1idXR0b24tdGV4dFwiXG4gICAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuXG4gICAgICB0ZXh0LmlubmVyVGV4dCA9IHdvcmQuYWN0aW9uc1soaSArIDEpIGFzIDFdO1xuICAgIH0pO1xuXG4gICAgdGhpcy4kZWwuY2hpbGRyZW4uZWRpdG9yLmNoaWxkcmVuLnRleHRhcmVhLnBsYWNlaG9sZGVyID1cbiAgICAgIHdvcmQuZWRpdG9yLnBsYWNlaG9sZGVyO1xuICAgIHRoaXMuJGVsLmNoaWxkcmVuLmVtYWlsLmlucHV0LnBsYWNlaG9sZGVyID0gd29yZC5lbWFpbC5wbGFjZWhvbGRlcjtcbiAgICB0aGlzLiRlbC5jaGlsZHJlbi5maW5pc2guY2hpbGRyZW4udGV4dC5pbm5lclRleHQgPSB3b3JkLmZpbmlzaC50ZXh0O1xuICAgIHRoaXMuJGVsLmNoaWxkcmVuLnN1Ym1pdC5idXR0b24uaW5uZXJUZXh0ID0gd29yZC5zdWJtaXQudGV4dDtcbiAgfVxuXG4gIHByaXZhdGUgX25vdGU/OiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIHB1YmxpYyBnZXQgbm90ZSgpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLl9ub3RlO1xuICB9XG4gIHB1YmxpYyBzZXQgbm90ZShub3RlOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9ub3RlID0gbm90ZTtcblxuICAgIHRoaXMuJGVsLmNoaWxkcmVuLmFjdGlvbnMuYnV0dG9ucy5mb3JFYWNoKChidG4sIGluZGV4KSA9PiB7XG4gICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZShcIi0tY29hdGlvbi1hY3RpdmUtYnV0dG9uXCIpO1xuICAgICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCItLWNvYXRpb24tZGVhY3RpdmUtYnV0dG9uXCIpO1xuXG4gICAgICBpZiAoaW5kZXggKyAxID09PSBub3RlKSB7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKFwiLS1jb2F0aW9uLWFjdGl2ZS1idXR0b25cIik7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBub3RlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKFwiLS1jb2F0aW9uLWRlYWN0aXZlLWJ1dHRvblwiKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuX25vdGUgPSBub3RlO1xuICAgIGlmIChub3RlICYmIHRoaXMuc3RlcCA8IDIpIHRoaXMuc3RlcCA9IDI7XG4gIH1cblxuICBwcml2YXRlIF9zdGVwID0gMTtcbiAgcHVibGljIGdldCBzdGVwKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3N0ZXA7XG4gIH1cbiAgcHVibGljIHNldCBzdGVwKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9zdGVwID0gdmFsdWU7XG4gICAgdGhpcy5zYXZpbmcgPSBmYWxzZTtcblxuICAgIHRoaXMuJGVsLmNoaWxkcmVuLmFjdGlvbnMuZWwuY2xhc3NMaXN0LnJlbW92ZShcIi0teGF5bWEtY2xvc2VcIik7XG4gICAgdGhpcy4kZWwuY2hpbGRyZW4uZWRpdG9yLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCItLXhheW1hLWNsb3NlXCIpO1xuICAgIHRoaXMuJGVsLmNoaWxkcmVuLnN1Ym1pdC5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICB0aGlzLiRlbC5jaGlsZHJlbi5lbWFpbC5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICB0aGlzLiRlbC5jaGlsZHJlbi5maW5pc2guZWwuY2xhc3NMaXN0LnJlbW92ZShcIi0teGF5bWEtY2xvc2VcIik7XG5cbiAgICBpZiAodGhpcy5zdGVwID09PSAxKSB7XG4gICAgICB0aGlzLiRlbC5jaGlsZHJlbi5lZGl0b3IuZWwuY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtY2xvc2VcIik7XG4gICAgICB0aGlzLiRlbC5jaGlsZHJlbi5zdWJtaXQuZWwuY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtY2xvc2VcIik7XG4gICAgICB0aGlzLiRlbC5jaGlsZHJlbi5lbWFpbC5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmZpbmlzaC5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcblxuICAgICAgdGhpcy5ub3RlID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy50ZXh0ID0gXCJcIjtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3RlcCA9PT0gMikge1xuICAgICAgdGhpcy4kZWwuY2hpbGRyZW4uZW1haWwuZWwuY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtY2xvc2VcIik7XG4gICAgICB0aGlzLiRlbC5jaGlsZHJlbi5maW5pc2guZWwuY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtY2xvc2VcIik7XG4gICAgfSBlbHNlIGlmICh0aGlzLnN0ZXAgPT09IDMpIHtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmVkaXRvci5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmZpbmlzaC5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kZWwuY2hpbGRyZW4uYWN0aW9ucy5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmVkaXRvci5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLnN1Ym1pdC5lbC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1jbG9zZVwiKTtcbiAgICAgIHRoaXMuJGVsLmNoaWxkcmVuLmVtYWlsLmVsLmNsYXNzTGlzdC5hZGQoXCItLXhheW1hLWNsb3NlXCIpO1xuICAgICAgdGhpcy4kZWwuY2hpbGRyZW4uZmluaXNoLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCItLXhheW1hLWNsb3NlXCIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX3NhdmluZyA9IGZhbHNlO1xuICBwdWJsaWMgZ2V0IHNhdmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5fc2F2aW5nO1xuICB9XG4gIHB1YmxpYyBzZXQgc2F2aW5nKHZhbHVlKSB7XG4gICAgdGhpcy5fc2F2aW5nID0gdmFsdWU7XG5cbiAgICB0aGlzLiRlbC5jaGlsZHJlbi5zYXZpbmcuY2xhc3NMaXN0WyF2YWx1ZSA/IFwiYWRkXCIgOiBcInJlbW92ZVwiXShcbiAgICAgIFwiLS14YXltYS1jbG9zZVwiXG4gICAgKTtcbiAgfVxuXG4gIC8vIHByaXZhdGUgX2VtYWlsID0gXCJcIjtcbiAgcHVibGljIGdldCBlbWFpbCgpIHtcbiAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInhheW1hLmF1dGguZW1haWxcIikgfHwgXCJcIjtcbiAgfVxuICBwdWJsaWMgc2V0IGVtYWlsKHZhbHVlOiBzdHJpbmcpIHtcbiAgICAvLyB0aGlzLl9lbWFpbCA9IHZhbHVlO1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ4YXltYS5hdXRoLmVtYWlsXCIsIHZhbHVlKTtcbiAgfVxuXG4gIHByaXZhdGUgX2xhbmc6IFwiZnJcIiB8IFwiZW5cIiA9IFwiZnJcIjtcbiAgcHVibGljIGdldCBsYW5nKCk6IFwiZnJcIiB8IFwiZW5cIiB7XG4gICAgcmV0dXJuIHRoaXMuX2xhbmc7XG4gIH1cbiAgcHVibGljIHNldCBsYW5nKHZhbHVlOiBcImZyXCIgfCBcImVuXCIpIHtcbiAgICB0aGlzLl9sYW5nID0gdmFsdWU7XG4gIH1cbn1cbiIsImltcG9ydCB0ZW1wbGF0ZSBmcm9tIFwiLi90ZW1wbGF0ZVwiO1xuaW1wb3J0IF9zdHlsZSBmcm9tIFwiLi9zdHlsZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHBhcmVudDogRWxlbWVudCkgPT4ge1xuICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBkaXYuaW5uZXJIVE1MID0gdGVtcGxhdGU7XG5cbiAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gIHN0eWxlLmlubmVySFRNTCA9IF9zdHlsZTtcbiAgZGl2LmZpcnN0Q2hpbGQ/LmFwcGVuZENoaWxkKHN0eWxlKTtcblxuICBwYXJlbnQuYXBwZW5kQ2hpbGQoZGl2LmZpcnN0Q2hpbGQgYXMgYW55KTtcbn07XG4iLCJpbXBvcnQgdGVtcGxhdGUgZnJvbSBcIi4vdGVtcGxhdGVzXCI7XG5pbXBvcnQgX3N0eWxlIGZyb20gXCIuL3N0eWxlc1wiO1xuaW1wb3J0IFhheW1hIGZyb20gXCIuLi94YXltYVwiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBtYWluITogYW55O1xuICBhcHAhOiBIVE1MRGl2RWxlbWVudDtcbiAgZW50cmVwcmlzZSE6IHN0cmluZztcbiAgbGFuZz86IFwiZnJcIiB8IFwiZW5cIjtcblxuICAkZWwhOiB7XG4gICAgZWw6IEhUTUxEaXZFbGVtZW50O1xuICAgIHN0YXJ0ZXJCdXR0b246IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNsb3NlckJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gIH07XG5cbiAgY29uc3RydWN0b3IoZW50cmVwcmlzZTogc3RyaW5nLCBsYW5nPzogXCJmclwiIHwgXCJlblwiKSB7XG4gICAgdGhpcy5lbnRyZXByaXNlID0gZW50cmVwcmlzZTtcbiAgICB0aGlzLmxhbmcgPSBsYW5nO1xuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICBhc3luYyBpbml0KCkge1xuICAgIGlmICghdGhpcy5sYW5nKSB7XG4gICAgICBjb25zdCBsYW5nID0gd2luZG93Lm5hdmlnYXRvci5sYW5ndWFnZTtcbiAgICAgIHRoaXMubGFuZyA9IFtcImZyXCIsIFwiZW5cIl0uaW5jbHVkZXMobGFuZykgPyAobGFuZyBhcyBcImZyXCIpIDogXCJmclwiO1xuICAgIH1cblxuICAgIGNvbnN0IGFwcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgYXBwLmlubmVySFRNTCA9IGF3YWl0IHRlbXBsYXRlKCk7XG4gICAgdGhpcy5hcHAgPSBhcHAuZmlyc3RDaGlsZCBhcyBIVE1MRGl2RWxlbWVudDtcblxuICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgIHN0eWxlLmlubmVySFRNTCA9IF9zdHlsZTtcbiAgICB0aGlzLmFwcC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhcHApO1xuXG4gICAgY29uc3Qgc3RhcnRlciA9IHRoaXMuYXBwLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi4tLXhheW1hLXN0YXJ0LWJ1dHRvblwiXG4gICAgKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICBzdGFydGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLnRvZ2dsZU9wZW4oKSk7XG5cbiAgICBjb25zdCBjbG9zZXIgPSB0aGlzLmFwcC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuLS14YXltYS1jbG9zZXItYnV0dG9uXCJcbiAgICApIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIGNsb3Nlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy50b2dnbGVPcGVuKCkpO1xuXG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5hcHAucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLi0teGF5bWEtbWFpbi1jb250YWluZXJcIlxuICAgICkgYXMgSFRNTERpdkVsZW1lbnQ7XG5cbiAgICB0aGlzLiRlbCA9IHtcbiAgICAgIGVsOiB0aGlzLmFwcCxcbiAgICAgIGNsb3NlckJ1dHRvbjogY2xvc2VyLFxuICAgICAgc3RhcnRlckJ1dHRvbjogc3RhcnRlcixcbiAgICB9O1xuXG4gICAgdGhpcy50cmFuc2xhdGUodGhpcy5sYW5nKTtcblxuICAgIHRoaXMubWFpbiA9IG5ldyBYYXltYSh7XG4gICAgICBwYXJlbnQ6IGNvbnRhaW5lcixcbiAgICAgIGVudHJlcHJpc2U6IHRoaXMuZW50cmVwcmlzZSxcbiAgICAgIGxhbmc6IHRoaXMubGFuZyxcbiAgICAgIG9uUmVhZHk6ICgpID0+IHRoaXMub25SZWFkeSgpLFxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSB0cmFuc2xhdGUobGFuZzogXCJmclwiIHwgXCJlblwiKSB7XG4gICAgY29uc3Qgd29yZHMgPSB7XG4gICAgICBmcjoge1xuICAgICAgICBzdGFydGVyQnV0dG9uOiBcIlZvdHJlIGF2aXNcIixcbiAgICAgICAgY2xvc2VyQnV0dG9uOiBcIkZlcm1lclwiLFxuICAgICAgfSxcbiAgICAgIGVuOiB7XG4gICAgICAgIHN0YXJ0ZXJCdXR0b246IFwiRmVlZGJhY2tcIixcbiAgICAgICAgY2xvc2VyQnV0dG9uOiBcIkNsb3NlXCIsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCB3b3JkID0gd29yZHNbbGFuZ107XG5cbiAgICBjb25zdCB0ZXh0ID0gdGhpcy4kZWwuc3RhcnRlckJ1dHRvbi5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuLS14YXltYS1zdGFydC1idXR0b24tdGV4dFwiXG4gICAgKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICB0ZXh0LmlubmVyVGV4dCA9IHdvcmQuc3RhcnRlckJ1dHRvbjtcblxuICAgIHRoaXMuJGVsLmNsb3NlckJ1dHRvbi5pbm5lclRleHQgPSB3b3JkLmNsb3NlckJ1dHRvbjtcbiAgfVxuXG4gIG9uUmVhZHkoKSB7XG4gICAgdGhpcy5hcHAuY2xhc3NMaXN0LmFkZChcInJlYWR5XCIpO1xuICB9XG5cbiAgdG9nZ2xlT3Blbihmb3JjZUNsb3NlPzogYm9vbGVhbikge1xuICAgIGZvcmNlQ2xvc2U7XG4gICAgdGhpcy5hcHAuY2xhc3NMaXN0W2ZvcmNlQ2xvc2UgPyBcInJlbW92ZVwiIDogXCJ0b2dnbGVcIl0oXCJvcGVuXCIpO1xuICAgIHRoaXMubWFpbi5zdGVwID0gMTtcbiAgfVxufVxuIiwiaW1wb3J0IF90ZW1wbGF0ZSBmcm9tIFwiISFyYXctbG9hZGVyIS4vdGVtcGxhdGUuaHRtbFwiO1xuaW1wb3J0IHN0YXJ0QnV0dG9uIGZyb20gXCIuL3N0YXJ0QnV0dG9uXCI7XG5pbXBvcnQgY2xvc2VyQnV0dG9uIGZyb20gXCIuL2Nsb3NlckJ1dHRvblwiO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAoKSA9PiB7XG4gIGxldCB0ZW1wbGF0ZSA9IF90ZW1wbGF0ZTtcbiAgdGVtcGxhdGUgPSBhd2FpdCBzdGFydEJ1dHRvbih0ZW1wbGF0ZSk7XG4gIHRlbXBsYXRlID0gYXdhaXQgY2xvc2VyQnV0dG9uKHRlbXBsYXRlKTtcblxuICByZXR1cm4gdGVtcGxhdGU7XG59O1xuIiwiaW1wb3J0IF9zdmcgZnJvbSBcIi4uLy4uL3hheW1hL3N2Z3NcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKHRlbXBsYXRlOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoXCItLXhheW1hLXN0YXJ0LWJ1dHRvblwiKTtcblxuICBjb25zdCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgdGV4dC5jbGFzc0xpc3QuYWRkKFwiLS14YXltYS1zdGFydC1idXR0b24tdGV4dFwiKTtcbiAgdGV4dC5pbm5lclRleHQgPSBcIlZvdHJlIGF2aXNcIjtcbiAgYnV0dG9uLmFwcGVuZENoaWxkKHRleHQpO1xuXG4gIGNvbnN0IGljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBpY29uLmNsYXNzTGlzdC5hZGQoXCItLXhheW1hLXN0YXJ0LWJ1dHRvbi1pY29uXCIpO1xuICBpY29uLmlubmVySFRNTCA9IF9zdmcubG92ZTtcbiAgYnV0dG9uLmFwcGVuZENoaWxkKGljb24pO1xuXG4gIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFwiX194YXltYV9zdGFydF9idXR0b25fX1wiLCBidXR0b24ub3V0ZXJIVE1MKTtcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBhc3luYyAodGVtcGxhdGU6IHN0cmluZykgPT4ge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICBidXR0b24uY2xhc3NMaXN0LmFkZChcIi0teGF5bWEtY2xvc2VyLWJ1dHRvblwiKTtcbiAgYnV0dG9uLmlubmVySFRNTCA9IFwiZmVybWVyXCI7XG5cbiAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoXCJfX3hheW1hX2Nsb3Nlcl9idXR0b25fX1wiLCBidXR0b24ub3V0ZXJIVE1MKTtcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBcIiN4YXltYXtmb250LWZhbWlseTpcXFwiUm9ib3RvXFxcIiwgc2Fucy1zZXJpZjtmb250LXNpemU6MTRweH0jeGF5bWEgLi0teGF5bWEtc3RhcnQtYnV0dG9ue3Bvc2l0aW9uOmZpeGVkO3JpZ2h0OjA7dG9wOjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtNTAlKTt3aWR0aDozNnB4O2JvcmRlcjowO3BhZGRpbmc6MDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjAuM2VtO2JvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MC4zZW07YmFja2dyb3VuZC1jb2xvcjp2YXIoLS14YXltYS1kYXJrLWNvbG9yKTtjb2xvcjp2YXIoLS14YXltYS1saWdodC1jb2xvcik7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtwYWRkaW5nLXRvcDo4cHg7cGFkZGluZy1ib3R0b206OHB4O2dhcDo1cHg7Y3Vyc29yOnBvaW50ZXJ9I3hheW1hIC4tLXhheW1hLXN0YXJ0LWJ1dHRvbiAuLS14YXltYS1zdGFydC1idXR0b24tdGV4dHt3cml0aW5nLW1vZGU6dmVydGljYWwtcmw7LXdlYmtpdC10ZXh0LW9yaWVudGF0aW9uOm1peGVkO3RleHQtb3JpZW50YXRpb246bWl4ZWR9I3hheW1hIC4tLXhheW1hLXN0YXJ0LWJ1dHRvbiAuLS14YXltYS1zdGFydC1idXR0b24taWNvbnt3aWR0aDoyMHB4fSN4YXltYSAuLS14YXltYS1zdGFydC1idXR0b24gLi0teGF5bWEtc3RhcnQtYnV0dG9uLWljb24gc3Zne2ZpbGw6dmFyKC0teGF5bWEtbGlnaHQtY29sb3IpfSN4YXltYSAuLS14YXltYS1tYWluLWNvbnRhaW5lcntwb3NpdGlvbjpmaXhlZDtyaWdodDoxMHB4O3RvcDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSk7d2lkdGg6MzUwcHg7bWF4LXdpZHRoOmNhbGMoMTAwJSAtIDIwcHgpO2JveC1zaGFkb3c6dmFyKC0teGF5bWEtc2hhZG93KTthbmltYXRpb246WGF5bWFBbmltZU1haW5Db250YWluZXIgMC41cyBlYXNlfSN4YXltYSAuLS14YXltYS1tYWluLWNvbnRhaW5lciAuLS14YXltYS1jbG9zZXItYnV0dG9ue3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3JpZ2h0OjEwcHg7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSk7Ym9yZGVyOjA7bWluLXdpZHRoOjI0cHg7aGVpZ2h0OjI0cHg7b3V0bGluZTpub25lO2JhY2tncm91bmQtY29sb3I6dmFyKC0teGF5bWEtZGFyay1jb2xvcik7Y29sb3I6dmFyKC0teGF5bWEtbGlnaHQtY29sb3IpO3otaW5kZXg6NTA7Ym9yZGVyLXJhZGl1czoxNmVtO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MTBweH0jeGF5bWEgLi0teGF5bWEtbWFpbi1jb250YWluZXIgLi0teGF5bWEtY2xvc2VyLWJ1dHRvbiBzdmd7ZmlsbDp2YXIoLS14YXltYS1saWdodC1jb2xvcik7d2lkdGg6OHB4fUBrZXlmcmFtZXMgWGF5bWFBbmltZU1haW5Db250YWluZXJ7MCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSkgdHJhbnNsYXRlWCg1MCUpO29wYWNpdHk6MH0xMDAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpIHRyYW5zbGF0ZVgoMCkgc2NhbGUoMSk7b3BhY2l0eToxfX0jeGF5bWE6bm90KC5vcGVuKSAuLS14YXltYS1tYWluLWNvbnRhaW5lcntkaXNwbGF5Om5vbmV9I3hheW1hLm9wZW4gLi0teGF5bWEtc3RhcnQtYnV0dG9ue2Rpc3BsYXk6bm9uZX0jeGF5bWE6bm90KC5yZWFkeSl7ZGlzcGxheTpub25lfVxcblwiOyIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9wb3B1cFwiO1xuZXhwb3J0IHsgZGVmYXVsdCBhcyBYYXltYSB9IGZyb20gXCIuL3hheW1hXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0KGVudHJlcHJpc2U6IHN0cmluZywgbGFuZz86IFwiZnJcIiB8IFwiZW5cIikge1xuICBjb25zdCBhcHAgPSBuZXcgUG9wdXAoZW50cmVwcmlzZSwgbGFuZyk7XG4gIHJldHVybiBhcHA7XG59XG5cbi8vVDZ6Q21GSnNyOHN3WVMzT1I4bEdcbiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiZyIsImdsb2JhbFRoaXMiLCJ0aGlzIiwiRnVuY3Rpb24iLCJlIiwid2luZG93Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidGVtcGxhdGUiLCJkaXYiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbm5lckhUTUwiLCJyZXBsYWNlIiwib3V0ZXJIVE1MIiwic2F2aW5nIiwiYWN0aW9ucyIsImZyb3duIiwiaWNvbiIsInN2Z3MiLCJ0ZXh0Iiwibm90ZSIsImRpc2xpa2UiLCJhY2NlcHRhYmxlIiwibGlrZSIsImxvdmUiLCJrZXlzIiwiaSIsImxlbmd0aCIsImJ1dHRvbiIsInN0eWxlIiwiYW5pbWF0aW9uRHVyYXRpb24iLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsInN0cmluZ1RvQnl0ZUFycmF5JDEiLCJzdHIiLCJvdXQiLCJwIiwiYyIsImNoYXJDb2RlQXQiLCJiYXNlNjQiLCJieXRlVG9DaGFyTWFwXyIsImNoYXJUb0J5dGVNYXBfIiwiYnl0ZVRvQ2hhck1hcFdlYlNhZmVfIiwiY2hhclRvQnl0ZU1hcFdlYlNhZmVfIiwiRU5DT0RFRF9WQUxTX0JBU0UiLCJFTkNPREVEX1ZBTFMiLCJFTkNPREVEX1ZBTFNfV0VCU0FGRSIsIkhBU19OQVRJVkVfU1VQUE9SVCIsImF0b2IiLCJlbmNvZGVCeXRlQXJyYXkiLCJpbnB1dCIsIndlYlNhZmUiLCJBcnJheSIsImlzQXJyYXkiLCJFcnJvciIsImluaXRfIiwiYnl0ZVRvQ2hhck1hcCIsIm91dHB1dCIsImJ5dGUxIiwiaGF2ZUJ5dGUyIiwiYnl0ZTIiLCJoYXZlQnl0ZTMiLCJieXRlMyIsIm91dEJ5dGUxIiwib3V0Qnl0ZTIiLCJvdXRCeXRlMyIsIm91dEJ5dGU0IiwicHVzaCIsImpvaW4iLCJlbmNvZGVTdHJpbmciLCJidG9hIiwiZGVjb2RlU3RyaW5nIiwiYnl0ZXMiLCJwb3MiLCJjMSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImMyIiwidSIsImMzIiwiYnl0ZUFycmF5VG9TdHJpbmciLCJkZWNvZGVTdHJpbmdUb0J5dGVBcnJheSIsImNoYXJUb0J5dGVNYXAiLCJjaGFyQXQiLCJieXRlNCIsImJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nIiwidXRmOEJ5dGVzIiwiYmFzZTY0RW5jb2RlIiwiRGVmZXJyZWQiLCJjb25zdHJ1Y3RvciIsInJlamVjdCIsInJlc29sdmUiLCJwcm9taXNlIiwiUHJvbWlzZSIsIndyYXBDYWxsYmFjayIsImNhbGxiYWNrIiwiZXJyb3IiLCJjYXRjaCIsIm5hdmlnYXRvciIsIkZpcmViYXNlRXJyb3IiLCJjb2RlIiwibWVzc2FnZSIsImN1c3RvbURhdGEiLCJzdXBlciIsIm5hbWUiLCJzZXRQcm90b3R5cGVPZiIsImNhcHR1cmVTdGFja1RyYWNlIiwiRXJyb3JGYWN0b3J5IiwiY3JlYXRlIiwic2VydmljZSIsInNlcnZpY2VOYW1lIiwiZXJyb3JzIiwiZGF0YSIsImZ1bGxDb2RlIiwiUEFUVEVSTiIsIl8iLCJyZXBsYWNlVGVtcGxhdGUiLCJmdWxsTWVzc2FnZSIsImEiLCJiIiwiYUtleXMiLCJiS2V5cyIsImsiLCJpbmNsdWRlcyIsImFQcm9wIiwiYlByb3AiLCJpc09iamVjdCIsInRoaW5nIiwiX2RlbGVnYXRlIiwiQ29tcG9uZW50IiwiaW5zdGFuY2VGYWN0b3J5IiwidHlwZSIsIm11bHRpcGxlSW5zdGFuY2VzIiwic2VydmljZVByb3BzIiwiaW5zdGFudGlhdGlvbk1vZGUiLCJvbkluc3RhbmNlQ3JlYXRlZCIsInNldEluc3RhbnRpYXRpb25Nb2RlIiwibW9kZSIsInNldE11bHRpcGxlSW5zdGFuY2VzIiwic2V0U2VydmljZVByb3BzIiwicHJvcHMiLCJzZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjayIsIkRFRkFVTFRfRU5UUllfTkFNRSIsIlByb3ZpZGVyIiwiY29udGFpbmVyIiwiY29tcG9uZW50IiwiaW5zdGFuY2VzIiwiTWFwIiwiaW5zdGFuY2VzRGVmZXJyZWQiLCJpbnN0YW5jZXNPcHRpb25zIiwib25Jbml0Q2FsbGJhY2tzIiwiaWRlbnRpZmllciIsIm5vcm1hbGl6ZWRJZGVudGlmaWVyIiwibm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyIiwiaGFzIiwiZGVmZXJyZWQiLCJzZXQiLCJpc0luaXRpYWxpemVkIiwic2hvdWxkQXV0b0luaXRpYWxpemUiLCJpbnN0YW5jZSIsImdldE9ySW5pdGlhbGl6ZVNlcnZpY2UiLCJpbnN0YW5jZUlkZW50aWZpZXIiLCJnZXRJbW1lZGlhdGUiLCJvcHRpb25zIiwiX2EiLCJvcHRpb25hbCIsImdldENvbXBvbmVudCIsInNldENvbXBvbmVudCIsImlzQ29tcG9uZW50RWFnZXIiLCJpbnN0YW5jZURlZmVycmVkIiwiZW50cmllcyIsImNsZWFySW5zdGFuY2UiLCJkZWxldGUiLCJhc3luYyIsInNlcnZpY2VzIiwiZnJvbSIsInZhbHVlcyIsImFsbCIsImZpbHRlciIsIm1hcCIsIklOVEVSTkFMIiwiX2RlbGV0ZSIsImlzQ29tcG9uZW50U2V0IiwiZ2V0T3B0aW9ucyIsImluaXRpYWxpemUiLCJvcHRzIiwib25Jbml0IiwiZXhpc3RpbmdDYWxsYmFja3MiLCJTZXQiLCJleGlzdGluZ0luc3RhbmNlIiwiaW52b2tlT25Jbml0Q2FsbGJhY2tzIiwiY2FsbGJhY2tzIiwidW5kZWZpbmVkIiwiQ29tcG9uZW50Q29udGFpbmVyIiwicHJvdmlkZXJzIiwiYWRkQ29tcG9uZW50IiwicHJvdmlkZXIiLCJnZXRQcm92aWRlciIsImFkZE9yT3ZlcndyaXRlQ29tcG9uZW50IiwiZ2V0UHJvdmlkZXJzIiwiTG9nTGV2ZWwiLCJsZXZlbFN0cmluZ1RvRW51bSIsIkRFQlVHIiwiVkVSQk9TRSIsIklORk8iLCJXQVJOIiwiRVJST1IiLCJTSUxFTlQiLCJkZWZhdWx0TG9nTGV2ZWwiLCJDb25zb2xlTWV0aG9kIiwiZGVmYXVsdExvZ0hhbmRsZXIiLCJsb2dUeXBlIiwiYXJncyIsImxvZ0xldmVsIiwibm93IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibWV0aG9kIiwiY29uc29sZSIsIkxvZ2dlciIsIl9sb2dMZXZlbCIsIl9sb2dIYW5kbGVyIiwiX3VzZXJMb2dIYW5kbGVyIiwidmFsIiwiVHlwZUVycm9yIiwic2V0TG9nTGV2ZWwiLCJsb2dIYW5kbGVyIiwidXNlckxvZ0hhbmRsZXIiLCJkZWJ1ZyIsImxvZyIsImluZm8iLCJ3YXJuIiwiaWRiUHJveHlhYmxlVHlwZXMiLCJjdXJzb3JBZHZhbmNlTWV0aG9kcyIsImN1cnNvclJlcXVlc3RNYXAiLCJXZWFrTWFwIiwidHJhbnNhY3Rpb25Eb25lTWFwIiwidHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwIiwidHJhbnNmb3JtQ2FjaGUiLCJyZXZlcnNlVHJhbnNmb3JtQ2FjaGUiLCJpZGJQcm94eVRyYXBzIiwidGFyZ2V0IiwicmVjZWl2ZXIiLCJJREJUcmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlTmFtZXMiLCJvYmplY3RTdG9yZSIsInRyYW5zZm9ybUNhY2hhYmxlVmFsdWUiLCJmdW5jIiwiSURCRGF0YWJhc2UiLCJ0cmFuc2FjdGlvbiIsIklEQkN1cnNvciIsImFkdmFuY2UiLCJjb250aW51ZSIsImNvbnRpbnVlUHJpbWFyeUtleSIsImFwcGx5IiwidW53cmFwIiwic3RvcmVOYW1lcyIsInR4Iiwic29ydCIsImRvbmUiLCJ1bmxpc3RlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjb21wbGV0ZSIsIkRPTUV4Y2VwdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJjYWNoZURvbmVQcm9taXNlRm9yVHJhbnNhY3Rpb24iLCJvYmplY3QiLCJJREJPYmplY3RTdG9yZSIsIklEQkluZGV4Iiwic29tZSIsIlByb3h5IiwiSURCUmVxdWVzdCIsInJlcXVlc3QiLCJzdWNjZXNzIiwicmVzdWx0IiwidGhlbiIsInByb21pc2lmeVJlcXVlc3QiLCJuZXdWYWx1ZSIsInJlYWRNZXRob2RzIiwid3JpdGVNZXRob2RzIiwiY2FjaGVkTWV0aG9kcyIsImdldE1ldGhvZCIsInRhcmdldEZ1bmNOYW1lIiwidXNlSW5kZXgiLCJpc1dyaXRlIiwic3RvcmVOYW1lIiwic3RvcmUiLCJpbmRleCIsInNoaWZ0Iiwib2xkVHJhcHMiLCJQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIiwiZ2V0UGxhdGZvcm1JbmZvU3RyaW5nIiwiaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyIiwibGlicmFyeSIsInZlcnNpb24iLCJsb2dTdHJpbmciLCJuYW1lJG8iLCJ2ZXJzaW9uJDEiLCJsb2dnZXIiLCJQTEFURk9STV9MT0dfU1RSSU5HIiwiX2FwcHMiLCJfY29tcG9uZW50cyIsIl9hZGRDb21wb25lbnQiLCJhcHAiLCJfcmVnaXN0ZXJDb21wb25lbnQiLCJjb21wb25lbnROYW1lIiwiRVJST1JfRkFDVE9SWSIsIkZpcmViYXNlQXBwSW1wbCIsImNvbmZpZyIsIl9pc0RlbGV0ZWQiLCJfb3B0aW9ucyIsImFzc2lnbiIsIl9jb25maWciLCJfbmFtZSIsIl9hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQiLCJhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQiLCJfY29udGFpbmVyIiwiY2hlY2tEZXN0cm95ZWQiLCJpc0RlbGV0ZWQiLCJhcHBOYW1lIiwicmVnaXN0ZXJWZXJzaW9uIiwibGlicmFyeUtleU9yTmFtZSIsInZhcmlhbnQiLCJsaWJyYXJ5TWlzbWF0Y2giLCJtYXRjaCIsInZlcnNpb25NaXNtYXRjaCIsIndhcm5pbmciLCJTVE9SRV9OQU1FIiwiZGJQcm9taXNlIiwiZ2V0RGJQcm9taXNlIiwiYmxvY2tlZCIsInVwZ3JhZGUiLCJibG9ja2luZyIsInRlcm1pbmF0ZWQiLCJpbmRleGVkREIiLCJvcGVuIiwib3BlblByb21pc2UiLCJldmVudCIsIm9sZFZlcnNpb24iLCJuZXdWZXJzaW9uIiwiZGIiLCJvcGVuREIiLCJjcmVhdGVPYmplY3RTdG9yZSIsIm9yaWdpbmFsRXJyb3JNZXNzYWdlIiwid3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIiLCJoZWFydGJlYXRPYmplY3QiLCJwdXQiLCJjb21wdXRlS2V5IiwiYXBwSWQiLCJIZWFydGJlYXRTZXJ2aWNlSW1wbCIsIl9oZWFydGJlYXRzQ2FjaGUiLCJfc3RvcmFnZSIsIkhlYXJ0YmVhdFN0b3JhZ2VJbXBsIiwiX2hlYXJ0YmVhdHNDYWNoZVByb21pc2UiLCJyZWFkIiwiYWdlbnQiLCJkYXRlIiwiZ2V0VVRDRGF0ZVN0cmluZyIsImxhc3RTZW50SGVhcnRiZWF0RGF0ZSIsImhlYXJ0YmVhdHMiLCJzaW5nbGVEYXRlSGVhcnRiZWF0IiwiaGJUaW1lc3RhbXAiLCJ2YWx1ZU9mIiwib3ZlcndyaXRlIiwiaGVhcnRiZWF0c1RvU2VuZCIsInVuc2VudEVudHJpZXMiLCJoZWFydGJlYXRzQ2FjaGUiLCJtYXhTaXplIiwic2xpY2UiLCJoZWFydGJlYXRFbnRyeSIsImZpbmQiLCJoYiIsImRhdGVzIiwiY291bnRCeXRlcyIsInBvcCIsImV4dHJhY3RIZWFydGJlYXRzRm9ySGVhZGVyIiwiaGVhZGVyU3RyaW5nIiwiSlNPTiIsInN0cmluZ2lmeSIsInN1YnN0cmluZyIsIl9jYW5Vc2VJbmRleGVkREJQcm9taXNlIiwicnVuSW5kZXhlZERCRW52aXJvbm1lbnRDaGVjayIsInByZUV4aXN0IiwiREJfQ0hFQ0tfTkFNRSIsIm9uc3VjY2VzcyIsImNsb3NlIiwiZGVsZXRlRGF0YWJhc2UiLCJvbnVwZ3JhZGVuZWVkZWQiLCJvbmVycm9yIiwicmVhZEhlYXJ0YmVhdHNGcm9tSW5kZXhlZERCIiwiaGVhcnRiZWF0c09iamVjdCIsImV4aXN0aW5nSGVhcnRiZWF0c09iamVjdCIsImNvbW1vbmpzR2xvYmFsIiwiZXNtIiwiZ29vZyIsImwiLCJhYSIsImJhIiwiZWEiLCJNYXRoIiwicmFuZG9tIiwiZmEiLCJoYSIsImJpbmQiLCJhcmd1bWVudHMiLCJpYSIsImQiLCJ1bnNoaWZ0IiwicSIsInRvU3RyaW5nIiwiaW5kZXhPZiIsImphIiwidCIsIloiLCJWYiIsImYiLCJoIiwibiIsInYiLCJzIiwibGEiLCJuYSIsIk0iLCJkYSIsIm1hIiwiZm9yRWFjaCIsInNwbGl0IiwicWEiLCJjb25jYXQiLCJyYSIsInNhIiwidGVzdCIsIngiLCJ0YSIsInRyaW0iLCJleGVjIiwidyIsInVhIiwidmEiLCJ3YSIsInVzZXJBZ2VudCIsInhhIiwieWEiLCJ6YSIsIkFhIiwiQ2EiLCJOYSIsIkhhIiwieSIsIklhIiwiSmEiLCJLYSIsInRvTG93ZXJDYXNlIiwiTGEiLCJNYSIsImRvY3VtZW50TW9kZSIsIk9hIiwiUGEiLCJRYSIsInBhcnNlRmxvYXQiLCJTYSIsIkdhIiwiUmEiLCJtYXgiLCJwYXJzZUludCIsIlVhIiwiVmEiLCJ6IiwiZGVmYXVsdFByZXZlbnRlZCIsIkEiLCJyZWxhdGVkVGFyZ2V0Iiwic2NyZWVuWSIsInNjcmVlblgiLCJjbGllbnRZIiwiY2xpZW50WCIsIm1ldGFLZXkiLCJzaGlmdEtleSIsImFsdEtleSIsImN0cmxLZXkiLCJzdGF0ZSIsInBvaW50ZXJJZCIsInBvaW50ZXJUeXBlIiwiY2hhbmdlZFRvdWNoZXMiLCJzcmNFbGVtZW50Iiwibm9kZU5hbWUiLCJmcm9tRWxlbWVudCIsInRvRWxlbWVudCIsInBhZ2VYIiwicGFnZVkiLCJXYSIsInByZXZlbnREZWZhdWx0IiwicmV0dXJuVmFsdWUiLCJCIiwiWGEiLCJZYSIsImxpc3RlbmVyIiwicHJveHkiLCJzcmMiLCJjYXB0dXJlIiwiY2EiLCJaYSIsIiRhIiwiYmIiLCJzcGxpY2UiLCJhYiIsImNiIiwiZmIiLCJvbmNlIiwiZ2IiLCJOIiwiaWIiLCJqYiIsIm1iIiwia2IiLCJhdHRhY2hFdmVudCIsImxiIiwiYWRkTGlzdGVuZXIiLCJyZW1vdmVMaXN0ZW5lciIsIk8iLCJuYiIsIm9iIiwiZGV0YWNoRXZlbnQiLCJwYiIsImhhbmRsZUV2ZW50IiwiQyIsIlAiLCJJIiwiRCIsInFiIiwicmIiLCJzYiIsInRiIiwibmV4dCIsIkFiIiwidmIiLCJqIiwid2IiLCJyZXNldCIsInliIiwic2V0VGltZW91dCIsInpiIiwiRGIiLCJCYiIsIkNiIiwiRWIiLCJGYiIsIlMiLCJjbGVhclRpbWVvdXQiLCJHYiIsIk51bWJlciIsIkhiIiwibSIsInN0YXJ0IiwiSWIiLCJFIiwiSmIiLCJLYiIsIkxiIiwiTWIiLCJGIiwicGFyc2UiLCJQYiIsIkgiLCJSYiIsIlNiIiwiVGIiLCJVYiIsIlNUQVRfRVZFTlQiLCJzdGF0IiwiSiIsInNpemUiLCJLIiwiV2IiLCJOT19FUlJPUiIsInhiIiwiVElNRU9VVCIsIlhiIiwiWWIiLCJaYiIsIiRiIiwiY2MiLCJMIiwiT1BFTiIsImFjIiwiYmMiLCJkYyIsIlgiLCJWIiwiZWMiLCJXIiwiWSIsIiQiLCJVIiwiZmMiLCJYTUxIdHRwUmVxdWVzdCIsImdjIiwiaGMiLCJpYyIsImpjIiwia2MiLCJsYyIsIm1jIiwibmMiLCJHIiwiTmIiLCJxYyIsIkJhIiwidGMiLCJ2YyIsInNjIiwid2MiLCJyYyIsImlzTmFOIiwic3Vic3RyIiwieGMiLCJlYiIsInBjIiwidWMiLCJhYm9ydCIsInljIiwiemMiLCJBYyIsIkJjIiwiQ2MiLCJrYSIsIlEiLCJEYSIsIkVhIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJEYyIsIlIiLCJvYSIsIkVjIiwiRmMiLCJHYyIsIkhjIiwiSWMiLCJLYyIsIlQiLCJKYyIsIkxjIiwiZ2EiLCJvYyIsIlRleHREZWNvZGVyIiwiZGVjb2RlIiwic3RyZWFtIiwiT2IiLCJjYW5jZWwiLCJRYiIsIk1jIiwiT2MiLCJQYyIsIlFjIiwiUmMiLCJTYyIsIlRjIiwiZGQiLCJaYyIsIlVjIiwiJGMiLCJmbG9vciIsImFicyIsImRlY29kZVVSSSIsImRlY29kZVVSSUNvbXBvbmVudCIsImVuY29kZVVSSSIsImNkIiwiVmMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJXYyIsIlhjIiwiWWMiLCJOYyIsImVkIiwiZ2QiLCJoZCIsIlBlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZyIsInBlcmZvcm1hbmNlIiwiZ2V0RW50cmllc0J5VHlwZSIsIm5leHRIb3BQcm90b2NvbCIsImlkIiwiamQiLCJrZCIsImxkIiwibWQiLCJvZCIsIm9ubG9hZCIsIm9uYWJvcnQiLCJvbnRpbWVvdXQiLCJwZCIsInFkIiwicmVhZHlTdGF0ZSIsInJkIiwic3RhdHVzIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwiSGVhZGVycyIsImNsZWFyIiwidWQiLCJ0ZCIsInNkIiwic2VuZCIsImhlYWRlcnMiLCJjcmVkZW50aWFscyIsImNhY2hlIiwiYm9keSIsImZldGNoIiwiUmVxdWVzdCIsImFycmF5QnVmZmVyIiwiVGEiLCJSZWFkYWJsZVN0cmVhbSIsImdldFJlYWRlciIsIlVpbnQ4QXJyYXkiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiYXBwZW5kIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwidmQiLCJ3ZCIsInhkIiwieWQiLCJwYSIsInpkIiwiQ2QiLCJEZCIsIkVkIiwiRmEiLCJsb2NhdGlvbiIsInByb3RvY29sIiwiQWQiLCJtb3pSZXNwb25zZUFycmF5QnVmZmVyIiwiR2QiLCJGZCIsIkhkIiwiaW50ZXJuYWxDaGFubmVsUGFyYW1zIiwiSWQiLCJ4bWxIdHRwRmFjdG9yeSIsInN1cHBvcnRzQ3Jvc3NEb21haW5YaHIiLCJjb25jdXJyZW50UmVxdWVzdExpbWl0IiwiZmFzdEhhbmRzaGFrZSIsImZvcmNlTG9uZ1BvbGxpbmciLCJkZXRlY3RCdWZmZXJpbmdQcm94eSIsIkpkIiwiS2QiLCJzZW5kQmVhY29uIiwiSW1hZ2UiLCJMZCIsIk1kIiwiUWQiLCJQZCIsInJvdW5kIiwibWluIiwiT2QiLCJSZCIsIk5kIiwibmQiLCJhZCIsImJkIiwiaG9zdG5hbWUiLCJwb3J0IiwiU2QiLCJUZCIsIm1lc3NhZ2VVcmxQYXJhbXMiLCJtZXNzYWdlSGVhZGVycyIsImNsaWVudFByb3RvY29sSGVhZGVyUmVxdWlyZWQiLCJpbml0TWVzc2FnZUhlYWRlcnMiLCJtZXNzYWdlQ29udGVudFR5cGUiLCJodHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtIiwic2VuZFJhd0pzb24iLCJodHRwU2Vzc2lvbklkUGFyYW0iLCJVZCIsIl9fc21fXyIsIlZkIiwidG9VcHBlckNhc2UiLCJGb3JtRGF0YSIsIndpdGhDcmVkZW50aWFscyIsInRpbWVvdXQiLCJCZCIsIl9fZGF0YV9fIiwiY3JlYXRlV2ViQ2hhbm5lbCIsIkhUVFBfRVJST1IiLCJDT01QTEVURSIsIkV2ZW50VHlwZSIsIkNMT1NFIiwiTUVTU0FHRSIsImxpc3RlbiIsImxpc3Rlbk9uY2UiLCJnZXRMYXN0RXJyb3IiLCJnZXRMYXN0RXJyb3JDb2RlIiwiZ2V0U3RhdHVzIiwiZ2V0UmVzcG9uc2VKc29uIiwiZ2V0UmVzcG9uc2VUZXh0IiwiY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCIsImdldFN0YXRFdmVudFRhcmdldCIsIkVycm9yQ29kZSIsIkV2ZW50IiwiU3RhdCIsInViIiwiUFJPWFkiLCJOT1BST1hZIiwiRmV0Y2hYbWxIdHRwRmFjdG9yeSIsIldlYkNoYW5uZWwiLCJYaHJJbyIsInVpZCIsImlzQXV0aGVudGljYXRlZCIsInRvS2V5IiwiaXNFcXVhbCIsIlVOQVVUSEVOVElDQVRFRCIsIkdPT0dMRV9DUkVERU5USUFMUyIsIkZJUlNUX1BBUlRZIiwiTU9DS19VU0VSIiwiT0siLCJDQU5DRUxMRUQiLCJVTktOT1dOIiwiSU5WQUxJRF9BUkdVTUVOVCIsIkRFQURMSU5FX0VYQ0VFREVEIiwiTk9UX0ZPVU5EIiwiQUxSRUFEWV9FWElTVFMiLCJQRVJNSVNTSU9OX0RFTklFRCIsIlJFU09VUkNFX0VYSEFVU1RFRCIsIkZBSUxFRF9QUkVDT05ESVRJT04iLCJBQk9SVEVEIiwiT1VUX09GX1JBTkdFIiwiVU5JTVBMRU1FTlRFRCIsIlVOQVZBSUxBQkxFIiwiREFUQV9MT1NTIiwidXNlciIsImdldFRva2VuIiwiaW52YWxpZGF0ZVRva2VuIiwiZW5xdWV1ZVJldHJ5YWJsZSIsInNodXRkb3duIiwiY3VycmVudFVzZXIiLCJmb3JjZVJlZnJlc2giLCJhdXRoIiwiYWRkQXV0aFRva2VuTGlzdGVuZXIiLCJhY2Nlc3NUb2tlbiIsInJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyIiwiZ2V0VWlkIiwiZ2V0QXV0aEhlYWRlclZhbHVlRm9yRmlyc3RQYXJ0eSIsInR0IiwiYXBwQ2hlY2siLCJ0b2tlbiIsImFkZFRva2VuTGlzdGVuZXIiLCJyZW1vdmVUb2tlbkxpc3RlbmVyIiwibnQiLCJwcmV2aW91c1ZhbHVlIiwic2VxdWVuY2VOdW1iZXJIYW5kbGVyIiwid3JpdGVTZXF1ZW5jZU51bWJlciIsInN0IiwiY3J5cHRvIiwibXNDcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJpdCIsInN0YXRpYyIsInJ0Iiwib3QiLCJldmVyeSIsImF0Iiwic2Vjb25kcyIsIm5hbm9zZWNvbmRzIiwiZnJvbU1pbGxpcyIsImdldFRpbWUiLCJ0b0RhdGUiLCJ0b01pbGxpcyIsIl9jb21wYXJlVG8iLCJ0b0pTT04iLCJwYWRTdGFydCIsImN0IiwidGltZXN0YW1wIiwiY29tcGFyZVRvIiwidG9NaWNyb3NlY29uZHMiLCJ0b1RpbWVzdGFtcCIsImh0IiwibHQiLCJmdCIsImR0Iiwic2VnbWVudHMiLCJvZmZzZXQiLCJsZW4iLCJjb21wYXJhdG9yIiwiY2hpbGQiLCJsaW1pdCIsImNvbnN0cnVjdCIsInBvcEZpcnN0IiwicG9wTGFzdCIsImZpcnN0U2VnbWVudCIsImxhc3RTZWdtZW50IiwiaXNFbXB0eSIsImlzUHJlZml4T2YiLCJpc0ltbWVkaWF0ZVBhcmVudE9mIiwidG9BcnJheSIsIl90IiwiY2Fub25pY2FsU3RyaW5nIiwid3QiLCJtdCIsImlzVmFsaWRJZGVudGlmaWVyIiwiaXNLZXlGaWVsZCIsImd0IiwiZmllbGRzIiwiY292ZXJzIiwicHQiLCJiaW5hcnlTdHJpbmciLCJpdGVyYXRvciIsInRvQmFzZTY0IiwidG9VaW50OEFycmF5IiwiYXBwcm94aW1hdGVCeXRlU2l6ZSIsIkVNUFRZX0JZVEVfU1RSSU5HIiwiSXQiLCJSZWdFeHAiLCJUdCIsIm5hbm9zIiwiRXQiLCJBdCIsImZyb21CYXNlNjRTdHJpbmciLCJmcm9tVWludDhBcnJheSIsIlB0IiwibWFwVmFsdWUiLCJfX2xvY2FsX3dyaXRlX3RpbWVfXyIsInRpbWVzdGFtcFZhbHVlIiwiVnQiLCJkYXRhYmFzZUlkIiwicGVyc2lzdGVuY2VLZXkiLCJob3N0Iiwic3NsIiwiYXV0b0RldGVjdExvbmdQb2xsaW5nIiwidXNlRmV0Y2hTdHJlYW1zIiwidnQiLCJwcm9qZWN0SWQiLCJkYXRhYmFzZSIsImlzRGVmYXVsdERhdGFiYXNlIiwiU3QiLCJEdCIsInh0IiwicGF0aCIsImZyb21TdHJpbmciLCJlbXB0eVBhdGgiLCJjb2xsZWN0aW9uR3JvdXAiLCJoYXNDb2xsZWN0aW9uSWQiLCJnZXRDb2xsZWN0aW9uR3JvdXAiLCJnZXRDb2xsZWN0aW9uUGF0aCIsIk50IiwiX190eXBlX18iLCJzdHJpbmdWYWx1ZSIsIk10IiwiUnQiLCJIdCIsIk90IiwiYm9vbGVhblZhbHVlIiwiYnl0ZXNWYWx1ZSIsInJlZmVyZW5jZVZhbHVlIiwiZ2VvUG9pbnRWYWx1ZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaW50ZWdlclZhbHVlIiwiZG91YmxlVmFsdWUiLCJhcnJheVZhbHVlIiwiRnQiLCIkdCIsIkJ0IiwiTHQiLCJVdCIsImZyb21OYW1lIiwiS3QiLCJHdCIsIld0IiwienQiLCJ0ZSIsImZpZWxkIiwiZ2V0RmllbGRzTWFwIiwic2V0QWxsIiwiYXBwbHlDaGFuZ2VzIiwiY2xvbmUiLCJlZSIsIm5lIiwiZG9jdW1lbnRUeXBlIiwicmVhZFRpbWUiLCJkb2N1bWVudFN0YXRlIiwiZW1wdHkiLCJjb252ZXJ0VG9Gb3VuZERvY3VtZW50IiwiY29udmVydFRvTm9Eb2N1bWVudCIsImNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCIsInNldEhhc0NvbW1pdHRlZE11dGF0aW9ucyIsInNldEhhc0xvY2FsTXV0YXRpb25zIiwic2V0UmVhZFRpbWUiLCJoYXNMb2NhbE11dGF0aW9ucyIsImhhc0NvbW1pdHRlZE11dGF0aW9ucyIsImhhc1BlbmRpbmdXcml0ZXMiLCJpc1ZhbGlkRG9jdW1lbnQiLCJpc0ZvdW5kRG9jdW1lbnQiLCJpc05vRG9jdW1lbnQiLCJpc1Vua25vd25Eb2N1bWVudCIsIm11dGFibGVDb3B5IiwiY2UiLCJoZSIsImRvY3VtZW50S2V5IiwibGFyZ2VzdEJhdGNoSWQiLCJsZSIsImZlIiwiX2UiLCJFTVBUWSIsImluc2VydCIsImNvcHkiLCJCTEFDSyIsInJlbW92ZSIsImxlZnQiLCJyaWdodCIsIm1pbktleSIsIm1heEtleSIsImlub3JkZXJUcmF2ZXJzYWwiLCJyZXZlcnNlVHJhdmVyc2FsIiwiZ2V0SXRlcmF0b3IiLCJkZSIsImdldEl0ZXJhdG9yRnJvbSIsImdldFJldmVyc2VJdGVyYXRvciIsImdldFJldmVyc2VJdGVyYXRvckZyb20iLCJpc1JldmVyc2UiLCJub2RlU3RhY2siLCJnZXROZXh0IiwiaGFzTmV4dCIsInBlZWsiLCJjb2xvciIsIlJFRCIsImZpeFVwIiwicmVtb3ZlTWluIiwiaXNSZWQiLCJtb3ZlUmVkTGVmdCIsInJvdGF0ZVJpZ2h0IiwibW92ZVJlZFJpZ2h0Iiwicm90YXRlTGVmdCIsImNvbG9yRmxpcCIsImNoZWNrTWF4RGVwdGgiLCJjaGVjayIsInBvdyIsIndlIiwiZmlyc3QiLCJsYXN0IiwiZm9yRWFjaEluUmFuZ2UiLCJmb3JFYWNoV2hpbGUiLCJmaXJzdEFmdGVyT3JFcXVhbCIsIm1lIiwidW5pb25XaXRoIiwiaXRlciIsInllIiwib3JkZXJCeSIsImZpbHRlcnMiLCJzdGFydEF0IiwiZW5kQXQiLCJwZSIsIkllIiwib3AiLCJkaXIiLCJpbmNsdXNpdmUiLCJwb3NpdGlvbiIsIkVlIiwiJGUiLCJMZSIsIlZlIiwidmUiLCJ4ZSIsIk5lIiwia2UiLCJNZSIsIlNlIiwiRGUiLCJtYXRjaGVzIiwiQ2UiLCJudWxsVmFsdWUiLCJPZSIsIkZlIiwiQmUiLCJVZSIsImV4cGxpY2l0T3JkZXJCeSIsImxpbWl0VHlwZSIsInplIiwiamUiLCJRZSIsImtleUZpZWxkIiwiSGUiLCJZZSIsIlhlIiwiWmUiLCJUZSIsInRuIiwiaXNEb2N1bWVudEtleSIsInNuIiwicm4iLCJvbiIsInVuIiwiaXNJbnRlZ2VyIiwiTUFYX1NBRkVfSU5URUdFUiIsIk1JTl9TQUZFX0lOVEVHRVIiLCJDdCIsImFuIiwiY24iLCJmbiIsIl9fcHJldmlvdXNfdmFsdWVfXyIsImRuIiwiX24iLCJ3biIsIm1uIiwibG4iLCJ5biIsImhuIiwiZ24iLCJlbGVtZW50cyIsInBuIiwiRW4iLCJ0cmFuc2Zvcm1SZXN1bHRzIiwiQW4iLCJ1cGRhdGVUaW1lIiwiZXhpc3RzIiwiaXNOb25lIiwiUm4iLCJibiIsIlBuIiwiQ24iLCJrbiIsImZpZWxkVHJhbnNmb3JtcyIsInhuIiwicHJlY29uZGl0aW9uIiwiTm4iLCJWbiIsIk1uIiwiRG4iLCJ2biIsInRyYW5zZm9ybSIsIlNuIiwiVG4iLCJmaWVsZE1hc2siLCJPbiIsIkZuIiwiQm4iLCJMbiIsIktuIiwibWFwS2V5Rm4iLCJlcXVhbHNGbiIsImlubmVyIiwiaW5uZXJTaXplIiwiR24iLCJRbiIsImpuIiwiV24iLCJ6biIsIkhuIiwiSm4iLCJZbiIsIlhuIiwibHMiLCJmcyIsImRzIiwiX3MiLCJ3cyIsImZyb21UaW1lc3RhbXAiLCJtcyIsInlzIiwiVHMiLCJLcyIsImdzIiwiQXMiLCJScyIsIk5zIiwicGFyZW50Iiwic3RydWN0dXJlZFF1ZXJ5IiwiYWxsRGVzY2VuZGFudHMiLCJjb2xsZWN0aW9uSWQiLCJ3aGVyZSIsIk1zIiwiQnMiLCJkaXJlY3Rpb24iLCJiZWZvcmUiLCJxZSIsInVuYXJ5RmlsdGVyIiwiVXMiLCJmaWVsZEZpbHRlciIsIkxzIiwiY29tcG9zaXRlRmlsdGVyIiwicmVkdWNlIiwiZnJvbVNlcnZlckZvcm1hdCIsImZpZWxkUGF0aCIsIk5hTiIsInFzIiwiZmllbGRQYXRocyIsInlpIiwibmV4dENhbGxiYWNrIiwiY2F0Y2hDYWxsYmFjayIsImlzRG9uZSIsImNhbGxiYWNrQXR0YWNoZWQiLCJ3cmFwRmFpbHVyZSIsIndyYXBTdWNjZXNzIiwidG9Qcm9taXNlIiwid3JhcFVzZXJGdW5jdGlvbiIsIndhaXRGb3IiLCJBaSIsIkRpIiwiYmF0Y2hJZCIsImxvY2FsV3JpdGVUaW1lIiwiYmFzZU11dGF0aW9ucyIsIm11dGF0aW9ucyIsImFwcGx5VG9SZW1vdGVEb2N1bWVudCIsIm11dGF0aW9uUmVzdWx0cyIsImFwcGx5VG9Mb2NhbFZpZXciLCJhcHBseVRvTG9jYWxEb2N1bWVudFNldCIsIkNpIiwiYmF0Y2giLCJjb21taXRWZXJzaW9uIiwiZG9jVmVyc2lvbnMiLCJ4aSIsIm11dGF0aW9uIiwiZ2V0S2V5Iiwia2kiLCJKdCIsIktpIiwiSmUiLCJZaSIsIlp0Iiwic2UiLCJpZSIsInJlIiwib2UiLCJ1ZSIsImFlIiwiYXIiLCJjciIsImFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4IiwiZ2V0Q29sbGVjdGlvblBhcmVudHMiLCJnZXRFbnRyaWVzIiwiYWRkRmllbGRJbmRleCIsImRlbGV0ZUZpZWxkSW5kZXgiLCJnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCIsImdldEluZGV4VHlwZSIsImdldEZpZWxkSW5kZXhlcyIsImdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSIsImdldE1pbk9mZnNldCIsInVwZGF0ZUNvbGxlY3Rpb25Hcm91cCIsInVwZGF0ZUluZGV4RW50cmllcyIsImdyIiwiY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCIsInBlcmNlbnRpbGVUb0NvbGxlY3QiLCJtYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0IiwiREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUiLCJERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QiLCJERUZBVUxUIiwiRElTQUJMRUQiLCJiciIsIkRyIiwiWHIiLCJpbmRleE1hbmFnZXIiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSIsImdldEVudHJ5IiwiR3MiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMiLCJRcyIsImpzIiwiV2UiLCJXcyIsInpzIiwiZ2V0QWxsRnJvbUNvbGxlY3Rpb24iLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSIsIm5ld0ludmFsaWREb2N1bWVudCIsIlpyIiwidGFyZ2V0SWQiLCJmcm9tQ2FjaGUiLCJIcyIsIkpzIiwiZG9jQ2hhbmdlcyIsImRvYyIsInRvIiwiWHMiLCJacyIsInRpIiwiZWkiLCJuaSIsIkdlIiwic2kiLCJpaSIsInJpIiwibm4iLCJlbyIsInBlcnNpc3RlbmNlIiwib2kiLCJ1aSIsImFpIiwiY2kiLCJoaSIsImdldFJlbW90ZURvY3VtZW50Q2FjaGUiLCJnZXRUYXJnZXRDYWNoZSIsImdldEJ1bmRsZUNhY2hlIiwibGkiLCJnZXRJbmRleE1hbmFnZXIiLCJnZXRNdXRhdGlvblF1ZXVlIiwiZmkiLCJzZXRJbmRleE1hbmFnZXIiLCJjb2xsZWN0R2FyYmFnZSIsInJ1blRyYW5zYWN0aW9uIiwiY29sbGVjdCIsInNvIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzIiwiZGkiLCJyZW1vdmVkQmF0Y2hJZHMiLCJhZGRlZEJhdGNoSWRzIiwiYW8iLCJnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCIsInlvIiwicGkiLCJnZXRCdW5kbGVNZXRhZGF0YSIsInNhdmVCdW5kbGVNZXRhZGF0YSIsImNyZWF0ZVRpbWUiLCJnZXROYW1lZFF1ZXJ5Iiwic2F2ZU5hbWVkUXVlcnkiLCJxdWVyeSIsImJ1bmRsZWRRdWVyeSIsInBvIiwib3ZlcmxheXMiLCJJaSIsImdldE92ZXJsYXkiLCJzYXZlT3ZlcmxheXMiLCJYdCIsInJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCIsImdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbiIsImdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbkdyb3VwIiwiSW8iLCJUaSIsIlRvIiwiRWkiLCJSaSIsImFkZFJlZmVyZW5jZSIsImJpIiwicmVtb3ZlUmVmZXJlbmNlIiwiUGkiLCJWaSIsInZpIiwiU2kiLCJjb250YWluc0tleSIsIkVvIiwicmVmZXJlbmNlRGVsZWdhdGUiLCJOaSIsImNoZWNrRW1wdHkiLCJhZGRNdXRhdGlvbkJhdGNoIiwibG9va3VwTXV0YXRpb25CYXRjaCIsIk1pIiwiZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCIsIlBPU0lUSVZFX0lORklOSVRZIiwiT2kiLCJyZW1vdmVNdXRhdGlvbkJhdGNoIiwiRmkiLCJtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCIsInBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrIiwiQW8iLCIkaSIsImRvY3MiLCJhZGRFbnRyeSIsInJlbW92ZUVudHJ5IiwiZ2V0QWxsRnJvbUNvbGxlY3Rpb25Hcm91cCIsIkJpIiwibmV3Q2hhbmdlQnVmZmVyIiwiUm8iLCJnZXRTaXplIiwiY2hhbmdlcyIsImNoYW5nZXNBcHBsaWVkIiwiYXNzZXJ0Tm90QXBwbGllZCIsImdldEZyb21DYWNoZSIsImdldEFsbEZyb21DYWNoZSIsImJvIiwiTGkiLCJsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uIiwiaGlnaGVzdFRhcmdldElkIiwiVWkiLCJxaSIsInRhcmdldENvdW50IiwiZm9yRWFjaFRhcmdldCIsImdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIiLCJhbGxvY2F0ZVRhcmdldElkIiwic2V0VGFyZ2V0c01ldGFkYXRhIiwic2VxdWVuY2VOdW1iZXIiLCJhZGRUYXJnZXREYXRhIiwidXBkYXRlVGFyZ2V0RGF0YSIsInJlbW92ZVRhcmdldERhdGEiLCJyZW1vdmVUYXJnZXRzIiwicmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQiLCJnZXRUYXJnZXRDb3VudCIsImdldFRhcmdldERhdGEiLCJhZGRNYXRjaGluZ0tleXMiLCJyZW1vdmVNYXRjaGluZ0tleXMiLCJnZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCIsIlBvIiwiR2kiLCJlcyIsIm5zIiwiUWkiLCJzdGFydGVkIiwic2V0RGF0YWJhc2VEZWxldGVkTGlzdGVuZXIiLCJzZXROZXR3b3JrRW5hYmxlZCIsImdldERvY3VtZW50T3ZlcmxheUNhY2hlIiwiVm8iLCJqaSIsIldpIiwicmFpc2VPbkNvbW1pdHRlZEV2ZW50IiwiemkiLCJvciIsIm9uQ29tbWl0dGVkTGlzdGVuZXJzIiwiYWRkT25Db21taXR0ZWRMaXN0ZW5lciIsImN1cnJlbnRTZXF1ZW5jZU51bWJlciIsInZvIiwiSGkiLCJKaSIsIlhpIiwicmVtb3ZlVGFyZ2V0IiwiZnJvbVBhdGgiLCJaaSIsInVwZGF0ZUxpbWJvRG9jdW1lbnQiLCJPbyIsImFjdGl2ZVRhcmdldElkcyIsIm5yIiwic3IiLCJlciIsInVwZGF0ZVRpbWVNcyIsIiRvIiwiVXIiLCJxciIsIm9ubGluZVN0YXRlSGFuZGxlciIsImFkZFBlbmRpbmdNdXRhdGlvbiIsInVwZGF0ZU11dGF0aW9uU3RhdGUiLCJhZGRMb2NhbFF1ZXJ5VGFyZ2V0IiwidXBkYXRlUXVlcnlTdGF0ZSIsInJlbW92ZUxvY2FsUXVlcnlUYXJnZXQiLCJpc0xvY2FsUXVlcnlUYXJnZXQiLCJjbGVhclF1ZXJ5U3RhdGUiLCJnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMiLCJpc0FjdGl2ZVF1ZXJ5VGFyZ2V0IiwiaGFuZGxlVXNlckNoYW5nZSIsInNldE9ubGluZVN0YXRlIiwibm90aWZ5QnVuZGxlTG9hZGVkIiwiQm8iLCJLciIsIkxvIiwiR3IiLCJRciIsImpyIiwiV3IiLCJ6ciIsIkhyIiwiVW8iLCJCYXRjaEdldERvY3VtZW50cyIsIkNvbW1pdCIsIlJ1blF1ZXJ5IiwicW8iLCJKciIsIllyIiwibm8iLCJvbk1lc3NhZ2UiLCJpbyIsInJvIiwib28iLCJLbyIsImRhdGFiYXNlSW5mbyIsInVvIiwiY28iLCJobyIsImxvIiwiZm8iLCJfbyIsIndvIiwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zIiwiaXNJRSIsInJ1bnRpbWUiLCJjaHJvbWUiLCJicm93c2VyIiwiaXNCcm93c2VyRXh0ZW5zaW9uIiwicW4iLCJRbyIsImpvIiwiV28iLCJ0aW1lcklkIiwibW8iLCJlbnF1ZXVlQWZ0ZXJEZWxheSIsInNraXBEZWxheSIsIkpvIiwiU28iLCJhdXRoQ3JlZGVudGlhbHNQcm92aWRlciIsImFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlciIsIkRvIiwiQ28iLCJ4byIsIk5vIiwia28iLCJNbyIsIkZvIiwiR28iLCJlbnF1ZXVlQW5kRm9yZ2V0IiwiWW8iLCJYbyIsImxhc3RTdHJlYW1Ub2tlbiIsIlpvIiwic3RyZWFtVG9rZW4iLCJEcyIsIndyaXRlUmVzdWx0cyIsImNvbW1pdFRpbWUiLCJ0dSIsImV1IiwibnUiLCJFcyIsIndyaXRlcyIsInVwZGF0ZSIsInVwZGF0ZU1hc2siLCJ2ZXJpZnkiLCJ1cGRhdGVUcmFuc2Zvcm1zIiwic2V0VG9TZXJ2ZXJWYWx1ZSIsImFwcGVuZE1pc3NpbmdFbGVtZW50cyIsInJlbW92ZUFsbEZyb21BcnJheSIsImluY3JlbWVudCIsImN1cnJlbnREb2N1bWVudCIsInZzIiwiYXV0aENyZWRlbnRpYWxzIiwiYXBwQ2hlY2tDcmVkZW50aWFscyIsInN1IiwiaXUiLCJ0ZXJtaW5hdGUiLCJhc3luY1F1ZXVlIiwicnUiLCJvdSIsInV1IiwiYXUiLCJjdSIsImh1IiwibHUiLCJmdSIsImxvY2FsU3RvcmUiLCJkYXRhc3RvcmUiLCJyZW1vdGVTeW5jZXIiLCJkdSIsIl91Iiwid3UiLCJtdSIsImd1IiwieXUiLCJWdSIsInB1IiwiSXUiLCJUdSIsIkV1IiwiYXBwbHlTdWNjZXNzZnVsV3JpdGUiLCJBdSIsIlVuIiwicmVqZWN0RmFpbGVkV3JpdGUiLCJSdSIsInZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MiLCJoYW5kbGVDcmVkZW50aWFsQ2hhbmdlIiwic3RvcCIsInZ1IiwidGFyZ2V0VGltZU1zIiwicmVtb3ZhbENhbGxiYWNrIiwidGltZXJIYW5kbGUiLCJoYW5kbGVEZWxheUVsYXBzZWQiLCJTdSIsImt1IiwicXVlcmllcyIsIm9ubGluZVN0YXRlIiwiYnUiLCJKdSIsInJlbW90ZVN0b3JlIiwiZXZlbnRNYW5hZ2VyIiwic2hhcmVkQ2xpZW50U3RhdGUiLCJtYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucyIsImlzUHJpbWFyeUNsaWVudCIsInZpZXciLCJQdSIsInNuYXBzaG90IiwibGlzdGVuZXJzIiwiQnUiLCJ6byIsInRyYWNrUmVtb3ZhbHMiLCJZcyIsInNuYXBzaG90VmVyc2lvbiIsIndpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIiwic3luY2hyb25pemVUYWJzIiwiZ2NTY2hlZHVsZXIiLCJpbml0aWFsVXNlciIsImNyZWF0ZURhdGFzdG9yZSIsImNyZWF0ZVJlbW90ZVN0b3JlIiwiY3JlYXRlRXZlbnRNYW5hZ2VyIiwic3luY0VuZ2luZSIsImNyZWF0ZVN5bmNFbmdpbmUiLCJjbGllbnRJZCIsImF1dGhDcmVkZW50aWFsTGlzdGVuZXIiLCJhcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciIsInNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciIsInNldEFwcENoZWNrVG9rZW5DaGFuZ2VMaXN0ZW5lciIsInZlcmlmeU5vdFRlcm1pbmF0ZWQiLCJpc1NodXR0aW5nRG93biIsImVudGVyUmVzdHJpY3RlZE1vZGUiLCJlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCIsIm9ubGluZUNvbXBvbmVudHMiLCJvZmZsaW5lQ29tcG9uZW50cyIsImdldENvbmZpZ3VyYXRpb24iLCJpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzIiwiY2FjaGVTaXplQnl0ZXMiLCJleHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nIiwiZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nIiwiX2F1dGhDcmVkZW50aWFscyIsIl9hcHBDaGVja0NyZWRlbnRpYWxzIiwiX3BlcnNpc3RlbmNlS2V5IiwiX3NldHRpbmdzIiwiX3NldHRpbmdzRnJvemVuIiwiX2RhdGFiYXNlSWQiLCJfYXBwIiwiX2luaXRpYWxpemVkIiwiX3Rlcm1pbmF0ZWQiLCJfdGVybWluYXRlVGFzayIsIl9zZXRTZXR0aW5ncyIsImNsaWVudCIsInNlc3Npb25JbmRleCIsImlhbVRva2VuIiwiX2dldFNldHRpbmdzIiwiX2ZyZWV6ZVNldHRpbmdzIiwiX3Rlcm1pbmF0ZSIsInNldHRpbmdzIiwiY29udmVydGVyIiwiX2tleSIsImZpcmVzdG9yZSIsIl9wYXRoIiwid2l0aENvbnZlcnRlciIsIl9xdWVyeSIsIktlIiwidmlzaWJpbGl0eVN0YXRlIiwiZW5xdWV1ZSIsInN0YWNrIiwiY3JlYXRlQW5kU2NoZWR1bGUiLCJfcXVldWUiLCJfZmlyZXN0b3JlQ2xpZW50IiwiX2ludGVybmFsUGF0aCIsIl9ieXRlU3RyaW5nIiwiX21ldGhvZE5hbWUiLCJpc0Zpbml0ZSIsIl9sYXQiLCJfbG9uZyIsInRvTXV0YXRpb24iLCJ5aCIsIm1ldGhvZE5hbWUiLCJjb250YWlucyIsInRoIiwiZWgiLCJtZXJnZSIsIm1lcmdlRmllbGRzIiwiX2giLCJmaCIsIndoIiwicGgiLCJsaCIsImRoIiwiX3RvRmllbGRUcmFuc2Zvcm0iLCJmcm9tRGF0ZSIsImdldFByb3RvdHlwZU9mIiwic2VhcmNoIiwibWgiLCJnaCIsImxsIiwidG9GaXJlc3RvcmUiLCJZaCIsIl9sIiwiU0RLX1ZFUlNJT04iLCJyYXdDb25maWciLCJleGlzdGluZ0FwcCIsIm5ld0FwcCIsImluaXRpYWxpemVBcHAiLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwic3RvcmFnZUJ1Y2tldCIsIm1lc3NhZ2luZ1NlbmRlcklkIiwibWVhc3VyZW1lbnRJZCIsImRhdGFiYXNlVVJMIiwiZ2V0QXBwIiwiaGVhcnRiZWF0Q29udHJvbGxlciIsInRyaWdnZXJIZWFydGJlYXQiLCJzYXZlIiwiZG9jUmVmIiwiWGF5bWEiLCJmaXJlYmFzZSIsIiR0ZXh0YXJlYSIsIiRlbCIsIm9uU2F2ZSIsIm9uUmVhZHkiLCJlbnRyZXByaXNlIiwibGFuZyIsImluaXQiLCJmaXJzdENoaWxkIiwiZWwiLCJxdWVyeVNlbGVjdG9yIiwiYnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJidG4iLCJnZXRBdHRyaWJ1dGUiLCJvbkFjdGlvbkJ0bkNsaWNrIiwiZWRpdG9yIiwidGV4dGFyZWEiLCJlbWFpbCIsImVtYWlsSW5wdXQiLCJzdWJtaXQiLCJzdWJtaXRCdG4iLCJmaW5pc2giLCJmaW5pc2hJY29uIiwiZmluaXNoVGV4dCIsImNoaWxkcmVuIiwic3RlcCIsInRyYW5zbGF0ZSIsIm5vdGVzIiwiZmluYWxseSIsIndvcmQiLCJmciIsInBsYWNlaG9sZGVyIiwiZW4iLCJpbm5lclRleHQiLCJfbm90ZSIsIl9zdGVwIiwiX3NhdmluZyIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsInNldEl0ZW0iLCJfbGFuZyIsIlBvcHVwIiwibWFpbiIsImxhbmd1YWdlIiwic3RhcnRCdXR0b24iLCJjbG9zZXJCdXR0b24iLCJzdGFydGVyIiwidG9nZ2xlT3BlbiIsImNsb3NlciIsInN0YXJ0ZXJCdXR0b24iLCJmb3JjZUNsb3NlIl0sInNvdXJjZVJvb3QiOiIifQ==